### 5-1-1. ワークブックとデータモデルのデータリネージを表示する (View workbook and data model data lineage)

データリネージ（系譜）とは、ワークブックまたはデータモデル内のデータ要素間の祖先と関係を指します。すべてのワークブックとデータモデルには**リネージグラフ**が含まれており、ドキュメント内の関係と依存関係を確認・操作することができます。

データリネージのユースケースには、以下のようなものがあります。
* データ要素への変更が子要素にどのように影響するかを判断する
* 予期しないデータのソースを特定する
* 未使用または冗長な要素を削除するために既存のワークブックをクリーンアップする
* データおよび/または権限エラーのソースを診断する
* マテリアライゼーションスケジュールの依存関係を特定する

このドキュメントでは、ワークブックまたはデータモデルのデータリネージを表示し、操作する方法について説明します。

#### **要件 (Requirements)**

データリネージを表示するには、ワークブックまたはデータモデルに対する`Can Edit`[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。

#### **ワークブックまたはデータモデルのデータリネージを表示する (View data lineage for a workbook or data model)**

1.  ドキュメントヘッダーの`Edit`をクリックして、編集用にドキュメントを開きます。
2.  `(Lineage)`を選択して、ワークブックまたはデータモデルのデータリネージを開きます。
    > 💡
    > 特定の要素の要素ツールバーからリネージを開くこともできます。
    > 1.  要素ツールバーで、`More`を選択します。
    > 2.  メニューで、`View lineage`を選択します。
    > ドキュメントのデータリネージが、その要素がハイライトされた状態で開きます。

[画像挿入]


データリネージグラフでは、以下のいずれかを実行できます。
* `+`および`-`オプションを使用してズームインおよびズームアウトする。
* ブラウザウィンドウのビューにリネージグラフを合わせる。
* `Show controls`チェックボックスを選択して、コントロール要素を表示または非表示にする。
* カーソルで掴んでドラッグして、グラフ内を移動する。
* クリックしてドラッグすることで、グラフ内の要素を再編成する。要素の位置に加えた変更は、データリネージを閉じるとリセットされます。
* [特定の要素またはページにリネージビューをフォーカスする](#focus-your-lineage-view-on-a-specific-element-or-page)。
* [データリネージから要素を開く](#open-an-element-from-data-lineage)。

#### **特定の要素またはページにリネージビューをフォーカスする (Focus your lineage view on a specific element or page)**

* **始める前に:** このアクションは編集モードでのみ利用可能です。編集を開始するには、ドキュメントヘッダーの`Edit`をクリックします。

1.  `(Lineage)`を選択して、ワークブックまたはデータモデルのデータリネージを開きます。
2.  グラフの上部で、要素を検索するか、ドロップダウンメニューを開いてワークブックまたはデータモデル内の特定のページを選択します。
3.  メニューからページを選択すると、そのページの要素のみが表示されます。

#### **データリネージから要素を開く (Open an element from data lineage)**

* **始める前に:** このアクションは編集モードでのみ利用可能です。編集を開始するには、ドキュメントヘッダーの`Edit`をクリックします。

1.  `(Lineage)`を選択して、ワークブックまたはデータモデルのデータリネージを開きます。
2.  リネージグラフで要素を選択します。
3.  要素の詳細で、`View element`を選択します。

### 5-1-2. ワークブックまたは要素のデータソースを変更する (Change the data source for a workbook or element)

ワークブック全体または特定のデータ要素で使用されるデータソースを変更することができます。

例えば、実験や計算の作成中に本番データベースへの負荷を軽減するために、テストデータ接続からのデータソースでワークブックを構築することがあります。チームや組織とワークブックを公開・共有する準備ができたら、ワークブックで使用されているテストデータソースを本番データソースに置き換えることができます。

また、バージョンタグに基づいて、ワークブックやデータモデルのデータソースを自動的に変更または交換することもできます。「[Swap the source of a tagged version](https://help.sigmacomputing.com/docs/add-version-tags#swap-the-source-of-a-tagged-version)」を参照してください。

#### **要件 (Requirements)**
* 変更したい接続に対する`Can use`[アクセス権](https://help.sigmacomputing.com/docs/data-permissions)が付与されている必要があります。
* ワークブックに対する`Can edit`または`Can explore`のアクセス権が必要です。

#### **ワークブックのデータソースを交換する (Swap the data source for a workbook)**
ワークブック内のすべての要素のデータソースを交換するには（例えば、テストデータウェアハウス接続から本番データウェアハウス接続に変更するなど）、以下を実行します。

1.  ワークブックを`Edit`または`Explore`モードで開きます。
2.  ワークブックメニュー から、`Swap data sources…`を選択します。
3.  `Swap Data Sources Overview`モーダルで、自動選択された`Matching Connection`を確認します。必要に応じて、選択された接続を更新します。
4.  ワークブック内の各要素の`Matching Data Sources`を確認します。いずれかのデータソースに`No Match`がある場合は、`Match Manually`を選択して、一致するデータソースがない各要素に対して異なるデータソースを選択します。
5.  手動マッチページで、要素によって使用されるデータソースを選択し、`Select Source`をクリックします。
6.  新しいデータソースを検索または参照し、`Select`をクリックします。
7.  マッチングが必要な次のデータソースを選択し、これらのステップを繰り返します。
8.  一致しないすべてのデータソースが新しいデータソースにマッチングされた後、`Swap`を選択します。
9.  手動でマッチングする必要があるデータソースがない場合は、`Swap Now`を選択します。

ワークブックは新しいデータソースを使用するように更新されます。一致するデータソースがない要素はエラーを表示します。

> 🚩
> ワークブックに入力テーブルまたはカスタムSQL要素が含まれている場合、それらの要素のデータソースと接続は交換されません。代わりに、新しい接続をデータソースとして要素を再作成する必要があります。
> * **入力テーブルの場合、** 新しい接続で入力テーブルを作成し、古い入力テーブルから新しいものへデータをコピー＆ペーストします。
> * **カスタムSQL要素の場合、** 新しいSQL要素を作成し、新しいデータ接続に対して同等のSQLを記述します。

#### **要素のデータソースを変更する (Change the data source for an element)**
特定の要素に使用されるデータソースを変更することもできます。例えば、Snowflakeデータベースにビューを作成し、Sigmaのテーブル要素をSnowflake接続のベーステーブルの代わりにそのビューを使用するように更新したい場合、ソースを交換できます。

> 🚩
> 入力テーブルまたは接続されたデータウェアハウスを直接クエリするSQLを使用する要素のデータソースは変更できません。SQL要素のソースを変更すると、その要素はもはやSQLを使用しなくなります。

##### **要素のデータソースを交換する (Swap the data source for an element)**
`Edit`または`Explore`モードで要素を選択した後、データソースを変更できます。
1.  ワークブックキャンバスから、`More` > `Element source` > `Change source`を選択します。または、エディタパネルの`Properties`タブで、データソースの名前を探し、 > `Change source`を選択します。
2.  要素の新しいデータソースを検索または参照します。
3.  [任意] データソースをプレビューして特定の列を選択し、`Add`をクリックします。
4.  データソースを選択して、データソースの変更を完了します。

データ要素は更新されます。要素に新しいデータソースに存在しない列を参照する計算列が含まれている場合、その計算列は「unknown column」と表示されます。

##### **テーブル要素で使用されるテーブルを置き換える (Replace the table used by a table element)**
テーブルまたはピボットテーブル要素で使用されるテーブルを別のテーブルに置き換えたい場合は、以下を実行します。
1.  ワークブックキャンバスから、`More` > `Element source` > `Replace table`を選択します。または、エディタパネルの`Properties`タブで、データソースの名前を探し、 > `Replace table`を選択します。
2.  要素の新しいテーブルを検索または参照します。
3.  選択した列を確認し、任意で不要な列の隣にあるチェックボックスの選択を解除します。
4.  `Add`をクリックします。

データ要素は更新されます。テーブルに新しいテーブルに存在しない列を参照する計算列が含まれている場合、その計算列は「unknown column」と表示されます。

### 5-1-3. ワークブックの更新オプションを管理する (Manage workbook refresh options)

Sigmaは、個人がワークブックを開くか更新するたびに、ワークブックのデータを更新します。ユーザーの操作なしで画面に表示されるワークブックなど、設定されたスケジュールでワークブックのデータを更新したい場合は、カスタムの更新スケジュールを設定できます。

データ要素は個別に更新することもできますが、自動スケジュールでは更新できません。

> 🚩
> Sigmaはデータを保存しません。すべての更新は、ウェアハウス内のデータに再度クエリを実行します。自動更新を設定すると、接続に負荷がかかり、多額のウェアハウスコストが発生する可能性があります。

#### **要件 (Requirements)**

更新スケジュールを設定するには、個々のワークブックに対する`Can Edit`[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)と、`Set workbook data refresh`権限が有効になっているアカウントタイプを割り当てられている必要があります。

ワークブックがホストアプリケーションに埋め込まれている場合、カスタム更新スケジュールを埋め込みコンテンツに適用するには、セキュアな埋め込みがJSON Web Tokens (JWTs)で認証されている必要があります。「[Create an embed API with JSON Web Tokens (Beta)](https://help.sigmacomputing.com/docs/example-embed-api-and-url#create-an-embed-api-with-json-web-tokens)」を参照してください。

#### **更新スケジュールを設定する (Set up a refresh schedule)**

ワークブックの更新スケジュールを設定するには、以下を実行します。
1.  ワークブックヘッダーの更新ボタンの右側にあるキャレット() `More options`をクリックします。
2.  `Data refresh`を選択します。
3.  `Data refresh settings`モーダルが開きます。
4.  `Refresh schedule`で、`Enable`トグルをオンにします。
5.  `Query data every`フィールドを調整して、ワークブックを更新する頻度を指定します。例えば、10分ごとなど。
6.  [任意] 更新スケジュールを特定の時間枠に制限するには、`Between`フィールドに時間を入力します。Sigmaは、更新スケジュールが有効であるべきかを評価するために、ブラウザのタイムゾーンを使用します。
7.  `Save`をクリックします。

#### **個々のデータ要素を更新する (Refresh individual data elements)**

個々のデータ要素のデータを手動で更新できます。
1.  データ要素を選択します。
2.  要素のツールバーで、`More`をクリックします。
3.  `Refresh data`をクリックします。
4.  要素内のデータが更新されます。

### 5-1-4. ワークブックのローカライゼーションを管理する (Manage workbook localization)

ローカライゼーションにより、ワークブックの編集者はカスタムワークブックのテキストを他の言語に翻訳できます。翻訳はワークブックのプレビューと埋め込みビューに適用されます。

管理者は、Sigma組織内のすべてのワークブックに適用される組織レベルの翻訳を作成することもできます。管理者によって管理される組織レベルの翻訳ファイルの詳細については、「[組織の翻訳ファイルを管理する](https://help.sigmacomputing.com/docs/manage-organization-translation-files)」を参照してください。

#### **要件 (Requirements)**
ワークブックの翻訳を管理するには、`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)が付与されている必要があります。
> 📘
> ワークブックのプレビューまたは埋め込みビューのURLと有効なロケール定義を持つ任意のユーザーが、翻訳されたワークブックを閲覧できます。

#### **サポートされている言語とロケール (Supported languages and locales)**
Sigmaは以下の言語とロケールをサポートしています。
| 言語 | ロケール |
| :--- | :--- |
| Chinese (Simplified) | zh-cn |
| Chinese (Traditional) | zh-tw |
| English (United States) | en |
| English (Australia) | en-au |
| English (Canada) | en-ca |
| English (Ireland) | en-ie |
| English (United Kingdom) | en-gb |
| French | fr |
| French (Canada) | fr-ca |
| German | de |
| Italian | it |
| Japanese | ja |
| Korean | ko-kr |
| Polish | pl |
| Portuguese | pt |
| Portuguese (Brazil) | pt-br |
| Russian | ru |
| Spanish | es |
| Spanish (Mexico) | es-mx |
| Swedish | sv-se |
| Thai | th |

#### **ワークブックの翻訳を作成する (Create a workbook translation)**
ワークブックの設定メニューからアクセスできる`Manage locales`パネルを使用して、ワークブックのロケールと翻訳を管理します。

1.  ワークブックを`Edit`モードで開きます。
2.  ワークブックの左サイドバーにある設定アイコン()をクリックして、ワークブックの設定パネルを開きます。
3.  `Manage locales`をクリックします。
4.  新しい言語を追加するには、`Available locales`の隣にあるプラスアイコン(+)をクリックします。
5.  ドロップダウンメニューから言語を選択します。
    > 📘
    > このステップを完了してワークブックのロケールを作成すると、すべての標準Sigmaテキスト（メニューラベル、モーダルテキストなど）の翻訳が有効になります。ワークブックのカスタムテキストを翻訳するには、この手順の残りを完了してください。
6.  ワークブック内のカスタムテキストの翻訳を追加するには、その他アイコン()をクリックし、jsonファイルをダウンロードします。

| オプション | 内容 | いつ使うか |
| :--- | :--- | :--- |
| **Download** | このオプションは、組織レベルの翻訳ファイルが存在しない場合に表示されます。結果のjsonファイルには、ワークブック内のカスタム文字列のすべてのキーと値のペアが含まれます。 | 管理者が組織全体に適用される翻訳を定義していない場合に、カスタムテキストの翻訳を定義するためにこのオプションを選択します。 |
| **Download untranslated strings** | 結果のjsonファイルには、組織レベルの翻訳ファイルのキーと一致しない、ワークブック内のカスタム文字列のキーと値のペアのみが含まれます。 | 組織レベルで定義されている値を上書きしたくない場合に、このオプションを選択します。 |
| **Download all strings** | 結果のjsonファイルには、ワークブック内のカスタム文字列のすべてのキーと値のペアが含まれます。 | このワークブックのカスタム文字列に適用されるすべての翻訳を確認したい場合、または組織レベルの翻訳をこのワークブック用に異なる翻訳で上書きしたい場合に、このオプションを選択します。|

7.  ダウンロードしたファイルを開きます。
8.  `.json`ファイルには、キーと値のペアのリストが含まれています。
    値を適切な翻訳に更新します。
    > 🚩
    > どのキーも編集しないでください。
9. ファイルを編集して保存します。ファイル名は変更しないでください。
10. Sigmaに戻ります。`Upload`をクリックし、更新した`.json`ファイルを選択します。
11. プレビューアイコン()をクリックして、翻訳されたテキストでワークブックのプレビューを開きます。

#### **ワークブックの翻訳を更新する (Update a workbook translation)**
#### **ワークブックの翻訳を更新する (Update a workbook translation)**
ワークブックにテキストの変更を公開するたびに、新しいまたは変更されたテキスト文字列の新しい翻訳を含むロケールの`.json`ファイルをダウンロードして再アップロードする必要があります。新しく追加された文字列は、jsonファイルの末尾に表示されます。

管理者がその言語の組織全体の翻訳ファイルを作成している場合は、未翻訳の文字列のみをダウンロードするか、すべての文字列をダウンロードするかを選択する必要があります。

| オプション | 内容 | いつ使うか |
| :--- | :--- | :--- |
| **Download (ダウンロード)** | このオプションは、組織レベルの翻訳ファイルが存在しない場合に表示されます。結果のjsonファイルには、ワークブック内のカスタム文字列のすべてのキーと値のペアが含まれます。 | 管理者が組織全体に適用される翻訳を定義していない場合に、カスタムテキストの翻訳を定義するためにこのオプションを選択します。 |
| **Download untranslated strings (未翻訳の文字列をダウンロード)** | 結果のjsonファイルには、組織レベルの翻訳ファイルのキーと一致しない、ワークブック内のカスタム文字列のキーと値のペアのみが含まれます。言い換えれば、組織レベルで翻訳が既に存在する場合、そのキーと値のペアはこのファイルでは省略されます。組織レベルのファイルで翻訳されていないキーは、このワークブックで定義された翻訳（もしあれば）を表示するか、まだ翻訳が提供されていない場合は英語の値を表示します。 | 組織レベルで定義されている値を上書きしたくない場合に、このオプションを選択します。 |
| **Download all strings (すべての文字列をダウンロード)** | 結果のjsonファイルには、ワークブック内のカスタム文字列のすべてのキーと値のペアが含まれます。組織レベルのファイルでのみ翻訳されているキーは、管理者がそのファイルで定義した値を表示します。組織レベルのファイルで翻訳されていないキーは、このワークブックで定義された翻訳（もしあれば）を表示するか、まだ翻訳が提供されていない場合は英語の値を表示します。組織レベルのファイルとワークブックレベルのファイルの両方で翻訳されているキーは、このワークブックで定義された翻訳を表示します。 | このワークブックのカスタム文字列に適用されるすべての翻訳を確認したい場合、または組織レベルの翻訳をこのワークブック用に異なる翻訳で上書きしたい場合に、このオプションを選択します。|

#### **言語のカスタム翻訳を追加する (Add a custom translation for a language)**

特定の言語に対して複数のユニークな翻訳を維持することができます。言語のカスタム翻訳を追加すると、例えば、埋め込みダッシュボードの異なる消費者に対して、ワークブック内の文字列を異なる方法で翻訳できます。

言語のカスタム翻訳を追加すると、カスタム翻訳ファイルがベース言語ファイルの**代わり**に使用されます。ベース言語ファイルに加えてカスタムの翻訳セットを適用するには、ベース言語ファイルをカスタム言語ファイルに複製してください。

1.  ワークブックを`Edit`モードで開きます。
2.  ワークブックの左サイドバーにある設定アイコン()をクリックして、ワークブックの設定パネルを開きます。
3.  `Manage locales`をクリックします。
4.  `Available locales`の隣にあるプラスアイコン(+)をクリックします。
5.  ドロップダウンメニューで、`Add custom translations`を選択します。
6.  カスタム翻訳ファイルの名前を入力します。
    > 🚩
    > 管理者が定義した組織レベルのカスタム翻訳セットをこの言語で継承したい場合は、ここで管理者が組織レベルの翻訳ファイルを作成した際に使用したのと同じ名前を使用する必要があります。管理者にファイルの名前を尋ねてください。
7.  `Base language`を設定して、すべての標準Sigmaテキスト（メニューラベル、モーダルテキストなど）に使用する言語を指定します。
8.  `Add`をクリックします。
9.  利用可能なロケールのリストで、追加したカスタム言語バリアントを見つけます。
    > 📘
    > 組織レベルの言語バリアントが存在し、カスタム言語バリアントファイルに同じ名前を使用した場合、組織レベルのファイルはグレーで表示されます。
10. ワークブック内のカスタムテキストの翻訳を追加するには、その他アイコン()をクリックし、jsonファイルをダウンロードします。

| オプション | 内容 | いつ使うか |
| :--- | :--- | :--- |
| **Download (ダウンロード)** | このオプションは、組織レベルの翻訳ファイルが存在しない場合に表示されます。結果のjsonファイルには、ワークブック内のカスタム文字列のすべてのキーと値のペアが含まれます。 | 管理者が組織全体に適用される翻訳を定義していない場合に、カスタムテキストの翻訳を定義するためにこのオプションを選択します。 |
| **Download untranslated strings (未翻訳の文字列をダウンロード)** | 結果のjsonファイルには、組織レベルの翻訳ファイルのキーと一致しない、ワークブック内のカスタム文字列のキーと値のペアのみが含まれます。 | 組織レベルで定義されている値を上書きしたくない場合に、このオプションを選択します。 |
| **Download all strings (すべての文字列をダウンロード)** | 結果のjsonファイルには、ワークブック内のカスタム文字列のすべてのキーと値のペアが含まれます。組織レベルのファイルでのみ翻訳されているキーは、管理者がそのファイルで定義した値を表示します。このワークブックレベルのファイルで翻訳されているキーは、このワークブックで既に定義されている翻訳（もしあれば）を表示するか、まだ翻訳が提供されていない場合は英語の値を表示します。組織レベルのファイルとワークブックレベルのファイルの両方で翻訳されているキーは、このワークブックで定義された翻訳を表示します。 | このワークブックのカスタム文字列に適用されるすべての翻訳を確認したい場合、または組織レベルの翻訳をこのワークブック用に異なる翻訳で上書きしたい場合に、このオプションを選択します。|

11. ダウンロードしたファイルを開きます。
12. `.json`ファイルには、キーと値のペアのリストが含まれています。
13. 値を適切な翻訳に更新します。
    > 🚩
    > どのキーも編集しないでください。
14. ファイルを編集して保存します。ファイル名は変更しないでください。
15. Sigmaに戻ります。`Upload`をクリックし、更新した`.json`ファイルを選択します。
16. プレビューアイコン()をクリックして、翻訳されたテキストでワークブックのプレビューを開きます。

カスタム翻訳は、管理者によって作成された組織レベルのファイルから継承できます。「[組織の翻訳ファイルを管理する](https://help.sigmacomputing.com/docs/manage-organization-translation-files)」を参照してください。

#### **翻訳ファイルでマークダウンと動的テキストを使用する (Use markdown and dynamic text in a translation file)**

JSONの値にマークダウンと動的テキストを使用して、リッチテキストをサポートできます。

値の一部として動的テキストを生成するには、以下の構文を使用します。 `[={formula-id}]`

他のリッチテキストにはマークダウン構文を使用します。

| 表示 | マークダウンバージョン |
| :--- | :--- |
| I love **bold** text. | `I love **bold** text.` |
| *Italics* are great too. | `*Italics* are great too.` |
| Click this [link](https://help.sigmacomputing.com). | `Click this [link](https://help.sigmacomputing.com).` |
| * Bullet points<br>* Make bulleted lists | `* Bullet points`<br>`* Make bulleted lists` |
| 1. Numbers<br>2. Make numbered lists | `1. Numbers`<br>`2. Make numbered lists` |

#### **埋め込みまたはプレビューにロケールと翻訳を適用する (Apply locales and translations to embeds or previews)**
埋め込みまたはプレビューにロケールを適用するには、埋め込みまたはワークブックプレビューのURLに `:lng=<your-locale>` を追加します。ロケールを適用すると、メニューラベルやモーダルテキストなどの標準Sigmaテキストが、ロケールに関連付けられた言語に翻訳されます。そのロケールに翻訳ファイルが定義されている場合、ロケールを適用すると、ワークブック内のカスタムテキストも定義された翻訳で翻訳されます。
言語のカスタム翻訳バリアントを適用する場合は、`:lng_variant=<variant+name>` も追加します。名前の特殊文字にはURLエンコーディングを使用してください。

* **埋め込みAPIコードの例:**
    ```javascript
    // 注：ローカライゼーションの値は大文字と小文字を区別します
    searchParams += '&:lng=fr-ca';
    ```
* **カスタム翻訳バリアントの埋め込みAPIコードの例:**
    ```javascript
    // 注：ローカライゼーションの値は大文字と小文字を区別します
    searchParams += '&:lng=it&:lng_variant=Custom+Italian';
    ```
* **埋め込みURLの例:**
    `https://app.sigmacomputing.com/my-company/workbook/My-Workbook-2PG8oM9uFxNLyzxAukJfBrL?:embed=true&:lng=fr-ca`
* **カスタム翻訳バリアントの埋め込みURLの例:**
    `https://app.sigmacomputing.com/my-company/workbook/My-Workbook-2PG8oM9uFxNLyzxAukJfBrL?:embed=true&:lng=it&:lng_variant=Custom+Italian`
> 💡
> ロケールを適用するために翻訳ファイルは必須ではありません。
> 翻訳ファイルが定義されていなくても、上記のパラメータを使用して埋め込みやプレビューにロケールを適用し、メニューラベルやモーダルテキストなどの標準Sigmaテキストを別の言語で表示することができます。

#### **現在の制限事項 (Current limitations)**
* 自動生成されたデータ要素名（例：Sum of Cost by Year of Date）は、Sigmaが生成する.jsonファイルには含まれません。翻訳を定義する前に、すべてのデータ要素を手動で命名してください。
* 探索モードはサポートされていません。
* 数値と日付のフォーマットはサポートされていません。

### 5-1-5. ワークブックのページの可視性を管理する (Manage workbook page visibility)

デフォルトでは、ワークブックのページは、ワークブックを閲覧、探索、または編集する権限を持つすべてのユーザーに表示されます。個々のページの可視性を変更して、特定のワークブックのコンテンツの閲覧を制限することができます。

このドキュメントでは、Sigmaのページの可視性オプションについて説明し、特定のページの可視性をカスタマイズする方法を解説します。

#### **ユーザー要件 (User requirements)**
ワークブックのページの可視性を管理する機能には、以下が必要です。
* `Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

#### **ページの可視性を理解する (Understanding page visibility)**
ページの可視性はセキュリティ機能ではありません。データへのアクセスを制限する必要がある場合は、「[Dataset Row-Level Security](https://help.sigmacomputing.com/docs/set-up-row-level-security)」を参照してください。
> 📘
> ワークブック内の少なくとも1つのページには、ページの可視性制限が適用されていない状態である必要があります。
> 🚧
> ページの可視性設定は、`View`および`Explore`モードでのみ適用されます。ワークブックの所有者および特定のワークブックに対する`Can edit`権限を付与された任意のユーザーは、ページの可視性設定に関わらず、`Edit`モードですべてのページにアクセスできます。
> 🚧
> `Save As`権限を持つユーザーがワークブックのコピーを保存すると、元のワークブックのページの可視性設定に関わらず、コピーにはすべてのページが表示されます。

##### **ページの可視性アイコン (Page visibility icons)**
ページタブには、現在のページの可視性設定を示すアイコンが表示されます。

| アイコン | 説明 |
| :--- | :--- |
| (アイコンなし) | ページがすべてのユーザーに表示されることを示します。|
| (アイコン) | ページが選択されたユーザーまたはチームにのみ表示されることを示します。|
| (アイコン) | ページがすべてのユーザーから非表示になっていることを示します。|

##### **ワークブックのバージョンとセキュアな埋め込みでのページの可視性 (Page visibility in workbook versions and secure embeds)**
* **タグ付きバージョン (Tagged versions)**
    タグ付きのワークブックバージョンは、タグが適用されたときにワークブックに保存されたページの可視性設定を継承します。したがって、あるバージョンではユーザーがページにアクセスでき、別のバージョンでは同じユーザーから非表示にすることができます。
* **セキュアな埋め込み (Secure embeds)**
    セキュアな埋め込みでのページの可視性は、チーム設定によって決定されます。ページは、ユーザーの割り当てられたチームに表示されている場合（`Show page to all users`または`Only show to select users or teams`を介して）にのみ、埋め込みユーザーに表示されます。
    > 🚧
    > セキュアな埋め込みユーザーが埋め込まれたワークブックのコピーを保存すると、元のワークブックのページの可視性設定に関わらず、コピーにはすべてのページが表示されます。

#### **ページを非表示または再表示する (Hide or unhide a page)**
`Hide page`および`Unhide page`オプションを使用して、すべてのユーザーに対するページの可視性を迅速に更新します。
1.  ワークブックを`Edit`モードで開きます。
2.  カスタマイズしたいページのタブを探します。
3.  タブのキャレット()をクリックしてページメニューを開き、利用可能なオプションを選択します。
    * **Hide page:** `View`または`Explore`モードでワークブックにアクセスするすべてのユーザーからページを非表示にします。ページが現在すべてのユーザーに表示されている場合に利用可能です。
    * **Unhide page:** 任意のモードでワークブックにアクセスするすべてのユーザーにページを表示します。ページが現在すべてまたは選択されたユーザーとチームから非表示になっている場合に利用可能です。

#### **ページの可視性をカスタマイズする (Customize page visibility)**
`Customize page visibility`オプションを使用して、すべてのユーザーまたは特定のユーザーとチームに対するページの可視性を更新します。
1.  ワークブックを`Edit`モードで開きます。
2.  カスタマイズしたいページのタブを探します。
3.  タブのキャレット()をクリックしてページメニューを開き、`Customize page visibility`を選択します。
4.  `Customize Page Visibility`モーダルで、ページの可視性を構成します。
    a. `Page visibility setting`フィールドをクリックし、ドロップダウンからオプションを選択します。
        * **Hide page from all users:** `View`または`Explore`モードでワークブックにアクセスするすべてのユーザーからページを非表示にします。
        * **Show page to all users (default):** 任意のモードでワークブックにアクセスするすべてのユーザーにページを表示します。
        * **Only show to select users or teams:** 選択されたユーザーとチームにのみページを表示します。`View`または`Explore`モードでワークブックにアクセスする残りのユーザーからはページを非表示にします。
    b. ステップ4aで`Only show to select users or teams`を選択した場合は、`Select users`フィールドを使用して、該当するユーザーとチームを検索して選択します。
    c. `Save`をクリックして、ページの可視性の変更を適用します。

### 5-1-6. ドキュメントにショートカットを追加する (Add shortcuts to documents)

複数の場所にドキュメントへのリンクを保存したい場合は、ショートカットを追加できます。

ショートカットを使用して、特定のデータソースをソースピッカーで見つけやすくしたり、主要なワークブックやデータモデルへのアクセスを容易にするためにドキュメントを整理したりします。

例えば、「Sales」ワークスペースにある「Quarterly Sales Targets」ワークブックへのショートカットを、個人の「My Documents」フォルダに追加して、そのワークブックに簡単にアクセスできるようにすることができます。

別の例として、「Marketing」ワークスペースに「Google Analytics」データモデル（またはデータウェアハウステーブル）へのショートカットを追加できます。次にMarketingワークスペースの誰かがワークブックに新しい要素を追加しようとするとき、その標準的なデータモデルが簡単に見つかります。

#### **サポートされているショートカットドキュメント (Supported shortcut documents)**
以下のファイル、フォルダ、その他のオブジェクトへのリンクを、Sigmaのワークスペースまたはフォルダにショートカットとして保存できます。
* ワークブック
* フォルダ（「My Documents」を除く）
* ワークスペース
* データモデル（データモデル内の可視要素を含む）
* データセット
* データウェアハウスのテーブル、ビュー、スキーマ、カタログ、データベース

ショートカットへのショートカットを追加することはできず、「My Documents」フォルダへのショートカットを別のフォルダやワークスペースに追加することもできません。

#### **ショートカットの権限 (Shortcut permissions)**
ドキュメントにショートカットを追加するには、あなたが所有者であるか、そのドキュメントに対する`Can Explore`または`Can Edit`の権限を持っている必要があります。

ワークブック、フォルダ、ワークスペース、データモデル、またはデータセットへのショートカットを作成しても、そのファイルやフォルダへの権限は変更されません。フォルダやワークスペースへのアクセス権を持つ誰もがショートカットを閲覧できますが、ドキュメント（ワークスペース、ワークブック、フォルダ、データモデル、データセット）へのアクセス権を付与されたユーザーのみが、そのドキュメントを開くことができます。

#### **ドキュメントにショートカットを追加する (Add a shortcut to a document)**
サポートされているドキュメントへのショートカットを、別のフォルダまたはワークスペースに追加できます。バージョンタグが付いたワークブック、データモデル、またはデータセットにショートカットを追加することはできません。

1.  ショートカットを追加したいドキュメントを含む親フォルダまたはワークスペースを開きます。例えば、「My Documents」フォルダ内のサブフォルダへのショートカットを追加するには、「My Documents」を開きます。
2.  `More` > `Add shortcut…`を選択します。
3.  ショートカットを追加したいフォルダまたはワークスペースを検索または参照し、`Add`をクリックします。
4.  ドキュメントへのショートカットが、そのフォルダまたはワークスペースで利用可能になります。

ワークブック、データモデル、またはデータセットを表示中にショートカットを追加することもできます。
1.  ヘッダーで、ワークブック、データモデル、またはデータセットのタイトルの隣にある下矢印()を選択して、ドキュメントメニューを開きます。
2.  `File` > `Add shortcut…`を選択します。
3.  ショートカットを追加したいフォルダまたはワークスペースを検索または参照し、`Add`をクリックします。
    ワークブックへのショートカットが、そのフォルダまたはワークスペースで利用可能になります。

#### **データウェアハウスオブジェクトにショートカットを追加する (Add a shortcut to a data warehouse object)**
データウェアハウス内のテーブル、ビュー、スキーマ、カタログ、またはデータベースにショートカットを追加するには：
1.  Sigmaホームから、`Connections`を選択します。
2.  接続を選択し、ショートカットを追加したいオブジェクトを検索または参照します。
3.  オブジェクトにカーソルを合わせ、`More` > `Add shortcut…`を選択します。
4.  ショートカットを追加したいフォルダまたはワークスペースを検索または参照し、`Add`をクリックします。
5.  オブジェクトへのショートカットが、そのフォルダまたはワークスペースで利用可能になります。

その後、データソースを追加する際に、そのショートカットを使用してデータベースオブジェクトをより簡単に見つけることができます。

削除されたドキュメントへのショートカットがある場合、そのショートカットを削除するように促されます。ショートカットをクリックすると、もしアクセス権があれば、削除されたドキュメントを復元するように促されます。

### 5-2-1. テンプレートからワークブックを作成する (Create workbooks from templates)

テンプレートは、迅速かつ一貫性をもって新しいワークブックを構築できる、再利用可能なワークブック構造です。

このドキュメントでは、既存のテンプレートにアクセスし、それらを使用して新しいワークブックを作成する方法について説明します。テンプレートに関する詳細は、「[テンプレートの作成と編集](https://help.sigmacomputing.com/docs/create-and-edit-templates)」および「[テンプレートの共有](https://help.sigmacomputing.com/docs/share-templates)」を参照してください。

#### **要件 (Requirements)**

既存のテンプレートにアクセスし、それを使用して新しいワークブックを作成する機能には、以下が必要です。
* `Can create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたの組織のユーザーによって作成されたテンプレート（`Templates` > `Internal`内）にアクセスするには、あなたがテンプレートの所有者であるか、`Can use`または`Can edit`のテンプレート権限を付与されている必要があります。
* Sigmaテンプレートやあなたの組織と共有されている他のテンプレート（`Templates` > `External`内）にアクセスするには、`Internal`メンバータイプを割り当てられている必要があります。ゲストユーザーは外部テンプレートにアクセスできません。

#### **テンプレートからワークブックを作成する (Create a workbook from a template)**

1.  ホームページの左側ナビゲーションパネルから`Templates`ギャラリーページを開きます。
2.  探索したいテンプレートをクリックします。
3.  テンプレート化されたワークブックが開きます。
4.  テーブル、ビジュアライゼーション、コントロールなど、そのインタラクティブな要素のいずれかをクリックしてテンプレートを探索します。あなたの変更は、テンプレート自体には影響しません。
5.  [任意] テンプレートから編集可能で公開可能なワークブックを作成するには、テンプレートのヘッダーで`Save As`をクリックします。

#### **ワークブックテンプレートであなたのデータを使用する（ソースを交換する）(Use your data in a workbook template (swap sources))**

* **前提条件:** 交換したいデータはSigmaで利用可能である必要があります。

ワークブックテンプレートに独自のデータを注入するには：
1.  ホームページの左側ナビゲーションパネルから`Templates`ギャラリーページを開きます。
2.  使用したいテンプレートをクリックします。
3.  テンプレート化されたワークブックが開きます。
4.  ワークブックが[サンプルデータ](https://help.sigmacomputing.com/docs/sample-connection)上に構築されている場合、ページ上部にポップアップが表示されます。
5.  `Swap now`をクリックします。
6.  これにより、`Swap Data Sources`ページが開きます。
7.  Sigmaは、テンプレートの期待されるデータとあなたのデータを自動的に照合しようと試みます。
8.  しかし、これを上書きすることも、Sigmaが見つけられないソースを手動で選択する必要がある場合もあります。
    * [任意] 一致したソースを置き換えるには、`REPLACE WITH`の下にあるソースの隣の編集()ボタンをクリックします。次に、モーダルから新しいソースを選択します。
9.  テンプレートが追加のソースを必要とする場合は、左端のパネル`ALL SOURCES IN USE`から各ソースの一致を確認します。
10. 準備ができたら、`Swap`をクリックします。
11. ワークブックを探索して、あなたのデータが正しく表示されることを確認します。
12. テンプレートから編集可能で公開可能なワークブックを作成するには、テンプレートのヘッダーで`Save As`をクリックします。

ワークブックはソースの交換もサポートしています。ワークブックにデータを交換し始めるには、ワークブックを編集モードで開き、ヘッダーメニューを開いて`Swap data sources`をクリックします。

### 5-2-2. ワークブックテンプレートの作成と編集 (Create and edit workbook templates)

ワークブック[テンプレート](https://help.sigmacomputing.com/docs/get-started-with-workbook-templates)を使用すると、ユーザーは[ワークブック](https://help.sigmacomputing.com/docs/workbooks-overview)の構造をテンプレート化して共有し、迅速かつ一貫性のある再利用が可能になります。

#### **要件 (Requirements)**

テンプレートを作成および編集する機能には、以下が必要です。
* 既存のワークブックから新しいテンプレートを作成するには、`Create, edit, and publish workbooks`権限を持つ[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられ、既存のワークブックに対する表示アクセス権を持っている必要があります。
* 既存のテンプレートを編集するには、あなたがテンプレートの所有者であるか、`Can edit`のテンプレート権限を付与されている必要があります。

#### **新しいテンプレートを作成する (Create a new template)**

1.  テンプレートの基として使用したいワークブックを開きます。
2.  ドキュメントメニューから、`File` > `Save as template`を選択します。
3.  `Template Name`を入力します。
4.  [任意] テンプレートを共有したい場合は、組織のメンバーまたはチームの名前を入力し、ドロップダウンから希望の権限を選択します。
5.  `Save`をクリックします。新しいテンプレートにリダイレクトされます。

#### **既存のテンプレートを編集する (Edit an existing template)**

1.  ホームページから`Templates`を選択します。
2.  編集したいテンプレートを見つけ、`More` > `Open`を選択します。
3.  テンプレートのヘッダーで、`Edit`を選択します。
4.  変更を加えます。
5.  テンプレートのヘッダーで、`Publish`をクリックして変更を保存します。

### 5-3. ワークブックのライフサイクル

#### 5-3-1. ワークブックのライフサイクル：探索、ドラフト、公開 (Workbook lifecycle: explore, draft, and publish)

ワークブックは、アドホックなデータ探索と複雑な長期レポーティングの両方をサポートします。共同作業が可能なインターフェースと、データ操作への視覚的なアプローチにより、組織内の誰もがライブデータとリアルタイムの共同作業にアクセスできるようになります。この記事では、データ探索から公開、バージョン履歴までの、ワークブックのライフサイクルの基本を紹介します。

##### **アドホックなデータ探索 (Ad hoc data exploration)**
新規の、保存されていないワークブックは「探索（explorations）」とも呼ばれます。探索は、将来の使用のために作業を保存することなく、データを探索して次に進みたい場合のアドホック分析に最適です。
探索を公開済みワークブックとして保存するには、探索のヘッダーにある`Save as`をクリックします。
「[Ad hoc data exploration](https://help.sigmacomputing.com/docs/ad-hoc-data-explorations)」を参照してください。

##### **ワークブックのモード：編集、探索、表示 (Workbook modes: Edit, Explore, and View)**
公開済みのワークブックは、編集、探索、表示の3つの異なるモードでアクセスできます。特定のワークブックでアクセスできるモードは、その個々のワークブックに対してあなたに付与された権限に依存します。「[Workbook modes overview](https://help.sigmacomputing.com/docs/workbook-modes-overview)」を参照してください。

##### **ドラフトと公開 (Drafts and publishing)**
ワークブックに加えられた編集は、共有されたライブドラフトとして自動的に保存されます。複数の編集者が単一のドラフトでリアルタイムに共同作業できます。すべてのアクティブな編集者は、現在編集モードにいる他のユーザーのリストと、それぞれが選択している要素を見ることができます。
`Publish`をクリックすると、ライブドラフト上のすべての編集者によってドラフトされた変更を含む、ワークブックへのすべてのドラフトされた変更が公開されます。
「[Edit, draft, and publish a workbook](https://help.sigmacomputing.com/docs/draft-and-publish-a-workbook)」を参照してください。

##### **バージョン履歴 (Version history)**
Sigmaは、公開されたワークブックのバージョンとそれに関連する変更の履歴を保存します。これをバージョン履歴と呼びます。バージョン履歴には、ワークブックヘッダーにあるバージョンメニューからアクセスします。
「[Workbook versions and version history](https://help.sigmacomputing.com/docs/document-versions-and-version-history)」を参照してください。

### 5-3-2. ドキュメントバッジの表示と管理 (View and manage document badges)

ワークブックとデータモデルに認定バッジ（推奨、警告、非推奨）を設定して、ドキュメントのステータス、品質、信頼性を反映させます。

例えば、以下のようにデータモデルのライフサイクルの段階を示すためにバッジを使用します。
* **Endorsed (推奨):** データモデルは検証済みで信頼でき、品質基準を満たしています。
* **Warning (警告):** データモデルは古い、不完全、またはレビュー中です。
* **Deprecated (非推奨):** データモデルは廃止されたか、もはやメンテナンスされていません。

このドキュメントでは、ワークブックとデータモデルでバッジを表示、設定、削除する方法について説明します。データセットとデータベーステーブルに認定バッジを追加する方法については、「[データセットの作成と管理](https://help.sigmacomputing.com/docs/create-and-manage-datasets)」および「[データカタログのレビューと管理](https://help.sigmacomputing.com/docs/review-and-manage-your-data-catalog)」を参照してください。

#### **ユーザー要件 (User requirements)**
バッジを設定または削除する機能には、以下が必要です。
* `Manage all badges`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがドキュメントの所有者であるか、任意の[ドキュメント権限](https://help.sigmacomputing.com/docs/folder-and-document-permissions)を付与されている必要があります。

バッジは、ドキュメントへのアクセス権を付与された任意のユーザーに表示されます。

#### **既存のバッジを表示する (View existing badges)**
ホームページから、または個々のワークブックからバッジを表示できます。
* **ホームページ:** ホームページから、`My documents`を選択します。最近アクセスしたドキュメントのうち、どのドキュメントにバッジが割り当てられているかを確認できます。
* **ワークブック内:** バッジはドキュメントメニュー（ワークブックの名前の隣）に表示されます。

#### **バッジを設定する (Set a badge)**
1.  バッジを割り当てたいドキュメントを開きます。
2.  ヘッダーで、ドキュメント名をクリックし、メニューから`File` > `Set badge`を選択します。
3.  `Set badge`モーダルで、ドキュメントに適用するバッジを選択し、次にバッジに関するメモを追加します（任意）。<img width="442" height="343" alt="93c323bcf1da34cef10cde8bd6e76f778618ef5b53c983e1d0d87519ba259f8f-image" src="https://github.com/user-attachments/assets/d31efc12-341e-45b3-bc80-25c4134f7484" />

4.  `Add`（現在バッジが設定されていない場合）または`Update`（既存のバッジを置き換える場合）をクリックしてバッジを設定します。

#### **バッジを削除する (Delete a badge)**
1.  削除したいバッジがあるドキュメントを開きます。
2.  ヘッダーで、ドキュメント名をクリックし、メニューから`File` > `Set badge`を選択します。
3.  `Set badge`モーダルで、`Delete`をクリックしてドキュメントからバッジを削除します。

### 5-3-3. ワークブックのバージョンとバージョン履歴 (Workbook versions and version history)

ワークブックにはバージョンがあります。デフォルトのバージョンは「Published」と「Draft」で、「タグ付きバージョン」と呼ばれる新しいカスタムバージョンを追加することもできます。バージョンタグ付けの詳細については、「[ワークブックとデータモデルにバージョンタグを追加する](https://help.sigmacomputing.com/docs/add-version-tags)」を参照してください。ワークブックの編集と公開の詳細については、「[ワークブックの編集、ドラフト、公開](https://help.sigmacomputing.com/docs/draft-and-publish-a-workbook)」を参照してください。

ワークブックのバージョン履歴には、以前に公開されたすべてのワークブックのバージョンのリストと、保留中のドラフトの変更が含まれています。各公開バージョンには、編集履歴と呼ばれる変更の詳細なリストが含まれています。バージョンと編集履歴を使用して、ドラフトされた変更を確認したり、古い公開バージョンと比較または元に戻したり、チームの誰が特定の編集または一連の変更を行ったかを特定したり、特定のバージョンタグでタグ付けされたバージョンを特定したりできます。ワークブックのバージョン履歴の保持期間に制限はありません。

#### **要件 (Requirements)**
* 編集履歴や現在のドラフトへの編集を含むワークブックのバージョン履歴は、ワークブックに対する`Can Edit`権限を持つユーザーのみが利用できます。
* ワークブックの古いバージョンや変更を復元できるのは、`Can Edit`権限を持つユーザーのみです。
* 2022年12月13日より前に行われた変更については、編集履歴は利用できません。2022年12月13日以降、ライブ編集が有効になっているすべての組織では、編集履歴で編集が追跡されます。ライブ編集が有効になる前に行われた編集は、追跡されません。詳細は、「[ワークブックでのライブ編集による共同作業](https://help.sigmacomputing.com/docs/collaborate-with-live-edit-in-workbooks)」を参照してください。

#### **ワークブックのバージョンについて (About workbook versions)**
ワークブックを開くと、現在のバージョンがワークブックヘッダーに表示されます。
* 公開済みのワークブックを表示している場合、バージョンは`PUBLISHED`です。
* タグ付きバージョンを表示している場合、バージョンタグの名前が表示されます。
* 編集のためにワークブックを開くと、バージョンは`DRAFT`です。

ワークブックは、以下のいずれかのバージョンを持つことができます。
* **Draft (ドラフト):** ワークブックを編集中は、ドラフトモードになり、変更はあなたと現在ワークブックを編集している他の人にのみ表示されます。
* **Published (公開済み):** ワークブックへの表示または探索アクセス権を持つ他の人が変更を見られるようにするには、それを公開します。
* **Tagged (タグ付き):** 特定のユーザーまたは特定の目的のためにワークブックの読み取り専用バージョンを利用可能にしたい場合は、特定のワークブックバージョンにタグを適用できます。例えば、「Development」や「Production」としてワークブックにタグを付けることができます。「[ワークブックとデータモデルにバージョンタグを追加する](https://help.sigmacomputing.com/docs/add-version-tags)」を参照してください。

ワークブックのバージョンのライフサイクルに関する詳細は、「[ワークブックの編集、ドラフト、公開](https://help.sigmacomputing.com/docs/draft-and-publish-a-workbook)」を参照してください。

#### **ワークブックのバージョン履歴を開く (Open version history for a workbook)**
ワークブックに変更を加えると、その変更はバージョン履歴に表示されます。バージョンを公開すると、バージョン履歴が更新されます。
バージョン履歴を表示するには、ワークブックに対する`Can Edit`権限が必要です。

1.  ワークブックを開きます。
2.  ドキュメント名の隣にあるキャレット()をクリックし、`Version history`を選択します。現在のバージョンの名前を選択し、`View version history`を選択することもできます。<img width="1370" height="790" alt="0194740807d15b795f80246ff4cf6000479c03ef296cb63e279a8a87db693814-workbook-vh-open" src="https://github.com/user-attachments/assets/97e12193-3881-404a-8fcf-266565a381d7" />

3.  バージョン履歴パネルが開き、最新バージョンとその変更が表示されます。以前に公開されたバージョンは以下にリストされ、現在公開されているバージョンに対応するバージョンには`Current`というラベルが付いています。 バージョンタイムスタンプの隣にあるシェブロンをクリックして特定のバージョンの詳細な編集履歴を確認するか、特定のバージョンまたは変更を選択してその時点でのワークブックを表示します。<img width="1371" height="577" alt="0ca6cd62dd323090a666c58d665ec54fa14bd8eb46e4941adacb35d485b18b06-selected-change-vh" src="https://github.com/user-attachments/assets/9d51bff1-5490-45b8-b95f-6dd7eafcf7c1" />

4.  ワークブックの最新バージョンに戻るには、`Go back to latest version`を選択します。
5.  バージョン履歴パネルを閉じるには、`X`をクリックします。

#### **ドラフトを以前の変更またはバージョンに復元する (Restore a draft to a previous change or version)**
ワークブックを以前に公開されたバージョンに戻すか、ワークブックのバージョン履歴の特定の変更に戻すには、以前の変更またはバージョンをドラフトとして復元します。以前のバージョンを復元する前に行われた変更は、バージョン履歴に残ります。
バージョン履歴の以前のバージョンまたは変更を復元するには、ワークブックに対する`Can Edit`権限が必要です。

* **ドラフトを以前に公開されたバージョンに復元する**
    ドラフトを以前に公開されたバージョンに復元するには、以下を実行します。
    1.  ワークブックのバージョン履歴を開きます。
    2.  復元したい以前に公開されたバージョンを探します。
    3.  `More`をクリックし、`Restore version as draft`を選択します。
    4.  変更は、リストされたバージョンのタイムスタンプとともに`Restored version from`としてバージョン履歴に表示されます。
    5.  必要に応じて他の変更を行うか、`Publish`をクリックして変更を公開します。

* **バージョン履歴の以前の変更に戻す**
    ワークブックのドラフトを、バージョンまたはドラフトの編集履歴の特定の変更に復元できます。
    > 🚧
    > ワークブックに入力テーブルが含まれており、バージョン履歴の以前の変更にワークブックを復元した場合、入力テーブルの内容はその時点には復元されず、代わりに最新の変更が反映されます。
    > 代わりに、特定の変更に最も近い公開バージョンを復元し、その後で特定の変更を復元することができます。
    ドラフトを編集履歴の以前の変更に戻すには、以下を実行します。
    1.  ワークブックのバージョン履歴を開きます。
    2.  ドラフトを戻したい変更が含まれるバージョンを探します。
    3.  必要に応じて、バージョンの編集履歴を展開し、その変更を探して選択します。
    4.  ワークブックヘッダーで、`Restore version as draft`を選択します。
    5.  変更は`Restored from autosaved draft`としてバージョン履歴に表示されます。
    6.  必要に応じて他の変更を行うか、`Publish`をクリックして変更を公開します。

#### **以前に公開されたバージョンを操作する (Work with previously published versions)**
ワークブックのバージョン履歴を確認する際、以前に公開されたバージョンに対していくつかのアクションを実行できます。`More`を選択して、以下のいずれかを実行します。
* **Restore version as draft:** バージョンをドラフトとして復元します。「[ドラフトを以前に公開されたバージョンに復元する](#restore-a-draft-to-a-previously-published-version)」を参照してください。
* **Edit name and description:** バージョンの名前と説明を変更します。デフォルトでは、バージョンはタイムスタンプでリストされます。
* **Save as new workbook:** バージョンを新しいワークブックとして保存します。
* **Copy link:** 以前のワークブックバージョンへのリンクをコピーします。ワークブックへのアクセス権を持つユーザーのみがリンクを表示できます。
* **Set a tag on the version:** バージョンにタグを設定します。「[ワークブックとデータモデルにバージョンタグを追加する](https://help.sigmacomputing.com/docs/add-version-tags)」を参照してください。

### 5-3-4. ワークブックとデータモデルにバージョンタグを追加する (Add version tags to workbooks and data models)

> 🚩
> データモデルのバージョンタグ付けはパブリックベータ機能であり、迅速で反復的な変更の対象となります。そのため、最新の製品バージョンはこのドキュメントの内容と異なる場合があります。詳細は、「[Beta features](https://help.sigmacomputing.com/docs/beta-features)」を参照してください。
> ワークブックのバージョンタグ付けは一般的に利用可能です。

ワークブックまたはデータモデルのバージョンにタグを追加して、そのドキュメントバージョンの読み取り専用ビューを作成します。その後、タグ付きバージョンを別のチームと共有して彼ら専用にしたり、タグ付きバージョンのワークブックをアプリケーションに埋め込んだり、タグ付きバージョンを使用してバージョン管理を行う開発ライフサイクルを実装したりできます。

ワークブックまたはデータモデルのバージョンにタグを付けると、タグ付きバージョンに影響を与えることなく、典型的なドラフトと公開のワークフローでソースドキュメントの反復作業を続けることができます。詳細は、「[Version tagging workflow](#version-tagging-workflow)」を参照してください。

ワークブックまたはデータモデルの複数のバージョンにタグを付けることができますが、同じタグでドキュメントの複数のバージョンにタグを付けることはできません。

管理者は、承認フローを必要とする保護されたタグの作成を含む、バージョンタグの作成と管理ができます。「[Create and manage version tags](https://help.sigmacomputing.com/docs/create-and-manage-version-tags)」を参照してください。

#### **バージョンタグ付けのワークフロー (Version tagging workflow)**
すべてのワークブックとデータモデルには、公開バージョンとドラフトがあります。ドキュメントに加えられたすべての変更は、[バージョン履歴](https://help.sigmacomputing.com/docs/document-versions-and-version-history)で表示できます。

特定のドキュメントバージョンにタグを付けて、そのドキュメントバージョンのステータスについて何かを示すことができます。例えば、ワークブックのバージョンにタグを付けて、内容の正確性をレビューする必要があること、または本番環境で使用する準備ができていることを示します。
<img width="1759" height="1344" alt="4be75c3ec3cb8eaefd59cade127457cb1258bb6afa73e321f0aa15e50a019c95-version-tag-workflow" src="https://github.com/user-attachments/assets/48cd4525-a2af-400f-b282-51adff62f8bb" />

データモデルにもタグを付け、同様のワークフローを使用して、テスト用または本番用に特定のデータモデルバージョンにタグを付けられます。

タグ付きバージョンがレビューされている間、ドラフトの反復作業を続けることができます。ドラフトまたは公開バージョンに加えられた変更は、タグ付きバージョンには影響しません。詳細は、「[Make changes to a tagged workbook version](#make-changes-to-a-tagged-workbook-version)」を参照してください。
<img width="1375" height="890" alt="6d1aa5d397ed3e77e4b4c358aba2e9e35d18a529aed6b3f1faeffa61e457880a-draft-publish-tag-workflow" src="https://github.com/user-attachments/assets/aec8133a-8631-4bae-a98d-f3db452e6385" />

##### **バージョンタグ付けがデータセットとデータモデルに与える影響 (How version tagging affects datasets and data models)**
データセットをデータソースとして使用するワークブックバージョンにタグを付けると、使用中のデータセットバージョンのコピーが作成され、タグ付きワークブックバージョンで使用されます。タグ付きワークブックバージョンに関連付けられたデータセットは、元のデータセットに変更が加えられても更新されなくなり、ワークブックバージョンがタグ付けされたときに使用されていたデータセットのバージョンが事実上凍結されます。データソース自体は、バージョンタグによって何ら影響を受けません。
<img width="3728" height="2664" alt="4dac999-vt-diagram-dataset" src="https://github.com/user-attachments/assets/e26ce890-aec5-474b-99c5-511642ca76e6" />

データモデルをデータソースとして使用するワークブックは、動作が異なります。データモデルをデータソースとして使用するワークブックバージョンにタグを付けると、ワークブックバージョンはタグ付けされますが、データモデルバージョンはタグ付けされません。新しい列の追加や既存の列のデータ型の変更など、データモデルに加えられた将来の変更は、そのデータモデルに依存するワークブックのバージョンと同期されます。
<img width="3728" height="2664" alt="841bfca-vt-diagram-data-model" src="https://github.com/user-attachments/assets/37455837-ff10-4cf4-95f3-c890752613ae" />

タグ付きバージョンのワークブックのデータソースとして使用されるデータモデルを「凍結」したい場合は、データモデルとワークブックの両方にタグを付け、タグ付きバージョンのワークブックのデータソースとしてタグ付きデータモデルを使用できます。「[Swap the source of a tagged workbook version](#swap-the-source-of-a-tagged-workbook-version)」を参照してください。

##### **タグ付きワークブックバージョンの埋め込み (Embedding tagged workbook versions)**
ワークブックを埋め込む場合、バージョンタグを使用して環境間でコンテンツをプロモートする管理ができます。例えば、「test」と「production」タグを使用して変更を管理し、本番で使用されるバージョンを保護します。その後、埋め込みでタグ付きバージョンへの直接リンクを使用できます。「[タグ付きバージョンのワークブックへのリンク](#link-to-a-tagged-version-of-a-workbook)」を参照してください。

バージョンタグのワークフローとタグ付きバージョンのワークブックへのアクセス制限に関する詳細は、「[タグ付きワークブックバージョンに変更を加える](#make-changes-to-a-tagged-workbook-version)」および「[ドキュメントのタグ付きバージョンを共有する](https://help.sigmacomputing.com/docs/share-a-workbook#share-tagged-versions-of-a-document)」を参照してください。

タグの作成と、リクエスト承認フローを強制するためのタグの保護に関する詳細は、「[バージョンタグの作成と管理](https://help.sigmacomputing.com/docs/create-and-manage-version-tags)」を参照してください。

Sigmaでのバージョンタグ付けを、開発ワークフローに既に統合されているソース管理プラットフォームと統合したい場合は、Sigma REST APIを使用できます。レシピについては、「[QuickStart - Embedding 08: Version Tagging](https://help.sigmacomputing.com/docs/quickstart-embedding-08-version-tagging)」を参照してください。

##### **バージョンタグ付けとマテリアライゼーション (Version tagging and materialization)**
マテリアライズされたデータソースに依存するワークブックのバージョンにタグを付けると、タグ付きバージョンはマテリアライズされたデータソースを使用しない場合があります。

* **マテリアライズされたデータセット:** マテリアライズされたデータセットは、タグ付きバージョンのワークブックでは使用されません。代わりに、タグ付きバージョンのワークブックは、タグが適用されたときに作成されたデータセットのコピーに依存します。
* **マテリアライズされたデータモデル:** タグ付きバージョンのワークブックのソースを交換する場合など、タグ付きバージョンのデータモデルを使用しない限り、マテリアライズされたデータモデルが使用されます。データモデルのタグ付きバージョンはマテリアライズできません。

| オブジェクト | マテリアライズされたバージョンは使用されるか？ | 詳細 |
| :--- | :--- | :--- |
| **データセット** | マテリアライズされたバージョンは使用されない | タグ付きバージョンのワークブックは、元のデータセットの代わりにデータセットのコピーを使用します。 |
| **データモデル** | マテリアライズされたバージョンは使用される | タグ付きバージョンのワークブックはデータモデルを使用し、データモデルに加えられた変更と同期を保ち、マテリアライズされた結果を使用します。 |
| **タグ付きデータモデル** | マテリアライズされたバージョンは使用されない | タグ付きバージョンのワークブックは、タグ付きバージョンのデータモデルを使用します。これは現時点ではマテリアライズできません。 |

マテリアライゼーションの詳細については、「[Materialization](https://help.sigmacomputing.com/docs/about-materialization)」を参照してください。

#### **ワークブックまたはデータモデルのバージョンにタグを付ける (Tag a workbook or data model version)**

ワークブックまたはデータモデルのバージョンにタグを付けることができます。ドキュメントにタグを付けると、そのドキュメントの読み取り専用バージョンが作成され、それを他の人と共有したり埋め込んだりできます。
> 🚧
> データモデルのタグ付きバージョンは、Ask Sigmaでは利用できません。管理者がAsk Sigmaで利用可能なデータソースにデータモデルを含めることを選択した場合、そのデータモデルの公開バージョンのみが利用可能であり、公開バージョンにアクセスできるユーザーのみがそのデータモデルを参照するAsk Sigmaからの回答を受け取ることができます。詳細は、「[組織のAI機能を構成する](https://help.sigmacomputing.com/docs/configure-ai-features-for-your-organization)」を参照してください。

##### **ユーザー要件 (User requirements)**
ドキュメントバージョンにタグを付けるには、以下が真である必要があります。
* ドキュメントに対する`Can Edit`[権限](https://help.sigmacomputing.com/docs/share-a-workbook)が付与されている。
* `Apply Tag`および`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)が割り当てられている。

一部のタグは保護されており、ドキュメントに設定するには追加の権限が必要です。保護されたタグを設定するには、Adminアカウントタイプを割り当てられているか、保護されたタグを設定するアクセス権が付与されている必要があります。アクセス権がない場合は、タグの追加をリクエストできます。「[バージョンタグの作成と管理](https://help.sigmacomputing.com/docs/create-and-manage-version-tags)」を参照してください。

##### **ドキュメントにタグを設定する (Set a tag on a document)**
ドキュメントにタグを設定するには、以下の手順に従います。
1.  ドキュメントを開き、タグを付けたいバージョンを探します。
    * **ドキュメントの最新公開バージョンにタグを付けるには：**
        a. ドキュメント名の隣にある下矢印()をクリックしてドキュメントメニューを開きます。
        b. `Versions` > `Tag this version`を選択します。ドキュメントがドラフト状態で未公開の編集がある場合は、代わりに`Tag latest published version`と表示されます。
    * **ドキュメントの特定のバージョンにタグを付けるには：**
        a. ドキュメント名の隣にある下矢印()をクリックしてドキュメントメニューを開きます。
        b. `Versions` > `Version history`を選択し、タグを付けたいバージョンを探します。
        c. `More` > `Set tag on this version`をクリックします。
    `Set tag on version`モーダルが表示されます。
2.  `Choose tag`で、タグを選択します。
    適用する権限がない保護されたタグを選択した場合、タグの承認者にリクエストを送信するよう促されます。
    * a.`Request reason`に、保護されたタグをドキュメントに適用したい理由を正当化するためのメッセージをメールリクエストに含めて入力します。
    * b. `Request tag on version`をクリックします。
    * Sigmaはリクエストを承認できるユーザーにメールを送信します。
3.  [任意] タグ付きバージョンのドキュメントが異なるデータソースを使用するようにしたい場合は、`Swap sources of the tagged version`のチェックボックスを選択します。例えば、タグ付きバージョンに異なる接続、データベースまたはカタログ、テーブル、データモデル、またはデータセットを使用します。「[タグ付きバージョンのソースを交換する](#swap-the-source-of-a-tagged-workbook-version)」を参照してください。
    > 📘
    > ドキュメントに入力テーブルまたはCSVアップロードから作成されたテーブルが含まれている場合、このオプションを選択しないでください。これらの要素は接続間で移行できません。
4.  [任意] タグ付きバージョンのドキュメントへのアクセス権しか持たないユーザーが、デフォルトでタグ付きバージョンを開くようにしたい場合は、`Set this tag as default`のチェックボックスを選択します。「[ドキュメントのデフォルトバージョンタグを設定する](#set-a-default-version-tag-for-a-document)」を参照してください。
5.  バージョンタグ付きワークブックの場合、ワークブックで使用されているデータソースへの`Can view`アクセス権を付与したい場合は、`Allow user to use data sources when they "Save as"`のチェックボックスを選択します。このチェックボックスが選択されていない場合、ユーザーはデータなしでワークブックのタグ付きバージョンにアクセスします。
6.  `Set tag`をクリックします。
> 🚩
> ワークブックに入力テーブルが含まれている場合、タグ付きバージョンのワークブックには、ソースワークブックの入力テーブルとは別の空の入力テーブルのコピーが含まれます。ソースワークブックの入力テーブルに存在するデータをバージョンタグ付きバージョンに含めたい場合は、以下の手順が必要です：
> 1. 入力テーブルのデータ入力権限を、表示/探索モードで公開バージョンのみ編集可能に変更します。
> 2. バージョンタグを適用します。
> 3. 空のテーブルに手動でデータをコピー＆ペーストします。
> データモデルバージョンの一つの入力テーブルからタグ付きデータモデルバージョンにデータを移行したい場合、データモデルの公開バージョンの入力テーブルにデータを追加できないため、この回避策は利用できません。

#### **ドキュメントのデフォルトバージョンタグを設定する (Set a default version tag for a document)**

ワークブックまたはデータモデルにタグを適用する際、そのタグをデフォルトとして設定できます。デフォルトタグは、公開バージョンへのアクセス権がないユーザーに対して、デフォルトで表示されるドキュメントのバージョンを決定します。ユーザーが公開バージョンへのアクセス権を持っている場合、公開バージョンがデフォルトタグよりも優先されます。

> 📘
> ユーザーがドキュメントの公開バージョンにアクセスできず、デフォルトのバージョンタグが設定されていない場合、ドキュメントはユーザーがアクセスできる最新作成のタグ付きバージョンをロードします。

ドキュメントに対する`Can edit`アクセス権を持つ任意のユーザーが、タグをデフォルトとして設定できます。
1.  ドキュメント名の隣にある下矢印()をクリックしてドキュメントメニューを開きます。
2.  `Versions` > `Version history`を選択します。
3.  デフォルトとして設定したいタグ付きバージョンを探し、`More`を選択します。
4.  `Set tag as default`をクリックします。

タグをデフォルトから削除し、別のデフォルトタグに置き換えない場合は、以下の手順に従います。
1.  ドキュメント名の隣にある下矢印()をクリックしてドキュメントメニューを開きます。
2.  `Versions` > `Version history`を選択します。
3.  デフォルトバージョンタグの隣にある`More`を選択します。
4.  `Remove as default`をクリックします。

#### **ドキュメントバージョンからタグを削除する (Remove a tag from a document version)**

ワークブックまたはデータモデルのバージョンからタグを削除すると、バージョンはバージョン履歴から引き続きアクセス可能ですが、タグ付きバージョンへのアクセス権しか持たない人はドキュメントへのアクセスを失います。

> 💡
> 間違ったドキュメントバージョンにタグを付けた場合や、タグ付きバージョンへのアクセスのみを持つユーザーのアクセスを制限したい場合にタグを削除することがあります。タグ付きバージョンを更新したい場合は、このドキュメントの「[タグ付きワークブックバージョンに変更を加える](https://help.sigmacomputing.com/docs/add-version-tags#make-changes-to-a-tagged-workbook-version)」を参照してください。

ドキュメントバージョンからタグを削除するには：
1.  ドキュメント名の隣にある下矢印()をクリックしてドキュメントメニューを開きます。
2.  `Versions` > `Version history`を選択します。
    > 💡
    > 各バージョンの詳細な変更を折りたたむには、最新バージョンの隣にある下矢印を選択します。
3.  タグ付きバージョンを探し、`More` > `Remove this tag`を選択します。
4.  タグを削除すると、タグ付きバージョンがキャンバスに表示されます。

#### **タグ付きワークブックバージョンのソースを交換する (Swap the source of a tagged workbook version)**
> 📘
> ワークブックに複数のデータソースからの要素が含まれている場合、タグ付きワークブックバージョンのソースを交換することはできません。

タグ付きワークブックバージョンのソースを交換するには、例えば「testing」とタグ付けされたワークブックにテストデータ接続を使用し、「production」とタグ付けされたワークブックに本番データ接続に交換するなど、以下の手順に従います。手順は、ワークブックがデータソースとしてデータモデルを使用しているかどうかによって異なります。
* [タグ付きワークブックバージョンで使用されるデータモデルソースを交換する](#swap-the-data-model-source-used-by-a-tagged-workbook-version)
* [タグ付きワークブックバージョンで使用されるデータセットまたは接続ソースを交換する](#swap-the-dataset-or-connection-source-used-by-a-tagged-workbook-version)

ワークブックのデータソースの変更に関する詳細は、「[ワークブックまたは要素のデータソースを変更する](https://help.sigmacomputing.com/docs/change-the-data-source-for-a-workbook-or-element)」を参照してください。

##### **タグ付きワークブックバージョンで使用されるデータモデルソースを交換する (Swap the data model source used by a tagged workbook version)**
ワークブックがデータソースとしてデータモデルを使用しており、タグ付きワークブックバージョンが公開バージョンとは異なるデータソースを使用するようにしたい場合は、まずデータモデルにタグを付けてタグ付きデータモデルのソースを交換し、次にワークブックにタグを付けてタグ付きデータモデルをソースとして使用します。
ワークブックがデータソースとして使用するデータモデルが、別のデータモデルに基づいている場合は、そのソースデータモデルにもタグを付けます。
> 💡
> データソースで使用される接続を交換する場合、ワークブックバージョンではなくデータモデルバージョンにタグを付けてソースを交換すると、データソースへのアクセスをより簡単に管理および制御できます。

* **データモデルにタグを付けてソースを交換する**
    1.  編集のためにデータモデルを開き、タグを付けるバージョンを選択します。
    2.  `Set tag on version`モーダルが表示されます。
    3.  `Choose tag`で、データモデルに適用するタグを選択します。ワークブックで使用する予定の同じタグを選択します。
    4.  `Swap sources of the tagged version`のチェックボックスを選択します。
    5.  `Set tag`をクリックします。
    6.  `Swap sources`モーダルで、`Sources of tagged data model`に、タグ付きバージョンで使用する新しいデータソースを選択します。代わりにデータベースまたはカタログ、スキーマ、またはテーブルを変更したい場合は、現在のオブジェクト名にカーソルを合わせ、`Select`をクリックして別のオブジェクトを選択し、`Confirm`をクリックします。
    7.  `Swap and tag`を選択します。

* **ワークブックにタグを付けて、ソースをタグ付きデータモデルに交換する**
    1.  編集のためにワークブックを開き、タグを付けるバージョンを選択します。
    2.  `Set tag on version`モーダルが表示されます。
    3.  `Choose tag`で、ワークブックバージョンに適用するタグを選択します。
    4.  `Swap sources of the tagged version`のチェックボックスを選択します。
    5.  `Set tag`をクリックします。
    6.  `Swap sources`モーダルで、`Sources of tagged workbook`についてドロップダウンメニューを開き、対応するタグ付きバージョンのデータモデルを選択します。
        > 📘
        > ワークブックに複数のデータソースが含まれている場合、各データソースのソースを交換するオプションが表示されます。
    7.  `Swap and tag`を選択します。

##### **タグ付きワークブックバージョンで使用されるデータセットまたは接続ソースを交換する (Swap the dataset or connection source used by a tagged workbook version)**
タグ付きワークブックバージョンに異なる接続パス、データベース、またはスキーマを選択するには、以下を実行します。
1.  編集のためにワークブックを開き、タグを付けるバージョンを選択します。
2.  `Set tag on version`モーダルが表示されます。
3.  `Choose tag`で、ワークブックバージョンに適用するタグを選択します。
4.  `Swap sources of the tagged version`のチェックボックスを選択し、`Set tag`をクリックします。
5.  `Swap sources`モーダルで、`Sources of tagged data model`に、タグ付きバージョンで使用する新しいデータソースを選択します。
6.  `Swap and tag`をクリックします。
タグ付きバージョンのワークブックは、新しい接続を使用するように更新されます。ワークブックがデータセットを使用している場合、新しい接続上にデータセットのコピーが作成されます。


#### **タグ付きワークブックバージョンに変更を加える (Make changes to a tagged workbook version)**

タグ付きバージョンのワークブックに変更を加えたい場合は、まずタグ付きバージョンをドラフトに戻し、変更を加え、変更を公開し、バージョンに再度タグを付ける必要があります。

例えば、「testing」タグでワークブックバージョンにタグを付けた後、本番環境で使用する準備ができたことを示すために「production」タグでワークブックにタグを付ける開発ライフサイクルに従う場合、「testing」タグで反復作業を行いたい場合があります。

「testing」タグ付きバージョンのワークブックを更新するには、以下を実行します。
1.  編集のためにワークブックを開きます。
2.  ドキュメント名の隣にある下矢印()をクリックしてドキュメントメニューを開きます。
3.  `Versions` > `Version history`を選択します。
4.  タグ付きバージョンを探し、関連するバージョンの日付を選択して開きます。
5.  そのバージョンについて、`More` > `Restore version as draft`を選択します。
6.  ドラフトで希望の変更を加えます。
7.  変更が終わったら、変更を公開します。
8.  ドキュメントメニューを開き、`Versions` > `Version history`を選択して、バージョン履歴を再度開きます。
9.  バージョン履歴には、`Restored version from <date>`という項目が表示され、そのバージョンの上にさらなる変更がリストされます。
10. 変更を含む最新の公開バージョンについて、`More > Set tag on this version`を選択します。
11. 最新バージョンにタグが付けられ、内容が一致するように更新されます。以前にタグ付けされたバージョンは、グレーアウトされたバージョンタグでリストされます。
    > 📘
    > 以前のバージョンからtestingタグを削除しないでください。そうすると、そのタグ付きバージョンのワークブックへのアクセス権しか持たない人はアクセスを失います。異なるバージョンに再度タグを付けると、共有は維持されます。
12. 保存して作業を続けたい他の変更があった場合は、タグ付きバージョンを最新のドラフトとして復元する前のバージョンに戻り、`More > Restore version as draft`を選択します。

#### **タグ付きバージョンを別のタグに更新する (Update a tagged version to use another tag)**
例えば、「staging」バージョンタグから「production」バージョンタグにタグ付きワークブックバージョンを昇格させたい場合は、以下を実行します。
1.  編集のためにワークブックを開きます。
2.  ドキュメント名の隣にある下矢印()をクリックしてドキュメントメニューを開きます。
3.  `Versions`を選択し、表示したいタグ（例：「Staging」）を選択します。
    タグ付きバージョンが開きます。
4.  ドキュメントメニューを開き、`Versions` > `Tag this version`を選択します。
    `Set tag on version`モーダルが開きます。
5.  モーダルで、関連オプションを選択し、`Set tag`を選択します。
    「Production」タグがバージョンに追加されます。
6.  次に、バージョンから「Staging」タグを削除します。ドキュメントメニューを開き、`Versions` > `Version history`を選択します。
7. バージョン履歴で、「Staging」タグが適用されているバージョンを探し、`More` > `Remove this tag`を選択します。
8. モーダルで、このタグ付きバージョンへのアクセス権のみが付与されているユーザー、またはタグ付きバージョンへのリンクを使用する埋め込みが、タグを削除した後にアクセスを失うことを承認し、`Remove`を選択します。
   バージョンは、現在のタグが「Production」、以前のタグが「Staging」として表示されます。

#### **バージョンタグを使用してフォルダへのアクセスを制限する (Restrict access to a folder using a version tag)**
バージョンタグを使用してドキュメントへのアクセスを管理する場合、ワークスペースまたはフォルダを設定してアクセスをより簡単に管理できます。
ワークスペースまたはフォルダをユーザーまたはチームと共有し、それらのユーザーまたはチームに特定のタグへのアクセス権を付与できます。そうすると、そのワークスペースまたはフォルダ内のワークブックまたはデータモデルは、それらのユーザーまたはチームがアクセスできるようにするために、そのタグが適用されている必要があります。

例えば、5つの地域をカバーする営業組織がある場合、各地域にワークスペースを作成し、各営業チームにその地域のタグを持つワークスペースへの`Can explore`アクセス権を付与できます。
そうすると、ワークスペース内のすべてのドキュメントには、対応するタグ付きバージョンが必要です。この例では、Sales US-Eastワークスペース内のすべてのワークブックには、Sales US-Eastチームのメンバーがワークブックの`East`バージョンを表示および探索できるように、`East`とタグ付けされたバージョンが必要です。

ワークスペースでチームメンバーに`Can contribute`や`Can manage`などの昇格された権限を付与すると、それらのチームメンバーはワークスペース内のドキュメントのすべてのバージョンにアクセスできます。
ワークスペースおよびフォルダレベルで設定された権限は、ワークスペースまたはフォルダ内のワークブックおよびドキュメントに継承されます。詳細は、「[フォルダを共有する](https://help.sigmacomputing.com/docs/share-a-folder)」を参照してください。

#### **タグ付きバージョンのワークブックへのリンク (Link to a tagged version of a workbook)**
タグ付きバージョンのワークブックに直接リンクしたい場合（例えば、タグ付きバージョンのワークブックを埋め込むなど）、URLでタグ名を参照します。
例えば、ワークブックに`staging`タグを追加した場合、`staging`でタグ付けされたワークブックバージョンのURLには以下が含まれます。
`/workbook/My-Workbook-{workbook_id}/tag/staging`

埋め込みにも同じ構成が適用されます。`staging`タグはURLに追加されます。
`/embed/{embed_id}/tag/staging`

他のURLパラメータと同様に、スペースや特殊文字を含むバージョンタグ名はエンコードされます。例えば、「Staging Copy」という名前のバージョンタグの場合は`staging%20copy`となります。「[Embed URL parameters](https://help.sigmacomputing.com/docs/embed-url-parameters)」を参照してください。

### 5-4. マテリアライゼーション

#### 5-4-1-1. マテリアライゼーションについて (About materialization)

> 🚩
> データモデル内のデータ要素とデータセットのマテリアライゼーションは、一般的に利用可能です。
> ワークブック内のデータ要素のマテリアライゼーションは、パブリックベータです。
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このドキュメントは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

マテリアライゼーションは、レポートの速度とパフォーマンスを向上させます。データモデル、ワークブック、およびデータセットに対してマテリアライゼーションを設定できます。

##### **マテリアライゼーションについて (About materialization)**
データ要素間の複雑な結合や、カーディナリティが高く複数のグルーピングレベルと計算列を持つデータセットなど、コストのかかる、または長時間実行されるクエリを使用するデータソースがある場合、マテリアライゼーションを設定することでクエリのパフォーマンスが向上し、コンピューティングコストの削減に役立ちます。

マテリアライゼーションは、データセットまたはデータ要素のコピーをテーブルとして、または場合によっては動的テーブルとして、あなたのウェアハウスに書き戻します。マテリアライズされたデータは、Sigmaサービスによって管理されるスキーマ内のクラウドデータウェアハウスに、すべての書き戻しデータに使用されるのと同じデータベースまたはカタログとスキーマに保存されます。マテリアライズされたテーブルは、先頭に `t_mat` または `T_ID` が付くか、末尾に `_MAT` が付き、Sigmaの接続エクスプローラーには表示されません。

##### **マテリアライゼーションが使用されるとき (When materialization is used)**
マテリアライゼーションを使用する要素を表示または操作すると、Sigmaのクエリコンパイラは自動的かつ透過的に最新のマテリアライゼーションを使用します。あなたのクラウドデータウェアハウスはクエリを再計算しません。
ワークブックページのコントロールがマテリアライズされた要素を対象としている場合、コントロールの値を変更するとライブデータにクエリが実行されます。代わりに、コントロールをワークブックまたはデータモデルの子要素を対象にしてください。「[マテリアライゼーションのベストプラクティス](#best-practices-for-materialization)」を参照してください。
ワークブックまたはデータモデルのマテリアライズされたデータセットまたはマテリアライズされた要素を編集すると、マテリアライズされたデータは使用されず、正確な結果を保証するために基盤となるデータにクエリが実行されます。

##### **データモデルとワークブックのマテリアライゼーションとデータセットのマテリアライゼーションの比較**
ワークブックとデータモデルのマテリアライズされたデータ要素は、マテリアライズされたデータセットとはいくつかの違いがあります。
* データセットを公開すると、変更がマテリアライゼーションの正確さに影響しない場合でも、マテリアライゼーションが実行されます。マテリアライズされた要素を持つワークブックまたはデータモデルを公開すると、公開された変更がマテリアライゼーションに影響する場合にのみ、マテリアライゼーションが実行されます。
* データセットに複数のグルーピングレベルが含まれている場合、1つのグルーピングレベルしかマテリアライズできません。ワークブックまたはデータモデルのデータ要素に複数のグルーピングレベルが含まれている場合、各グルーピングレベルをマテリアライズできます。
* ワークブックとデータモデルのデータ要素の未使用のマテリアライゼーションは、自動的に一時停止できます。未使用のデータセットのマテリアライゼーションは自動的に一時停止できません。詳細は「[マテリアライゼーションの管理](https://help.sigmacomputing.com/docs/manage-materializations)」を参照してください。
* Snowflake接続でマテリアライゼーションを使用する場合、ワークブックとデータモデルのマテリアライズされたデータ要素は一時テーブルを使用します。一時テーブルの詳細については、Snowflakeドキュメントの「[Working with Temporary and Transient Tables](https://docs.snowflake.com/en/user-guide/tables-temp-transient)」を参照してください。

##### **動的テーブルによる増分マテリアライゼーション (Incremental materialization with dynamic tables)**
デフォルトでは、マテリアライゼーションは毎回新しいテーブルを作成します。Snowflake接続でマテリアライゼーションを使用する場合、代わりにマテリアライゼーションに動的テーブルを使用するように接続を構成できます。多くの場合、動的テーブルは増分更新を可能にし、つまり、マテリアライゼーションが実行されると、変更されたデータのみが更新されます。

マテリアライゼーションに動的テーブルを使用するには：
1.  マテリアライゼーションに動的テーブルを使用するように接続を構成します。「[Connect to Snowflake](https://help.sigmacomputing.com/docs/connect-to-snowflake)」の「書き込みアクセスを構成する」を参照してください。
2.  マテリアライゼーションに使用される動的テーブルを構築するためにクエリされる可能性のあるデータベーステーブルで、変更追跡を有効にします。Snowflakeドキュメントの動的テーブル作成に関する「[Enable change tracking](https://docs.snowflake.com/en/user-guide/dynamic-tables-creating#enabling-change-tracking-on-underlying-objects)」を参照してください。

これらのステップを完了すると、マテリアライゼーションは動的テーブルを使用し、利用可能であれば増分リフレッシュを使用します。増分リフレッシュが利用できない場合は、完全なリフレッシュが実行されます。動的テーブルが利用できないかサポートされていない場合は、テーブルが使用されます。要素のマテリアライゼーション履歴を確認して、どの方法が使用されたかを確認できます。「[マテリアライズされたデータ要素のステータスを確認する](https://help.sigmacomputing.com/docs/schedule-materialization-for-a-data-model-or-workbook#review-the-status-of-a-materialized-data-element)」を参照してください。

増分リフレッシュが使用されない場合や、動的テーブルが使用されない場合についての詳細は、Snowflakeドキュメントの「[Known limitations for dynamic tables](https://docs.snowflake.com/en/user-guide/dynamic-tables-limitations)」を参照してください。

既存のマテリアライゼーションスケジュールは、次回のスケジュールされた実行の一部として動的テーブルを使用しようとします。ワークブックとデータモデルのデータ要素のみが、動的テーブルによる増分マテリアライゼーションを使用できます。マテリアライズされたデータセットは動的テーブルを使用しません。

##### **マテリアライゼーションのベストプラクティス (Best practices for materialization)**
* マテリアライゼーションをスケジュールする際は、データの更新時間を考慮してください。データウェアハウスのデータがスケジュールで更新される場合、Sigmaのマテリアライゼーションスケジュールがそのデータ更新の完了後に開始するようにしてください。
* データが使用されないと予想されるときにマテリアライゼーションが実行されるようにスケジュールし、ユーザーがデータにアクセスする前に完了させます。必要であれば、マテリアライゼーションに使用する専用のコンピューティングリソースを作成します。例えば、マテリアライゼーションをゆっくり実行するが、リソースの使用量が少ない小さなコンピューティングリソースを作成します。
* 上流の要素をマテリアライズする場合、下流のマテリアライズされた要素のマテリアライゼーションスケジュールが、上流の要素のマテリアライゼーションの完了後に開始するようにしてください。
* データ構造の変更が将来のマテリアライゼーションの失敗を引き起こさないように、データモデルまたはデータセットを設定する際には、[マテリアライゼーションの制限](#materialization-limitations)を考慮してください。
* マテリアライズされたデータソースと要素の子要素にコントロールを対象として、信頼性の高いインタラクションと出力を確保します。
* 長時間実行されるクエリのタイムアウト制限を考慮してください。マテリアライゼーションクエリは、[接続で構成されたSigmaのクエリタイムアウト](https://help.sigmacomputing.com/docs/manage-workbook-refresh-options#set-a-query-id-cache-duration)を使用せず、代わりにデータプラットフォームで使用されるコンピューティングリソースで定義された設定（例えば、Snowflakeの仮想ウェアハウスのクエリタイムアウト設定など）を使用します。

##### **マテリアライゼーションの制限 (Materialization limitations)**
一部のデータ構造はマテリアライズできません。[行レベルのセキュリティ](https://help.sigmacomputing.com/docs/set-up-row-level-security)を持つデータセットなど、一つ以上の[システム関数](https://help.sigmacomputing.com/docs/system-functions)を使用する列がデータに含まれている場合、マテリアライゼーションは実行に失敗します。

マテリアライゼーションは実行時のデータの固定出力を反映するため、一部のデータ構造は予期しない結果を生むことがあります。
* データセットが[パラメータ](https://help.sigmacomputing.com/docs/create-and-manage-dataset-parameters)を使用する場合、マテリアライゼーションはパラメータの初期値を使用して実行されます。パラメータへの将来の変更は影響しません。
* ワークブックまたはデータモデルのデータ要素が一つ以上の[コントロール](https://help.sigmacomputing.com/docs/intro-to-control-elements)の対象となっている場合、マテリアライゼーションはコントロールの初期値を使用して実行されます。マテリアライゼーション後、コントロールを使用してマテリアライズされたデータ要素と対話すると、マテリアライズされたデータは使用されず、代わりにクエリが実行されて最新のデータが取得されます。代わりに、コントロールを子要素を対象にしてください。

ワークブックやデータモデルのデータ要素は、ルックアップ、[結合](https://help.sigmacomputing.com/docs/join-data-in-workbooks)、リレーションシップなどで他のデータ要素を参照していてもマテリアライズできますが、ソースデータ要素の一つがマテリアライズできない場合を除きます。
データセットは、ルックアップ、リンク、または[結合](https://help.sigmacomputing.com/docs/join-data)などで他のデータセットを参照していてもマテリアライズできますが、ソースデータセットの一つがマテリアライズできない場合を除きます。
OAuth認証を使用してデータプラットフォームに接続している場合、ワークブックやデータモデルのデータ要素はマテリアライズできますが、データセットはマテリアライズできません。

##### **マテリアライゼーションを設定する (Set up materialization)**
データモデルやワークブックの要素、またはデータセットにマテリアライゼーションを設定するには：
* [データモデルまたはワークブックのマテリアライゼーションをスケジュールする](https://help.sigmacomputing.com/docs/schedule-materialization-for-a-data-model-or-workbook)
* [データセットのマテリアライゼーションをスケジュールする](https://help.sigmacomputing.com/docs/dataset-materialization-api)
* 
#### 5-4-1-2. データモデルまたはワークブックのマテリアライゼーションをスケジュールする (ベータ版)

> 🚩
> データモデル内のデータ要素のマテリアライゼーションは一般的に利用可能です。
> ワークブック内のデータ要素のマテリアライゼーションはパブリックベータです。
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このドキュメントは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

マテリアライゼーションをスケジュールすることにより、ワークブックまたはデータモデル内のデータ要素をマテリアライズします。構成したマテリアライゼーションスケジュールは、下流の要素のデータの鮮度に影響します。制限事項やベストプラクティスを含む詳細については、「[マテリアライゼーションについて](https://help.sigmacomputing.com/docs/about-materialization)」を参照してください。データモデルがバージョンタグを使用している場合は、「[バージョンタグ付きデータモデルのマテリアライゼーションをスケジュールする](https://help.sigmacomputing.com/docs/schedule-materialization-for-a-version-tagged-data-model)」を参照してください。

##### **要件 (Requirements)**
* 接続で[書き込みアクセス](https://help.sigmacomputing.com/docs/set-up-write-access)が有効になっている必要があります。
* データモデルでマテリアライゼーションをスケジュールするには、`Schedule materializations`および`Create, edit, and publish datasets`権限が有効になっているアカウントタイプを割り当てられている必要があります。
* ワークブックでマテリアライゼーションをスケジュールするには、`Schedule materializations`および`Create, edit, and publish workbooks`権限が有効になっているアカウントタイプを割り当てられている必要があります。
* ワークブックまたはデータモデルに対する`Can Edit`アクセス権が必要です。

##### **データ要素のマテリアライゼーションスケジュールを作成する (Create a data element materialization schedule)**
ワークブックまたはデータモデル内の特定のデータ要素をマテリアライズできます。
> 📘
> データ要素は1つのマテリアライゼーションスケジュールしか持てませんが、1つのスケジュールで複数の要素をマテリアライズするように作成できます。

1.  編集のためにデータモデルまたはワークブックを開きます。
2.  マテリアライズしたい要素を探し、`More`をクリックして要素メニューを開きます。
3.  `Advanced options` > `Schedule materialization...`を選択します。
4.  `Materialization schedules`モーダルで、データ要素をマテリアライズするスケジュールを設定します。
    * (任意) `Daily`のドロップダウンを選択し、`Weekly`, `Monthly`, または`Custom`を選択します。
        * `Daily`の場合、`Once a day`または`Multiple times`を選択します。
        * `Weekly`の場合、マテリアライゼーションジョブを実行する曜日を選択し、`Once a day`または`Multiple times`を選択します。
        * `Monthly`の場合、マテリアライゼーションジョブを実行する月の日と時刻を選択します。
        * `Custom`の場合、cron構文を使用してスケジュールを指定します。
    * `Multiple times`を選択した場合は、頻度を指定します。例えば、午前9時から午後6時までの間、毎時15分に2時間ごとなど。
    * (任意) ドロップダウンメニューを使用して、デフォルトのスケジュールタイムゾーンを調整します。
    > 📘
    > 要素に複数のグルーピングレベルが含まれている場合、マテリアライズするグルーピングレベルを選択します。Sigmaは選択されたグルーピングレベルとその上位のすべてのレベルをマテリアライズします。グループ化された要素の最も粒度の細かいレベル（All source columns）をマテリアライズすることは、しばしば不要でコストがかかる可能性があります。
5.  `Save schedules`をクリックします。
マテリアライゼーションの実行は、ワークブックの最新の公開バージョンを使用して直ちに開始されます。
> 🚩
> データプラットフォームへの認証にOAuthを使用する場合、マテリアライゼーションジョブはマテリアライゼーションをスケジュールしたユーザーとして実行されます。代わりにサービスアカウントを使用してマテリアライゼーションを実行するには、ワークブックをサービスアカウントとして実行します。「[Run a workbook with service account credentials](https://help.sigmacomputing.com/docs/run-a-workbook-with-service-account-credentials)」を参照してください。

##### **依存マテリアライゼーションスケジュールを設定する (Set up a dependent materialization schedule)**
親要素と子要素の両方をマテリアライズする場合、子要素に対して依存マテリアライゼーションスケジュールを設定できます。依存マテリアライゼーションスケジュールでは、一つ以上の子要素のマテリアライゼーションは、親要素のマテリアライゼーションが正常に完了した後に実行されます。依存マテリアライゼーションは、子要素のデータが親要素で利用可能な最新のデータを反映することを保証するのに役立ちます。

親要素は、同じワークブック、データモデル、またはデータモデルをまたいで、複数のレベル上流にある場合があります。親要素と子要素を特定するには、ワークブックまたはデータモデルの[データリネージ](https://help.sigmacomputing.com/docs/view-workbook-data-lineage)を確認してください。

依存マテリアライゼーションスケジュールを設定するには、以下を実行します。
1.  編集のためにデータモデルまたはワークブックを開きます。
2.  マテリアライズしたい子要素を探し、`More`をクリックして要素メニューを開きます。
3.  `Advanced options > Schedule materialization...`を選択します。
4.  `Materialization schedules`モーダルが、選択した要素のドラフトスケジュールと共に開きます。
5.  `Frequency`セクションの`Select a run time`で、オプションを選択します。
    * 子要素を親要素のマテリアライゼーションが正常に終了した後にのみマテリアライズするには、`After selected parent schedule finishes`を選択し、ドロップダウンメニューで関連する親スケジュールを選択します。
    * 親要素のマテリアライゼーションスケジュールとは別に、子要素を独自のスケジュールでマテリアライズするには、`Manual Time`を選択し、頻度を指定します。
6.  [任意] 同じスケジュールで複数の要素をマテリアライズしたい場合は、`+ Add element`を選択し、別の要素を選択します。
7.  `Save schedules`を選択します。
保存後、依存スケジュールは親スケジュールと同じスケジュールの一部として表示されます。親スケジュールが一時停止または失敗した場合、依存スケジュールも一時停止または失敗します。
> 📘
> 親要素のマテリアライゼーションスケジュールが削除された場合、依存スケジュールは親要素に設定された頻度と一致するように更新されます。

##### **マテリアライズされたデータ要素のステータスを確認する (Review the status of a materialized data element)**
マテリアライゼーションのステータスはいくつかの場所で確認できます。
* ワークブックまたはデータモデルでデータ要素を表示すると、要素メニューにマテリアライゼーションのステータスが表示されます。
* データ要素のリネージを確認すると、マテリアライゼーションのステータスが表示されます。

データ要素のマテリアライゼーション履歴を確認するには：
1.  編集のためにデータモデルまたはワークブックを開きます。
2.  マテリアライズしたい要素を探し、`More`をクリックして要素メニューを開きます。
3.  `Advanced options` > `Schedule materialization...`を選択します。
4.  `Materialization schedules`モーダルで、`History`を選択します。
5.  ワークブックまたはデータモデル内のすべての要素のマテリアライゼーション履歴を確認します。
    * マテリアライゼーションのステータスを確認します。失敗したマテリアライゼーションについては、エラーメッセージをコピーできます。
    * マテリアライゼーションの開始時刻と実行時間を確認します。
    * 総行数と総バイト数でマテリアライズされたデータの量を確認します。
    * `More`を選択して要素を直ちにマテリアライズするか、その要素をマテリアライズするスケジュールに移動します。

##### **スケジュールされたマテリアライゼーションを実行する (Run a scheduled materialization for a data element)**
スケジュールされたマテリアライゼーションを持つデータ要素を直ちにマテリアライズするには：
1.  マテリアライズされたデータ要素を選択します。
2.  メニューで、`View materialization info` ()を選択します。
    * このオプションが利用できない場合、要素はマテリアライズされていません。「[データ要素のマテリアライゼーションスケジュールを作成する](https://help.sigmacomputing.com/docs/schedule-materialization-for-a-data-model-or-workbook#create-a-data-element-materialization-schedule)」を参照してください。
3.  表示されるメニューで、`Materialize now`をクリックします。
マテリアライゼーションの実行は、ワークブックの最新の公開バージョンを使用して直ちに開始されます。

また、スケジュールからデータ要素のマテリアライゼーションを実行することもできます。例えば、同じスケジュール内のすべてまたは複数の要素のマテリアライゼーションを直ちに実行したい場合などです。
1.  マテリアライズされたデータ要素を選択します。
2.  `More`をクリックして要素メニューを開きます。
3.  `Advanced options` > `Schedule materialization...`を選択します。
4.  `Materialization schedules`モーダルで、スケジュール内の要素を確認し、直ちにマテリアライズするものを選択します。
    * スケジュール内のすべての要素をマテリアライズするには、ヘッダー行で`More` > `Materialize all now`を選択します。
    * スケジュール内の個々の要素をマテリアライズするには、要素の行を探し、`More` > `Materialize now`を選択します。
マテリアライゼーションの実行は、ワークブックの最新の公開バージョンを使用して直ちに開始されます。

##### **マテリアライゼーションスケジュールを管理する (Manage the materialization schedule for a data element)**
マテリアライゼーションスケジュールを変更して、マテリアライズの頻度やどの要素がマテリアライズされるかを変更できます。また、スケジュールから一つ以上の要素を削除したり、スケジュール全体を削除したりすることもできます。要素またはスケジュール全体を削除すると、関連するテーブルは24時間以内にデータプラットフォームから削除されます。

1.  編集のためにデータモデルまたはワークブックを開きます。
2.  マテリアライズしたい要素を探し、`More`をクリックして要素メニューを開きます。
3.  `Advanced options` > `Schedule materialization...`を選択します。
4.  `Materialization schedules`モーダルで、希望の変更を加えます。
    * スケジュールの頻度を修正する。
    * スケジュールから要素を削除する。要素の行を探し、`More` > `Remove element`を選択します。
    * `Delete schedule`を選択してスケジュールを削除する。

管理者として、追加のマテリアライゼーション機能を管理するには、「[マテリアライゼーションの管理](https://help.sigmacomputing.com/docs/manage-materializations)」を参照してください。

#### 5-4-1-3. データセットのマテリアライゼーションをスケジュールする (Schedule materialization for a dataset)

マテリアライゼーションをスケジュールすることにより、データセットをマテリアライズします。構成したマテリアライゼーションスケジュールは、下流の要素のデータの鮮度に影響します。制限事項やベストプラクティスを含む詳細については、「[マテリアライゼーションについて](https://help.sigmacomputing.com/docs/about-materialization)」を参照してください。

##### **要件 (Requirements)**
* 接続で[書き込みアクセス](https://help.sigmacomputing.com/docs/set-up-write-access)が有効になっている必要があります。
* データセットでマテリアライゼーションをスケジュールするには、`Schedule materializations`および`Create, edit, and publish datasets`権限が有効になっているアカウントタイプを割り当てられている必要があります。
* データセットに対する`Can Edit`アクセス権が必要です。

##### **データセットのマテリアライゼーションスケジュールを作成する (Create a materialization schedule for a dataset)**
データセットをマテリアライズするには：
1.  マテリアライズしたいデータセットを開きます。
2.  `Materialization`タブを選択し、`Create Schedule`をクリックします。
3.  `Add Materialization Schedule`モーダルで、マテリアライズされたデータを更新するためのスケジュールを定義します。
4.  `Save`をクリックします。
データの最初のマテリアライゼーションは直ちに開始されます。

##### **データセットのマテリアライゼーションのステータスを確認する (Review the status of a dataset materialization)**
データセットがマテリアライズされている場合、データセットのヘッダーでマテリアライゼーションのステータスを確認できます。
1.  データセットヘッダーで、情報アイコン()をクリックしてデータセット情報を開きます。
2.  `Materialization`セクションで、ステータスを確認します。最終更新日や次回更新日などの詳細を表示するには、ステータスにカーソルを合わせます。

Adminアカウントタイプを割り当てられたユーザーは、いつでも`Materialization`タブからマテリアライゼーションのステータスと履歴を表示できます。「[Manage materializations](https://help.sigmacomputing.com/docs/manage-materializations)」を参照してください。

##### **データセットのマテリアライゼーションジョブを実行する (Run a materialization job for a dataset)**
スケジュールされたマテリアライゼーションを手動で実行するには、以下を実行します。
1.  データセットを開き、`Materialization`タブを選択します。
2.  `Schedule`セクションで、`Run Now`をクリックします。

##### **データセットのマテリアライゼーションスケジュールを修正する (Modify a dataset materialization schedule)**
データセットのマテリアライゼーションスケジュールに変更を加えるには：
1.  データセットを開き、`Materialization`タブを選択します。
2.  `Schedule`セクションで、`More` > `Edit Schedule`をクリックします。
3.  新しいスケジュールを定義します。
4.  `Save`をクリックします。
マテリアライゼーションスケジュールは直ちに変更されます。次のマテリアライゼーションは、次のスケジュールされた時刻に行われます。

##### **データセットのマテリアライゼーションスケジュールを削除する (Delete a dataset materialization schedule)**
データセットのマテリアライゼーションスケジュールを削除し、マテリアライズされたデータを接続されたデータプラットフォームから削除するには：
1.  データセットを開き、`Materialization`タブを選択します。
2.  `Schedule`セクションで、`More` > `Remove Schedule`をクリックします。
3.  表示される確認画面で、`Remove`を選択します。
Sigmaは自動的にウェアハウスからマテリアライズされたテーブルを削除します。テーブルが削除されるまで最大24時間かかることがあります。

#### 5-4-1-4. バージョンタグ付きデータモデルのマテリアライゼーションをスケジュールする (Schedule materialization for a version-tagged data model)

一つ以上のタグ付きバージョンを持つデータモデルがある場合、データモデルの各バージョンに対して[マテリアライゼーション](https://help.sigmacomputing.com/docs/about-materialization)スケジュールを設定できます。例えば、「testing」と「production」のタグ付きバージョンのデータモデルがある場合、各タグのデータ要素に対してマテリアライゼーションをスケジュールでき、これにより、そのタグ付きバージョンのデータモデルに依存する下流の要素のパフォーマンスを向上させることができます。

バージョンタグ付きデータモデルの要素のマテリアライゼーションをスケジュールする際には、[マテリアライゼーションのベストプラクティス](https://help.sigmacomputing.com/docs/about-materialization#best-practices-for-materialization)が引き続き適用されます。マテリアライゼーションのスケジューリングに関する詳細は、「[データモデルまたはワークブックのマテリアライゼーションをスケジュールする](https://help.sigmacomputing.com/docs/schedule-materialization-for-a-data-model-or-workbook)」を参照してください。

##### **要件 (Requirements)**
* この機能を使用するには、[データをマテリアライズする権限](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を持つアカウントタイプを割り当てられている必要があります。
* データ要素をマテリアライズするには、データソースの接続で書き込みアクセスが有効になっている必要があります。

##### **タグ付きデータモデルのマテリアライゼーションをスケジュールする (Schedule materialization for a tagged data model)**
少なくとも一つのタグ付きバージョンを持つデータモデルについて、タグ付きバージョンの一つ以上のデータ要素のマテリアライゼーションをスケジュールします。データモデルの異なるタグ付きバージョン間で同じデータ要素のマテリアライゼーションをスケジュールしたい場合は、各タグ付きバージョンに対してスケジュールを作成します。

1.  データモデルを開きます。
2.  ドキュメントヘッダーで、更新データボタンの隣にある`More options` > `Materialization schedule...`をクリックします。
3.  `Materialization`モーダルで、`+ New schedule`をクリックします。マテリアライゼーションスケジュールがない場合は、`Add schedule`をクリックします。
    > 💡
    > 代わりに既存のスケジュールを複製するには、複製したいスケジュールを探し、`More` > `Duplicate schedule`を選択します。
4.  `Version`で、 を選択してバージョンを修正し、ドロップダウンでスケジュールを適用するバージョンタグを選択します。
5.  `Elements`で、スケジュールにデータ要素を追加します。公開バージョンまたはデータモデルの別のタグ付きバージョンでマテリアライズされているのと同じ要素をタグ付きバージョンでマテリアライズするには、`+ Add element`を選択し、`Copy elements from schedule of other versions`を選択します。
6.  スケジュールの頻度を設定します。
    * (任意) `Daily`のドロップダウンを選択し、`Weekly`, `Monthly`, または`Custom`を選択します。
    * `Daily`の場合、`Once a day`または`Multiple times`を選択します。
    * `Weekly`の場合、マテリアライゼーションジョブを実行する曜日を選択し、`Once a day`または`Multiple times`を選択します。
    * `Monthly`の場合、マテリアライゼーションジョブを実行する月の日と時刻を選択します。
    * `Custom`の場合、cron構文を使用してスケジュールを指定します。
    * `Multiple times`を選択した場合は、頻度を指定します。
    * (任意) ドロップダウンメニューを使用して、デフォルトのスケジュールタイムゾーンを調整します。
7.  スケジュールを保存します。

> 📘
> タグをデータモデルの新しいバージョンに昇格させる（例えば、古いバージョンのデータモデルから最新の公開バージョンにタグを移動するなど）と、新しいマテリアライゼーションの実行が開始されます。新しくタグ付けされたバージョンのマテリアライゼーションが実行されている間は、以前にタグ付けされたバージョンのデータモデルのマテリアライズされたデータが使用されます。

#### 5-4-2-1. パフォーマンス向上のためのベストプラクティス (Best practices for improved performance)

このドキュメントでは、パフォーマンスに関連するいくつかのベストプラクティスを集めて、検討のために提供します。

##### **データセットを使用してクエリ負荷を削減する (Use datasets to reduce query loads)**
Sigmaはデータセットを使用して、データ定義を一元化し、ワークブックにソースデータを提供します。データセットの使用に関する詳細は、「[Data modeling In Sigma](https://help.sigmacomputing.com/docs/datasets)」および「[Data modeling tutorial](https://help.sigmacomputing.com/docs/tutorial-data-modeling-with-datasets)」を参照してください。

データセットレベルでフィルターを使用することにより、ワークブックのクエリで返される不要なデータの量を削減します。フィルターは、制限しすぎることなく無関係なデータを削減します。最も関連性の高いデータのみを表示することで、インサイト発見のプロセスがはるかに速くなります。マテリアライゼーションと組み合わせると、クエリの実行も速くなります。

* **データセットの時間範囲フィルター (Dataset time range filters)**
    相対日付フィルターを使用して、Sigmaのクエリが特定の時間範囲のデータのみを返すようにします。詳細は、「[Add relative date filters](https://help.sigmacomputing.com/docs/dataset-filters#add-relative-date-filters)」および「[Dataset filters](https://help.sigmacomputing.com/docs/dataset-filters)」を参照してください。
* **データセットパラメータ (Dataset parameters)**
    データセットパラメータを作成し、ワークシートで使用して、データが必要なものだけにフィルタリングされるようにします。詳細は、「[Dataset parameters](https://help.sigmacomputing.com/docs/dataset-parameters)」を参照してください。

##### **データセットとワークブック要素をマテリアライズしてコンピューティングコストを削減する (Materialize datasets and workbook elements to reduce compute costs)**
マテリアライゼーションを使用すると、データセットとワークブック要素をテーブルとしてウェアハウスに書き戻すことができ、これによりコンピューティングコストを削減できます。マテリアライゼーションは、データウェアハウスがデータセットを要素または下流のSigma分析で使用する際に再計算を回避できるようにすることで、クエリのパフォーマンスを向上させます。詳細は、「[Materialization](https://help.sigmacomputing.com/docs/about-materialization)」を参照してください。

##### **CDWでクエリキャッシュを使用する (Use a query cache in the CDW)**
一部のクラウドデータウェアハウス（CDW）には、Sigmaが追加のコンピューティングコストを発生させることなくクエリ結果を取得するために使用できるクエリ結果キャッシュがあります。これにより、パフォーマンスが向上します。詳細は、「[Set a cache duration](https://help.sigmacomputing.com/docs/set-a-cache-duration)」を参照してください。

##### **ワークブックのパフォーマンスを向上させるためのその他のヒント (More tips for improving workbook performance)**
過剰な結合、繰り返されるロジック、未使用のデータ、フィルターの過負荷は、ワークブックを遅くする可能性があります。パフォーマンスのヒントについては、Sigmaコミュニティの「[How to improve workbook performance](https://community.sigmacomputing.com/dashboards-and-workbooks/how-to-improve-workbook-performance-224)」を参照してください。

#### 5-4-2-2. ウェアハウスビューの作成と管理 (Create and manage warehouse views)

ウェアハウスビューは、あなたのデータプラットフォームに保存される仮想テーブルです。テーブル、ピボットテーブル、入力テーブル、およびチャートからウェアハウスビューを作成し、Sigmaまたはあなたのデータエコシステム内の他の任意のアプリケーションを使用してそれらにクエリを実行できます。ウェアハウスビューはクエリを簡素化し、関連性のある最新のデータサブセットをデータプラットフォームから直接取得することを可能にします。

このドキュメントでは、ワークブックとデータモデルでウェアハウスビューを作成および管理する方法について説明します。管理者ポータルの `Warehouse Views` ページに関する情報については、「[Review warehouse view details](https://help.sigmacomputing.com/docs/review-warehouse-view-details)」を参照してください。

> 📘
> この機能は、すべてのデータプラットフォーム接続でサポートされているわけではありません。あなたの接続がサポートしているかを確認するには、「[Supported data platforms and feature compatibility](https://help.sigmacomputing.com/docs/region-and-feature-support)」を参照してください。

##### **システムとユーザー要件 (System and user requirements)**
ウェアハウスビューを作成および管理する機能には、以下が必要です。
* 要素のデータソースは、[書き込みアクセス](https://help.sigmacomputing.com/docs/set-up-write-access)が有効になっている接続からデータを取得する必要があります。
* `Create warehouse views` 権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたはワークブックまたはデータモデルの所有者であるか、そのワークブックまたはデータモデルに対する `Can edit` [アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

##### **ウェアハウスビューについて (About warehouse views)**
データベーステーブルにデータを保存する代わりに、ウェアハウスビューは、Sigmaの個々のデータ要素または入力テーブルによって定義された特定のクエリロジックを表現するSQLステートメントを保存します。

ウェアハウスビューを作成すると、あなたのデータプラットフォームとSigmaの間にライブリンクが確立されます。ビューはデータ要素または入力テーブルを信頼できる唯一の情報源（source of truth）として参照し、要素の基盤となるデータの最新バージョンを反映するように自動的に更新されます。

ウェアハウスビューはデータプラットフォームに直接クエリを実行するため、マテリアライゼーションとは動作が異なります。しかし、マテリアライズされた要素からウェアハウスビューを作成することもでき、その場合、ビューは要素のマテリアライズされた基盤となるデータテーブルにクエリを実行します。

##### **ウェアハウスビューについて (About warehouse views)**
データベーステーブルにデータを保存する代わりに、ウェアハウスビューは、Sigmaの個々のデータ要素または入力テーブルによって定義された特定のクエリロジックを表現するSQLステートメントを保存します。

ウェアハウスビューを作成すると、あなたのデータプラットフォームとSigmaの間にライブリンクが確立されます。ビューはデータ要素または入力テーブルを信頼できる唯一の情報源（source of truth）として参照し、要素の基盤となるデータの最新バージョンを反映するように自動的に更新されます。

ウェアハウスビューはデータプラットフォームに直接クエリを実行するため、マテリアライゼーションとは動作が異なります。しかし、マテリアライズされた要素からウェアハウスビューを作成することもでき、その場合、ビューは要素のマテリアライズされた基盤となるデータテーブルにクエリを実行します。

##### **ウェアハウスビューの考慮事項 (Warehouse view considerations)**
ウェアハウスビューを作成する際には、以下の制限と制約を考慮してください。
* ウェアハウスビューは、ドキュメントの公開バージョンから作成されます。データモデルまたはワークブックのタグ付きバージョンからウェアハウスビューを作成することはできません。ワークブックのカスタムビューと保存済みビューもサポートされていません。ドラフトでウェアハウスビューが作成された場合、以下のいずれかの結果となります。
    * 要素がドラフトにのみ存在する場合、Sigmaはワークブックまたはデータモデルが公開され、要素が公開バージョンに存在するときにビューを作成します。
    * 要素が公開バージョンに存在するが、ドラフトに未保存の変更が含まれている場合、Sigmaは要素の公開バージョンに基づいてビューを作成します。これはドラフトのデータと一致しない可能性があります。
    * 要素が公開バージョンに存在し、ドラフトに未保存の変更がない場合、Sigmaは要素の公開バージョンに基づいてビューを作成します。これはドラフトのデータと一致します。
* 以下の動的な条件はサポートされていません。
    * **要素内でパラメータとして参照されるコントロール値:** コントロール値は、クエリがユーザー入力に依存するため、要素のSQLステートメントで明示的に定義されません。
    * **相対日付フィルター:** 相対日付フィルター（`Last`, `Next`, `Current`など）は、要素のSQLステートメントで明示的に定義できない現在の日付基準に依存します。
* グループ化されたテーブルからウェアハウスビューを作成する場合、ウェアハウスビューに使用するグルーピングレベルを定義することはできません。
* データ要素に[列レベルのセキュリティ](https://help.sigmacomputing.com/docs/column-level-security)が含まれている場合、ウェアハウスビューを作成することはできません。
* データ要素が[転置](https://help.sigmacomputing.com/docs/transpose-a-table)されている場合、ウェアハウスビューを作成することはできません。

##### **ビューを作成する (Create a view)**
ウェアハウスビューを作成するには、以下を実行します。
1.  公開済みのワークブックまたはデータモデルを開き、ウェアハウスビューを作成したい要素を探します。
2.  要素ツールバーで、`More` をクリックして要素メニューを開き、`Advanced options` > `Create warehouse view` を選択します。
3.  `Create Warehouse View` モーダルで、Sigmaはビューの名前を自動生成します。必要に応じて名前を編集し、`Create` をクリックします。この名前は、データプラットフォームにビューを保存する際にも使用されます。

Sigmaはビューが正常に作成されると通知します。また、要素ツールバーでステータスをプレビューしたり、`View warehouse view info` をクリックしてビューの詳細を確認したりすることもできます。
> 📘
> Sigmaがビューを作成した後、要素に適用されたフィルターやその他の変更は、ワークブックが再公開されたときにのみビューに保存されます。

要素ごとに作成できるウェアハウスビューは1つだけです。同じデータの複数のビューを作成する必要がある場合は、要素を複製し、必要に応じてデータを調整して、別のウェアハウスビューを作成できます。

Sigmaはビューが正常に作成されると通知します。また、要素ツールバーでステータスをプレビューしたり、`View warehouse view info` をクリックしてビューの詳細を確認したりすることもできます。
> 📘
> Sigmaがビューを作成した後、要素に適用されたフィルターやその他の変更は、ワークブックが再公開されたときにのみビューに保存されます。

要素ごとに作成できるウェアハウスビューは1つだけです。同じデータの複数のビューを作成する必要がある場合は、要素を複製し、必要に応じてデータを調整して、別のウェアハウスビューを作成できます。

##### **ビューの名前を変更する (Rename a view)**
ウェアハウスビューの名前を変更するには、以下を実行します。
1.  ワークブックまたはデータモデルを開き、名前を変更したいウェアハウスビューに関連付けられた要素を探します。
2.  要素ツールバーで、`More`をクリックして要素メニューを開き、`Advanced options` > `Manage warehouse view`を選択します。
3.  `Manage Warehouse View`モーダルで、`Name`フィールドに新しい名前を入力し、`Update`をクリックします。
     ウェアハウスビューの名前とパスが更新されます。

要素ツールバーでウェアハウスビューの更新ステータスをプレビューするか、`View warehouse view info`をクリックしてビューの詳細を確認できます。「[ウェアハウスビューのステータス](#warehouse-view-statuses)」を参照してください。
##### **ビューを削除する (Delete a view)**
ウェアハウスビューを削除するには、以下を実行します。
1.  ワークブックまたはデータモデルを開き、削除したいウェアハウスビューに関連付けられた要素を探します。
2.  要素ツールバーで、`More` > `Advanced options` > `Manage warehouse view` を選択します。
3.  `Manage Warehouse View` モーダルで、`Delete` をクリックします。
4.  `Confirm Delete` モーダルで、`Delete` をクリックします。

##### **ウェアハウスビューのステータス (Warehouse view statuses)**
ウェアハウスビューには以下のステータスが適用されます。

| ステータス | 説明 |
| :--- | :--- |
| **Pending** | Sigmaはワークブックが公開されるとビューを作成または更新します。|
| **Successful** | Sigmaはビューの作成または更新に成功しました。|
| **In Progress** | Sigmaは現在ビューを作成または更新中です。|
| **Failed** | ビューの作成または更新ができませんでした。失敗ステータスの原因を表示するには、ウェアハウスビュー詳細で`Failed`ステータスインジケータにカーソルを合わせます。|

##### **トラブルシューティング (Troubleshooting)**
特定の要素に対してウェアハウスビューを作成できない場合は、以下のいずれかが真であるかを確認してください。
* 現在、探索（exploration）で作業している。ウェアハウスビューを作成する前に、探索をワークブックとして保存する必要があります。
* 別のウェアハウスビューをソースとするデータ要素または入力テーブルに対してウェアハウスビューを作成しようとしている。ビューは他のビューをクエリできません。
* 要素データが[コントロール値をパラメータとして参照している](https://help.sigmacomputing.com/docs/reference-workbook-control-values-in-sql-statements)。
* 要素タイプが現在ウェアハウスビューをサポートしていない。

### 5-5. クエリの調査

#### 5-5-1. ワークブックとデータモデルのクエリを調査する (Examine workbook and data model queries)

ワークブックまたはデータモデルを開くと、Sigmaは最適化されたSQLクエリを生成・実行し、接続されたデータプラットフォームからデータを取得します。クエリ結果は、安全にあなたのウェブブラウザに返されます。

ワークブックまたはデータモデルの**クエリ履歴**を開くことで、ブラウザセッション中に実行されたクエリの構文やその他の詳細を確認できます。データセットのクエリ履歴に関する詳細は、「[データセットのクエリを調査する](https://help.sigmacomputing.com/docs/examine-dataset-queries)」を参照してください。

**クエリ履歴**は、ユーザーセッション中にワークブックから実行された最近のクエリの概要を表示し、クエリのランタイムや現在のステータスを含みます。個々のクエリをさらに深く掘り下げて、基盤となるSQLを表示したり、トラブルシューティングのためのリクエストIDを収集したり、エラーを調査したりすることができます。

##### **最近のクエリを表示する (View recent queries)**
クエリ履歴は、既存のセッション中にワークブックまたはデータモデルから実行された最近のクエリを表示します。ドキュメントの個々のクエリのリストは、各クエリの詳細を自動的に表示します。

1.  ドキュメントヘッダーで、更新データボタンの隣にある`More options`をクリックします。
2.  `Query history`を選択します。

##### **ブラウザの計算を表示する (View browser calculations)**
一部のクエリはデータプラットフォームから結果を返し、その他はデータプラットフォームの結果キャッシュから、さらに他の結果はブラウザキャッシュから返されます。
デフォルトでは、ブラウザで実行された計算はデータプラットフォームに送信されないため、クエリ履歴から非表示になっています。ブラウザの計算履歴を表示するには、以下を実行します。

1.  ドキュメントヘッダーで、更新データボタンの隣にある`More options`をクリックします。
2.  `Query history`を選択します。
3.  `Query history`モーダルの上部で、`View browser calculations`トグルをオンにします。
4.  `Execution Path`列で`Browser`エントリを確認します。

##### **個々のクエリ詳細を表示する (View individual query details)**
生成されたSQL、完全な実行時間、トラブルシューティング用のリクエストIDなど、個々のクエリの詳細を表示するには、以下を実行します。
1.  ドキュメントヘッダーで、更新データボタンの隣にある`More options`をクリックします。
2.  `Query history`を選択します。
3.  調査したいクエリを選択します。Sigmaは選択されたクエリの詳細を表示します。
    * 要素名を選択して、クエリが実行されたデータ要素を開きます。
    * 実行時間と期間を確認します。
    * 生成されたSQLを表示およびコピーします。
    * 失敗したクエリの場合、エラーメッセージを確認します。
    * トラブルシューティングの際にSigmaサポートと共有するためのリクエストIDをコピーします。

##### **クエリを一時停止および再開する (Pause and resume queries)**
データプラットフォームに対して自動的にクエリを実行せずにドキュメントに変更を加えるには、クエリを一時停止します。
1.  ドキュメントヘッダーで、更新データボタンの隣にある`More options`をクリックします。
2.  `Pause queries`を選択します。
クエリを一時停止した後にクエリの実行を再開するには、`Resume queries`を選択します。

##### **クエリ履歴のリファレンス (Query history reference)**
ステータス、実行時間、リクエストタイプ、および実行パスの詳細については、以下のセクションを参照してください。

* **クエリステータスタイプ (Query status types)**

| ステータス | 詳細 |
| :--- | :--- |
| **Completed** | クエリは正常に実行されました。|
| **Running** | クエリは現在実行中です。デフォルトでは、Sigmaはクエリのタイムアウトを120秒（2分）に設定しています。 |
| **Errored** | クエリ実行中にエラーが発生しました。行を選択してクエリ詳細とエラーメッセージを表示します。 |
| **Paused** | ドキュメント上のクエリは一時停止しています。クエリの実行を再開して最新データを取得するには、ドキュメントヘッダーの`Refresh queries`をクリックします。 |
| **Canceled** | クエリはキャンセルされました。これは、クエリが終了する前に別のドキュメントタブに切り替えた場合や、クエリが終了する前にドキュメントに変更が加えられた場合に発生する可能性があります。 |

* **クエリ実行時間 (Query run time)**
    正常に完了したクエリとタイムアウトしたクエリに対して、詳細なクエリ実行時間の内訳が利用可能です。クエリの実行時間は、ネットワークトラフィック、キューの遅延、またはデータプラットフォームの処理時間によって変動する可能性があります。実行時間の内訳により、クエリが遅延したかどうか、どの段階で遅延したかを確認できます。

    実行時間は3つの部分に分かれています。
    * **Queue duration (キュー期間):** クエリがデータプラットフォームに送信される前にSigmaのキューで待機する時間。特定のデータプラットフォームでは、Sigmaキューはデータプラットフォームに送信される同時リクエストの数を制限するために使用されます。
    * **Sigma runtime (Sigmaランタイム):** キューの期間とデータプラットフォームの時間を除く、Sigmaがクエリを処理するのにかかる時間。失敗したクエリやキャンセルされたクエリは、クエリがデータプラットフォームのタイムアウトにより失敗した場合でも、すべての実行時間をSigmaに帰属させます。
    * **Warehouse runtime (ウェアハウスランタイム):** Sigmaがデータプラットフォームにリクエストを送信してから応答を受け取るまでの時間。これは、おおよそデータプラットフォームがクエリの実行に費やした時間と同等です。
    * **Result fetch time (結果取得時間):** Sigmaがデータプラットフォームから結果を取得するのにかかる時間。
    * **Details unavailable (詳細利用不可):** PDFダウンロードなどの一部のエクスポートクエリでは、実行時間の内訳詳細は利用できません。

    未完了のクエリやダウンロード/エクスポートリクエストは、詳細な実行時間の内訳を表示しません。
    特定のクエリの実行時間（例えば、キューイング時間が著しく長いなど）に懸念がある場合は、Sigmaサポートにお問い合わせください。

* **クエリリクエストタイプ (Query request types)**
    Sigmaは、異なるタイプの情報を取得するために、データプラットフォームに対して異なるタイプの最適化されたクエリを作成します。
    ドキュメントのクエリ履歴を調査する際、以下のようなリクエストタイプが表示されることがあります。

| リクエストタイプ | 詳細 |
| :--- | :--- |
| **Data Prefetch Query** | 表示されているデータ要素によって使用されるデータソースを取得します。<br>例えば、10個の表示されているKPI要素のデータを取得するために10個の個別のクエリを実行する代わりに、1つのクエリを実行してデータソースを取得します。|
| **<Element name> <Element type>**<br>例：<br>EVENTS Visualization: bar | 要素のデータを取得します。|
| **SQL Preview** | データモデルの概要を表示するために使用されるデータを取得します。|
| **Filter Top Values** | 列の詳細を表示する際や、データ要素のリストフィルターを開く際など、トップの値を取得します。|
| **<Element name> Count Rows** | 列の詳細を取得する際や、データモデルの概要で折りたたまれた要素を表示する際など、要素の行数を取得します。|
| **<Element name> Column statistics** | ワークブックまたはデータモデルの列の詳細を表示する際など、列の統計情報を取得します。|
| **Export Query** | スケジュールされた、またはオンデマンドのワークブック、ページ、または要素のエクスポートを実行するために最新のデータを取得します。|
| **<Element name> Export Query** | CSVやJSONなどの生データ形式で要素をダウンロードするために最新のデータを取得します。|

* **クエリ実行パス詳細 (Query execution path details)**
    Sigmaで利用可能なデータに応じて、クエリの実行パスは異なる場合があります。

| 実行パス | 詳細 |
| :--- | :--- |
| **Warehouse** | 最適化されたSQLクエリでデータプラットフォームを直接クエリしてデータを取得します。|
| **Warehouse (cache)** | 特定のデータプラットフォームで利用可能。クエリIDを使用して、データプラットフォームのクエリ結果キャッシュからデータを取得するクエリを実行します。詳細は、「[Set a query ID cache duration](https://help.sigmacomputing.com/docs/set-a-query-id-cache-duration)」を参照してください。|
| **Warehouse (materialized)** | マテリアライズされたテーブルにクエリを実行してデータを取得します。「[About materialization](https://help.sigmacomputing.com/docs/about-materialization)」を参照してください。|
| **Browser** | ブラウザキャッシュからデータを取得し、アルファクエリを使用して計算を実行します。詳細は、「[Caching and data freshness](https://help.sigmacomputing.com/docs/caching-and-data-freshness)」を参照してください。|

詳細は、「[Caching and data freshness](https://help.sigmacomputing.com/docs/caching-and-data-freshness)」を参照してください。

### 5-5-2. データセットのクエリを調査する (Examine dataset queries)

#### **最近のクエリを表示する (View recent queries)**
クエリ履歴モーダルは、既存のセッション内に開いているドキュメントから実行された最近のクエリを表示します。
あなたのドキュメントの個々のクエリリストは、各クエリのステータス、アクションタイプ、開始時刻、実行時間を自動的に表示します。

1.  データセットのワークシートタブを開きます。
2.  データセットのツールバーの一番左にある更新ボタンの隣にあるキャレットアイコンをクリックします。
3.  `Query history...`をクリックします。

#### **個々のクエリを表示する (View an individual query)**
1.  データセットの`Worksheet`タブを開きます。
2.  データセットのツールバーの一番左にある更新ボタンの隣にあるキャレットアイコンをクリックします。
3.  `Query history...`をクリックします。
4.  調査したいクエリをクリックします。
5.  クエリ詳細ビューを探索します：
    * Sigmaが生成したSQLを表示およびコピーします。
    * クエリが失敗した場合、エラーも`Query Details`の下に表示されます。

#### **クエリステータスタイプ (Query status types)**
これらはSigma内で可能なクエリステータスタイプです。

| | |
| :--- | :--- |
| **Completed** | あなたのクエリは正常に実行されました！ |
| **Running** | あなたのクエリは現在実行中です。 |
| **Errored** | 何か問題があります。クエリ詳細ビューを開いてエラーメッセージを確認してください。 |
| **Paused** | ドキュメント上のクエリは一時停止しています。クエリを再開するには、ドキュメントツールバーの`Play`をクリックしてください。 |
| **Canceled** | クエリはキャンセルされました。これは、クエリが実行される前にドキュメントに追加の変更が加えられた場合に発生する可能性があります。この状況では、Sigmaは新しいクエリのみを実行します。 |

> 📘
> デフォルトでは、Sigmaはクエリのタイムアウトを120秒（2分）に設定しています。組織の管理者は、接続ごとにこれをカスタマイズするオプションがあります。

#### **クエリ実行時間の内訳 (Query runtime breakdown)**
正常に完了したクエリとタイムアウトしたクエリに対して、詳細なクエリ実行時間の内訳が利用可能です。クエリの実行時間は、ネットワークトラフィック、キューの遅延、またはデータウェアハウスの処理時間によって変動する可能性があります。Sigmaの実行時間の内訳により、クエリが遅延したかどうか、いつ遅延したかを確認できます。

実行時間は3つの部分に分かれています。
| | |
| :--- | :--- |
| **Queue duration** | クエリがウェアハウスに送信される前にSigmaのキューで待機する時間。 |
| **Sigma runtime** | キューの期間とウェアハウスの時間を除く、Sigmaがクエリを処理するのにかかる時間。 |
| **Warehouse runtime**| Sigmaがデータウェアハウスにリクエストを送信してから応答を受け取るまでの時間。これは、おおよそウェアハウスがクエリの実行に費やした時間です。 |

未完了のクエリは、詳細な実行時間の内訳を表示しません。この機能は、ダウンロード/エクスポートリクエストでも利用できません。

#### **クエリを一時停止および再開する (Pause and resume queries)**
ウェアハウスに対して自動的にクエリを実行せずにドキュメントに変更を加えるために、クエリを一時停止できます。

1.  データセットの`Worksheet`タブを開きます。
2.  データセットのツールバーの一番左にある更新/再生ボタンの隣にあるキャレットアイコンをクリックします。
3.  `Pause queries`または`Resume queries`をクリックします。
   
### 5-5-3. クエリIDキャッシュ期間を設定する (Set a query ID cache duration)

一部のクラウドデータウェアハウス（CDW）には、Sigmaが追加のコンピューティングコストを発生させることなくクエリ結果を取得するために使用できるクエリ結果キャッシュがあります。CDWで利用可能な場合、SigmaはクエリIDを使用してキャッシュされたデータにアクセスします。これにより、パフォーマンスが向上します。

ワークブックには、クエリIDのキャッシュ期間、つまり存続期間（TTL）の設定があります。デフォルトの期間は10分です。詳細については、「[Caching and data freshness](https://help.sigmacomputing.com/docs/caching-and-data-freshness)」を参照してください。

実際のクエリ結果はSigmaではなく、CDWにキャッシュされます。通常、CDWキャッシュは結果のコピーの形をとり、24時間保存されます。
TTL期間内にソースデータが変更された場合、キャッシュされた結果は無関係または不正確なデータを反映します。

クエリの結果を返そうとする場合、`Cache duration`設定を使用して、結果キャッシュが特定の分数だけ古いことを指定できます。

#### **要件 (Requirements)**
* この機能は、SnowflakeやBigQueryを含む、結果キャッシュをサポートするCDWでのみ利用可能です。
* ワークブックのクエリIDキャッシュ期間を設定するには、組織の`Admin`である必要があります。

#### **クエリキャッシュID期間を設定する (Set a query cache ID duration)**
1.  ワークブックのヘッダーにある更新ボタンの右側にあるキャレット（▼）ボタンをクリックします。
2.  `Data refresh`を選択します。
    `Data Refresh Settings`モーダルが開きます。
3.  `Cache duration`の下で、分または時間で期間を設定します。
4.  `Save`をクリックします。

### 5-5-4. キャッシュとデータの鮮度 (Caching and data freshness)

ワークブックまたはデータモデルを開くと、Sigmaは最適化されたSQLクエリを生成・実行し、接続されたデータプラットフォームからデータを取得します。Sigmaはあなたのデータを保存せず、ブラウザのキャッシングとウェアハウスレベルのキャッシングを使用して、ウェアハウスのオーバーヘッドを削減しつつ、新鮮なデータを保証します。

#### **Sigmaがウェアハウスのオーバーヘッドを削減する方法 (How Sigma reduces warehouse overhead)**
データ要素が更新されると、Sigmaはウェアハウスへのオーバーヘッドを削減しようと試みます。Sigmaが従うステップは以下の通りです。
1.  ブラウザキャッシュを確認する
2.  アルファクエリを試す
3.  CDWの結果IDキャッシュを試す（一部のCDWでのみ利用可能）
4.  ウェアハウスに再度クエリを実行する

> 🚩
> 手動更新またはスケジュールされた更新は、すべてのキャッシングオプションをバイパスします。「[Manage workbook refresh options](https://help.sigmacomputing.com/docs/manage-workbook-refresh-options)」を参照してください。

どのクエリがどこで実行されているかの詳細については、ワークブック、データモデル、またはデータセットのクエリ履歴を確認してください。「[Examine workbook and data model queries](https://help.sigmacomputing.com/docs/examine-workbook-queries)」および「[Examine dataset queries](https://help.sigmacomputing.com/docs/examine-dataset-queries)」を参照してください。

##### **ブラウザキャッシュを確認する (Check browser cache)**
ブラウザキャッシュは、ブラウザですぐにアクセスできるデータを占めます。キャッシュは空であるため、最初にワークブックまたはデータモデルを開いたときにはブラウザキャッシュは利用できませんが、変更を加えるにつれて、Sigmaは可能な場合に結果を表示するために自動的にブラウザキャッシュを使用します。
データ要素に変更を加えると、Sigmaはまずブラウザに既にある既存のデータが、更新された要素でまだ機能するかどうかを確認します。
これは、以下のような場合に発生する可能性があります。
* 列の名前が変更されたり、移動されたりした場合

##### **アルファクエリを試す (Try alpha query)**
ブラウザ内のデータを直接使用できない場合、Sigmaはブラウザ内の既存のデータを使用して新しい値を再計算できるかどうかを確認します。
これは、以下のような場合に発生する可能性があります。
* 新しい集計列が追加された場合

##### **クエリIDキャッシュを試す (Try query ID cache)**
クエリキャッシュは、SnowflakeやBigQueryのように、データウェアハウスが結果キャッシングをサポートしている場合にのみ使用されます。
これは、以下のような場合に発生する可能性があります。
* データを再グループ化する場合

Sigmaはクエリ結果を保存せず、ウェアハウスから返されたクエリIDのみを保存し、そのIDを使用してデータウェアハウスのキャッシュから結果を取得します。

##### **クエリIDキャッシュ期間を設定する (Set a query ID cache duration)**
SnowflakeやBigQueryなど、一部のデータプラットフォームは、クエリIDを使用してキャッシュから過去のクエリの結果を返すことをサポートしています。
ワークブックのキャッシュ期間、つまり存続期間（TTL）とは、SigmaがクエリIDを使用してCDWの結果キャッシュから結果を取得しようと試みる期間を指します。
SigmaがクエリIDキャッシュをクエリに使用できると判断し、CDWに対して最後にクエリが実行された時刻がクエリIDキャッシュ期間内である場合、Sigmaはウェアハウスに対してクエリを再実行しようとはしません。
ウェアハウスに対して最後にクエリが実行された時刻がクエリIDキャッシュ期間外である場合、SigmaはクエリIDを使用してCDWの結果キャッシュから結果を取得してワークブックをレンダリングし、並行してウェアハウスに対してクエリを実行します。最新の結果がウェアハウスから返されると、Sigmaはワークブック要素を更新します。
TTLの変更に関する情報については、「[Set a query ID cache duration](https://help.sigmacomputing.com/docs/set-a-query-id-cache-duration)」を参照してください。

##### **手動更新と更新スケジュール (Manual refresh and refresh schedules)**
必要に応じて、更新スケジュールを使用してください。詳細は「[workbook refresh options](https://help.sigmacomputing.com/docs/manage-workbook-refresh-options)」を参照してください。
> 🚩
> Sigmaはクエリ結果を保存せず、ウェアハウスから返されたクエリIDのみを保存します。すべてのデータ更新は、ウェアハウス内のデータに再度クエリを実行します。自動更新を設定すると、接続に負荷がかかり、多額のウェアハウスコストが発生する可能性があります。

### 6-1-1. チャートの概要 (Intro to charts)

チャートとビジュアライゼーションは、分析に視覚的なコンテキストを追加するグラフィカルなデータ要素です。これらを使用すると、より焦点を絞り、理解しやすい形式でデータを生成、探索、表示することができます。

ワークブックにチャートを追加することで、説得力のあるデータナラティブを作成するために重要な、パターン、トレンド、外れ値、および相関関係を明らかにすることができます。各ビジュアライゼーションを構築して、特定のデータインサイトを提供し、より良いビジネス上の意思決定に役立つ重要な質問に答えます。

このドキュメントでは、Sigmaが提供するチャートの種類を紹介し、要素のプロパティと書式設定をどこで構成するかを説明します。

#### **チャートタイプ (Chart types)**
効果的なチャートは、意味のあるデータストーリーを語るために不可欠ですが、適切な種類のチャートを選択することは困難な場合があります。視覚化したいデータの種類、答える必要のある質問、および分析を閲覧・利用するユーザーを考慮してください。

以下の情報は、明確で詳細なナラティブに最適なチャートを選択するのに役立ちます。

<img width="723" height="447" alt="bar-chart" src="https://github.com/user-attachments/assets/59a08a5d-1378-4ff1-bd68-ac132238271b" />

* **棒グラフ (Bar chart)**
    データのカテゴリやグループ間で値がどのように異なるかを示します。値を相互に比較したり、参照マークとの関連で比較したり、全体の一部としての比率として比較したりします。
    「[棒グラフの作成](https://help.sigmacomputing.com/docs/build-a-bar-chart)」を参照してください。

  <img width="723" height="447" alt="line-chart" src="https://github.com/user-attachments/assets/5db0950b-ae3f-48f0-8530-49bd2a0ca226" />

* **折れ線グラフ (Line chart)**
    一つ以上のメトリックの値が時間とともにどのように変化するかを示します。データセット内のトレンドを見つけ、異常を特定します。
    「[折れ線グラフの作成](https://help.sigmacomputing.com/docs/build-a-line-chart)」を参照してください。

<img width="760" height="489" alt="kpi-chart" src="https://github.com/user-attachments/assets/330bff63-2ad1-42c4-b001-c2754124b009" />

* **KPIチャート (KPI chart)**
    単一のメトリック値をハイライトして、パフォーマンスや目標に対する進捗を測定します。特定の期間の合計値を要約したり、時間経過に伴う値を比較したり、ベンチマークや目標に対して測定したりします。
    「[KPIチャートの作成](https://help.sigmacomputing.com/docs/build-a-kpi-chart)」を参照してください。

  <img width="723" height="447" alt="area-chart" src="https://github.com/user-attachments/assets/f3412945-6fe8-4716-bf7d-e6f7370bded3" />

* **エリアチャート (Area chart)**
    時間経過に伴う一つ以上のメトリックの大きさや累積値を図示します。データのカテゴリやグループを比較したり、データの構成や部分と全体の関係を評価したりします。
    「[エリアチャート](https://help.sigmacomputing.com/docs/area-charts)」を参照してください。

<img width="723" height="447" alt="scatter-plot" src="https://github.com/user-attachments/assets/64f8c6e9-dd01-4f93-9b36-deea2ccb0c4d" />

* **散布図 (Scatter plot)**
    メトリック間の相関の有無と強さを示します。データセット内のパターンを分析し、分布を理解し、外れ値を特定します。
    「[散布図の作成](https://help.sigmacomputing.com/docs/build-a-scatter-plot)」を参照してください。

  <img width="723" height="447" alt="combo-chart" src="https://github.com/user-attachments/assets/50715de7-22ea-4829-a5e5-51e934e0a0b1" />


* **コンボチャート (Combo chart)**
    棒、線、エリア、および/または点のマークを組み合わせて、複数のタイプのメトリックを比較します。データセット間の相関と変動を特定するために、関係を評価します。
    「[コンボチャート](https://help.sigmacomputing.com/docs/combo-charts)」を参照してください。

<img width="723" height="446" alt="box-chart" src="https://github.com/user-attachments/assets/cb96a38b-686f-404e-aa62-4977c2cca887" />


* **箱ひげ図 (Box chart)**
    一つ以上のメトリックの値の分布を示します。最小値、中央値、最大値をマークし、データセット内の外れ値を特定します。
    「[箱ひげ図](https://help.sigmacomputing.com/docs/box-and-whisker-charts)」を参照してください。

<img width="723" height="448" alt="donut-chart" src="https://github.com/user-attachments/assets/d4238fa5-01a3-4a18-820f-a9fa0c5abc3f" />


* **円グラフとドーナツグラフ (Pie and donut charts)**
    値を全体の一部としての比率として描写し、データの分布と部分と全体の関係を伝えます。
    「[円グラフとドーナツグラフ](https://help.sigmacomputing.com/docs/pie-and-donut-charts)」を参照してください。

<img width="723" height="448" alt="donut-chart" src="https://github.com/user-attachments/assets/64dbec90-94b4-48d2-91b2-728b767e27bc" />


* **サンキーダイアグラム (Sankey diagram)**
    プロセスやシステムを通じてデータがどのように流れ、変化するかを示します。異なるパス間のデータの動きと比率を比較して、分布、ワークフロー、ネットワークなどを分析します。
    「[サンキーダイアグラムの作成](https://help.sigmacomputing.com/docs/build-a-sankey-diagram)」を参照してください。

<img width="723" height="435" alt="funnel-chart" src="https://github.com/user-attachments/assets/47bce710-3a9f-42fd-ad2d-e9e9bde09dc6" />

* **ファネルチャート (Funnel chart)**
    線形プロセスにおける連続した段階での値を測定します。段階ごとの入力を理解し、ボトルネックやその他の問題を特定し、プロセスの全体的な健全性を評価します。
    「[ファネルチャートの作成](https://help.sigmacomputing.com/docs/build-a-funnel-chart)」を参照してください。

<img width="597" height="348" alt="gauge-chart" src="https://github.com/user-attachments/assets/70f68351-be2a-4db0-a504-7b6eecc797be" />

* **ゲージチャート (Gauge chart)**
    放射状のスケールに対して単一値のメトリックを測定します。成長を評価し、パフォーマンスを査定し、目標に対する進捗を追跡します。
    「[ゲージチャートの作成](https://help.sigmacomputing.com/docs/build-a-gauge-chart)」を参照してください。

<img width="701" height="361" alt="3ad246e-thumbnail-no-border" src="https://github.com/user-attachments/assets/3650c813-6c24-4564-b12c-5ad7ccc31ee3" />

* **ウォーターフォールチャート (Waterfall chart)**
    ある期間における一つまたは二つのデータカテゴリの変化を示します。
    「[ウォーターフォールチャートの作成](https://help.sigmacomputing.com/docs/build-a-waterfall-chart)」を参照してください。

<img width="896" height="507" alt="region-map" src="https://github.com/user-attachments/assets/8793571a-c148-42c8-877f-ce7681dee4ee" />

* **リージョンマップ (Region map)**
    国、州、郡、市を含む地域別のデータ分布を図示します。スケールを比較して、異なる地理的エリア間の変動性とパターンを特定します。
    「[マップ](https://help.sigmacomputing.com/docs/maps)」を参照してください。

* **ポイントマップ (Point map)**
    緯度と経度の座標に基づいて正確な位置でデータ分布を図示します。地理空間パターンを明らかにし、データセット内の外れ値を特定します。
    「[マップ](https://help.sigmacomputing.com/docs/maps)」を参照してください。

<img width="896" height="507" alt="point-map" src="https://github.com/user-attachments/assets/6e763dd6-e445-4f1f-9d34-3cc3f9259704" />

* **地理マップ (Geography map)**
    地理（WKT）またはバリアント（GeoJSON）データを使用して、マップ上に地理空間オブジェクトを図示します。データ分布を示し、パターンを明らかにし、空間ネットワークを図示し、または異なる地理的エリア間のデータ変動性を評価します。
    「[地理マップの作成](https://help.sigmacomputing.com/docs/build-a-geography-map)」を参照してください。

<img width="625" height="380" alt="geography-map" src="https://github.com/user-attachments/assets/7f0688fc-c08d-4f91-8b58-36f794ee56c1" />

#### **カスタム構成 (Custom configurations)**
チャートには、データがどのように表現されるかを決定する様々なプロパティと書式設定オプションがあります。幅広いカスタマイズ可能な構成により、チャートを強化し、意味のある実用的な情報を提示するようにできます。

* **プロパティ (Properties)**
    `Element properties`パネルでは、チャートタイプを選択し、軸のカテゴリ、メトリック、色、ツールヒントを含むチャートプロパティを定義するためにソース列を構成する必要があります。
    データ値のタイプを変換したり、データの集計や切り捨てを変更したり、チャートのマーカーやツールヒントをカスタマイズしたりできます。選択したチャートタイプによっては、チャートの向きを変更したり、データのスタッキングを修正したり、トレリスの行や列を追加したりするオプションもあります。
  
<img width="1148" height="574" alt="aad3c8f-1" src="https://github.com/user-attachments/assets/495014a5-9b3c-4efb-b4be-e9ce794fb6ce" />

* **書式設定 (Formatting)**
    `Element format`パネルでは、チャートのタイトルの内容、サイズ、配置を含む様々なコンポーネントの外観をカスタマイズできます。選択したチャートタイプによっては、背景、軸、凡例、データラベル、参照マーク、トレンドラインなどを書式設定することもできます。

  <img width="1148" height="574" alt="7cd7232-3" src="https://github.com/user-attachments/assets/5f66cb63-0953-4c95-a490-9e23f7fad169" />

### 6-2-1. 棒グラフの作成 (Build a bar chart)

棒グラフは通常、データのカテゴリやグループ間で値を比較するために使用されます。基本的な単一系列の棒グラフを作成したり、複数の変数を比較したり、参照マークに対して値を測定したり、全体の一部を評価したりする高度なチャートを構築したりできます。

このドキュメントでは、基本的な棒グラフの要件を詳述し、ワークブックのチャートを強化するのに役立つ主要なプロパティと書式設定オプションを紹介します。
<img width="723" height="447" alt="bar-chart" src="https://github.com/user-attachments/assets/ba6cd19d-cc33-4b65-9c30-840684e5cf9e" />

> 💡
> **使用例：**
> * **店舗分析:** 製品カテゴリごとの総売上を測定し、トップおよびボトムのパフォーマンスカテゴリを特定します。
> * **マーケティング分析:** 広告の参照サイト（LinkedInやGoogleAdsなど）ごとのユニークなウェブサイトページビューを追跡し、広告のパフォーマンストレンドと参照サイトの効果を理解します。
> * **会計分析:** 支出カテゴリごとの出張費を監視し、出張費を理解し、期待を超えるカテゴリを特定します。
> * **教育分析（ヒストグラム）:** スコア範囲ごとの学生の試験結果をカウントし、度数分布を分析し、パフォーマンスのばらつきを理解します。

#### **ユーザー要件 (User requirements)**
棒グラフやその他のチャートを作成する機能には、以下が必要です。
* `Edit Workbook`および/または`Explore Workbook`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
> 🚧
> ワークブックへの`Can explore`アクセス権が付与されている場合、`Explore`モードでチャートのプロパティと書式設定を作成および変更できますが、変更を公開することはできません。

#### **基本的な棒グラフの要件 (Basic bar chart requirements)**
棒グラフをプロットするには、`Element properties`タブで以下のプロパティを構成します。

| チャート | ワークブックに表示されるチャートタイプ |
| :--- | :--- |
| **X軸 (X-axis)** | X軸（水平軸）のカテゴリまたは変数を定義するソース列 |
| **Y軸 (Y-axis)** | Y軸（垂直軸）のカテゴリまたは変数を定義するソース列 |

棒グラフでは、通常、一方の軸が順序カテゴリまたは名目カテゴリ（段階、地域、部門など）を表し、垂直または水平の棒として表示されます。もう一方の軸は、各カテゴリの値（売上、リード、経費など）を測定する変数を表し、対応する棒の高さまたは長さを決定します。各軸に関連付けられるデータのタイプは、いつでも変更できるチャートの向きに依存します。

> 🚩
> すべてのチャートの核には、チャートによって視覚化される情報を提供する、基盤となるデータテーブル（データソースから派生）があります。棒グラフを構築する際、Sigmaは要素のプロパティを基盤となるデータテーブルのソース列にマッピングするために、データを自動的に計算および構造化します。チャートを構成中に基盤となるデータを表示する方法については、「[データ要素を最大化または最小化する](https://help.sigmacomputing.com/docs/maximize-an-element)」を参照してください。

#### **棒グラフを追加する (Add a bar chart)**
ワークブックにチャート要素を追加し、それを棒グラフとして指定します。
1.  `Explore`または`Edit`モードでワークブックを開き、新しいチャート要素を追加します。
2.  `Chart`プロパティで、ドロップダウンフィールドをクリックし、リストから`Bar`を選択します。
<img width="442" height="254" alt="bar_visualization-type" src="https://github.com/user-attachments/assets/0e28b0c7-983d-44f4-9770-1863cbd9ce9d" />
     > 📘
    > このドロップダウンフィールドを使用して、既存のチャートを別のタイプに変換することもできます。Sigmaは、初期タイプと新しいタイプで共有されるすべてのプロパティと書式設定構成を保持します。共有されていないプロパティと書式設定は、チャートをさらに変換しても保存または復元されません。

##### **カテゴリを定義する (Define the categories)**
チャートカテゴリを定義するためにソース列を構成します。
垂直棒グラフ（デフォルトの向き）を構築する場合は、`X-axis`プロパティに以下のステップを適用します。水平棒グラフを構築する場合は、`Y-axis`プロパティにステップを適用します。チャートの向きとそれがチャート軸にどのように影響するかについての情報は、このドキュメントの「[向きとスタッキングを変更する](#change-orientation-and-stacking)」を参照してください。

1.  該当する軸プロパティで、`Add column`をクリックし、メニューからオプションを選択します。
    * 既存の列の個別値に基づいてカテゴリを生成するには、`Select column`リストを検索またはスクロールし、希望の列名を選択します。
    * カスタム数式に基づいてカテゴリを生成するには、`New column`を選択し、ツールバーに数式を入力します。例えば、ヒストグラムを構築する際、`BinRange`または`BinFixed`関数を使用してカスタム数式を作成し、値の範囲に基づいてカテゴリを生成します。
    > 💡
    > `Columns`リストから列名を該当する軸プロパティにドラッグ＆ドロップして、既存の列を選択または置換することもできます。

<img width="1195" height="419" alt="bar_define-categories_step-1" src="https://github.com/user-attachments/assets/20e59c92-a15e-44e9-858e-60b436dfac24" />

2.  [任意] ソース列データがチャートでどのように分類され、表示されるかを制御します。
    * a. ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
    * b. 以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。
        * **Truncate date (日付の切り捨て):** 選択した間隔または測定単位で日付値を分類します。
        * **Transform (変換):** 列を選択した[データ値タイプ](https://help.sigmacomputing.com/docs/supported-data-types-and-formats)に変換します。
        * **Format (書式):** 軸とデータラベルを選択した書式で表示します。

<img width="1195" height="583" alt="bar_define-categories_step-2" src="https://github.com/user-attachments/assets/32b63943-9522-4350-bc18-c28fdc06d672" />

##### **変数を定義する (Define the variable)**
チャート変数を定義するためにソース列を構成します。Sigmaは、同じチャートカテゴリに関連付けられた値を自動的に集計します。
垂直棒グラフ（デフォルトの向き）を構築する場合はY軸プロパティに、水平棒グラフを構築する場合はX軸プロパティに以下のステップを適用します。

1.  該当する軸プロパティで、`Add calculation`をクリックし、メニューからオプションを選択します。
    * 既存の列の値を集計するには、`Aggregate column`リストを検索またはスクロールし、希望の列名を選択します。
    * カスタム数式に基づいて値を計算するには、`New column`を選択し、ツールバーに数式を入力します。
    * 各カテゴリに関連付けられた行数をカウントするには、`Row count`を選択します。
    > 📘
    > 棒グラフは最大25,000データポイントをサポートします。構成がこの制限を超えるデータセットになる場合、チャートは最初の25,000データポイントを表示し、チャートが不完全であることを示す警告メッセージが表示されます。
    
<img width="1195" height="442" alt="bar_define-metric_step-1" src="https://github.com/user-attachments/assets/869ad89d-c455-4e69-a5da-f0ea87f8eedf" />

2.  [任意] ソース列データがチャートでどのように計算され、表示されるかを制御します。
    * a. ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
    * b. 以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。
        * **Set aggregate (集計の設定):** 選択した集計方法に基づいて値を計算します。
        * **Transform (変換):** 列を選択したデータ値タイプに変換します。
        * **Format (書式):** 軸とデータラベルを選択した書式で表示します。
    > 📘
    > 値を集計せずにソース列データをプロットするには、`Y-axis`プロパティの`Aggregate values`チェックボックスをオフにします。
<img width="1195" height="783" alt="bar_define-metric_step-2" src="https://github.com/user-attachments/assets/dbd25f8f-6457-4db1-8eae-c6f8498249c0" />

3.  [任意] 前のステップを繰り返して、複数のy軸ソース列を追加します。Sigmaは列を[積み上げまたはクラスター化](https://help.sigmacomputing.com/docs/build-a-bar-chart#change-orientation-and-stacking)されたシリーズとしてプロットします。

<img width="1195" height="419" alt="bar_define-metric_step-3" src="https://github.com/user-attachments/assets/32db9782-75a1-45ff-90c7-ff0a4bbf749f" />

4. [任意] Sigmaは視覚化されたデータを反映するためにソース列名とチャートタイトルを自動生成しますが、必要に応じてこれらのフィールドをカスタマイズできます。
* ソース列の名前を変更するには、`X-axis`または`Y-axis`プロパティで列名をダブルクリックし、新しい名前を入力します。変更はデフォルトのチャートタイトルに反映されます。
* チャートタイトルを編集するには、チャート内のタイトルをダブルクリックし、新しいタイトルを入力します。
> 📘
> Sigmaはデフォルトのチャートタイトルのみを自動生成します。タイトルがカスタマイズされると、ソース列とその名前の変更はもはや反映されません。
<img width="1195" height="419" alt="bar_define-metric_step-4" src="https://github.com/user-attachments/assets/11d73cc7-6e3f-4569-ac46-8b04829bb81f" />
<img width="1195" height="419" alt="bar_define-metric_step-4" src="https://github.com/user-attachments/assets/b8495014-d052-4ac8-af53-c73b89e08ff5" />

#### **高度な棒グラフのプロパティと書式設定 (Advanced bar chart properties and formatting)**
Sigmaは、積み上げ、100%積み上げ、クラスター化（グループ化）、および二重軸棒グラフなど、高度な棒グラフとそのバリエーションを構築するための柔軟性を提供する、様々なプロパティと書式設定オプションを備えています。

以下のセクションでは、棒グラフを強化し、意味のある実用的な情報で特定のインサイトを提供するのに役立つ構成を紹介します。

##### **向きとスタッキングを変更する (Change orientation and stacking)**
`Element properties` > `Chart`プロパティで棒グラフの向きとスタッキングを変更して、カテゴリ間およびカテゴリ内でのデータ比較方法を最適化します。
<img width="401" height="110" alt="bar_properties_orientation-stacking" src="https://github.com/user-attachments/assets/58941b89-0816-4c17-bc3a-793b9bf816a9" />

| 向き (Orientation) | |
| :--- | :--- |
| **Vertical (垂直)** | x軸でデータを分類し、y軸で値を測定して垂直の棒マークを作成します。 |<img width="711" height="343" alt="bar_orientation_vertical" src="https://github.com/user-attachments/assets/e2e863e8-d79e-4bfa-a0d9-4f31f918d358" />

| **Horizontal (水平)**| y軸でデータを分類し、x軸で値を測定して水平の棒マークを作成します。 |<img width="711" height="343" alt="bar_orientation_horizontal" src="https://github.com/user-attachments/assets/e4a3f19c-4e4f-4452-9915-0d36aba1d693" />


| スタッキング (Stacking) | |
| :--- | :--- |
| **No stacking (積み上げなし)** | 複数のデータシリーズをカテゴリ内で別々の棒としてプロットします。結果のクラスター化棒グラフで、カテゴリ間およびカテゴリ内の値を比較します。 |<img width="711" height="344" alt="bar_stacking_no-stacking" src="https://github.com/user-attachments/assets/2bf15b14-cb47-4a2d-be47-09949aa9e4a6" />

| **Stacked (積み上げ)** | 複数のデータシリーズを累積的な棒セグメントとしてプロットします。結果の積み上げ棒グラフで、各カテゴリの合計値へのサブカテゴリの貢献度を比較します。 |<img width="711" height="343" alt="bar_stacking_stacked" src="https://github.com/user-attachments/assets/5f29a2f9-ec53-47ae-9da5-c42d53895d8d" />

| **Stacked 100% (100%積み上げ)** | 複数のデータシリーズを、各カテゴリの合計値の100%になる積み上げ棒としてプロットします。結果の100%積み上げ棒グラフで、サブカテゴリの分布を比較します。 |<img width="711" height="343" alt="bar_stacking_stacked-100" src="https://github.com/user-attachments/assets/2576cdea-4782-47c7-a836-3d4644963164" />


##### **マークの色を構成する (Configure mark colors)**
`Element properties` > `Marks` > `Color`タブで棒マークの色を構成して、データを区別したり、特定の値をハイライトしたり、色を使用して棒の値をカテゴリ別に分割したり、カラースケールを適用したりできます。
<img width="401" height="215" alt="bar_marks_color" src="https://github.com/user-attachments/assets/8d287015-e5ea-462e-b533-08c88300ec13" />

| マークの色 | |
| :--- | :--- |
| **Single color** | 各データシリーズについて、16進コードを入力するか、カラーパレットまたはカラーピッカーからオプションを選択します。<br>書式設定ルールの追加に関する情報は、このドキュメントの「[条件付き書式を追加する](#add-conditional-formatting)」を参照してください。|<img width="711" height="343" alt="bar_marks_color_single-color" src="https://github.com/user-attachments/assets/4ee51a4d-095d-4651-96b7-42e7e5baae42" />

| **By category**| 色のカテゴリを定義するソース列を選択し、結果のスタックまたはクラスターのカラーパレットを選択またはカスタマイズします。|<img width="711" height="343" alt="bar_marks_color_by-category" src="https://github.com/user-attachments/assets/9b1c5ec5-e874-4a6c-a9dd-9775df89aba4" />

| **By scale** | カラースケールを定義するソース列を選択し、マークに適用する色の範囲を選択します。|<img width="711" height="344" alt="bar_marks_color_by-scale" src="https://github.com/user-attachments/assets/c6884a4a-5b2e-48d8-bf49-ebf0dc7d4e27" />


> 📘
> Y軸（垂直棒グラフの場合）またはX軸（水平棒グラフの場合）に複数の変数があると、各データシリーズが異なる変数の測定値を表す、積み上げまたはクラスター化された棒グラフになります。`By category`の色設定も棒のスタックまたはクラスターを生成できますが、結果のシリーズは、構成されたチャートカテゴリ内で同じ変数を測定するサブカテゴリを表します。

##### **条件付き書式を追加する (Add conditional formatting)**
`Element properties` > `Marks` > `Color`タブで`Single color`を選択すると、値ベースの条件に応じて棒マークの色を決定する書式設定ルール（+ Add rule）を構成できます。これにより、単一色の選択に例外が作成され、指定された条件を満たす値をハイライトできます。
<img width="252" height="216" alt="bar_conditional-formatting_rule" src="https://github.com/user-attachments/assets/88d3f846-6af5-4d1a-a150-566cbab7e968" />

（例）
<img width="401" height="352" alt="bar_marks_color_conditional-formatting" src="https://github.com/user-attachments/assets/45bca4e6-6b74-4316-a4e5-63b173b36e1c" />
<img width="721" height="345" alt="bar_conditional-formatting" src="https://github.com/user-attachments/assets/b7f11523-2d84-4008-8a10-3bece63d2d98" />

> 💡
> 複数のルールの条件が満たされた場合、Sigmaは書式設定ルールを上から下への優先順位で適用します。必要に応じて、ルールブロックをドラッグ＆ドロップして並べ替えます。

##### **ツールチップのフィールドと値をカスタマイズする (Customize tooltip fields and values)**
`Element properties` > `Marks` > `Tooltip`タブでチャートマークのツールチップフィールドをカスタマイズして、最も関連性の高いメトリックとデータ属性を表示します。詳細は、このドキュメントの「[チャートマークのツールチップフィールドをカスタマイズする](https://help.sigmacomputing.com/docs/customize-chart-mark-tooltip-fields)」を参照してください。

<img width="420" height="133" alt="bar_marks_tooltip" src="https://github.com/user-attachments/assets/adbb7d51-ebbf-4241-a942-e49b1e7101d9" />

[チャートのスタッキング](https://help.sigmacomputing.com/docs/build-a-bar-chart#change-orientation-and-stacking)を適用すると、`Element format` > `Tooltip`セクションでツールチップをカスタマイズして、変数の値を累積スタックのパーセンテージとして表示することもできます。

<img width="400" height="97" alt="bar_format_tooltip" src="https://github.com/user-attachments/assets/dc0ac0e3-8732-4bfe-aa24-76e0db580b87" />

| ツールチップの値表示 | |
| :--- | :--- |
| **Default** | (<img width="644" height="331" alt="bar_format_tooltip_currency" src="https://github.com/user-attachments/assets/45308191-b293-427c-a6ea-903d6af78591" />
) |
| **Percent** | (<img width="644" height="331" alt="bar_format_tooltip_percent" src="https://github.com/user-attachments/assets/81003875-4c32-4c7f-82ce-b42feb869426" />
) |

##### **ギャップ幅のサイズを変更する (Resize gap width)**
`Element format` > `Gaps`セクションで棒マーク間のギャップのサイズを変更します。ギャップ幅は読みやすさを最適化するために自動サイズ調整されますが、Sigmaは棒グラフの間隔をカスタマイズする柔軟性を提供します。
<img width="401" height="107" alt="bar_format_gap-width" src="https://github.com/user-attachments/assets/c5540c1e-9d3a-4fa7-88de-9efb82741e61" />

| ギャップ幅 | |
| :--- | :--- |
| **Small** | (<img width="711" height="343" alt="bar_gap-width_small" src="https://github.com/user-attachments/assets/2ea5ba26-826f-4d59-a061-2f4aca58dfdb" />
) |
| **Medium** | (<img width="711" height="343" alt="bar_gap-width_medium" src="https://github.com/user-attachments/assets/ae5e118c-eb44-4855-bb88-8665f8ddb934" />
) |
| **Large** | (<img width="711" height="343" alt="bar_gap-width_large" src="https://github.com/user-attachments/assets/fadbd378-ed14-4b2a-b1ad-b0558871eaeb" />
) |

##### **すべての棒グラフの書式設定オプション (All bar chart format options)**
* Background
* Title
* X-axis
* Y-axis
* Legend
* Trellis
* Data labels
* Gaps
* Tooltip¹
* Reference marks
* Trend lines

¹ ツールチップの書式設定は、積み上げ棒グラフでのみサポートされています。

### 6-2-2. 折れ線グラフの作成 (Build a line chart)

折れ線グラフは通常、値が時間とともにどのように変化するかを評価するために使用されます。基本的な単一線のチャートを作成して、データセットのトレンドを見つけ、異常を特定します。また、高度な複数線のチャートを構築して、同じ期間にわたる複数の変数を分析・比較することもできます。

このドキュメントでは、基本的な折れ線グラフの要件を詳述し、ワークブックのチャートを強化するのに役立つ主要なプロパティと書式設定オプションを紹介します。

<img width="723" height="447" alt="2915739-line-graph" src="https://github.com/user-attachments/assets/f00bafeb-4cff-47d1-a6be-3d5a0e039744" />

> 💡
> **使用例：**
> * **消費者向けパッケージ商品（CPG）分析:** 製品カテゴリごとの月次利益率を比較し、利益トレンドを理解し、全体的な事業収益性に関するインサイトを得ます。
> * **製造分析:** 時間ごとの機械稼働率を追跡し、生産性の低下や信頼性の問題を特定します。
> * **航空旅行分析:** 航空会社ごとの月次定時出発率を評価し、季節的なパターンを理解し、企業間の運用効率を比較します。

#### **ユーザー要件 (User requirements)**
折れ線グラフやその他のチャートを作成する機能には、以下が必要です。
* `Edit Workbook`および/または`Explore Workbook`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
> 🚧
> ワークブックへの`Can explore`アクセス権が付与されている場合、`Explore`モードでチャートのプロパティと書式設定を作成および変更できますが、変更を公開することはできません。

#### **ワークブックの前提条件 (Workbook prerequisite)**
折れ線グラフを構築する前に、[新しいチャート要素を追加し、データソースを選択する](https://help.sigmacomputing.com/docs/create-a-data-element)必要があります。
すべてのチャートの核には、チャートによって視覚化される情報を提供する、基盤となるデータテーブル（データソースから派生）があります。折れ線グラフを構築する際、Sigmaは様々なチャートプロパティのソース列を作成するために、基盤となるデータを自動的にグループ化、集計、計算します。チャートを構成中に[基盤となるデータテーブルを表示](https://help.sigmacomputing.com/docs/view-underlying-data)して、データがどのように適用されるかを確認できます。
> 🚩
> 折れ線グラフは最大25,000データポイントをサポートします。構成がこの制限を超えるデータセットになる場合、チャートは最初の25,000データポイントを表示し、チャートが不完全であることを示す警告メッセージが表示されます。データポイントの数を減らすには、値を集計するか、チャートまたはソース要素にデータフィルターを適用してください。

#### **基本的な折れ線グラフの要件 (Basic line chart requirements)**
折れ線グラフをプロットするには、`Element properties`パネルで以下のプロパティを構成します。

| チャート | ワークブックに表示されるチャートタイプ |
| :--- | :--- |
| **X軸 (X-axis)** | X軸（水平軸）のカテゴリを定義するソース列 |
| **Y軸 (Y-axis)** | Y軸（垂直軸）の変数を定義するソース列 |

折れ線グラフでは、X軸は通常、個々のデータポイントに対応する時間ベースのカテゴリ（日付、月、年など）を表します。Y軸は、各カテゴリの値（売上、リード、経費など）を測定する変数を表し、各データポイントの垂直位置を決定します。

##### **チャートタイプを選択する (Select the chart type)**
ワークブックに[新しいチャートを追加](https://help.sigmacomputing.com/docs/create-a-data-element)した後、チャートタイプを選択します。
1.  `Chart`プロパティで、ドロップダウンフィールドをクリックし、リストから`Line`を選択します。

<img width="416" height="258" alt="a4c77f1-line_visualization-type" src="https://github.com/user-attachments/assets/58735651-793d-4a30-a578-c1b075bdbc37" />

      > 📘
    > このドロップダウンフィールドを使用して、既存のチャートを別のタイプに変換することもできます。

##### **X軸のカテゴリを定義する (Define the x-axis categories)**
X軸のカテゴリを定義するためにソース列を構成します。
1.  `X-axis`プロパティで、`Add column`をクリックし、メニューからオプションを選択します。
    * 既存の列の個別値に基づいてカテゴリを生成するには、`Select column`リストを検索またはスクロールし、希望の列名を選択します。
    * カスタム数式に基づいてカテゴリを生成するには、`New column`を選択し、ツールバーに数式を入力します。
    > 💡
    > `Columns`リストから列名を`X-axis`プロパティにドラッグ＆ドロップして、既存の列を選択または置換することもできます。

<img width="1195" height="419" alt="899c5fc-line_define-x-axis_step-1" src="https://github.com/user-attachments/assets/1db13b78-e537-42b2-a0ec-fa6019e4a291" />

2. [任意] ソース列データがチャートでどのように分類され、表示されるかを制御します。
 * ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
 * 以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。

| | |
| :--- | :--- |
| **Truncate date (日付の切り捨て)** | 選択した間隔または測定単位で日付値を分類します。|
| **Transform (変換)** | 列を選択したデータ値タイプに変換します。|
| **Format (書式)** | 軸とデータラベルを選択した書式で表示します。|

<img width="1195" height="574" alt="eae5320-line_define-x-axis_step-2" src="https://github.com/user-attachments/assets/180c2473-368c-4097-bc38-e7fe20886d4a" />

> 📘
> 列メニュー項目の利用可能性と対応するオプションは、列のデータ値タイプによって異なります（例えば、`Truncate date`は日付値でのみ利用可能です）。

##### **Y軸の変数を定義する (Define the y-axis variable)**
Y軸の変数を定義するためにソース列を構成します。Sigmaは、同じX軸カテゴリに関連付けられた値を自動的に集計します。

1.  `Y-axis`プロパティで、`Add calculation`をクリックし、メニューからオプションを選択します。
    * 既存の列の値を集計するには、`Aggregate column`リストを検索またはスクロールし、希望の列名を選択します。
    * カスタム数式に基づいて値を計算するには、`New column`を選択し、ツールバーに数式を入力します。
    * 各カテゴリに関連付けられた行数をカウントするには、`Row count`を選択します。
    > 💡
    > `Columns`リストから列名を`Y-axis`プロパティにドラッグ＆ドロップして、既存の列を選択することもできます。

<img width="1194" height="420" alt="7e1d541-line_define-y-axis_step-1" src="https://github.com/user-attachments/assets/cb4f2bbc-3ef1-4d2d-8e67-4d6a7b3eaa12" />

2.  [任意] ソース列データがチャートでどのように計算され、表示されるかを制御します。
    * ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
    * 以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。
        * **Set aggregate (集計の設定):** 選択した集計方法に基づいて値を計算します。
        * **Transform (変換):** 列を選択したデータ値タイプに変換します。
        * **Format (書式):** 軸とデータラベルを選択した書式で表示します。
    > 📘
    > 値を集計せずにソース列データをプロットするには、`Y-axis`プロパティの`Aggregate values`チェックボックスをオフにします。これが25,000データポイントの制限を超える不完全なチャートになる場合、値を再集計するか、データフィルターを適用してデータポイントの数を減らしてください。
    
<img width="1195" height="747" alt="994fb08-line_define-y-axis_step-2" src="https://github.com/user-attachments/assets/307b5768-f600-473e-bbc9-ca3d8e78eb2e" />

    > 💡
    > ツールバーを使用して集計方法（数式を使用）とデータラベルの書式を変更することもできます。

<img width="1195" height="419" alt="21ff93f-line_define-y-axis_step-3" src="https://github.com/user-attachments/assets/f6b53274-7e3f-4445-95a2-7bce3219ec22" />

3.  [任意] 前のステップを繰り返して、複数のy軸ソース列を構成します。Sigmaはそれぞれをチャート上の別々の線系列としてプロットします。


4.  [任意] Sigmaは視覚化されたデータを反映するためにソース列名とチャートタイトルを自動生成しますが、必要に応じてこれらのフィールドをカスタマイズできます。
    * ソース列の名前を変更するには、`X-axis`または`Y-axis`プロパティで列名をダブルクリックし、新しい名前を入力します。変更はデフォルトのチャートタイトルに反映されます。
    * チャートタイトルを編集するには、チャート内のタイトルをダブルクリックし、新しいタイトルを入力します。
    > 📘
    > Sigmaはデフォルトのチャートタイトルのみを自動生成します。タイトルがカスタマイズされると、ソース列とその名前の変更はもはや反映されません。

<img width="1195" height="419" alt="2a70931-line_define-y-axis_step-4" src="https://github.com/user-attachments/assets/f5c148ba-b6c4-4a7f-ba25-c4f0ccfe6c31" />

#### **高度な折れ線グラフのプロパティ (Advanced line chart properties)**
Sigmaは、複数線、ステップ線、および二重軸折れ線グラフなど、高度な折れ線グラフとそのバリエーションを構築するための柔軟性を提供する、様々なプロパティと書式設定オプションを備えています。

以下のセクションでは、折れ線グラフを強化し、意味のある実用的な情報で特定のインサイトを提供するのに役立つ構成を紹介します。

##### **マークの色を構成する (Configure mark colors)**
`Element properties` > `Marks` > `Color`タブで線のマークの色を構成して、データを区別したり、関連性をハイライトしたり、色のカテゴリを追加したりします。

<img width="386" height="188" alt="6f4f6ed-line_marks_color" src="https://github.com/user-attachments/assets/7cf2ac4c-0074-494a-8aee-17952674a90c" />

| マークの色 | |
| :--- | :--- |
| **Single color** | 各データシリーズについて、16進コードを入力するか、カラーパレットまたはカラーピッカーからオプションを選択します。|<img width="719" height="343" alt="line_marks_color_single-color" src="https://github.com/user-attachments/assets/feb38c16-6d7c-492a-8906-10ea6144d18e" />

| **By category**| 色のカテゴリを定義するソース列を選択し、結果の複数線シリーズのカラーパレットを選択またはカスタマイズします。|<img width="719" height="343" alt="line_marks_color_by-category" src="https://github.com/user-attachments/assets/b5985f7b-5a39-4fff-bcb4-e35d7c34398b" />


> 📘
> Y軸に複数の変数があると、各データシリーズが異なる変数の測定値を表す、複数線のチャートになります。`By category`の色設定も複数線のチャートを生成できますが、結果のシリーズは、x軸カテゴリ内で同じ変数を測定するサブカテゴリを表します。

##### **線のスタイルをカスタマイズする (Customize line style)**
`Element format` > `Line Style`セクションで線のスタイルをカスタマイズします。折れ線グラフに複数のy軸変数が含まれている場合、異なるデータシリーズを個別または一括で変更できます。
<img width="401" height="297" alt="dfe5197-line_format_line-style" src="https://github.com/user-attachments/assets/3cece6e2-aab2-4bdd-b603-58aa4d291ff0" />

線のパターン（実線、破線、点線）と太さ（1-5px）に加えて、補間パスの種類を選択できます。

| 補間 | |
| :--- | :--- |
| **Straight** | データポイント間に直線を作成します。 |<img width="532" height="219" alt="line_interpolation_straight" src="https://github.com/user-attachments/assets/7b390559-1103-4c01-9bcc-cbabd27b118b" />

| **Smooth** | データポイントを通る曲線を作成します。|<img width="531" height="219" alt="line_interpolation_smooth" src="https://github.com/user-attachments/assets/56428284-dcc6-47d9-a14c-6c7dc7802293" />

| **Step** | データポイント間にステップアップまたはダウンを作成します（垂直線は中間点）。|<img width="532" height="219" alt="line_interpolation_step" src="https://github.com/user-attachments/assets/71f65a20-49af-4d53-9769-7620396ba1ca" />

| **Step (Before)**| データポイント間にステップアップまたはダウンを作成します（垂直変化は水平線の前）。|<img width="531" height="219" alt="line_interpolation_step-before" src="https://github.com/user-attachments/assets/83da88f4-a160-41cb-bf83-7f14a1abb7dc" />

| **Step (After)** | データポイント間にステップアップまたはダウンを作成します（垂直変化は水平線の後）。|<img width="532" height="219" alt="line_interpolation_step-after" src="https://github.com/user-attachments/assets/0014febe-cc56-4281-9362-ad22da17a879" />


> 💡
> ステップ線チャートは、価格、利率、在庫など、不規則な間隔で発生する変化を視覚化する際に役立ちます。

また、個々のデータポイントを表示または非表示にしたり、折れ線グラフがnull値をどのように扱うかを制御したりすることもできます。

| Nullデータ | |
| :--- | :--- |
| **Zero** | null値をゼロ値のデータポイントとしてプロットします。|<img width="532" height="218" alt="f492619-line_null_zero" src="https://github.com/user-attachments/assets/00919f1b-5144-4a38-bccc-a33a32ff101f" />

| **Interpolate** | null値を無視し、nullでないデータポイント間で線パスを続けます。|<img width="531" height="218" alt="c630db5-line_null_interpolate" src="https://github.com/user-attachments/assets/92244276-4089-463e-ab80-71846b3b9caa" />

| **Hide** | nullデータポイントを通る線パスを省略します。|<img width="532" height="218" alt="8fc59b7-line_null_hide" src="https://github.com/user-attachments/assets/ddda7f63-a920-4a9c-a2ab-ba451e74fb00" />


デフォルトでは、折れ線グラフは線の接続間の個別のデータポイントを非表示にします。`Show points`チェックボックスを選択すると、ポイントを表示し、そのサイズ（2-15px）と形状をカスタマイズできます。

<img width="295" height="179" alt="d72eae6-line_point-style_shape_square" src="https://github.com/user-attachments/assets/dc059855-f0ab-4b87-9bc3-3ec987006340" />

| ポイントスタイル | |
| :--- | :--- |
| **Circle** | (画像) |
| **Square** | (画像) |
| **Cross** | (画像) |
| **Diamond** | (画像) |
| **Triangle** | (画像) |

##### **すべての折れ線グラフの書式設定オプション (All line chart format options)**
* Background
* Title
* X-axis
* Y-axis
* Legend
* Trellis
* Data labels
* Reference marks
* Trend lines
* Line style

### 6-2-3. KPIチャートの作成 (Build a KPI chart)

> 🚩
> SigmaのKPIチャート要素は、Single Valueビジュアライゼーション（SVV）オプションを置き換えました。SVVの非推奨とKPIチャートの利点に関する情報については、Sigmaコミュニティの投稿を参照してください。

重要業績評価指標（KPI）チャートは、通常、パフォーマンスや目標に対する進捗を測定するために使用される単一のメトリック値をハイライトします。KPIチャートを作成して、特定の期間のメトリックの合計値を要約したり、追加のデータをインクルードして時間経過に伴うメトリックの値を比較し、ベンチマークや目標値に対して測定したりします。
<img width="758" height="460" alt="kpi-chart_intro" src="https://github.com/user-attachments/assets/bcc0e874-5050-4f75-8aec-31efd2c5fda7" />

> 💡
> **使用例：**
> * **マーケティング分析:** クリックスルー率を追跡し、時間経過に伴うメールキャンペーンのパフォーマンスをハイライトします。
> * **役員向けダッシュボード:** 月次の前年比収益を測定し、当月の収益が前年のベンチマークと比較してどうだったかを理解します。
> * **製造分析:** サイクルタイムを報告し、製品が製造プロセスを完了するのにかかる時間を分析します。

#### **ユーザー要件 (User requirements)**
KPIチャートやその他のチャートを作成する機能には、以下が必要です。
* `Edit Workbook`および/または`Explore Workbook`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
> 🚧
> ワークブックへの`Can explore`アクセス権が付与されている場合、`Explore`モードでチャートのプロパティと書式設定を作成および変更できますが、変更を公開することはできません。

#### **KPIチャートのバリエーション (KPI chart variations)**
SigmaのKPIチャートでは、要素のプロパティをどのように構成するかに応じて、様々な方法でメトリックを追跡・表示できます。

##### **静的バリエーション (Static variations)**

<img width="471" height="252" alt="kpi_chart-variations_summary-value" src="https://github.com/user-attachments/assets/0f8bd9a3-b4a0-42e8-ab91-7f118419a73e" />

* **サマリー値 (Summary value)**
    メトリックのグローバルな値を要約して、全体的なパフォーマンスや規模を理解します。
    KPIチャートは、データセット全体にわたるメトリック値を集計するグローバルサマリーをハイライトします。
    * **必要な要素プロパティ:**
        * Value (値)

<img width="471" height="252" alt="kpi_chart-variations_summary-value-comparison" src="https://github.com/user-attachments/assets/9db19e38-c459-49b5-a919-472814fb9d2d" />

* **ベンチマークサマリー比較 (Benchmark summary comparison)**
    メトリックのグローバルな値をベンチマークや目標値と比較します。相対的なパフォーマンスを評価し、パターン、関係、相関に関するインサイトを得ます。
    KPIチャートは、データセット全体にわたるメトリック値を集計するグローバルサマリーをハイライトします。また、比較をパーセンテージ、差分、または絶対値として表示します。
    * **必要な要素プロパティ:**
        * Value (値)
        * Comparison (比較) (Column)

<img width="472" height="252" alt="kpi_chart-variations_period-value" src="https://github.com/user-attachments/assets/052b42aa-6aa5-4e1d-9196-f6e3c54be797" />

##### **時系列バリエーション (Time series variations)**
* **期間の値 (Period value)**
    特定の時間間隔（週、月、年など）中のパフォーマンスを分析するために、メトリックの期間値を測定します。
    KPIチャートは、最新の期間の値またはグローバルサマリーをハイライトし、連続した期間にわたるパターンと変化を示すトレンドラインを表示できます。
    * **必要な要素プロパティ:**
        * Value (値)
        * Timeline (タイムライン)

<img width="471" height="252" alt="kpi_chart-variations_period-comparison" src="https://github.com/user-attachments/assets/8f0a792c-21ec-4314-8c06-af663d894f8d" />

* **期間比較 (Period comparison)**
    ある期間（週、月、年など）のメトリックの値を別の期間と比較し、連続的または期間比較の分析を実行します。
    KPIチャートは、最新の期間の値またはグローバルサマリーをハイライトし、比較をパーセンテージ、差分、または絶対値として表示できます。また、時間経過に伴うパターンと変化を示すトレンドラインを含めることもできます。
    * **必要な要素プロパティ:**
        * Value (値)
        * Timeline (タイムライン)
        * Comparison (比較) (Period)

<img width="472" height="252" alt="kpi_chart-variations_period-value-comparison" src="https://github.com/user-attachments/assets/84310540-0586-42d7-b957-792daf435176" />

* **ベンチマーク期間比較 (Benchmark period comparison)**
    メトリックの期間値をベンチマークや目標と比較して、相対的なパフォーマンスを評価し、パターン、関係、相関に関するインサイトを得ます。
    KPIチャートは、最新の期間の値またはグローバルサマリーをハイライトし、比較をパーセンテージ、差分、または絶対値として表示できます。また、両方の値のトレンドラインを含めて、時間経過に伴うパターンと変化を示すこともできます。
    * **必要な要素プロパティ:**
        * Value (値)
        * Timeline (タイムライン)
        * Comparison (比較) (Column)

> 🚀
> ワークブックをロードまたはリフレッシュする際、Sigmaは通常、各データ要素に対して個別のクエリを送信します。ワークブックにデータソースを共有する複数の静的KPIチャート（サマリー値およびベンチマークサマリー比較バリエーション）が含まれている場合、Sigmaはクエリバッチ処理を採用します。これにより、該当するすべてのKPIチャートからのデータリクエストを単一のクエリに統合し、クエリ処理のオーバーヘッドを削減し、パフォーマンスを最適化します。時系列KPIチャート（期間の値、期間比較、およびベンチマーク期間比較バリエーション）は、データベースに個別のクエリを送信し、クエリバッチ処理には含まれません。

#### **基本的なKPIチャートの構成 (Basic KPI chart configurations)**
以下の要素プロパティを構成して、基本的なKPIチャートを構築します。

| プロパティ | 説明 |
| :--- | :--- |
| **Chart** | ワークブックに表示されるチャートタイプ |
| **Value** | メトリック値を決定する計算 |
| **Timeline** | レポート期間を定義する日付データ |
| **Comparison** | 比較値を定義する期間または計算 |

> 🚩
すべてのチャート要素の核には、その基盤となるデータがあり、それがチャートが視覚化する情報を提供します。KPIチャートを構築する際、Sigmaは要素のプロパティを基盤となるデータテーブルの列（「ソース列」）に関連付けるために、データを自動的に計算および構造化します。

既存の列を集計したり、カスタム数式や値を追加したり、行数を適用したりしてプロパティを構成すると、Sigmaは新しいソース列を作成します。

チャートを構成中に基盤となるデータを表示する方法については、「[データ要素を最大化または最小化する](https://help.sigmac.com/docs/maximize-an-element)」を参照してください。

##### **KPIチャート要素を追加する (Add a KPI chart element)**
チャート要素を追加し、それをKPIチャートとして指定します。
> 💡
> テーブル要素のサマリー値から直接新しいKPIチャートを作成することもできます。テーブルサマリーを右クリックしてメニューを開き、`Create KPI element`を選択します。

1.  `Explore`または`Edit`モードでワークブックを開き、[新しいチャート要素を追加](https://help.sigmacomputing.com/docs/create-a-data-element)します。
2.  `Chart`プロパティで、ドロップダウンフィールドをクリックし、リストから`KPI`を選択します。

<img width="867" height="388" alt="kpi_visualization-type" src="https://github.com/user-attachments/assets/c1183dd7-afcc-475b-8a12-a0ba9fcc14ed" />

##### **メトリックを計算する (Calculate the metric)**
`Value`プロパティを構成してメトリックを計算します。この構成は、どの[KPIチャートバリエーション](#kpi-chart-variations)を構築する場合にも必要です。

`Value`プロパティで、`Add calculation`をクリックし、以下のいずれかの方法でメトリックを計算します。
* 既存の列の値を集計するには、`Aggregate column`リストを検索またはスクロールし、希望の列を選択します。
* カスタム計算または値を追加するには、`Add new column`を選択し、数式バーに計算または値を入力します。
* 基盤となるデータセットの行数をカウントするには、`Row count`を選択します。
> 💡
> `Columns`リストから列名を`Value`プロパティにドラッグ＆ドロップして、既存の列の値を集計することもできます。

<img width="867" height="422" alt="kpi_define-metric-value_step-1a" src="https://github.com/user-attachments/assets/cbba6848-6381-4d0b-a867-2074f6dc6a8e" />

`Timeline`プロパティが構成されていない場合、チャートはメトリックのグローバルサマリー値を表示します。これは、結果として得られる`Value`プロパティのソース列のすべてのデータポイントを集計したものです。`Aggregate values`チェックボックスの選択を解除すると、グローバルサマリーの代わりに列から一つの値が選択されて表示されます。`Timeline`プロパティを構成した後に表示される値に関する情報については、このドキュメントの「[レポート期間を定義する](#define-the-reporting-period)」を参照してください。

<img width="867" height="388" alt="kpi_define-metric-value_step-1b" src="https://github.com/user-attachments/assets/762f0984-e90e-4489-9156-4d89a74a337e" />

メトリックを追加すると、値は自動的に集計され、`Aggregate values`チェックボックスが選択されます。
[任意] メトリックの測定方法と書式設定を制御したい場合は、`Aggregate values`チェックボックスを選択したままにし、列メニューまたは数式ツールバーを使用してメトリック値の集計、データ型、または書式を調整します。
1.  `Value`プロパティで、列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
2.  以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。

| | |
| :--- | :--- |
| **Set aggregate** | 選択した集計方法に基づいてメトリックを測定します。 |
| **Transform** | 列を選択したデータ値タイプに変換します。 |
| **Format** | メトリック値を選択した書式で表示します。 |

例えば、利益の合計KPIをSI単位を使用して表示するように書式設定できます。

<img width="867" height="647" alt="kpi_define-metric-value_step-2a" src="https://github.com/user-attachments/assets/c6d029b7-f215-45fb-ac6c-9d1d803e16e6" />
<img width="867" height="388" alt="kpi_define-metric-value_step-2b" src="https://github.com/user-attachments/assets/dffc2219-ed24-48e6-ac6e-4495471e75c6" />


##### **レポート期間を定義する (Define the reporting period)**
`Timeline`プロパティを構成して、時系列のレポート期間を定義します。この構成は、期間の値、期間比較、またはベンチマーク期間比較のKPIチャートを構築するために必要です。

1.  `Timeline`プロパティで、`Add column`をクリックし、以下のいずれかの方法でレポート期間を定義します。
    * 既存の日付列から期間を派生させるには、`Select column`リストを検索またはスクロールし、希望の列を選択します。
    * 新しい日付列に基づいて期間を作成するには、`Add new column`を選択し、数式バーに日付関数または値を入力します。
    > 📘
    > `Timeline`プロパティは日付列のみをサポートしています。日付データを含まない列を選択または作成することはできません。

<img width="867" height="481" alt="kpi_define-measurable-period_step-1a" src="https://github.com/user-attachments/assets/546e1b99-e616-403f-941d-9e6aa7300125" />

ソース列が`Timeline`プロパティに追加されると、チャートで2つの変更が発生します。
* チャートは今、メトリックの最新の期間の値を表示します。これは、`Value`プロパティのソース列データを最新の期間で集計したものです。デフォルトの表示値をグローバルサマリーに変更するには、次のステップに進みます。
* 要素のレイアウトサイズが許せば、チャートはトレンドラインを表示します。これにカーソルを合わせると、以前の期間の値を表示できます。トレンドラインを非表示にする方法については、このドキュメントの「[トレンドラインをカスタマイズする](#customize-the-trend-line)」を参照してください。

<img width="867" height="388" alt="kpi_define-measurable-period_step-1b" src="https://github.com/user-attachments/assets/2a0cf2a7-c88b-417a-9716-b6c0866746be" />

[任意] デフォルトの表示タイプ（トレンドラインと対話していないときに表示される値）を変更します。
1.  `Value`プロパティで、ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
2.  `Default display type`にカーソルを合わせ、オプションを選択します。

| | |
| :--- | :--- |
| **Latest period** | 時系列の最新期間の集計値を表示します。 |
| **Global summary** | 時系列のすべての期間の集計値を表示します。 |

<img width="867" height="426" alt="kpi_define-period_change-default-display-type" src="https://github.com/user-attachments/assets/7f7cc15c-4bfd-4c5e-9e26-33203d0c029f" />

[任意] 期間の測定方法と書式設定を制御します。
1.  `Timeline`プロパティで、列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
2.  以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。

| | |
| :--- | :--- |
| **Truncate date** | 選択した期間に基づいてメトリック値を測定します。 |
| **Format** | 期間の日付を選択した書式で表示します。 |

<img width="866" height="684" alt="kpi_define-measurable-period_step-2" src="https://github.com/user-attachments/assets/9197a1d9-7374-4c2e-9a65-d84b449c95af" />


##### **比較期間を選択する (Select a comparison period)**
`Comparison` > `Period`プロパティを構成して、メトリックの連続的または期間比較を測定します。この構成は、期間比較KPIチャートを構築するために必要です。
1.  `Comparison`プロパティで、`Period`オプションを有効にします。
2.  ドロップダウンを開き、期間比較のタイプを選択します。

##### **比較値を選択する (Select a comparison value)**
`Comparison` > `Column`プロパティを構成して、メトリックをベンチマークまたは目標値と比較します。この構成は、ベンチマークサマリー比較またはベンチマーク期間比較のKPIチャートを構築するために必要です。

1.  `Comparison`プロパティで、`Add calculation`をクリックし、以下のいずれかの方法でベンチマークまたは目標値を計算します。
    * 既存の列の値を集計するには、`Aggregate column`リストを検索またはスクロールし、希望の列を選択します。
    * カスタム計算または値を追加するには、`Add new column`を選択し、数式バーに計算または値を入力します。
    * 基盤となるデータセットの行数をカウントするには、`Row count`を選択します。

<img width="867" height="646" alt="kpi_define-comparison-value_step-2a" src="https://github.com/user-attachments/assets/9d9e861d-3736-4e6c-ace6-3d70548e3e6b" />

2.  デフォルトでは、比較値はパーセンテージとして表示されます。代わりに差分または絶対値を表示するには、`Element format`パネルで[比較をカスタマイズ](https://help.sigmacomputing.com/docs/build-a-kpi-chart#customize-the-comparison-display)します。





3.  [任意] ベンチマークまたは目標の測定方法と書式設定を制御します。
    * `Comparison`プロパティで、列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
    * 以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。

| | |
| :--- | :--- |
| **Set aggregate** | 選択した集計方法に基づいてメトリックを測定します。 |
| **Transform** | 列を選択したデータ値タイプに変換します。 |

    

#### **高度なKPIチャートのプロパティと書式設定 (Advanced KPI chart properties and formatting)**
Sigmaは、詳細なKPIチャートを構築するための柔軟性を提供する、様々なプロパティと書式設定オプションを備えています。
以下のセクションでは、チャートを強化し、意味のある実用的な情報で特定のインサイトを提供するのに役立つ構成を紹介します。

##### **値の色の変更 (Change the value color)**
`Element properties` > `Marks` > `Color`タブでメトリック値のフォントの色を変更します。これはメトリック値のデフォルトの色を決定し、[条件付き書式](https://help.sigmacomputing.com/docs/build-a-kpi-chart#add-conditional-formatting)ルールによって上書きできます。
> 📘
> `Color`プロパティ（条件付き書式を含む）はメトリック値にのみ適用され、要素のタイトルや比較のフォントには影響しません。

##### **条件付き書式の追加 (Add conditional formatting)**
`Element properties` > `Marks` > `Color`タブで書式設定ルール（`+ Add rule`をクリック）を構成して、値ベースの条件に応じてメトリック値のフォントの色を変更します。これにより、指定された条件を満たす場合に値をハイライトまたは強調表示できます。

##### **値のフォントのカスタマイズ (Customize the value font)**
`Element format` > `Value`セクションでメトリック値のフォントの太さ、色、サイズをカスタマイズします。
> 📘
> `Value`の書式設定はメトリック値にのみ適用され、要素のタイトルや比較のフォントには影響しません。このセクションでフォントの色を変更すると、要素の`Color`プロパティのフォントの色も変更されます。

##### **比較表示のカスタマイズ (Customize the comparison display)**
`Element format` > `Comparison`セクションで比較表示をカスタマイズします。
カラーインジケーターの変更に加えて、比較値のフォントサイズを変更したり、ラベルを表示または非表示にしたり、ラベルの内容をカスタマイズしたりできます。
また、表示される比較のタイプを選択し、比較の好ましい方向を特定することもできます。`Direction`設定は、`Good color`、`Neutral color`、`Bad color`インジケーターが比較値にいつ適用されるかを決定します。

| 表示 (Display) | |
| :--- | :--- |
| **% difference from** | 比較値に対する増減のパーセントを表示します。 |
| **Difference from** | 比較値に対する数値的な増減を表示します。 |
| **% of** | 比較値のパーセントを表示します。 |
| **Absolute** | 比較期間または列の絶対値を表示します。 |

| 方向 (Direction) | |
| :--- | :--- |
| **Higher is better** | 増加した比較値に`Good color`を、減少した比較値に`Bad color`を適用します。 |
| **Lower is better** | 減少した比較値に`Good color`を、増加した比較値に`Bad color`を適用します。 |
| **None** | 比較値にカラーインジケーターを適用しません。 |

##### **トレンドラインのカスタマイズ (Customize the trend line)**
`Element format` > `Trend`セクションでトレンドラインをカスタマイズします。
トレンドラインの表示/非表示に加えて、トレンドラインの形状（線またはエリア）を選択し、その色をカスタマイズできます。

| 形状 (Shape) | |
| :--- | :--- |
| **Line** | (画像) |
| **Area** | (画像) |

また、ホバー時のツールチップを有効にしたり、タイムラインの目盛りとラベル付きでx軸を表示したり、グリッド線とラベル付きでy軸を表示したりすることもできます。

| 表示オプション | |
| :--- | :--- |
| **Show tooltip** | (画像) |
| **Show timeline axis** | (画像) |
| **Show y-axis** | (画像) |

##### **チャートレイアウトのカスタマイズ (Customize the chart layout)**
`Element format` > `Layout`セクションでチャートレイアウトをカスタマイズします。
テキストコンポーネントの配置を変更し、タイトルと比較値の位置を選択します。

| 配置 (Alignment) | |
| :--- | :--- |
| **Left** | () |
| **Center** | () |
| **Right** | () |

| タイトル (Title) | |
| :--- | :--- |
| **Top** | () |
| **Bottom** | () |

| 比較値 (Comparison value) | |
| :--- | :--- |
| **Right** | () |
| **Below** | () |

##### **すべてのKPIチャートの書式設定オプション (All KPI chart format options)**
* Background
* Title
* Value
* Comparison
* Trend
* Reference marks
* Layout
* 
### 6-2-4. 散布図の作成 (Build a scatter plot)

散布図は通常、2つの異なる変数間の相関関係（またはその欠如）を示すために使用されます。基本的な散布図を作成して、データセットのパターン、トレンド、外れ値を評価します。また、追加の変数を含めたり、トレンドラインをプロットしたり、四分位にわたってデータポイントを表示したりする高度なチャートを構築することもできます。

このドキュメントでは、基本的な散布図の要件を詳述し、ワークブックのチャートを強化するのに役立つ主要なプロパティと書式設定オプションを紹介します。

> 💡
> **使用例：**
> * **教育分析:** 大学の成績と大学卒業後の収入を評価し、学業成績と職業上の収入との間に考えられる相関関係を判断します。
> * **環境衛生分析:** 近隣の大気汚染量ごとにメトロ地域の健康指数スコアを比較し、パターンを分析し、介入が必要な地域を特定します。
> * **小売分析:** 利益ごとに価格変動と販売量を追跡し、価格変動に対する消費者の反応を理解し、価格設定が利益に影響しなかった箇所を特定します。

#### **ユーザー要件 (User requirements)**
散布図やその他のチャートを作成する機能には、以下が必要です。
* `Edit Workbook`および/または`Explore Workbook`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
> 🚧
> ワークブックへの`Can explore`アクセス権が付与されている場合、`Explore`モードでチャートのプロパティと書式設定を作成および変更できますが、変更を公開することはできません。

#### **ワークブックの前提条件 (Workbook prerequisite)**
散布図を構築する前に、[新しいチャート要素を追加し、データソースを選択する](https://help.sigmacomputing.com/docs/create-a-data-element)必要があります。
すべてのチャートの核には、チャートによって視覚化される情報を提供する、基盤となるデータテーブル（データソースから派生）があります。散布図を構築する際、Sigmaは様々なチャートプロパティのソース列を作成するために、基盤となるデータを自動的にグループ化、集計、計算します。チャートを構成中に[基盤となるデータテーブルを表示](https://help.sigmacomputing.com/docs/view-underlying-data)して、データがどのように適用されるかを確認できます。
> 🚩
> 散布図は最大25,000データポイントをサポートします。構成がこの制限を超えるデータセットになる場合、チャートは最初の25,000データポイントを表示し、チャートが不completeであることを示す警告メッセージが表示されます。データポイントの数を減らすには、値を集計するか、チャートまたはソース要素にデータフィルターを適用してください。

#### **基本的な散布図の要件 (Basic scatter plot requirements)**
散布図を表示するには、`Element properties`タブで以下のプロパティを構成します。
* **Chart** - ワークブックに表示されるチャートタイプ
* **X-axis** - x軸（水平軸）の変数を定義するソース列
* **Y-axis** - y-axis（垂直軸）の変数を定義するソース列

散布図では、データポイントはx軸とy軸上の異なる変数の交点を表します（収益とCOGS、気温と降水量、ページビューとクリック数など）。

##### **チャートタイプを選択する (Select the chart type)**
ワークブックに[新しいチャートを追加](https://help.sigmacomputing.com/docs/create-a-data-element)した後、ビジュアライゼーションタイプを選択します。
  `Chart`プロパティで、ドロップダウンフィールドをクリックし、リストから`Scatter`を選択します。
    > 📘
    > このドロップダウンフィールドを使用して、既存のチャートを別のタイプに変換することもできます。

##### **X軸の変数を定義する (Define the x-axis variable)**
X軸の変数を定義するためにソース列を構成します。
1.  ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
2.  以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。
    * **Truncate date (日付の切り捨て)** - 選択した間隔または測定単位で日付値をグループ化します。
    * **Transform (変換)** - 列を選択した[データ値タイプ](https://help.sigmacomputing.com/docs/supported-data-types-and-formats)に変換します。
    * **Format (書式)** - 軸とデータラベルを選択した書式で表示します。
> 📘
> 列メニュー項目の利用可能性と対応するオプションは、列のデータ値タイプによって異なります（例えば、`Truncate date`は日付値でのみ利用可能です）。

##### **Y軸の変数を定義する (Define the y-axis variable)**
Y軸の変数を定義するためにソース列を構成します。Sigmaは、同じx-axis値と相関するy-axis値を集計します。

1.  `Y-axis`プロパティで、`Add calculation`をクリックし、メニューからオプションを選択します。
    * 既存の列の値を集計するには、`Aggregate column`リストを検索またはスクロールし、希望の列名を選択します。
    * カスタム数式に基づいて値を計算するには、`New column`を選択し、ツールバーに数式を入力します。
    * 各カテゴリに関連付けられた行数をカウントするには、`Row count`を選択します。
    > 💡
    > `Columns`リストから列名を`Y-axis`プロパティにドラッグ＆ドロップして、既存の列を選択することもできます。
2.  [任意] ソース列データがチャートでどのように計算され、表示されるかを制御します。
    * ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
    * 以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。
        * **Set aggregate (集計の設定)** - 選択した集計方法に基づいて値を計算します。
        * **Transform (変換)** - 列を選択したデータ値タイプに変換します。
        * **Format (書式)** - 軸とデータラベルを選択した書式で表示します。
    > 📘
    > 値を集計せずにソース列データをプロットするには、`Y-axis`プロパティの`Aggregate values`チェックボックスをオフにします。これが25,000データポイントの制限を超える不完全なチャートになる場合、値を再集計するか、データフィルターを適用してデータポイントの数を減らしてください。
    > 💡
    > ツールバーを使用して集計方法（数式を使用）とデータラベルの書式を変更することもできます。
3.  [任意] 前のステップを繰り返して、複数のy軸ソース列を追加します。Sigmaはそれぞれをチャート上の別々のポイントシリーズとしてプロットします。
4.  [任意] Sigmaは視覚化されたデータを反映するためにソース列名とチャートタイトルを自動生成しますが、必要に応じてこれらのフィールドをカスタマイズできます。
    * ソース列の名前を変更するには、`X-axis`または`Y-axis`プロパティで列名をダブルクリックし、新しい名前を入力します。変更はデフォルトのチャートタイトルに反映されます。
    * チャートタイトルを編集するには、チャート内のタイトルをダブルクリックし、新しいタイトルを入力します。
    > 📘
    > Sigmaはデフォルトのチャートタイトルのみを自動生成します。タイトルがカスタマイズされると、ソース列とその名前の変更はもはや反映されません。

#### **高度な散布図のプロパティと書式設定 (Advanced scatter plot properties and formatting)**
Sigmaは、バブルチャートや四分位チャートなど、高度な散布図とそのバリエーションを構築するための柔軟性を提供する、様々なプロパティと書式設定オプションを備えています。

以下のセクションでは、散布図を強化し、意味のある実用的な情報で特定のインサイトを提供するのに役立つ構成を紹介します。

##### **マークの色を構成する (Configure mark colors)**
`Element properties` > `Marks` > `Color`タブでポイントマークの色を構成して、データを区別したり、色のカテゴリを追加したり、カラースケールを作成したりします。

| マークの色 | |
| :--- | :--- |
| **Single color** | 各データシリーズについて、16進コードを入力するか、カラーパレットまたはカラーピッカーからオプションを選択します。<br>書式設定ルールの追加に関する情報は、「[条件付き書式を追加する](#add-conditional-formatting)」を参照してください。 |
| **By category**| 色のカテゴリを定義するソース列を選択し、結果の複数シリーズのカラーパレットを選択またはカスタマイズします。|
| **By scale** | カラースケールを定義するソース列を選択し、マークに適用する色の範囲を選択します。|

> 📘
> Y軸に複数の変数があると、各データシリーズが異なる変数の測定値を表す、複数シリーズの散布図になります。`By category`の色設定も複数シリーズの散布図を生成できますが、結果のシリーズは、同じ変数を測定するサブカテゴリを表します。
> 💡
> 軸の変数と同様に、色のカテゴリとカラースケールのソース列データがチャートでどのように計算され、表示されるかを制御できます。

##### **条件付き書式を追加する (Add conditional formatting)**
`Element properties` > `Marks` > `Color`タブで`Single color`を選択すると、値ベースの条件に応じてポイントマークの色を決定する書式設定ルール（+ Add rule）を構成できます。これにより、単一色の選択に例外が作成され、指定された条件を満たす値をハイライトできます。

> 💡
> 複数のルールの条件が満たされた場合、Sigmaは書式設定ルールを上から下への優先順位で適用します。必要に応じて、ルールブロックをドラッグ＆ドロップして並べ替えます。

##### **マークのサイズを構成する (Configure mark size)**
`Element properties` > `Marks` > `Size`タブでポイントマークのサイズを構成して、サイズの変数を追加し、バブルチャートを作成します。
サイズの変数を定義するソース列を選択します。Sigmaは、同じx軸の値と相関する値を集計し、自動生成されたサイズ範囲に基づいてポイントを比例させます。相対的なサイズを変更するには、以下の「[ポイントスタイルをカスタマイズする](#customize-point-style)」を参照してください。
> 📘
> 軸の変数と同様に、サイズ変数のソース列データがチャートでどのように計算され、表示されるかを制御できます。

##### **ポイントスタイルをカスタマイズする (Customize point style)**
`Element format` > `Point style`セクションでポイントスタイルをカスタマイズします。散布図に複数のy軸変数が含まれている場合、異なるデータシリーズを個別または一括で変更できます。
デフォルトでは、散布図のポイントは円形です。ポイントの形状を変更して、複数のデータシリーズを区別できます。

| ポイント形状 | |
| :--- | :--- |
| **Circle** | (画像) |
| **Square** | (画像) |
| **Cross** | (画像) |
| **Diamond** | (画像) |
| **Triangle** | (画像) |

チャートにサイズ変数が含まれていない場合、読みやすさを最適化するためにポイントサイズをピクセル（2-15px）でカスタマイズできます。それ以外の場合は、相対的なサイズを適用して、範囲内の最小ポイントサイズを変更できます。

| ポイントサイズ | |
| :--- | :--- |
| **Small** | (画像) |
| **Medium** | (画像) |
| **Large** | (画像) |

##### **参照マークを追加する (Add reference marks)**
`Element format` > `Reference marks`セクションで参照マークを追加して、目標、ベースライン、またはその他のベンチマークを区切ります。散布図では、参照マークを使用して四分位チャートを作成することもできます。

| 四分位チャート | |
| :--- | :--- |
| **Reference line** | チャートを4つのセグメントに分割するために、垂直および水平の線を作成します。|
| **Reference band** | セグメントを色で区別するために、垂直および水平のバンドを作成します。|

##### **すべての散布図の書式設定オプション (All scatter plot format options)**
* Background
* Title
* X-axis
* Y-axis
* Legend
* Trellis
* Data labels
* Reference marks
* Trend lines
* Point style

### 6-2-5. サンキーダイアグラムの作成 (Build a Sankey diagram)

サンキーダイアグラムは通常、プロセスやシステム内の段階間でのデータの流れと変化を評価するために使用されます。単純なサンキーダイアグラムを作成して、データ分布、ワークフロー、ネットワークなどを実証したり、高度な多段階ダイアグラムを構築して、複雑なデータ関係を分析し、段階、カテゴリ、または期間にわたる変数の変化を特定したりします。

このドキュメントでは、基本的なサンキーダイアグラムの要件を詳述し、ワークブックのチャートを強化するのに役立つ主要なプロパティと書式設定オプションを紹介します。

> 📘
> **使用例：**
> * **エネルギー分析:** 電力負荷と消費量を測定し、施設のパフォーマンスを理解し、エネルギーの起源と変換に関するインサイトを得ます。
> * **財務分析:** 部門、部署、および経費カテゴリごとの年間支出を追跡し、資金の流れを理解し、予算と支出の分布を分析します。
> * **マーケティング分析:** 親ドメインとその後のページ訪問によるウェブサイト訪問者の活動を追跡し、ユーザーのナビゲーションを理解し、ウェブサイトアーキテクチャの欠陥を評価します。

#### **ユーザー要件 (User requirements)**
サンキーダイアグラムやその他のチャートを作成する機能には、以下が必要です。
* `Edit Workbook`および/または`Explore Workbook`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
> 🚧
> ワークブックへの`Can explore`アクセス権が付与されている場合、`Explore`モードでチャートのプロパティと書式設定を作成および変更できますが、変更を公開することはできません。

#### **ワークブックの前提条件 (Workbook prerequisite)**
サンキーダイアグラムを構築する前に、[新しいチャート要素を追加し、データソースを選択する](https://help.sigmacomputing.com/docs/create-a-data-element)必要があります。
すべてのチャートの核には、チャートによって視覚化される情報を提供する、基盤となるデータテーブル（データソースから派生）があります。サンキーダイアグラムを構築する際、Sigmaは様々なチャートプロパティのソース列を作成するために、基盤となるデータを自動的にグループ化、集計、計算します。チャートを構成中に[基盤となるデータテーブルを表示](https://help.sigmacomputing.com/docs/view-underlying-data)して、データがどのように適用されるかを確認できます。
> 📘
> サンキーダイアグラムは最大25,000データポイントをサポートします。構成がこの制限を超えるデータセットになる場合、チャートは最初の25,000データポイントを表示し、チャートが不完全であることを示す警告メッセージが表示されます。

#### **基本的なサンキーダイアグラムの要件 (Basic Sankey diagram requirements)**
サンキーダイアグラムを作成するには、`Element properties`パネルで以下のプロパティを構成します。
* **Chart** - ワークブックに表示されるチャートタイプ
* **Stages** - 段階とカテゴリを定義するソース列
* **Value** - データパス変数を定義するソース列

サンキーダイアグラムでは、段階は個々の長方形のノードとして表示されるカテゴリで構成され、データフローの開始点と終了点を表します。データパスは、カテゴリ間のデータの流れの方向と量（エネルギー消費量、経費、ページ訪問者など）を図示し、パスの幅はデータパス変数の値に比例します。

##### **チャートタイプを選択する (Select the chart type)**
ワークブックに[新しいチャートを追加](https://help.sigmacomputing.com/docs/create-a-data-element)した後、チャートタイプを選択します。
    `Chart`プロパティで、ドロップダウンフィールドをクリックし、リストから`Sankey`を選択します。
    > 📘
    > このドロップダウンフィールドを使用して、既存のチャートを別のタイプに変換することもできます。Sigmaは、初期タイプと新しいタイプで共有されるすべてのプロパティと書式設定構成を保持します。共有されていないプロパティと書式設定は、チャートをさらに変換しても保存または復元されません。

##### **段階とカテゴリを定義する (Define the stages and categories)**
段階とカテゴリを定義するためにソース列を構成します。
1.  `Stage`プロパティで、`Add column`をクリックし、メニューからオプションを選択します。
    * 既存の列の個別値に基づいて段階カテゴリを生成するには、`Select column`リストを検索またはスクロールし、希望の列名を選択します。
    * カスタム数式に基づいて段階カテゴリを生成するには、`New column`を選択し、ツールバーに数式を入力します。
    > 📘
    > `Columns`リストから列名を`Stage`プロパティにドラッグ＆ドロップして、既存の列を選択または置換することもできます。
2.  [任意] ソース列データがチャートでどのように分類され、表示されるかを制御します。
    * ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
    * 以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。
        * **Truncate date (日付の切り捨て)** - 選択した間隔または測定単位で日付値を分類します。
        * **Transform (変換)** - 列を選択したデータ値タイプに変換します。
        * **Format (書式)** - データラベルを選択した書式で表示します。
    > 📘
    > 列メニュー項目の利用可能性と対応するオプションは、列のデータ値タイプによって異なります（例えば、`Truncate date`は日付値でのみ利用可能です）。
3.  前のステップを繰り返して、追加の段階を構成します（最低2つの段階が必要です）。
    > 📘
    > Sigmaは段階を（開始点と終了点として）上から下への優先順位でチャート化します。`Stage`プロパティでソース列名をドラッグ＆ドロップして、必要に応じて並べ替えます。

##### **変数を定義する (Define the variable)**
データパス変数を定義するためにソース列を構成します。Sigmaは、データフローの開始点を測定するために、初期段階のカテゴリに関連付けられた列値を自動的に集計します。これらの各カテゴリ内で、Sigmaは後続の段階カテゴリに関連付けられた値を集計し、これらの測定値を終点へのデータパスとしてプロットします。
1.  `Value`プロパティで、`Add calculation`をクリックし、メニューからオプションを選択します。
    * 既存の列の値を集計するには、`Aggregate column`リストを検索またはスクロールし、希望の列名を選択します。
    * カスタム数式に基づいて値を計算するには、`New column`を選択し、ツールバーに数式を入力します。
    * 各段階名に関連付けられた行数をカウントするには、`Row count`を選択します。
    > 📘
    > `Columns`リストから列名を`Value`プロパティにドラッグ＆ドロップして、既存の列を選択することもできます。
2.  [任意] ソース列データがチャートでどのように計算され、表示されるかを制御します。
    * 列メニューを開くには、ソース列名の右にあるキャレット()をクリックします。
    * 以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。
        * **Set aggregate (集計の設定)** - 選択した集計方法に基づいて値を計算します。
        * **Transform (変換)** - 列を選択したデータ値タイプに変換します。
        * **Format (書式)** - データラベルを選択した書式で表示します。
    > 📘
    > ツールバーを使用して集計方法（数式を使用）とデータラベルの書式を変更することもできます。構成が25,000データポイントの制限を超える不完全なチャートになる場合、データフィルターを適用してデータポイントの数を減らしてください。
3.  [任意] Sigmaは視覚化されたデータを反映するためにソース列名とチャートタイトルを自動生成しますが、必要に応じてこれらのフィールドをカスタマイズできます。
    * ソース列の名前を変更するには、`Stage`または`Value`プロパティで列名をダブルクリックし、新しい名前を入力します。変更はデフォルトのチャートタイトルに反映されます。
    * チャートタイトルを編集するには、チャート内のタイトルをダブルクリックし、新しいタイトルを入力します。
    > 📘
    > Sigmaはデフォルトのチャートタイトルのみを自動生成します。タイトルがカスタマイズされると、ソース列とその名前の変更はもはや反映されません。タイトルのカスタマイズに関する情報は、「[要素のタイトルをカスタマイズする](https://help.sigmacomputing.com/docs/customize-element-title)」を参照してください。
4.  [任意] `Element properties` > `Marks` > `Color`セクションで、カテゴリノードとパスに適用するカラーパレットを選択またはカスタマイズします。

##### **すべてのサンキーダイアグラムの書式設定オプション (All Sankey diagram format options)**
* Background
* Title
* Data labels

### 6-2-6. ファネルチャートの作成 (Build a funnel chart)

ファネルチャートは通常、線形プロセスにおける連続した段階での値を測定するために使用されます。ファネルチャートを作成して、各段階での入力を評価し、ワークフロー内の潜在的な問題やボトルネックを発見します。

このドキュメントでは、基本的なファネルチャートの要件を詳述し、ワークブックのビジュアライゼーションを強化するのに役立つ主要なプロパティと書式設定オプションを紹介します。

> 📘
> **使用例：**
> * **プロダクトマーケティング分析:** メールキャンペーンのパイプラインを監視し、ほとんどの見込み客がどこで失われているかを理解し、より大きなコンバージョンの機会を評価します。
> * **営業分析:** 販売サイクルの各段階での見込み客数を追跡し、ほとんどの見込み客が現在どの段階にいるかを特定し、特定の販売活動への投資を評価します。
> * **人事分析:** 採用プロセスの段階を人口統計（年齢、性別、提出された応募など）で分析し、特定の候補者グループのパイプライン離脱率を測定し、離脱が期待を超えているかどうか、プロセスの改善が必要かどうかを判断します。

#### **ユーザー要件 (User requirements)**
ファネルチャートやその他のチャートを作成する機能には、以下が必要です。
* `Edit Workbook`および/または`Explore Workbook`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
> 🚧
> ワークブックへの`Can explore`アクセス権が付与されている場合、`Explore`モードでチャートのプロパティと書式設定を作成および変更できますが、変更を公開することはできません。

#### **ワークブックの前提条件 (Workbook prerequisite)**
ファネルチャートを構築する前に、[新しいチャート要素を追加し、データソースを選択する](https://help.sigmacomputing.com/docs/create-a-data-element)必要があります。
すべてのチャートの核には、チャートによって視覚化される情報を提供する、基盤となるデータテーブル（データソースから派生）があります。ファネルチャートを構築する際、Sigmaは様々なチャートプロパティのソース列を作成するために、基盤となるデータを自動的にグループ化、集計、計算します。チャートを構成中に[基盤となるデータテーブルを表示](https://help.sigmacomputing.com/docs/view-underlying-data)して、データがどのように適用されるかを確認できます。

#### **基本的なファネルチャートの要件 (Basic funnel chart requirements)**
ファネルチャートを表示するには、`Element properties`パネルで以下のプロパティを構成します。
* **Chart** - ワークブックに表示されるチャートタイプ
* **Stage** - 段階を定義するソース列
* **Value** - 変数を定義するソース列

ファネルチャートでは、段階は名目カテゴリ（キャンペーンパイプライン、販売パイプライン、採用段階など）を参照し、水平の棒として表示されます。変数は各段階の値（リード数、見込み客数、候補者数など）を測定し、各棒の幅を決定します。
チャートの最上部に表示される最初の段階は、通常、プロセスの初期入力を表し、最大の段階値（および最も広い棒）に対応します。データがプロセスを流れるにつれて値の減少が発生するため、各段階は前の段階の値のサブセットを測定します。その結果、チャートは徐々に狭まり、ファネル（漏斗）の形を作り出します。

##### **チャートタイプを選択する (Select the chart type)**
ワークブックに[新しいチャートを追加](https://help.sigmacomputing.com/docs/create-a-data-element)した後、チャートタイプを選択します。
1.  `Chart`プロパティで、ドロップダウンフィールドをクリックし、リストから`Funnel`を選択します。
    > 📘
    > このドロップダウンフィールドを使用して、既存のチャートを別のタイプに変換することもできます。

##### **段階を定義する (Define the stages)**
段階を定義するためにソース列を選択します。
> 📘
> データソースに段階名を値として含む単一の列がある場合は、以下の手順に従い、この列を`Stage`プロパティに追加します。あるいは、データソースが各段階を個別のデータ列として分解している場合は、このステップをスキップし、`Value`プロパティで個々の段階列を集計します（「変数を定義する」を参照）。

1.  `Stage`プロパティで、`Add column`をクリックし、メニューからオプションを選択します。
    * 既存の列の個別値に基づいて段階名を生成するには、`Select column`リストを検索またはスクロールし、希望の列名を選択します。
    * カスタム数式に基づいて段階名を生成するには、`New column`を選択し、ツールバーに数式を入力します。

##### **変数を定義する (Define the variable)**
変数を定義するためにソース列を構成します。Sigmaは、同じ段階に関連付けられた列値を自動的に集計します。

1.  `Value`プロパティで、`Add calculation`をクリックし、メニューからオプションを選択します。
    * 既存の列の値を集計するには、`Aggregate column`リストを検索またはスクロールし、希望の列名を選択します。
    * カスタム数式に基づいて値を計算するには、`New column`を選択し、ツールバーに数式を入力します。
    * 各段階に関連付けられた行数をカウントするには、`Row count`を選択します。
    > 📘
    > `Columns`リストから列名を`Value`プロパティにドラッグ＆ドロップして、既存の列を選択することもできます。
2.  [任意] ソース列データがチャートでどのように計算され、表示されるかを制御します。
    * ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
    * 以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。
        * **Set aggregate (集計の設定)** - 選択した集計方法に基づいて値を計算します。
        * **Transform (変換)** - 列を選択したデータ値タイプに変換します。
        * **Format (書式)** - データラベルを選択した書式で表示します。
    > 📘
    > 値を集計せずにソース列データをプロットするには、`Value`プロパティの`Aggregate values`チェックボックスをオフにします。これが25,000データポイントの制限を超える不完全なチャートになる場合、値を再集計するか、データフィルターを適用してデータポイントの数を減らしてください。
    > 📘
    > ツールバーを使用して集計方法（数式を使用）とデータラベルの書式を変更することもできます。
3.  [任意] 前のステップを繰り返して、複数の段階値のソース列を構成します。Sigmaは列をチャート上の積み上げシリーズとしてプロットします。
4.  [任意] Sigmaは視覚化されたデータを反映するためにソース列名とチャートタイトルを自動生成しますが、必要に応じてこれらのフィールドをカスタマイズできます。
    * ソース列の名前を変更するには、`Stage`または`Value`プロパティで列名をダブルクリックし、新しい名前を入力します。変更はデフォルトのチャートタイトルに反映されます。
    * チャートタイトルを編集するには、チャート内のタイトルをダブルクリックし、新しいタイトルを入力します。
    > 📘
    > Sigmaはデフォルトのチャートタイトルのみを自動生成します。タイトルがカスタマイズされると、ソース列とその名前の変更はもはや反映されません。

#### **高度なファネルチャートのプロパティと書式設定 (Advanced funnel chart properties and formatting)**
Sigmaは、詳細なファネルチャートを構築するための柔軟性を提供する、様々なプロパティと書式設定オプションを備えています。

以下のセクションでは、チャートを強化し、意味のある実用的な情報で特定のインサイトを提供するのに役立つ構成を紹介します。

##### **マークの色を構成する (Configure mark colors)**
`Element properties` > `Marks` > `Color`タブでチャートマークの色を構成して、データを区別します。

| | |
| :--- | :--- |
| **By category** | `Value`プロパティに一つのソース列のみが構成されている場合、チャートは段階を表すカテゴリカルカラーにデフォルト設定されます。<br> `Value`プロパティに複数のソース列が構成されている場合、チャートはそれらの各列を表すカテゴリカルカラーを持つ積み上げシリーズにデフォルト設定されます。<br>デフォルトのカテゴリカルカラー変数を変更するには、ソース列を選択し、次にカラーパレットを選択またはカスタマイズします。|
| **By scale** | スケールカラー変数を定義するソース列を選択し、マークに適用する色の範囲を選択します。|

##### **データラベルをカスタマイズする (Customize data labels)**
`Element format` > `Data labels`セクションで、コンバージョン率、段階の値、および段階名を表すデータラベルをカスタマイズします。

異なるタイプのデータラベルを表示または非表示にすることに加えて、それぞれのフォントサイズと色をカスタマイズできます。
また、チャートマークに対する各データラベルタイプの位置を選択できます。
* Left
* Inline
* Right

> 📘
> ファネルチャートの`Color`プロパティは、特定のデータラベルと位置の利用可能性を決定することがあります。例えば、段階名は、チャートが段階を表すカテゴリカルカラーを特徴とする場合にのみインラインで表示できます（「[マークの色を構成する](#configure-mark-colors)」の`By category`の詳細を参照）。

コンバージョン率を表示する場合、`Percentage style`オプションを選択して、コンバージョン率がどのように計算されるかを決定できます。

| パーセンテージスタイル | |
| :--- | :--- |
| **% of total** | 各段階の値を最初の段階の値（ファネルの最上部の合計値）に対して計算します。<br>現在の段階 / 最初の段階 = コンバージョン率 |
| **% of prior** | 各段階の値を直前の段階の値に対して計算します。<br>現在の段階 / 直前の段階 = コンバージョン率 |

##### **すべてのファネルチャートの書式設定オプション (All funnel chart format options)**
* Background
* Title
* Legend
* Data labels

### 6-2-7. ゲージチャートの作成 (Build a gauge chart)

ゲージチャートは通常、放射状のスケールに対して測定可能な値を表示するために使用されます。ゲージチャートを作成して、成長を評価したり、パフォーマンスを査定したり、目標に対する進捗を追跡したりします。

このドキュメントでは、基本的なゲージチャートの要件を詳述し、ワークブックのチャートを強化するのに役立つ主要なプロパティと書式設定オプションを紹介します。

> 📘
> **使用例：**
> * **IT分析:** プロジェクトの進捗を追跡するために、実装完了率（パーセンテージとして）を測定します。
> * **製造分析:** 設備のパフォーマンスを監視するために、機械の稼働時間（パーセンテージとして）を追跡します。
> * **顧客体験（CX）分析:** 顧客エンゲージメントとロイヤルティに関するインサイトを得るために、個々の店舗またはカスタマーサービスチームのネットプロモータースコア（NPS）を測定します。

#### **ユーザー要件 (User requirements)**
ゲージチャートやその他のチャートを作成する機能には、以下が必要です。
* `Edit Workbook`および/または`Explore Workbook`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
> 🚧
> ワークブックへの`Can explore`アクセス権が付与されている場合、`Explore`モードでチャートのプロパティと書式設定を作成および変更できますが、変更を公開することはできません。

#### **ワークブックの前提条件 (Workbook prerequisite)**
ゲージチャートを構築する前に、[新しいチャート要素を追加し、データソースを選択する](https://help.sigmacomputing.com/docs/create-a-data-element)必要があります。
すべてのチャートの核には、チャートによって視覚化される情報を提供する、基盤となるデータテーブルがあります。ゲージチャートを構築する際、Sigmaはチャートプロパティの値を計算するために基盤となるデータを自動的に集計します。チャートを構成中に[基盤となるデータテーブルを表示](https://help.sigmacomputing.com/docs/view-underlying-data)して、非集計データを確認できます。

#### **基本的なゲージチャートの要件 (Basic gauge chart requirements)**
ゲージチャートを表示するには、`Element properties`パネルで以下のプロパティを構成します。
* **Chart:** ワークブックに表示されるチャートタイプ
* **Value:** 測定可能な値を定義するソース列
* **Minimum:** ゲージの最小値を定義するソース列
* **Maximum:** ゲージの最大値を定義するソース列

ゲージチャートでは、単一の値が放射状のスケールで測定されます。最小値と最大値がゲージの範囲を決定し、測定可能な値を評価するための参照点を提供します。

##### **チャートタイプを選択する (Select the chart type)**
ワークブックに[新しいチャートを追加](https://help.sigmacomputing.com/docs/create-a-data-element)した後、チャートタイプを選択します。
1.  `Chart`プロパティで、ドロップダウンフィールドをクリックし、リストから`Gauge`を選択します。
    > 📘
    > このドロップダウンフィールドを使用して、既存のチャートを別のタイプに変換することもできます。

##### **測定可能な値を定義する (Define the measurable value)**
測定可能な値を定義するためにソース列を構成します。
1.  `Value`プロパティで、`Add calculation`をクリックし、メニューからオプションを選択します。
    * 既存の列の値を集計するには、`Aggregate column`リストから列名を選択します。
    * カスタム数式または定数値を適用するには、`New column`を選択し、ツールバーに数式または値を入力します。
    * データソースの行数をカウントするには、`Row count`を選択します。
2.  [任意] データがチャートでどのように計算され、表示されるかを制御します。列メニューから`Set aggregate`、`Transform`、`Format`などを選択します。

##### **ゲージの範囲を定義する (Define the gauge range)**
ゲージの最小値と最大値を定義するためにソース列を構成します。
1.  `Minimum`プロパティで、`Add calculation`をクリックし、値、列、または計算を選択します。
    > 📘
    > `Minimum`プロパティに値を構成しない場合、値はデフォルトでゼロになります。
2.  `Maximum`プロパティで、`Add calculation`をクリックし、値、列、または計算を選択します。
3.  [任意] Sigmaはソース列名とチャートタイトルを自動生成しますが、必要に応じてこれらのフィールドをカスタマイズできます。

#### **高度なゲージチャートのプロパティと書式設定 (Advanced gauge chart properties and formatting)**
Sigmaは、詳細なゲージチャートを構築するための柔軟性を提供する、様々なプロパティと書式設定オプションを備えています。

##### **ターゲット値を構成する (Configure target value)**
`Element properties` > `Target`プロパティでターゲット値を構成して、ゲージ上に目標やベンチマークをマークします。

##### **チャートの色を構成する (Configure chart colors)**
`Element properties` > `Color`プロパティでチャートの色を構成します。

| | |
| :--- | :--- |
| **Single color** | ゲージの塗りつぶし（最小値から測定可能値までの領域）の色を選択します。|
| **By scale** | ゲージに適用するカラースケールを選択します。|

##### **条件付き書式を追加する (Add conditional formatting)**
`Element properties` > `Marks` > `Color`タブで`Single color`を選択すると、値ベースまたはパーセンテージベースの条件に応じてゲージの塗りつぶしまたはゲージスケールの色を決定する書式設定ルール（+ Add rule）を構成できます。

##### **ゲージマークをカスタマイズする (Customize gauge marks)**
`Element format` > `Gauge marks`セクションでゲージマーク（ゲージ、針、ターゲット）をカスタマイズします。

| | |
| :--- | :--- |
| **Gauge color** | ゲージの未充填領域の色。|
| **Show needle** | ゲージの測定可能な値を指す針を表示または非表示にします。|
| **Needle color** | ゲージの針の色。|
| **Show gauge fill** | ゲージの塗りつぶしの色を表示または非表示にします。|
| **Target color** | ターゲットマークの色。|

##### **すべてのゲージチャートの書式設定オプション (All gauge chart format options)**
Background, Title, Data labels, Gauge marks

### 6-2-8. 地理マップの作成 (Build a geography map)

地理マップ（Map - Geographyチャートタイプ）は、[地理データ（WKT形式）またはバリアントデータ（GeoJSON形式）](https://help.sigmacomputing.com/docs/supported-data-types-and-formats#geography)を持つデータセットをサポートし、通常、マップ上に地理空間オブジェクトを図示するために使用されます。空間ネットワーク、相関、関係を表示するための**コネクションマップ**を作成したり、異なる地理的エリア間の変動性やパターンを特定するための**コロプレスマップ**を構築したりします。

> 💡
> **使用例：**
> * **土地利用分析:** ゾーニングコード別に土地区画を表現し、土地利用パターンと近隣地域との競合を特定します。
> * **マーケティング分析:** 特定の地域全体の顧客を定量化し、顧客分布を分析し、市場到達範囲を理解します。
> * **環境分析:** 石油・ガスパイプラインをマッピングし、住宅地や天然資源への近接性を評価します。

#### **ユーザー要件 (User requirements)**
地理マップやその他のチャートを作成する機能には、以下が必要です。
* `Create, edit, and publish workbooks`および/または`Explore workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
* ワークブックへの`Can explore`アクセス権が付与されている場合、`Explore`モードでチャートのプロパティと書式設定を作成および変更できますが、変更を公開することはできません。

#### **データの前提条件 (Data prerequisites)**
地理マップには、以下の[データ型](https://help.sigmacomputing.com/docs/supported-data-types-and-formats)のいずれかが必要です。
* 地理データ (WKT)¹
* バリアントデータ (GeoJSON)

データセットが互換性がない場合、関数（`type`や`geography`関数など）を使用してデータをサポートされている型に変換できる場合があります。あるいは、コロプレスマップを構築する際には、`Map - Region`チャートを使用することもできます。
¹ 地理データ型は、SnowflakeおよびBigQuery接続でのみ利用可能です。

#### **地理マップのバリエーション (Geography map variations)**
* **コネクション（リンク）マップ (Connection (link) map)**
    地理的な場所（都市、ランドマーク、名所など）を接続して、空間ネットワーク、相関、関係を図示します。
* **コロプレスマップ (Choropleth map)**
    地域を定義し、値を比較して、異なる地理的エリア間の変動性とパターンを特定します。
> 🚩
> `Map - Geography`チャートは、ポイント（リンク）マップをサポートしていません。しかし、データセットにポイントを表す地理空間データが含まれている場合は、`Map - Point`チャートを使用してポイントマップを構築できます。
> ポイントが地理データ型で表されている場合は、`Latitude`および`Longitude`関数を使用してWKT形式から座標を抽出します。ポイントがバリアントデータ型で表されている場合は、列メニューの`Extract columns`オプションを選択してGeoJSON形式から座標を抽出します。その後、抽出されたデータを`Map - Point`チャートでプロットできます。

#### **基本的な地理マップの構成 (Basic geography map configurations)**
地理マップには、以下の要素プロパティが必要です。
* **Chart:** データを図示するために使用されるチャートタイプ
* **Geography:** 地理空間オブジェクトを定義するソース列
> 📘
> すべてのチャートの核には、チャートによって視覚化される情報を提供する、基盤となるデータテーブルがあります。地理マップを構築する際、Sigmaは要素のプロパティを基盤となるデータテーブルのソース列にマッピングするために、データを自動的に計算および構造化します。

##### **地理マップを追加する (Add a geography map)**
新しいチャート要素を追加し、それを地理マップとして指定します。
1.  `Explore`または`Edit`モードでワークブックを開き、[新しいチャート要素を追加](https://help.sigmacomputing.com/docs/create-a-data-element)します。
2.  新しい要素の`Chart`プロパティで、ドロップダウンフィールドをクリックし、リストから`Map - Geography`を選択します。

##### **地理空間オブジェクトを定義する (Define the geospatial objects)**
ランドマーク、ルート、地域、またはその他の特徴を表す地理空間オブジェクト（線またはポリゴン）を定義するソース列を構成します。列には、WKT形式の地理データまたはGeoJSON形式のバリアントデータが含まれている必要があります。
1.  `Geography`プロパティで、`Add column`をクリックし、メニューからオプションを選択します。
    * 既存の列からオブジェクトをマッピングするには、`Select geography/variant column`リストを検索またはスクロールし、列名を選択します。
    * カスタム数式を使用して新しい列を作成するには、`Add new column`を選択し、ツールバーに数式または値を入力します。

`Geography`プロパティが構成されると、マップはソース列データによって表される地理空間オブジェクトを図示します。

#### **高度な地理マップのプロパティと書式設定 (Advanced geography map properties and formatting)**

##### **マークの色を構成する (Configure mark colors)**
`Element properties` > `Marks` > `Color`タブで線またはポリゴンのマークの色を構成して、パターンを視覚化したり、バリエーションをハイライトしたり、読みやすさを向上させたりします。

| 色 | |
| :--- | :--- |
| **Single color** | 16進コードを入力するか、カラーパレットまたはカラーピッカーからオプションを選択します。 |
| **By scale** | カラースケールを定義するソース列を選択し、マークに適用する色の範囲を選択します。 |

##### **ツールチップのフィールドをカスタマイズする (Customize tooltip fields)**
`Element properties` > `Marks` > `Tooltip`プロパティでソース列を構成して、マップのツールチップにフィールドを追加します。

##### **マップスタイルを変更する (Change map style)**
`Element format` > `Map` styleセクションでマップのベーススタイルを変更します。
* Base style: `Light`, `Dark`, `Streets`, `Satellite`, `Custom`

##### **すべての地理マップの書式設定オプション (All geography map format options)**
Title, Map style, Legend

### 6-2-9. ウォーターフォールチャートの作成 (Build a waterfall chart)

ウォーターフォールチャートは通常、ある期間における一つまたは二つのデータカテゴリの変化を示すために使用されます。

このドキュメントでは、基本的なウォーターフォールチャートの要件を詳述し、ワークブックのチャートを強化するのに役立つ主要なプロパティと書式設定オプションを紹介します。

> 💡
> **使用例：**
> * **会計分析:** 全体予算へのプラスとマイナスの貢献を測定します。
> * **財務分析:** プロジェクト、部門、または組織全体の収益と支出を追跡します。
> * **小売分析:** 店舗や地域の時間経過に伴うプラスとマイナスの来店客数を追跡します。
> * **人事分析:** 総従業員数の追跡の一環として、従業員の定着率を測定します。

#### **ユーザー要件 (User requirements)**
ウォーターフォールチャートやその他のチャートを作成する機能には、以下が必要です。
* `Edit Workbook`および/または`Explore Workbook`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
> 🚧
> ワークブックへの`Can explore`アクセス権が付与されている場合、`Explore`モードでビジュアライゼーションのプロパティと書式設定を作成および変更できますが、変更を公開することはできません。

#### **基本的なウォーターフォールチャートの要件 (Basic waterfall chart requirements)**
ウォーターフォールチャートをプロットするには、`Element properties`タブで以下のプロパティを構成します。
* **Chart:** ワークブックに表示されるチャートタイプ
* **X-axis:** x軸（水平軸）のカテゴリまたは変数を定義するソース列
* **Y-axis:** y軸（垂直軸）のカテゴリまたは変数を定義するソース列

ウォーターフォールチャートでは、通常、一方の軸が順序カテゴリまたは名目カテゴリ（段階、地域、部門など）を表し、垂直または水平の棒として表示されます。もう一方の軸は、各カテゴリの値（売上、リード、経費など）を測定する変数を表し、対応する棒の高さまたは長さを決定します。各軸に関連付けられるデータのタイプは、いつでも変更できるチャートの向きに依存します。
> 🚩
> すべてのビジュアライゼーションの核には、チャートによって視覚化される情報を提供する、基盤となるデータテーブルがあります。チャートを構築する際、Sigmaは要素のプロパティを基盤となるデータテーブルのソース列にマッピングするために、データを自動的に計算および構造化します。チャートを構成中に基盤となるデータを表示する方法については、「[データ要素を最大化または最小化する](https://help.sigmacomputing.com/docs/maximize-an-element)」を参照してください。

##### **ウォーターフォールチャートを追加する (Add a waterfall chart)**
新しいチャート要素を追加し、それをウォーターフォールチャートとして指定します。
1.  `Explore`または`Edit`モードでワークブックを開き、[新しいチャート要素を追加](https://help.sigmacomputing.com/docs/create-a-data-element)します。
2.  `Chart`プロパティで、ドロップダウンフィールドをクリックし、リストから`Waterfall`を選択します。
    > 📘
    > このドロップダウンフィールドを使用して、既存のチャートを別のタイプに変換することもできます。Sigmaは、初期タイプと新しいタイプで共有されるすべてのプロパティと書式設定構成を保持します。新しいタイプで共有されていないプロパティと書式設定は保持されません。

##### **カテゴリを定義する (Define the categories)**
使用するソース列を構成して、チャートのカテゴリを定義します。ウォーターフォールチャートは時間経過に伴う変化を示すのに最適なので、日付列を選択します。
1.  `X-axis`プロパティで、`Add column`をクリックし、メニューからオプションを選択します。
    * 既存の列の個別値に基づいてカテゴリを生成するには、`Select column`リストを検索またはスクロールし、列名を選択します。
    * カスタム数式に基づいてカテゴリを生成するには、`New column`を選択し、ツールバーに数式を入力します。
2.  [任意] ソース列データがチャートでどのように分類され、表示されるかを調整します。
    * ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
    * `Truncate date`、`Transform`、`Format`などのオプションを選択します。
    > 📘
    > 列メニュー項目の利用可能性と対応するオプションは、列のデータ型によって異なります。例えば、`Truncate date`は日付値でのみ利用可能です。

##### **変数を定義する (Define the variable)**
ソース列を構成して、チャートの変数、つまり時間とともに何が変化したかを定義します。ソース列を追加すると、Sigmaは同じチャートカテゴリに関連付けられた値を自動的に集計します。
1.  `Y-axis`プロパティで、`Add calculation`をクリックし、メニューからオプションを選択します。
    * 既存の列の値を集計するには、`Aggregate column`リストから列名を選択します。
    * カスタム数式に基づいて値を計算するには、`New column`を選択します。
    * 各カテゴリに関連付けられた行数をカウントするには、`Row count`を選択します。
    > 📘
    > このビジュアライゼーションは最大25,000データポイントをサポートします。構成がこの制限を超えるデータセットになる場合、ビジュアライゼーションは最初の25,000データポイントを表示し、チャートが不完全であることを示す警告メッセージが表示されます。
2.  [任意] ソース列データがチャートでどのように計算され、表示されるかを調整します。
    * ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開き、`Set aggregate`、`Transform`、`Format`などのオプションを選択します。
    > 📘
    > 値を集計せずにソース列データをプロットするには、`Y-axis`プロパティの`Aggregate values`チェックボックスをオフにします。
3.  [任意] 前のステップを繰り返して、追加のy軸ソース列を追加し、積み上げウォーターフォールチャートを作成します。
    * デフォルトでは、ウォーターフォールチャートは時間経過に伴う値の合計を表示します。y-axisソース列が1つしかない場合、表示形式を変更して各期間の値の差分を表示できます。「[ウォーターフォールの形状をカスタマイズする](https://help.sigmacomputing.com/docs/build-a-waterfall-chart#customize-waterfall-shape)」を参照してください。

##### **ウォーターフォールチャートをカスタマイズする (Customize your waterfall chart)**
Sigmaは視覚化されたデータを反映するためにソース列名とチャートタイトルを自動生成しますが、必要に応じてこれらのフィールドをカスタマイズできます。
* ソース列の名前を変更するには、`X-axis`または`Y-axis`プロパティで列名をダブルクリックし、新しい名前を入力します。変更はデフォルトのチャートタイトルに反映されます。
* チャートタイトルを編集するには、チャート内のタイトルをダブルクリックし、新しいタイトルを入力します。
> 📘
> Sigmaはデフォルトのチャートタイトルのみを自動生成します。タイトルがカスタマイズされると、ソース列とその名前の変更はもはや反映されません。

#### **高度なウォーターフォールチャートのプロパティと書式設定 (Advanced waterfall chart properties and formatting)**
Sigmaは、積み上げウォーターフォールチャートを含む、高度なウォーターフォールチャートを構築するための柔軟性を提供する、様々なプロパティと書式設定オプションを備えています。

以下のセクションでは、チャートを強化し、意味のある実用的な情報で特定のインサイトを提供するのに役立つ構成を紹介します。

##### **スタッキングを変更する (Change stacking)**
複数のソース列を追加すると、値はデフォルトで積み上げられます。チャートの書式設定を変更して、スタッキングを解除できます。

| スタッキング | |
| :--- | :--- |
| **No stacking** | 複数のデータシリーズを、各シリーズの小計を持つ別々のウォーターフォールチャートとしてプロットします。|
| **Stacked** | 複数のデータシリーズを累積的なウォーターフォールセグメントとしてプロットします。結果の積み上げウォーターフォールチャートで、各カテゴリの合計値へのサブカテゴリの貢献度を比較します。|

##### **マークの色を構成する (Configure mark colors)**
`Element properties` > `Marks` > `Color`タブでウォーターフォールマークの色を構成して、データを区別し、特定の値をハイライトします。

| | |
| :--- | :--- |
| **By series** | ウォーターフォールチャートの増加、減少、合計の値の色を選択します。書式設定ルールの追加に関する情報は、このドキュメントの「[条件付き書式を追加する](#add-conditional-formatting)」を参照してください。|

##### **条件付き書式を追加する (Add conditional formatting)**
`Element properties` > `Marks` > `Color`タブで、ウォーターフォールチャートに使用される増加・減少の色に加えて、値ベースの条件に応じてウォーターフォールマークの色を決定する書式設定ルール（`+ Add rule`）を構成できます。

> 💡
> 複数のルールの条件が満たされた場合、Sigmaは書式設定ルールを上から下への優先順位で適用します。必要に応じて、ルールブロックをドラッグ＆ドロップして並べ替えます。

##### **ツールチップのフィールドと値をカスタマイズする (Customize tooltip fields and values)**
`Element properties` > `Marks` > `Tooltip`タブでチャートマークのツールチップフィールドをカスタマイズして、最も関連性の高いメトリックとデータ属性を表示します。詳細は、「[チャートマークのツールチップフィールドをカスタマイズする](https://help.sigmacomputing.com/docs/customize-chart-mark-tooltip-fields)」を参照してください。
例えば、ツールチップからX軸のチャート値を削除し、`Tooltip`タブにSKU番号の個別カウントを示す新しい集計列を追加することで、デフォルトのツールチップをカスタマイズできます。

##### **ウォーターフォールの形状をカスタマイズする (Customize waterfall shape)**
ウォーターフォールの形状をカスタマイズできます。`Element format`で、`Waterfall shape`を選択し、利用可能なオプションを構成します。

* **表示する計算を設定する (Set the calculation to display)**
    ソース列が1つしかない（積み上げられていない）ウォーターフォールチャートの表示計算のみを選択できます。
    * **Sum**は時間経過に伴う値の合計を表示します。
    * **Difference**は各期間の値の差分を表示します。
* **開始値を構成する (Configure the start value)**
    ウォーターフォールチャートの開始値には、いくつかのオプションから選択できます。
    * **First value in data**は、データ内の最初の値をチャートの開始点として使用します。デフォルト値です。
    * **None**は開始値を表示せず、データ内の最初の値がウォーターフォールの一部として表示されます。
    * **Custom**は、定数値または集計列を開始値として使用します。`Custom`開始値を選択した場合、開始値ラベルをカスタマイズできます。
* **終了値を構成する (Configure the end value)**
    `Show end value`チェックボックスを選択して、終了値を表示します。終了値はデフォルトで表示されます。`End value label`に、ウォーターフォールチャート上の終了値を説明するラベルを入力します。
* **コネクターラインを表示する (Show connector lines)**
    `Show connector line`チェックボックスを選択して、ウォーターフォールチャートの値をつなぐ線を表示します。その後、`Connector line color`を選択できます。

##### **すべてのウォーターフォールチャートの書式設定オプション (All waterfall chart format options)**
* Background
* Title
* X-axis
* Y-axis
* Legend
* Data labels
* Reference marks

### 6-2-10. エリアチャート (Area charts)

ワークブックの`Add element`セクションから、または既存のデータ要素から直接、[チャートを作成](https://help.sigmacomputing.com/docs/create-a-data-element)できます。
視覚化されたデータは、すべての必須プロットフィールドが定義されるまでページキャンバスに表示されません。
`+`メニューを使用するか、列をドラッグ＆ドロップして、開いているフィールドとマークに列を追加します。

#### **必須フィールド (Required Fields)**
* **X-AXIS (X軸)** (1つ以上の列)
* **Y-AXIS (Y軸)** (1つ以上の列)

Y-AXISフィールドに追加された列は、デフォルトで集計されます。集計タイプ（例：Sum vs Count）は、元の列の値のタイプ（例：テキスト、数値、日付など）に依存します。
例えば、'Sales Amount'のような数値列は、新しい計算列 'Sum of Sales Amount' (例: `Sum([Sales Amount])`) を作成します。

#### **マーク (Marks)**
* **COLOR (色)**
* **TOOLTIP (ツールチップ)**
* **TRELLIS (トレリス)**

#### **積み上げエリアチャートのバリエーション (Stacked area chart variations)**
エリアチャートは3つの積み上げバリエーションをサポートしています。
* **No Stacking (積み上げなし) -** エリアはX軸から始まり、重なることがあります。
* **Stacked (積み上げ) -** エリアは互いの上に積み重なります。
* **Stacked 100% (100%積み上げ) -** すべてのエリアが合計でエリアの100%になります。

##### **積み上げエリアチャートを作成する (Create a stacked area chart)**
* **始める前に:** このアクションはエディタパネルを使用します。まだ開いていない場合は、ExploreまたはEditモードからエディタパネルを開いてください。

1.  エディタパネルで、`Color`フィールドに列を追加します。
2.  [任意] チャートのエディタパネルビューの上部から3つのスタックオプションのいずれかを選択します。

#### **フォーマットオプション (Format Options)**
ビジュアライゼーションのフォーマットオプションの編集を開始するには：
* **始める前に:** このアクションはエディタパネルを使用します。まだ開いていない場合は、ExploreまたはEditモードからエディタパネルを開いてください。

1.  サイドナビゲーションで`Element format`を選択します。
2.  フォーマットオプションを選択して、その設定を表示・編集します。

エリアチャートで利用可能なフォーマットオプションは以下の通りです。
* Background
* Title
* X-Axis Scale
* X-Axis Scale （訳注：原文のまま記載）
* Legend
* Reference Marks
* Area Shape

### 6-2-11. コンボチャート (Combo charts)

コンボチャートは、複数のチャートタイプを混合して使用するチャートの一種です。Sigmaのコンボチャートは、棒、線、エリア、および散布図をサポートしています。

#### **要件 (Requirements)**
* `Edit Workbook`および/または`Explore Workbook`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
> 🚧
> ワークブックへの`Can explore`アクセス権が付与されている場合、`Explore`モードでビジュアライゼーションのプロパティと書式設定を作成および変更できますが、変更を公開することはできません。

#### **コンボチャートをプロットする (Plot a combo chart)**
コンボチャートをプロットするには、`Element properties`タブで以下のプロパティを構成します。

| | |
| :--- | :--- |
| **Chart** | ワークブックに表示されるチャートタイプ |
| **X-axis** | X軸（水平軸）のカテゴリまたは変数を定義するソース列 |
| **Y-axis** | Y軸（垂直軸）のカテゴリまたは変数を定義するソース列 |

すべてのプロパティが構成されるまで、チャートは空です。

##### **ワークブックにコンボチャートを追加する (Add a combo chart to a workbook)**
1.  `Explore`または`Edit`モードでワークブックを開き、[新しいチャート要素を追加](https://help.sigmacomputing.com/docs/create-a-data-element)します。
2.  `Chart`プロパティで、ドロップダウンフィールドをクリックし、リストから`Combo`を選択します。

##### **X軸のカテゴリを定義する (Define the x-axis categories)**
X軸のカテゴリを定義するためにソース列を構成します。
1.  `X-axis`プロパティで、`Add column`をクリックし、メニューからオプションを選択します。
    * 既存の列の個別値に基づいてカテゴリを生成するには、`Select column`リストから列名を選択します。
    * カスタム数式に基づいてカテゴリを生成するには、`New column`を選択し、ツールバーに数式を入力します。
2.  [任意] ソース列データがチャートでどのように分類され、表示されるかを制御します。

##### **Y軸の変数を定義する (Define the y-axis variable)**
Y軸の変数を定義するためにソース列を構成します。Sigmaは、同じX軸カテゴリに関連付けられた値を自動的に集計し、集計タイプは列のデータ型に依存します。
デフォルトでは、y軸に配置された最初の列は棒グラフとして表示され、追加のすべての列は線としてプロットされます。
1.  `Y-axis`プロパティで、`Add calculation`をクリックし、メニューからオプションを選択します。
    * 既存の列の値を集計するには、`Aggregate column`リストから列名を選択します。
    * カスタム数式に基づいて値を計算するには、`New column`を選択します。
    * 各カテゴリに関連付けられた行数をカウントするには、`Row count`を選択します。
> 💡
> `Columns`リストから列名を`Y-axis`プロパティにドラッグ＆ドロップして、既存の列を選択することもできます。

[任意] ソース列データがチャートでどのように計算され、表示されるかを制御します。
1.  ソース列名にカーソルを合わせ、キャレット()をクリックして列メニューを開きます。
2.  以下のいずれかの項目にカーソルを合わせ、希望のオプションを選択します。

| | |
| :--- | :--- |
| **Set aggregate (集計の設定)** | 選択した集計方法に基づいて値を計算します。 |
| **Transform (変換)** | 列を選択したデータ値タイプに変換します。 |
| **Format (書式)** | 軸とデータラベルを選択した書式で表示します。 |

> 📘
> 値を集計せずにソース列データをプロットするには、`Y-axis`プロパティの`Aggregate values`チェックボックスをオフにします。これが25,000データポイントの制限を超える不完全なチャートになる場合、値を再集計するか、データフィルターを適用してデータポイントの数を減らしてください。
> 💡
> ツールバーを使用して集計方法（数式を使用）とデータラベルの書式を変更することもできます。

[任意] 前のステップを繰り返して、複数のy軸ソース列を構成します。Sigmaは各追加列をチャート上の別々の線系列としてプロットしますが、列メニューからプロットされた列の形状を変更できます。「[プロットされた列のチャートタイプを変更する](https://help.sigmacomputing.com/docs/combo-charts#change-the-chart-type-for-a-plotted-column)」を参照してください。

[任意] Sigmaは視覚化されたデータを反映するためにソース列名とチャートタイトルを自動生成しますが、必要に応じてこれらのフィールドをカスタマイズできます。
* ソース列の名前を変更するには、`X-axis`または`Y-axis`プロパティで列名をダブルクリックし、新しい名前を入力します。変更はデフォルトのチャートタイトルに反映されます。
* チャートタイトルを編集するには、チャート内のタイトルをダブルクリックし、新しいタイトルを入力します。
> 📘
> Sigmaはデフォルトのチャートタイトルのみを自動生成します。タイトルがカスタマイズされると、ソース列とその名前の変更はもはや反映されません。

#### **コンボチャートのプロパティ (Combo chart properties)**
コンボチャートに対して以下のプロパティを構成できます。
* 色を設定する。
* ツールチップのフィールドと値をカスタマイズする。
* トレリスフォーマットを使用する。

##### **カテゴリ別にチャートの色を構成する (ベータ版) (Configure a chart color by category (Beta))**
> 🚩
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このページは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

コンボチャートに棒が含まれている場合、カテゴリとして使用する列を設定し、カテゴリ別に棒の色を分割できます。
`Element properties` > `Marks` > `Color`タブでコンボチャートの色を構成します。
色を使用してデータを区別したり、特定の列の値をハイライトしたり、カテゴリ別にチャートの棒を分割したりできます。

| | |
| :--- | :--- |
| **Single color** | 各データシリーズについて、16進コードを入力するか、カラーパレットまたはカラーピッカーからオプションを選択します。|
| **By category** | コンボチャートに棒が含まれている場合、棒シリーズの色のカテゴリを定義するソース列を選択し、結果のスタックまたはクラスターのカラーパレットを選択またはカスタマイズします。線や棒を使用しない他のシリーズでは、カテゴリによる色設定はできません。|

> 📘
> Y軸に複数の変数があると、各データシリーズが異なる変数の測定値を表す、積み上げまたはクラスター化された棒シリーズになります。`By category`の色設定も棒のスタックまたはクラスターを生成できますが、結果のシリーズは、構成されたチャートカテゴリ内で同じ変数を測定するサブカテゴリを表します。

##### **プロットされた列のチャートタイプを変更する (Change the chart type for a plotted column)**
コンボチャートにプロットされた列のチャートタイプは、棒、線、エリア、または散布図の4つのオプションのいずれかです。
* **始める前に:** このアクションはエディタパネルを使用します。まだ開いていない場合は、ExploreまたはEditモードからエディタパネルを開いてください。「[Workbook modes](https://help.sigmacomputing.com/docs/workbook-modes-overview)」を参照してください。

チャートタイプを変更するには、以下を実行します。
1.  エディタパネルで、列にカーソルを合わせ、キャレットをクリックします。
2.  列メニューが開きます。
3.  `Shape`サブメニューで、`Bar`, `Line`, `Area`, または `Point`を選択します。

#### **フォーマットオプション (Format options)**
チャートのフォーマットオプションの編集を開始するには：
* **始める前に:** このアクションはエディタパネルを使用します。まだ開いていない場合は、ExploreまたはEditモードからエディタパネルを開いてください。「[Workbook modes](https://help.sigmacomputing.com/docs/workbook-modes-overview)」を参照してください。

1.  サイドナビゲーションで`Element format`を選択します。
2.  フォーマットオプションを選択して、その設定を表示・編集します。

##### **フォーマットカテゴリ (Format categories)**
コンボチャートで利用可能なフォーマットカテゴリは以下の通りです。
* Element style
* Title
* X-axis
* Y-axis
  * チャートの左側または右側に列のセカンダリy軸を追加できます。「[Format chart axis position](https://help.sigmacomputing.com/docs/format-chart-axis-position)」を参照してください。
* Legend
* Gaps
* Reference marks
* Trend lines
* Data labels
* Area/line style
* 
### 6-2-12. 箱ひげ図 (Box and whisker charts)

箱ひげ図は、ある軸に沿った値のセットの分布を表示します。これらは一般的にボックスプロットとしても知られています。

#### **要件 (Requirements)**
データ要素を作成するには、個々のワークブックに対する`Can Edit`[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)と編集モードである必要があります。
多くの探索的アクションは、探索モードでもサポートされています。「[Workbook modes](https://help.sigmacomputing.com/docs/workbook-modes-overview)」を参照してください。

#### **箱ひげ図の構成要素 (Anatomy of a box and whisker chart)**
箱ひげ図は、データを四分位数に分割します。上位四分位数、中央値、下位四分位数が、私たちが箱と呼ぶものを構成します。ひげの最小値からひげの最大値までの全範囲（箱を含む）が、統計的に中央のデータ範囲を占めます。これは四分位範囲（IQR）と呼ばれ、`Q3 - Q1`として計算されます。IQRから外れるデータポイントは外れ値と呼ばれます。

* **Maximum (最大値):** `Q3 + 1.5*IQR` 未満の最高値を持つデータポイント。
* **Upper Quartile (上位四分位数):** データの上位25%に含まれる値。
* **Median (中央値):** データ範囲の中点。
* **Lower Quartile (下位四分位数):** データの下位25%に含まれる値。
* **Minimum (最小値):** `Q1 - 1.5*IQR` を超える最低値を持つデータポイント。
* **Outliers (外れ値):** IQRの上または下に外れる値。外れ値は `> Q3 + 1.5*IQR` および `< Q1 - 1.5*IQR` として計算されます。

#### **箱ひげ図をプロットする (Plot a box and whisker chart)**
ワークブックのエディタパネルの`Add element`セクションから、または既存のデータ要素から直接、[チャートを作成](https://help.sigmacomputing.com/docs/create-a-data-element)できます。
視覚化されたデータは、すべての必須プロットフィールドが定義されるまでページキャンバスに表示されません。
フィールドの`+`メニューを使用するか、列をドラッグ＆ドロップして、開いているフィールドに列を追加します。

##### **フィールド (Fields)**
* **X-AXIS (X軸)** (1列)
    カテゴリカルデータは、まずX軸の列によってグループ化されます。
* **Y-AXIS (Y軸)** (1つ以上の列)
    チャートのY軸に追加された列は、デフォルトで集計されます。
* **SPLIT BY (分割キー)** (1列 - 任意)
    最初のグルーピング（X-AXISで定義）の下に2番目のグルーピングを作成します。

##### **マーク (Marks)**
* **COLOR (色)**
* **TOOLTIP (ツールチップ)** (1つ以上の列)

#### **表示の向き（水平 vs 垂直） (Display orientation (horizontal vs vertical))**
箱ひげ図は、垂直にも水平にも表示できます。
チャートの向きを選択するには、チャートのエディタパネルビューで、垂直表示アイコンまたは水平表示アイコンのいずれかを選択します。

#### **フォーマットオプション (Format options)**
* **始める前に:** このアクションはエディタパネルを使用します。まだ開いていない場合は、ExploreまたはEditモードからエディタパネルを開いてください。
チャートのフォーマットオプションの編集を開始するには：
1.  サイドナビゲーションで`Element format`を選択します。
2.  フォーマットオプションを選択して、その設定を表示・編集します。

箱ひげ図で利用可能なフォーマットカテゴリは以下の通りです。
* BACKGROUND
* TITLE
* X-AXIS
* Y-AXIS
* LEGEND
* BOX SHAPE
* DATA LABELS
* REFERENCE MARKS

#### **ポイント表示オプションをカスタマイズする (Customize point display options)**
* **始める前に:** このアクションはエディタパネルを使用します。まだ開いていない場合は、ExploreまたはEditモードからエディタパネルを開いてください。
1.  サイドナビゲーションで`Element format`を選択します。
2.  `BOX SHAPE`をクリックします。
3.  表示されるオプションから`BOX SHAPE`の書式設定を選択します。
    * `Show points`チェックボックスはデフォルトでオンになっています。すべてのポイントを非表示にするにはチェックを外します。
    * `Show points`が選択されている場合、以下を選択できます。
        * **Outliers only** – 箱の外側にあるポイントのみを表示します。
        * **All points** – 位置に関係なく、すべてのポイントを表示します。

### 6-2-13. 円グラフとドーナツグラフ (Pie and donut charts)

円グラフとドーナツグラフは、データを全体のパーセンテージとして視覚化するのに良い方法です。

#### **要件 (Requirements)**
データ要素を作成するには、個々のワークブックに対する`Can Edit`[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)と編集モードである必要があります。
多くの探索的アクションは、探索モードでもサポートされています。「[Workbook modes](https://help.sigmacomputing.com/docs/workbook-modes-overview)」を参照してください。

#### **プロットオプション (Plot options)**
ワークブックのエディタパネルの`PAGE ELEMENTS`セクションから、または既存のデータ要素から直接、円グラフとドーナツグラフを作成できます。

##### **必須フィールド (Required fields)**
* **COLOR (色)** (1列)
* **VALUE (値)** (1つ以上の列)

`VALUE`フィールドに追加された列は、デフォルトで集計されます。集計タイプ（例：Sum vs Count）は、元の列の値のタイプ（例：テキスト、数値、日付など）に依存します。
*例：数値列 [Sales Amount] は、新しい計算列 [Sum of Sales Amount] を作成します。*

##### **マーク (Marks)**
* **TOOLTIP (ツールチップ):** チャート内のポイントにカーソルを合わせたときに表示する列を選択します。
* **TRELLIS (トレリス):** トレリスの行または列として機能する列を選択し、チャートを別々のチャートに分割します。

##### **ドーナツの穴の値 (Donut hole value)**
> 🚩
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このページは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

ドーナツチャートを作成している場合、任意でドーナツの穴にKPIを追加できます。
1.  要素を選択します。
2.  エディタパネルが`Element properties`セクションで開きます。
3.  `Donut hole value`で、`+`を選択して計算を追加します。
4.  新しい列を追加するか、行数をカウントするか、または集計してドーナツの穴に表示する列を選択します。
5.  集計値が、デフォルトのラベルとして列名と共に表示されます。フォーマットオプションを使用して値を書式設定できます。

#### **フォーマットオプション (Format options)**
チャートのフォーマットオプションの編集を開始するには：
* **始める前に:** このアクションはエディタパネルを使用します。まだ開いていない場合は、ExploreまたはEditモードからエディタパネルを開いてください。

1.  エディタパネルで、`Element format`を選択します。
2.  フォーマットオプションを選択して、その設定を表示・編集します。

円グラフとドーナツグラフで利用可能なフォーマットカテゴリは以下の通りです。
* BACKGROUND
* TITLE
* LEGEND
* DATA LABELS
* DONUT HOLE (ドーナツチャートのみ)

### 6-2-14. マップ (Maps)

#### **マップをプロットする (Plot a map)**
ワークブックのエディタパネルの`PAGE ELEMENTS`セクションから、または既存のデータ要素から直接、[マップを作成](https://help.sigmacomputing.com/docs/create-a-data-element)できます。
マップされたデータは、すべての必須プロットフィールドが定義されるまでページキャンバスに表示されません。
フィールドの`+`メニューを使用するか、列をドラッグ＆ドロップして、開いているフィールドに列を追加します。

#### **マップタイプ (Map types)**
ワークブックは、Region、Point、Geographyの3つの異なるマップタイプをサポートしています。
利用可能なデータと表示したい結果に基づいてマップタイプを選択してください。例えば、"Colorado"や"California"のようなセル値を持つ`text`列 [State] をマップしたい場合は、Regionマップタイプを選択します。

##### **マップ - リージョン (Map - Region)**
リージョンマップは、`Region`プロパティに単一の`text`列を必要とします。列の値は、以下の地域タイプのいずれかと一致し、列内で一貫している必要があります。

> 📘
> 地域の値は、大文字と小文字を区別しません。例えば、カリフォルニア州の値は`California`、`california`、`CA`、`Ca`、または`ca`のいずれでもかまいません。しかし、データの整合性のために、列内のすべての値は同じサポートされている識別子と大文字小文字の使用法を用いるべきです。

| 地域タイプ | サポートされている識別子 |
| :--- | :--- |
| **Canadian provinces** | 名前 (例: `Ontario`, `Alberta`)<br>略称 (例: `ON`, `AB`) |
| **Countries** | 名前 (例: `United States`, `Australia`)<br>頭字語 (例: `U.S.A.`, `AUS`)<br>ISO 3166-1 alpha-2コード (例: `US`, `AU`)<br>ISO 3166-1 alpha-3コード (例: `USA`, `AUS`)<br>ISO 3166-1 numeric-3コード (例: `840`, `036`) |
| **US CBSA/MSA** | CBSA/MSAコード (例: `San Francisco-Oakland-Hayward, CA`) |
| **US counties** | 郡名, 州名 (例: `Alameda, California`)<br>FIPSコード (例: `06001`)<br>郡名には "County" や "Parish" を含めてはいけません。|
| **US postal places (cities)** | 市名, 州略称 (例: `Oakland, CA`) |
| **US states** | 名前 (例: `California`, `New York`)<br>略称 (例: `CA`, `NY`) |
| **US zip codes** | 郵便番号 (例: `94601`, `11226`) |

##### **マップ - ポイント (Map - Point)**
ポイントマップは、マップの`LATITUDE`と`LONGITUDE`の両方のフィールドに`number`列を必要とします。

##### **マップ - 地理 (Map - Geography)**
WKTおよびJSON形式は、単純な数値の緯度/経度列よりも複雑な地理データを保存できます。
SigmaのMap - Geographyチャートは、マップの`Geography`フィールドに`geography`または`variant`データ列を必要とします。もしWKTまたはGeoJSONデータがテキスト列(abc)として保存されている場合、`Geography`または`Variant`関数を使用して変換できます。

GeoJSONデータは、プロットされるために "geometry" キー内に "coordinates" がネストされている必要もあります。GeoJSONと私たちの`geography`タイプでは、座標の順序は常に`longitude`, `latitude`です。

* **例**
    例えば、以下のGeoJSONデータが与えられた場合：
    `{ "geometry": {"coordinates": [-94.042964, 33.019219] } }`

    以下は、有効なGeoJSONであっても、"geometry"キーがないため機能しない例です。
    ```json
    {  
        "coordinates": [  
            [30, 10], [10, 30], [40, 40]  
        ]  
    }
    ```
    こちらが機能する例です。
    ```json
    {  
      "geometry": {  
        "coordinates": [  
          [30, 10], [10, 30], [40, 40]  
        ]  
      }  
    }
    ```
    もしあなたのGeoJSONが機能しない例のように構造化されている場合、Sigmaの`CallVariant`パススルー関数を使用して "geometry" キーを先頭に追加できます。
    この例では、Snowflakeの "object_construct" 関数を呼び出してこれを実行します。
    `CallVariant("object_construct", "geometry", Json([Column with GeoJSON text]))`

### 6-3-1. トレリスチャートの作成と書式設定 (Create and format trellis charts)

トレリスチャート（スモールマルチプルまたはパネルチャートとも呼ばれる）を使用すると、単一のチャート内でデータの複数のサブセットを比較・分析できます。サブセットは、特定のデータディメンションに基づいて行と列に配置された、より小さなチャート（またはパネル）によって表されます。データの分割と、結果として得られるグリッド状の構造により、大規模で複雑なデータセット内の貴重なインサイトを発見するのに役立つパターン、トレンド、および関係を特定しやすくなります。

このドキュメントでは、トレリスチャートの概念と構造を紹介し、それらを使用してチャートに明快さと価値を追加する方法を説明します。
以下のチャートタイプがトレリシングをサポートしています。
* 棒グラフ
* 折れ線グラフ
* エリアチャート
* 散布図
* 円グラフ
* ドーナツグラフ
* コンボチャート

#### **ユーザー要件 (User requirements)**
トレリスチャートを作成および書式設定する機能には、以下が必要です。
* この機能を使用するには、個々のワークブックに対する`Can edit`または`Can explore`の[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。
* ワークブックのドラフト、カスタムビュー、または保存済みビューにいる必要があります。

#### **前提条件 (Prerequisites)**
トレリシングと互換性のあるチャートを持っているか、作成する必要があります。

#### **トレリスチャートを理解する (Understanding trellis charts)**
トレリスチャートを使用すると、多次元のデータサブセットを迅速かつ効果的に視覚化し、さまざまな角度から探索できます。データサブセットごとに個別のチャート要素を構築することもできますが、トレリスチャートを迅速に作成することで、データの整合性と使いやすさに貢献するいくつかの利点が得られます。これには以下が含まれます。

* **整理 (Organization):** データサブセットが論理的で整理された構造で表示され、体系的な比較と探索が容易になります。
* **スケーラビリティ (Scalability):** データセットに導入された新しい属性を含むデータの更新が、チャートのディメンションにシームレスに組み込まれます。
* **一貫性 (Consistency):** 共有された基盤となるデータにより、フィルターと集計の一貫した適用が保証され、単一のチャートを使用することで、スケール、フォーマット、スタイリングの均一性が提供されます。

##### **トレリスの行と列 (Trellis rows and columns)**
トレリスチャートでは、行（垂直方向の分割）が1つのディメンションを表し、列（水平方向の分割）が別のディメンションを表します。個々のパネルは、特定の行と列の属性の交点を表し、ディメンションと対応する属性のコンテキストでより消化しやすく、比較しやすいデータサブセットを視覚化します。

##### **非トレリス vs. トレリス (Non-trellis vs. trellis)**
以下のチャートは、トレリシングがデータチャートをどのように強化できるかを示しています。

* **トレリシングなし (No trellising):** この最初のチャートは、2019年から2023年までの会計年度ごとの総収益を比較する基本的なビューを示しています。積み上げ棒は各製品ファミリーの収益を区別し、各年内および年間での探索のための追加のディメンションを提供します。
* **トレリス列 (Trellis columns):** この2番目のチャートは、分析を深めるためにトレリス列を組み込んでいます。会計年度ごとおよび製品ファミリーごとの総収益をまだ分析できますが、追加のディメンションにより、店舗地域に基づいたより小さなデータサブセット内で、またそれらを横断してこれらのデータポイントを比較できます。
* **トレリスの行と列 (Trellis rows and columns):** この最後のチャートは、さらに詳細なデータサブセットのためにトレリスの行と列を組み込んでいます。前のチャートと同様に、会計年度ごとおよび製品ファミリーごとの総収益をまだ分析できますが、2つの追加ディメンションにより、店舗地域と製品タイプの交点に基づいたデータサブセット内で、またそれらを横断してデータポイントを比較できます。
グリッド構造により、共通の店舗地域または製品タイプ（同じ行または列にわたる共有属性）を共有するデータサブセット間の収益を簡単に比較できますが、完全なグリッドにわたってデータポイントを探索することによっても、意味のあるインサイトを得ることができます。

#### **トレリスチャートを作成する (Create a trellis chart)**
1.  ワークブックページでチャートを選択します。
2.  エディタパネルで、`Trellis`を選択します。
3.  必要に応じて`Trellis row`および`Trellis column`セクションに列を追加します。
    * データサブセットの垂直比較を作成するには、`Trellis row`プロパティで`Add column`をクリックします。
    * データサブセットの水平比較を作成するには、`Trellis column`プロパティで`Add column`をクリックします。
4.  以下のいずれかの方法で追加する列を選択します。
    * データソースの既存の列からディメンションを派生させるには、`Select column`リストを検索またはスクロールし、目的の列を選択します。
    * 新しい列に基づいてディメンションを作成するには、`Add new column`を選択し、数式バーに関数または値を入力します。

#### **トレリスのタイトルとラベルをカスタマイズする (Customize trellis titles and labels)**
トレリスのタイトルの表示/非表示、チャートタイトル、フォントサイズ、フォントの色などを必要に応じてカスタマイズできます。

1.  変更したいチャートをワークブックページで選択します。
2.  エディタパネルで`Format`を選択し、`Trellis`をクリックしてセクションを展開します。
3.  トレリスで利用可能なオプションを変更します。
    * トレリスのタイルサイズを変更するには、`Tile size`を変更します。`Auto`または`Compact`を選択できます。
    * 行または列を持つトレリスチャートの場合、行と列の間に境界線を表示するかどうかを選択できます。境界線を表示するには、`Show row border`または`Show column border`のチェックボックスを選択します。
4.  チャートのトレリスの行または列のタイトルとラベルを構成します。
    * タイトルを表示するには、`Show title`トグルをオンにするか、非表示にするにはオフにします。
    * ラベルを表示するには、`Show label`トグルをオンにするか、非表示にするにはオフにします。
    * タイトルまたはラベルのテキストを設定するには、関連するテキストボックスにタイトルまたはラベルを入力します。
    * トレリスのタイトルとラベルのフォントサイズと色を変更するには、書式設定ツールを使用します。

| | |
| :--- | :--- |
| **Font size** | フォントサイズを選択します (10-48px)。|
| **Text color**| 16進数値を入力するか、カラーパレットまたはピッカーからオプションを選択します。|

#### **共有トレリスコンポーネントをカスタマイズする (Customize shared trellis components)**
デフォルトでは、Sigmaは各列の共有x軸ラベル（デカルトチャートのみ）、各行の共有y軸ラベル（デカルトチャートのみ）、およびグリッド全体の共有凡例を表示します。トレリスフォーマットをカスタマイズして、共有コンポーネントを使用するか、各パネルに個別のラベルと凡例を表示することができます。

1.  変更したいチャートを選択します。
2.  エディタパネルで`Format`を選択し、`Trellis`をクリックしてセクションを展開します。
3.  共有コンポーネントを変更するには、`X-axis`、`Y-axis`、および`Color legends`フィールドを構成します。
    * 軸の値または凡例を共有するには、`X-axis`トグル、`Y-axis`トグル、またはその両方をオンにします。
    * 各パネルに軸の値または凡例を表示するには、目的の軸のトグルをオフにします。
    
### 6-3-2. チャートマークのツールチップフィールドをカスタマイズする (Customize chart mark tooltip fields)

チャートマークのツールチップは、ビジュアライゼーション内の個々のデータポイントにカーソルを合わせたときに表示されます。Sigmaはデフォルトのツールチップフィールドを自動選択しますが、ユースケースに最も関連性の高いメトリックとデータ属性を表示するようにカスタマイズできます。

> 📘
> ツールチップはすべてのビジュアライゼーションタイプで利用できますが、ゲージチャートとサンキーダイアグラムではカスタマイズできません。

このドキュメントでは、デフォルトおよびカスタムのツールチップフィールドを管理する方法について説明します。

#### **ユーザー要件 (User requirements)**
チャートマークのツールチップフィールドをカスタマイズする機能には、以下が必要です。
* この機能を使用するには、個々のワークブックに対する`Can edit`または`Can explore`の[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。
* ワークブックをカスタマイズまたは編集中である必要があります。

#### **デフォルトのツールチップフィールドを表示または非表示にする (Show or hide default tooltip fields)**
デフォルトでは、ツールチップはチャートプロパティで構成されたソース列に対応するフィールドを表示します。例えば、軸、値、段階、およびマークの色を定義する列です。必要に応じて、これらのフィールドを表示または非表示にできます。

1.  ワークブックページで、変更したいチャート要素を選択します。
2.  エディタパネルで、`X-axis`または`Y-axis`フィールドの関連する列にカーソルを合わせ、下矢印()をクリックして列メニューを開きます。
3.  `Show in tooltip`を選択して、ツールチップの可視性を変更します。
    * メニュー項目にチェックマーク(✓)が表示されている場合、対応するツールチップフィールドは現在表示されています。クリックするとツールチップフィールドが非表示になります。
    * メニュー項目にチェックマークがない場合、対応するツールチップフィールドは現在非表示です。クリックするとツールチップフィールドが表示されます。
4.  ツールチップへの変更は即座に反映されます。チャート内の個々のデータポイントにカーソルを合わせて変更を確認してください。

> 💡
> 棒グラフでスタッキングを適用する場合、エディタパネルの`Format` > `Tooltip`セクションでツールチップをカスタマイズして、変数の値を累積スタックのパーセンテージとして表示することもできます。「[Build a bar chart](https://help.sigmacomputing.com/docs/build-a-bar-chart)」の「Customize tooltip fields and values」を参照してください。

#### **追加のツールチップフィールドを表示する (Display additional tooltip fields)**
追加のフィールドでチャートのツールチップを強化するには、`Tooltip`プロパティに新しいまたは既存の列を追加します。

1.  ワークブックページで、変更したいチャート要素を選択します。
2.  エディタパネルで、`Tooltip`をクリックします。
3.  `Select column`フィールドで、`+ Add calculation...`をクリックし、新しいツールチップフィールドのソース列を構成します。
    * 既存の列からデータを参照または集計するには、`Select column`または`Aggregate column`リストを検索またはスクロールし、列名を選択します。必要に応じて集計を変更または削除できます。
    * カスタム数式に基づいて新しい列を作成するには、`Add new column`を選択し、ツールバーに数式または値を入力します。
    * 集計された行数に基づいて新しい列を作成するには、`Row count`を選択します。
4.  新しいツールチップフィールドは、チャート内の個々のデータポイントにカーソルを合わせると表示されます。

#### **カスタムツールチップフィールドを削除する (Remove custom tooltip fields)**
ツールチップに追加されたフィールドを削除するには、`Tooltip`プロパティで構成された列を削除します。

1.  ワークブックページで、変更したいチャート要素を選択します。
2.  エディタパネルで、`Tooltip`をクリックします。
3.  `Tooltip`プロパティで、削除したい列にカーソルを合わせ、下矢印()をクリックして列メニューを開きます。
4.  列を削除するには、`Delete column`を選択するか、`Tooltip`プロパティから`Add column`リストにドラッグ＆ドロップして削除します。
5.  ツールチップへの変更は即座に反映されます。チャート内の個々のデータポイントにカーソルを合わせて変更を確認してください。

### 6-3-3. チャートの凡例を書式設定する (Format chart legend)

チャートの凡例は、チャートマークの色、形状、サイズ、タイプ、およびその他の属性を、特定のグループまたは値に関連付けます。これにより、チャートのメトリックがカテゴリ（地域や製品タイプなど）に分散している場合や、メトリックがサイズやカラースケールを定義している場合に、ユーザーがデータを解釈するのに役立ちます。Sigmaのほとんどのチャートタイプは、チャートの使いやすさと読みやすさを向上させるために書式設定できる凡例をサポートしています。複数のチャートを更新する凡例を構成したい場合は、「[凡例コントロールの作成と構成](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control)」を参照してください。

このドキュメントでは、凡例の表示/非表示を変更し、その位置、フォントサイズ、およびテキストの色をカスタマイズする方法について説明します。

#### **ユーザー要件 (User requirements)**
チャートの凡例を書式設定する機能には、以下が必要です。
* `Full explore`および/または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

#### **凡例とヘッダーを表示または非表示にする (Show or hide the legend and header)**
チャートの凡例の表示/非表示を変更し、該当する場合にはヘッダー付きまたはヘッダーなしで表示するかを選択できます。ヘッダーは、グループに分類された変数またはチャートのサイズやカラースケールを定義するメトリックを指定します。

1.  ワークブックページで変更したいチャート要素を選択します。
2.  エディタパネルで`Format`を選択し、`Legend`をクリックしてセクションを展開します。
3.  チャートの凡例（ヘッダーとラベルを含む）の表示/非表示を変更するには、`Show legend`フィールドを構成します。
    * 凡例を表示するには、`Show legend`トグルをオンにします。
    * 凡例を非表示にするには、`Show legend`トグルをオフにします。
4.  凡例ヘッダーの表示/非表示を変更するには（凡例が表示されている場合）、`Show legend header`フィールドを構成します。
    * ヘッダーを表示するには、`Show legend header`トグルをオンにします。
    * ヘッダーを非表示にしてラベルのみを表示するには、`Show legend header`トグルをオフにします。

> 📘
> 散布図で`Size`プロパティを構成すると、チャート要素は色とサイズ用に2つの個別の凡例をサポートします。`Show color legend`および`Show size legend`フィールドを構成することで、個々の凡例の表示/非表示を変更できます。

#### **凡例の位置を変更する (Change the legend position)**
チャートに対する凡例の相対的な位置を変更するには：
1.  ワークブックページで変更したいチャート要素を選択します。
2.  エディタパネルで`Format`を選択し、`Legend`をクリックしてセクションを展開します。
3.  `Position`をクリックし、ドロップダウンからオプションを選択します。利用可能な位置は以下のマトリックスに示されています。

| | |
| :--- | :--- |
| Top | Bottom |
| Left | Right |
| Top left | Top right |
| Bottom left | Bottom right |

#### **ラベルをカスタマイズする (Customize the labels)**
凡例ラベルのフォントサイズと色をカスタマイズできます。凡例ヘッダーは、ラベルの書式設定の影響を受けません。

1.  ワークブックページで変更したいチャート要素を選択します。
2.  エディタパネルで`Format`を選択し、`Legend`をクリックしてセクションを展開します。
3.  ラベルのサイズを変更するには、`Label font size`ドロップダウンをクリックし、オプションを選択します。10から48のフォントサイズ値を選択できます。
4.  ラベルのフォントの色を変更するには、`Label text color`をクリックし、16進数値を入力するか、カラーパレットまたはピッカーからオプションを選択します。

### 6-3-4. チャートのデータラベルを表示する (Display chart data labels)

以下のビジュアライゼーションタイプでデータラベルを表示できます。
* エリアチャート
* 棒グラフ
* 箱ひげ図
* コンボチャート
* ドーナツ＆円グラフ
* ファネルチャート
* ゲージチャート
* 折れ線グラフ
* 散布図
* リージョンマップとポイントマップ

また、[データラベルの外観を書式設定する](https://help.sigmacomputing.com/docs/display-chart-data-labels#format-and-show-data-labels)こともできます。

#### **ユーザー要件 (User requirements)**
* ワークブックに対する`Can edit`または`Can explore`の[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。
* ワークブックのドラフト、カスタムビュー、または保存済みビューにいる必要があります。

#### **データラベルを書式設定して表示する (Format and show data labels)**
チャート上でデータラベルを書式設定して表示できます。棒グラフなど、複数のシリーズを持つことができるチャートの場合、書式設定をチャート内のすべてのシリーズに適用するか、特定のシリーズに適用するかを選択できます。

1.  ワークブックページで目的のチャートを選択します。
2.  エディタパネルで、`Format`を選択します。
3.  `Data labels`をクリックしてセクションを展開します。
4.  チャートにデフォルトのデータラベルを表示するには、以下のいずれかを選択します。
    * チャート上のすべてのシリーズにデータラベルを表示するには、`Show data labels`をオンにします。
    * 複数のデータシリーズを持つコンボまたはデカルト座標（棒、線、エリア、散布図）チャートで、異なるシリーズに対してどのデータラベルを表示するかを構成するには、デフォルトの`Apply to all series`を選択したままにするか、データラベルを表示したいデータシリーズを選択し、次に`Show data labels`をオンにしてそのシリーズのラベルを表示します。
5.  `Show data labels`をオンにしない場合、選択した書式設定オプションは[カスタムデータラベル](https://help.sigmacomputing.com/docs/display-chart-data-labels#add-custom-data-labels-to-a-chart-or-map)にのみ適用されます。
6.  利用可能なオプションを使用して、データラベルをカスタマイズします。
    * 例えば、ラベルのスタイルをカスタマイズして、最小・最大ラベルや端点ラベルを表示したり、フォントの色やサイズをカスタマイズしたりします。一部のチャートでは、ラベルの向きや位置、ラベルテキストの周りにアウトライン（ストローク）を表示するかどうかを構成できます。また、データの集計方法を調整することもできます。
    > 📘
    > データラベルのオプションは、ビジュアライゼーションタイプによって異なります。

#### **チャートまたはマップにカスタムデータラベルを追加する (Add custom data labels to a chart or map)**
デフォルトでは、チャートはY軸やX軸の値など、チャートの集計シリーズのデータラベルを表示できます。一部のチャートや、リージョンマップ、ポイントマップでは、チャートにカスタムデータラベルを提供するために使用する列を指定できます。

以下のチャートタイプにカスタムデータラベルを追加できます。
* 棒グラフ
* 折れ線グラフ
* コンボチャート
* エリアチャート
* 散布図
* リージョンマップ
* ポイントマップ

ラベルは、マップ上のリージョンやポイントなど、各チャートセグメントごとに分割された列の値で表示されます。

カスタムデータラベルを追加するには：
1.  要素を選択します。
2.  エディタパネルが`Properties`セクションで開きます。
3.  エディタパネルで、`Label`をクリックします。
4.  チャートまたはマップに表示したい値を持つ一つ以上の列を追加します。
5.  (任意) ラベルが希望通りに表示されるように、列の値の集計、フォーマット、またはその他の設定を調整します。「[Format and show data labels](#format-and-show-data-labels)」を参照してください。

### 6-3-5. チャートの軸の位置を書式設定する (Format chart axis position)

チャートのY軸の位置を変更したり、2番目のY軸を追加したりすることができます。水平チャートの場合は、代わりに2番目のX軸を追加したり、X軸の位置を変更したりできます。これにより、デュアルアクシス（二重軸）チャートや単一の共有軸を持つチャートを作成し、同じチャート上で2つの異なるシリーズからのデータをどのように表示するかをカスタマイズできます。

チャートの軸の書式設定は、以下のビジュアライゼーションタイプで利用可能です。
* 棒グラフ
* 箱ひげ図
* コンボチャート
* 折れ線グラフ
* 散布図
* ウォーターフォールチャート

#### **ユーザー要件 (User requirements)**
* この機能を使用するには、個々のワークブックに対する`Can edit`または`Can explore`の[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。
* ワークブックのドラフト、カスタムビュー、または保存済みビューにいる必要があります。

#### **チャートの軸の位置を変更する (Change the position of the chart axis)**
少なくとも1つの列をY軸（垂直チャートの場合）またはX軸（水平チャートの場合）に追加した後、軸の位置を変更できます。

1.  ページキャンバスで目的のチャートを選択し、エディタパネルで`Properties`が選択されていることを確認します。
2.  エディタパネルで、目的のY軸またはX軸の列名にカーソルを合わせ、下矢印()をクリックして列メニューを開きます。
3.  列メニューで、`Axis`にカーソルを合わせ、`Left`または`Right`を選択します。
4.  チャートは、新しい位置に軸がある状態で更新されます。

#### **2番目のチャート軸を追加する (Add a second chart axis)**
Y軸（垂直チャートの場合）またはX軸（水平チャートの場合）に少なくとも2つの列を可視化するチャートでは、2番目のチャート軸を追加できます。

1.  ワークブックページで目的のチャートを選択し、エディタパネルで`Properties`が選択されていることを確認します。
2.  エディタパネルで、目的のY軸またはX軸の列名にカーソルを合わせ、下矢印()をクリックして列メニューを開きます。
3.  列メニューで、`Axis`にカーソルを合わせ、`Left`または`Right`を選択します。
4.  チャートは、2番目のY軸を表示するように更新されます。

### 6-3-6. チャートの参照マークを表示する (Display chart reference marks)

参照マークは、平均、中央値、最小値、最大値に加えて、カスタム値や数式など、チャートに関する重要な情報を視覚的にハイライトします。これらは線または帯として表示するように構成できます。

参照線と参照帯は、以下のビジュアライゼーションタイプで利用可能です。
* 棒グラフ
* 折れ線グラフ
* エリアチャート
* 散布図
* コンボチャート

#### **ユーザー要件 (User requirements)**
* この機能を使用するには、個々のワークブックに対する`Can edit`または`Can explore`の[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。
* ワークブックの`Edit`または`Explore`モードである必要があります。「[workbook modes overview](https://help.sigmacomputing.com/docs/workbook-modes-overview)」を参照してください。

#### **参照マークを追加する (Add a reference mark)**
1.  ワークブックページで目的のチャートを選択します。
2.  エディタパネルで、`Format`を選択します。
3.  `Reference marks`をクリックしてセクションを展開します。
    > 📘
    > フォーマットオプションはビジュアライゼーションタイプによって異なります。
4.  `+ Add new`をクリックします。
5.  `Reference line`をクリックしてセクションを展開します。
6.  参照マークのタイプとして`Line`（デフォルト）または`Band`を選択します。
7.  残りのオプションで参照マークをカスタマイズします。これらのオプションは、参照線と参照帯で異なります。

### 6-3-7. トレンドラインを追加する (Add trend lines)

トレンドライン（傾向線）は、データセット内の一連の値にわたるパターンをハイライトし、予測するためにチャートに追加される線です。例えば、過去5年間の会社の全体的な収益成長のペースを追跡したい場合などに使用します。

この記事では、チャートにトレンドラインを追加、編集、削除する方法について説明します。

#### **ユーザー要件 (User requirements)**
* チャートを編集するには、個々のワークブックに対する`Can edit`または`Can explore`の[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。
* ワークブックの`Edit`または`Explore`モードである必要があります。「[workbook modes overview](https://help.sigmacomputing.com/docs/workbook-modes-overview)」を参照してください。

#### **前提条件 (Prerequisites)**
* チャートのX軸とY軸の両方に値がプロットされている必要があります。両方の軸には、互換性のあるスケールタイプが適用されている必要もあります。トレンドラインと互換性のあるスケールタイプは、`Linear`, `Time`, `Log`, `Pow`, `Sqrt`です。
* チャートがトレンドラインをサポートしている必要があります。トレリスチャート、積み上げチャート、および`Color`フィールドに値がプロットされているチャートは、トレンドラインをサポートしていません。
* トレンドの計算に使用したい列は、Y軸にプロットされている必要があります。

#### **トレンドラインのモデルタイプ (Trend line model types)**
利用可能なモデルタイプは、`Linear` (線形)、`Logarithmic` (対数)、`Exponential` (指数)、`Power` (べき乗)、`Quadratic` (二次)、および`Polynomial` (多項式)です。

どのモデルタイプを選択すればよいかわからない場合は、いくつか試してみて、データに最もよく合うものを選ぶことをお勧めします。線の`R²値`も、最適な適合度を判断するのに役立ちます。

各モデルタイプは、基盤となる線形回帰の数式に基づいています。これらの数式は以下に含まれていますが、線の背後にある数学を理解することは、Sigmaでトレンドラインを使用するために必須ではありません。

##### **Linear (線形)**
線形トレンドラインは、単純で安定した直線に従うデータに使用されます。データポイントは増加または減少する可能性がありますが、トレンドは安定しています。
* **数式:** `Y = a + b * X`

##### **Logarithmic (対数)**
対数トレンドラインは、変化率が急速に増加または減少し、その後横ばいになるデータセットに使用されます。
* **数式:** `Y = a + b * log(X)`

##### **Exponential (指数)**
指数トレンドラインは、値が常に増加する率で上昇または下降するデータセットに使用されます。
指数トレンドラインは、ゼロや負の数を認識しません。
* **数式:** `Y = a * e^(b * X)`

##### **Power (べき乗)**
べき乗トレンドラインは、値が特定の率で増加するデータセットに使用されます。
べき乗トレンドラインは、ゼロや負の数を認識しません。
* **数式:** `Y = a * X^b`

##### **Polynomial (多項式)**
多項式トレンドラインは、データが変動する場合に使用されます。長期間にわたる利益と損失を分析する際に役立ちます。
Sigmaの多項式トレンドラインはデフォルトで3次の多項式であり、3次から7次までをサポートします。`多項式の次数`とは、適用される係数の数を指します。これは、線に存在する山や谷の数に影響します。数値が大きいほど、より多くの山や谷が期待されます。3次のトレンドは通常、1つまたは2つの山や谷を持ちます。一方、2次のトレンドは1つの山または谷しか持ちません。
* **数式:** `Y = a + b * X + … + k * X^3`

##### **Quadratic (二次)**
二次トレンドラインは、2次の多項式トレンドラインです。多項式トレンドラインと同様に、データセットの変動を滑らかにするために使用されます。
* **数式:** `Y = a + b * X + c * X^2`

#### **R²値から最適な適合度を判断する (Determine best fit from R² values)**
R二乗値（R²）は、トレンドラインがデータにどれだけよく適合しているかを表します。これはデータポイント間の分散に基づいています。

R²値は常に0と1の間です。0に近い値は線の適合度が悪いことを示し、1に近い値はより良い適合度を示します。

チャートのトレンドラインにR²値を含めるには、エディタパネルでトレンドラインの`Show value`オプションを選択します。値は、トレンドラインのラベルが線に対して配置されている場所に表示されます。
12. (任意) 線のR²値を表示するには、`Show value`を選択します。

#### **トレンドラインを追加する (Add a trend line)**
チャートにトレンドラインを追加するには：
1.  チャートを選択します。
2.  エディタパネルで、`Format`をクリックします。
3.  `Trend lines`をクリックしてセクションを展開します。
4.  `+ Add new`をクリックします。
5.  `Trend line`を選択してセクションを展開し、トレンドラインの構成を開始します。
6.  `Select column`で、トレンドラインに使用する列を選択します。
    * 利用可能なリストには、チャートの`Y-axis`にプロットされた列のみが含まれます。
7.  `Model`で、トレンドラインの[モデルタイプ](https://help.sigmacomputing.com/docs/add-trend-lines#trend-line-model-types)を選択します。
    * **Linear:** 最適な適合の直線として表示します。
    * **Logarithmic:** 変化率が急速に増加または減少した後に横ばいになるデータセットに使用されます。
    * **Exponential:** 値が常に増加する率で上昇または下降するデータセットに使用されます。
    * **Power:** 値が特定の率で増加するデータセットに使用されます。
    * **Polynomial:** データが変動する場合に使用されます。Sigmaの多項式トレンドラインはデフォルトで3次の多項式です。この値は以下で構成可能です。
    * **Quadratic:** データセットの変動を滑らかにするために使用される2次の多項式トレンドライン。
8.  (任意) 多項式トレンドラインの場合のみ、`Degree`で3から7の間の多項式の次数を選択します。
    * 多項式の次数は、線に存在する山や谷の数を変更します。数値が大きいほど、より多くの山や谷が期待されます。
9.  (任意) 線のスタイル（`Solid`, `Dashed`, `Dotted`）を選択し、そのサイズと色を選択します。
10. (任意) トレンドラインにラベルを追加するには、`Label text`のチェックボックスを選択し、テキストボックスにラベルを入力します。
11. (任意) 線に対するラベルの位置を選択します：`Top right`, `Top left`, `Top center`, `Bottom right`, `Bottom left`, `Bottom center`。
12. (任意) 線のR²値を表示するには、`Show value`を選択します。
    * R²は、データポイント間の分散に基づいてトレンドラインがデータにどれだけよく適合しているかを表します。

#### **トレンドラインを編集する (Edit a trend line)**
既存のトレンドラインを編集するには：
1.  目的のチャートを選択し、エディタパネルで`Format`をクリックします。
2.  `Trend lines`をクリックしてセクションを展開します。
3.  編集したいトレンドラインを選択します。
4.  以下のいずれかの編集を行います。
    * トレンドに使用する新しい列を選択するには、`Select column`の下で列を選びます。
    * 線の`model type`を変更するには、`Model`の下でモデルタイプを選択します。
    * (任意) 多項式トレンドラインの場合のみ、`Degree`で3から7の間の多項式の次数を選択します。
    * 線のスタイル（`Solid`, `Dashed`, `Dotted`）を選択します。
    * 新しい線のサイズまたは色を選択します。
    * テキストラベルを追加するには、`Label text`チェックボックスを選択し、テキストボックスにラベルを入力します。
    * ラベルの位置を変更するには、ドロップダウンメニューから位置を選択します。
    * 線のR²値を表示または非表示にするには、`Show value`を選択または選択解除します。

#### **トレンドラインを削除する (Delete a trend line)**
トレンドラインを削除するには：
1.  チャートを選択し、サイドパネルで`Format`をクリックします。
2.  `Trend lines`をクリックしてセクションを展開します。
3.  編集したいトレンドラインを選択します。
4.  トレンドラインエディタの右下隅にある`Delete`をクリックします。

#### **軸のスケールタイプ (Axis scale types)**
チャートがトレンドラインをサポートするのは、その列が両方の軸にプロットされ、トレンドラインと互換性のあるスケールタイプが適用されている場合のみです。互換性のあるスケールタイプは、`Linear`, `Time`, `Log`, `Pow`, `Sqrt`です。
互換性のないスケールタイプを使用するチャートは、フォーマットパネルの`Trend lines`セクションに警告メッセージを表示します。この警告をクリアしてトレンドラインを追加するには、軸のスケールタイプを確認し、適切に更新してください。

軸のスケールタイプを変更するには：
1.  チャートを選択し、サイドパネルで`Format`をクリックします。
2.  `X-axis`または`Y-axis`のいずれかをクリックして、適切なセクションを展開します。
3.  `Scale type`ドロップダウンメニューからオプションを選択します。
    * **Linear:** 線形の数値スケールを使用して軸に沿ってデータをプロットします。
    * **Time:** 時間値として軸に沿ってデータをプロットします。
    * **Log:** 対数スケールを使用して軸に沿ってデータをプロットします。
    * **Pow:** べき乗スケールを使用して軸に沿ってデータをプロットします。
    * **Sqrt:** 平方根スケールを使用して軸に沿ってデータをプロットします。

### 6-3-8. カスタムカラースケールを追加する (Add a custom color scale)

チャートを書式設定したり、テーブルの列に条件付き書式を設定したりする際、単色やカラースケールなど、他のオプションの中から適用できます。Sigmaにはいくつかの事前定義されたカラーパレットが含まれていますが、独自に作成することもできます。
* [事前定義されたカラースケールパレットを選択する](#choose-a-predefined-color-scale-palette)
* [カスタムカラースケールパレットを設定する](#set-a-custom-color-scale-palette)

テーマの一部として[組織レベル](https://help.sigmacomputing.com/docs/workbook-themes)で、[ワークブックレベル](https://help.sigmacomputing.com/docs/workbook-settings-overview)でワークブック設定に、または特定のデータ要素の[要素レベル](https://help.sigmacomputing.com/docs/build-a-bar-chart#configure-mark-colors)でカラースケールパレットを追加できます。以下の要素がカラースケールをサポートしています。
* 棒グラフ
* ファネルチャート
* ゲージチャート
* 地理マップ
* 散布図
* [条件付き書式](https://help.sigmacomputing.com/docs/conditional-formatting)が設定されたテーブル、ピボットテーブル、入力テーブル

#### **ユーザー要件 (User requirements)**
* チャートを編集するには、個々のワークブックに対する`Can edit`または`Can explore`の[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。
* ワークブックの`Edit`または`Explore`モードである必要があります。「[workbook modes overview](https://help.sigmacomputing.com/docs/workbook-modes-overview)」を参照してください。

#### **事前定義されたカラースケールパレットを選択する (Choose a predefined color scale palette)**
1.  エディタパネルでチャートの色オプションを開くか、テーブルの条件付き書式オプションを開いて`Color scale`を選択します。
2.  カラーパレットのドロップダウンメニューを選択して、他の色の選択肢を確認します。
3.  ドロップダウンメニューを使用して、`Sequential`（デフォルト）または`Diverging`パレットを選択します。
4.  パレットを選択します。
5.  (任意) デフォルトの色を反転させるには、`Reverse color scale`のスイッチをオンにします。
6.  (任意) 特定のデータ値で色をカスタマイズするには、`Customize domain`をオンにし、データ内の`Minimum value`、`Middle value`、`Maximum value`を指定します。
7.  (任意) グラデーションのカラースケールの代わりに個別の色を使用するには、データ値に応じて`Steps`を`1`から`5`の間の値に設定します。このオプションを色のドメイン設定と併用して、特定のデータ値の色設定をより細かく定義できます。グラデーションのカラースケールに戻すには、`Steps`を`None`に設定します。
8.  (任意) 条件付き書式の場合のみ、`Format null values as zero`を有効にして、null値に書式を適用できます。データ値は更新されませんが、null値を持つセルは条件付き書式を反映します。

カスタムカラースケールパレットを作成して連続または分岐スケールに使用するには、「[カスタムカラースケールパレットを設定する](#set-a-custom-color-scale-palette)」を参照してください。

#### **カスタムカラースケールパレットを設定する (Set a custom color scale palette)**
データ要素またはテーブルセルの条件付き書式にカスタムカラースケールパレットを設定するには：

1.  エディタパネルでチャートの色オプションを開くか、テーブルの条件付き書式オプションを開いて`Color scale`を選択します。
2.  カラーパレットのドロップダウンメニューを選択して、他の色の選択肢を確認します。
3.  (任意) デフォルトのパレットを選択します。
4.  `Custom`を選択して、カスタムカラーパレットを構成します。デフォルトの色は、カスタムオプションを開いたときに選択されていたデフォルトパレット、または選択されたワークブックテーマで設定されたデフォルトパレットと一致します。
5.  カスタマイズしたい各色について、カラーブロックを選択し、以下のいずれかの方法で新しい色を選択します。
    * 提供されている標準色から選択する。
    * 色の16進コードを入力する。
    * スポイトツールを使用する。
    * カラーピッカーで色を選択する。
6.  (任意) 色を反転させるには、`Reverse color scale`をオンにします。
7.  (任意) 特定のデータ値で色をカスタマイズするには、`Customize domain`のスイッチをオンにし、データ内の`Minimum value`、`Middle value`、`Maximum value`を指定します。
8.  (任意) グラデーションのカラースケールの代わりに個別の色を使用するには、データ値に応じて`Steps`を`1`から`5`の間の値に設定します。このオプションを色のドメイン設定と併用して、特定のデータ値の色設定をより細かく定義できます。グラデーションのカラースケールに戻すには、`Steps`を`None`に設定します。
9.  (任意) 条件付き書式の場合のみ、`Format null values as zero`を有効にして、null値に書式を適用できます。データ値は更新されませんが、null値を持つセルは条件付き書式を反映します。

ワークブック内の他の要素でカスタムカラースケールを利用可能にするには、[ワークブック設定](https://help.sigmacomputing.com/docs/workbook-settings-overview)で連続色または分岐色のカスタムスケールを設定します。これにより、デフォルトのカスタムカラースケールが設定されます。特定の要素でこれを上書きできます。ワークブックレベルまたはテーマレベルのカスタムカラースケールを上書きした後、`Revert to default`を選択して、再度ワークブックレベルまたはテーマレベルのカスタムカラースケールを使用できます。

### 7-1-1. Sigmaでデータを動的にフィルタリングおよび変更する (Dynamically filter and modify data in Sigma)

Sigmaでワークブックを構築したりデータをモデリングしたりする際、ユーザー入力に基づいてデータをフィルタリングしたり、データを変更したりすることができます。

例えば、以下のようなことをしたい場合があります。
* データモデルをソースとして使用するワークブック、またはワークブックテーブルの子要素で利用可能なデータを制限する。
* ユーザー入力に基づいて計算を実行したり、SQLクエリをフィルタリングしたりする。
* ドリルダウンや表示されるデータの変更など、ワークブックの閲覧者のためのインタラクションを設計し、ワークブックを簡素化し、セルフサービス分析を提供する。
* レポートの送信方法や宛先を含め、エクスポートされたレポートの内容を修正する。

#### **データをフィルタリングする (Filter data)**
個々の要素、ワークブック全体、またはデータセットやデータモデルで利用可能なデータを制限できます。
* テーブル、ピボットテーブル、またはビジュアライゼーションに[フィルター](https://help.sigmacomputing.com/docs/data-element-filters)を追加します。データ要素フィルターは、その要素およびその要素をデータソースとして使用する下流の依存関係のデータを制限します。
* ワークブックまたはデータモデルのページに[コントロール](https://help.sigmacomputing.com/docs/intro-to-control-elements)を追加し、一つ以上の要素を対象として、それらの要素および任意の子要素で利用可能なデータを制限します。例えば：
    * 複数選択フィルターのためにリストコントロールを追加する。
    * 単一選択フィルターのためにセグメント化されたコントロールを追加する。
    * 特定の数値範囲内の値をフィルタリングするためにスライダーまたは範囲スライダーコントロールを追加する。
    * 日付フィルターのために日付範囲または日付コントロールを追加する。

#### **SQLクエリをフィルタリングするか、入力に基づいて計算を実行する (Filter SQL queries or perform calculations based on inputs)**
数式やSQLステートメントでコントロールを参照することにより、ユーザー入力に基づいて計算列を構築したり、カスタムSQLクエリをフィルタリングしたりします。
* ワークブックまたはデータモデルに[コントロール](https://help.sigmacomputing.com/docs/intro-to-control-elements)を追加し、次にカスタムSQL要素や計算列などの数式でコントロールの値を使用するために[コントロールを参照](https://help.sigmacomputing.com/docs/reference-workbook-control-values-in-sql-statements)します。例えば：
    * SQLクエリの「where」フィルターで日付範囲コントロールを参照して、結果をフィルタリングする。
    * `DateTrunc()`関数を持つ列で日付値を持つリストコントロールを参照し、その計算列をチャートのX軸として使用して、異なる日付範囲を動的に表示する。
    * `Switch`、`Choose`、または`If`関数を持つ列でセグメント化されたコントロールを参照して、ユーザー入力に基づいて列の出力を変更する。
    * 適用されたフィルタリングを表示するために、動的テキストを使用してデータ要素のタイトルでコントロール値を参照する。
* データセットに[パラメータ](https://help.sigmacomputing.com/docs/create-and-manage-dataset-parameters)を追加して、ユーザー入力に基づいてデータセットで計算を実行します。

#### **ワークブック閲覧者のためのインタラクションを設計する (Design interactions for workbook viewers)**
ワークブックに一つ以上の[コントロール](https://help.sigmacomputing.com/docs/intro-to-control-elements)を追加して、ワークブックを閲覧または探索しているユーザーが特定の方法でデータと対話できるようにします。例えば：
* スイッチコントロールを追加して、閲覧者がデータの粒度を切り替えたり、他のブール演算を実行したりできるようにする。
* テキストまたはテキストエリアコントロールを追加して、閲覧者が列内の情報を検索できるようにする。
* リストコントロール、セグメント化されたコントロール、スライダーまたは範囲スライダーコントロール、または日付または日付範囲コントロールを追加して、閲覧者がデータをフィルタリングできるようにする。
* [ドリルダウンコントロール](https://help.sigmacomputing.com/docs/create-and-manage-drill-downs)を追加して、ワンクリックのドリルダウンまたはドリルアップの動作をサポートする。

より複雑なインタラクション（例えば、ある要素とのインタラクションに基づいて別の要素をフィルタリングする、またはピボットテーブルやチャートで視覚化される列を変更するなど）を設計するには、ワークブックアクションを構成します。詳細は、「[Intro to actions](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。また、[コントロールとワークブックアクションを組み合わせる](https://help.sigmacomputing.com/docs/combine-controls-with-workbook-actions)ことで、データプラットフォームにデータを書き戻すことができるフォームのようなインタラクションを設計することもできます。

#### **エクスポートされたレポートの内容と受信者を修正する (Modify contents and recipients of an exported report)**
ワークブックに[コントロール](https://help.sigmacomputing.com/docs/intro-to-control-elements)を追加して、[コントロールの値](https://help.sigmacomputing.com/docs/send-and-schedule-exports#use-controls-to-customize-report-content)に応じてエクスポートされたレポートの内容を修正したり、[メールバースト](https://help.sigmacomputing.com/docs/send-and-schedule-exports#email-bursting)としてどのレポートがどの受信者に送信されるかを管理したりします。その後、UIまたはAPIを使用してエクスポートを実行またはスケジュールする際に、そのコントロールを参照できます。

#### **フィルター、コントロール、パラメータを使用するためのベストプラクティス (Best practices for using filters, controls, and parameters)**
ワークブック、データモデル、またはデータセットにフィルター、コントロール、またはパラメータを追加する際は、以下のベストプラクティスを考慮してください。
* データフィルタリングの一貫性を保ち、リネージを明確にするために、親またはソース要素にフィルターを追加します。例えば、個々のデータ要素を同じ値でフィルタリングするのではなく、ウェブサイト分析データモデルをホスト名でフィルタリングします。
* マテリアライゼーションを無効にしないように、マテリアライズされたデータのチャイルド要素にコントロールを対象とします。
* 要素がコントロールの対象となっている場合、フィルタリングされた要素の現在の状態を伝えるために、要素タイトルやワークブックページタイトルで動的テキストを使用します。
* フィルターが正しいグルーピングレベルに適用され、意図通りに機能することを保証するために、複雑なビジュアライゼーションのソーステーブルにフィルターを適用するか、フィルタリングを実行するコントロールを対象とすることを検討してください。
* コントロール値のソースとして列を使用するようにコントロールを構成する場合、同じコントロールでソース要素を対象としないでください。代わりに、テーブルを複製し、一方のテーブルをコントロール値のソースとして使用し、もう一方をターゲットとして使用します。これにより、下流または子要素のデータソースとして使用できます。

### 7-1-2-1. データ要素でデータをフィルタリングする (Filter data in data elements)

テーブル、ピボットテーブル、ビジュアライゼーションなどの[データ要素](https://help.sigmacomputing.com/docs/intro-to-element-types)でデータをフィルタリングして、分析や探索のために特定のデータサブセットに焦点を当てることができます。

#### **フィルターとコントロール (Filters and controls)**
いくつかの異なる方法でデータ要素をフィルタリングできます。
* データ要素内の列に直接フィルターを追加して、一つのデータ要素をフィルタリングします。データ要素にフィルターを作成した後、任意でそれを[コントロールに変換](https://help.sigmacomputing.com/docs/create-and-manage-control-elements#convert-a-filter-to-a-control)できます。
* コントロール要素を追加し、各データ要素にターゲットを追加することで、ワークブック内のワークブックのデータソースと一つ以上のデータ要素をフィルタリングします。「[コントロール要素の作成と管理](https://help.sigmacomputing.com/docs/create-and-manage-control-elements)」を参照してください。
* コントロールを追加し、SQLステートメントでコントロールIDを参照して、クエリで直接データをフィルタリングします。「[SQLステートメントでワークブックのコントロール値を参照する](https://help.sigmacomputing.com/docs/reference-workbook-control-values-in-sql-statements)」を参照してください。
* 同期されたコピーを持つコントロールを追加して、複数のページで同じコントロール設定を持つデータ要素をフィルタリングします。「[同期されたコントロール](https://help.sigmacomputing.com/docs/create-and-manage-control-elements#synced-controls)」を参照してください。

データ要素でデータをフィルタリングすると、そのフィルタリングは下流および子要素に影響します。親要素にフィルターを作成した場合、そのフィルターは子要素から表示または変更できません。どの要素が影響を受ける可能性があるかを特定するには、[ワークブックのデータリネージを確認する](https://help.sigmacomputing.com/docs/view-workbook-data-lineage)か、[データモデル内の特定の要素のリネージ](https://help.sigmacomputing.com/docs/view-workbook-data-lineage)を確認してください。

さらなるベストプラクティスについては、「[フィルター、コントロール、およびパラメータを使用するためのベストプラクティス](https://help.sigmacomputing.com/docs/dynamically-filter-and-modify-data-in-sigma#best-practices-for-using-filters,-controls,-and-parameters)」を参照してください。

##### **フィルターの操作順序 (Order of operations of filters)**
フィルターは一緒に適用されます。
例えば、`ID`列のテーブルで上位10個の値を表示するTop Nコントロールの対象となるデータ要素があり、その後、表示されている上位10個の値から3つの値を除外するためにクイックフィルターを適用したとします。ベーステーブルに10行以上ある場合、上位10個の値は更新され、新しい10個のセットが表示されます。
フィルターと集計についても同様です。製品カテゴリの販売アイテムの平均価格を計算する集計を持つグループ化されたテーブルがあり、その後、ベーステーブルの価格列をフィルタリングして最も安いアイテムを除外すると、フィルタリングされたデータで計算されるため、平均価格は上昇します。

#### **データ要素にフィルターを追加する (Add a filter to a data element)**
データ要素内の一つ以上の列をフィルタリングします。
* 要素ツールバーのフィルター()を使用します。
* 特定の列について、キャレット()をクリックして列詳細を開きます。
* セルを右クリックしてコンテキストメニューを開き、クイックフィルターを実行します。
* コントロールで要素をターゲットにします。「[コントロール要素の作成と管理](https://help.sigmacomputing.com/docs/create-and-manage-control-elements)」を参照してください。
> 📘
> 一つの列に複数のデータ要素フィルターを適用することはできません。一つの列を複数回フィルタリングしたい場合は、データ要素フィルターを、その列を対象とするコントロールやクイックフィルターなどの他のフィルターと組み合わせる必要があります。

##### **要素ツールバーまたは列詳細からフィルターを追加する (Add a filter from the element toolbar or column details)**
1.  要素ツールバーの`Filters`()を選択します。
2.  `Add filter...`を選択して新しいフィルターを追加します。
3.  `+`を選択し、フィルターを適用する列を選択します。
    > 📘
    > 既にフィルターが適用されている列をフィルタリングすることはできません。
4.  列のデータ型に基づいてデフォルトのフィルターが表示されます。
5.  `More`を選択して、以下のいずれか一つ以上を実行します。
    * フィルタータイプを変更する。
    * フィルタータイプに応じて、追加オプションを構成する。
6.  フィルターは自動的に適用されます。

##### **列またはチャートでデータをクイックフィルターする (Quick filter data in a column or chart)**
コンテキストメニューを使用してクイックフィルターを実行できます。クイックフィルターを使用すると、選択したデータ値をすばやく含める（保持する）か除外することができます。複数の列またはチャートの値を選択し、クイックフィルターを実行できます。
1.  含めたい、または除外したい値を探します。
2.  右クリックしてコンテキストメニューを開きます。
3.  選択した値に対して`Keep only`または`Exclude`のいずれかを選択します。
4.  データ要素が更新され、選択した値を含むか除外するリストフィルターが作成されます。要素ツールバーのフィルターを開いてフィルターを変更できます。

#### **フィルターのタイプ (Types of filters)**
フィルタリングしたい列のタイプに応じて、異なるフィルタータイプが利用可能です。ユースケースに最も適したフィルタータイプを選択してください。
* List (リスト)
* Top N (トップN)
* Number range (数値範囲)
* Date range (日付範囲)
* Text match (テキスト一致)

##### **List (リスト)**
リスト内の選択された値を含めるか除外します。リストフィルターには最大200個の値を表示できます。
* **サポートされるデータ型:** Text, Number, Date, Logical
* **例:**
    * ウェブサイト分析テーブルから除外する複数のページパスを選択する。
    * チャートにそれらの四半期のみを含めるために、リストから現在および前の四半期を選択する。
    * テーブルにそれらのみを含めるために、調査列のfalseおよびnull値を選択する。

##### **Top N (トップN)**
選択に応じて列のデータをランク付けし、制限します。以下から選択できます。
* First N
* Last N
* Top N
* Bottom N
* Top Percentile
* Bottom Percentile

ランキング関数も選択できます：`Rank`, `RankDense`, `RowNumber`。
* **サポートされるデータ型:** Text, Number, Date
* **例:**
    * 最後の20人の従業員を名前でアルファベット順に表示する。
    * ウェブサイト分析データで最も閲覧された上位10ページを表示する。
    * 日付順で最初の5件の調査回答を表示する。

Top Nの使用に関する詳細は、「[Top N Filter](https://help.sigmacomputing.com/docs/top-n-filter)」を参照してください。

##### **Number range (数値範囲)**
データ内で指定された数値範囲内の値のみを含めます（範囲の上限と下限を含む）。nullデータをフィルタリングするかどうかを選択できます。
* **サポートされるデータ型:** Number
* **例:**
    * 最小値を6に設定して、5件未満の回答しかない調査結果を除外する。
    * 45歳から55歳までの人口統計データを含める（両端を含む）。
    * 100回以上のクリックがあるユーザーセッションをウェブサイト分析データから除外する。

##### **Date range (日付範囲)**
データ内で指定された日付範囲内の値のみを含めます（範囲の上限と下限を含む）。固定日（2024年10月24日）または相対日（先月）を指定できます。
相対日の場合、現在の日、週、月、四半期、または年を含めるかどうかを選択できます。データに未来の日付が含まれている場合、それらの日付は含まれます。nullデータをフィルタリングするかどうかを選択することもできます。
* **サポートされるデータ型:** Date
* **例:**
    * 1か月間のキャンペーンを評価するために、過去30日間のデータを表示する。
    * 問題のトラブルシューティングのために、過去15分間のテレメトリデータを表示する。
    * 現在の四半期累計の財務データを表示する。
    * 例えば、2024年11月4日のように、月の最初の月曜日からのデータを表示する。

##### **Text match (テキスト一致)**
選択された演算子に従って、データ内で指定されたテキスト文字列の完全一致および部分一致のみを含めます。
以下の演算子から一つを選択します。
* Equal to
* Not equal to
* Contains
* Does not contain
* Starts with
* Does not start with
* Ends with
* Does not end with
* Like
* Not like
* Matches RegExp
* Does not match RegExp

一致が大文字と小文字を区別するかどうか、およびnull値をフィルタリングするかどうかも選択できます。
* **サポートされるデータ型:** Text
* **例:**
    * テキストに「Total」を含むデータを表示する。
    * 「https://www」で始まるホスト名のデータを表示する。
    * テキストに「Not Applicable」を含まないデータを表示する。
    * テキストが「EOF」で終わるデータを表示する（大文字と小文字を区別）。
    * 正規表現`total|subtotal`を使用して、テキストが「total」または「subtotal」に一致するデータを表示する。
      
### 7-1-2-2. フィルター値のソート (Sort filter values)

この記事では、インクルード（含める）およびエクスクルード（除外する）フィルターのソート方法について説明します。これは、[コントロール要素](https://help.sigmacomputing.com/docs/intro-to-control-elements)と[データ要素フィルター](https://help.sigmacomputing.com/docs/data-element-filters)の両方に関連します。

**重要:** インクルードおよびエクスクルードのフィルター/コントロールは、上位200個の値までしか表示しません。

#### **要件 (Requirements)**
なし。ワークブックを閲覧する権限を持つ誰もが、表示されているすべてのフィルターにアクセスできます。

#### **ソートオプション (Sort Options)**
すべてのインクルード/エクスクルードフィルターで、以下のオプションが利用可能です。
* **Descending by count (カウントで降順)** (デフォルト)
* **Ascending by count (カウントで昇順)**
* **Descending by alpha-numeric (英数字で降順)** (Z-A および 9-0)
* **Ascending by alpha-numeric (英数字で昇順)** (A-Z および 0-9)

#### **ソートオプションを選択する (Select a Sort Option)**
1.  フィルターをクリックします。
2.  ドロップダウンの右上隅にあるフィルター()ボタンをクリックします。
3.  ソートオプションを選択します。 


### 7-2. コントロール要素の概要 (Intro to control elements)

ワークブックにコントロール要素を追加して、ワークブックを閲覧またはカスタマイズするユーザーに、データの変更、データのフィルタリングや表示データの変更、ドリルダウンパス、またはその他のデータ操作方法など、事前定義されたインタラクションを提供します。

また、データモデルにコントロール要素を追加して、フィルター管理を一元化し、計算列でコントロール値をパラメータとして参照することもできます。

コントロール要素は、ワークブックに強力な構成オプションを提供します。
* テキスト入力コントロールを追加して、計算列のAIクエリにデータを渡すなど、ワークブックでインタラクティビティを構築します。「[Perform AI queries](https://help.sigmacomputing.com/docs/perform-ai-queries)」を参照してください。
* 数式でコントロール値を参照し、ユーザー入力に基づいて変化する計算列を有効にします。「[Reference control values as parameters](https://help.sigmacomputing.com/docs/reference-control-values-as-parameters)」を参照してください。
* コントロール値を参照して、SQLステートメントで動的フィルタリングを実行します。「[Reference workbook control values in SQL statements](https://help.sigmacomputing.com/docs/reference-workbook-control-values-in-sql-statements)」を参照してください。
* ユーザーの選択に基づいてワークブックに表示されるデータの粒度を変更します。「[Create and configure a segmented control](https://help.sigmacomputing.com/docs/create-and-configure-a-segmented-control)」を参照してください。
* 一つ以上のビジュアライゼーションに対して、事前定義されたドリルダウンおよびドリルアップパスを有効にします。「[Drill down control](https://help.sigmacomputing.com/docs/drill-down-control)」を参照してください。
* フォームを構築して、入力テーブルにデータを入力し、データプラットフォームに書き戻します。
* コントロール値を設定するアクションを定義し、複雑なワークフローを構築します。「[Create actions that manage control values](https://help.sigmacomputing.com/docs/create-actions-that-manage-control-values)」を参照してください。
* コントロールの利用可能な値に基づいて、レポートの異なるコピーを異なる受信者に一括送信（バースト）します。「[Export as email burst](https://help.sigmacomputing.com/docs/send-and-schedule-exports#email-bursting)」を参照してください。

> 🚧
> PDFまたはPNG形式へのスケジュールされたエクスポートまたは直接ダウンロードを実行する際、Sigmaはデバッグおよびトラブルシューティング目的で使用されるトレースログに、該当するコントロール値をURLパラメータとして保存することがあります。コントロールを使用して機密データをフィルタリングする際は注意してください。

#### **フィルターとコントロール (Filters and controls)**
いくつかの異なる方法でデータ要素をフィルタリングできます。
* データ要素内の列に直接フィルターを追加して、一つのデータ要素をフィルタリングします。データ要素にフィルターを作成した後、それをコントロールに変換できます。「[Filter data in data elements](https://help.sigmacomputing.com/docs/data-element-filters)」を参照してください。
* コントロール要素を追加し、各データ要素にターゲットを追加することで、ワークブック内のワークブックのデータソースと一つ以上のデータ要素をフィルタリングします。「[Create and manage a control element](https://help.sigmacomputing.com/docs/create-and-manage-control-elements)」を参照してください。
* コントロールを追加し、SQLステートメントでコントロールを参照して、クエリで直接データをフィルタリングします。「[Reference workbook control values in SQL statements](https://help.sigmacomputing.com/docs/reference-workbook-control-values-in-sql-statements)」を参照してください。
* 同期されたコピーを持つページコントロールを追加して、複数のページで同じコントロール設定を持つデータ要素をフィルタリングします。「[Synced controls](https://help.sigmacomputing.com/docs/create-and-manage-control-elements#synced-controls)」を参照してください。

#### **コントロールIDについて (About control IDs)**
ワークブックにコントロールを追加すると、Sigmaは自動的にコントロールIDを生成します。そのIDを使用して、ワークブックのエクスポート時や要素のターゲット設定時、カスタムSQLステートメント内、埋め込みURLの構築時、または異なるSigma REST APIエンドポイントを使用する際に、コントロールの値を参照できます。
コントロールIDは変更できますが、そうするとコントロールへの既存の参照が壊れる可能性があります。コントロールのラベルはいつでも更新できます。

#### **コントロールのタイプ (Types of controls)**
コントロール要素は、すべてのフィルタータイプを含む幅広いオプションをサポートしています。
* List values
* Text input
* Text area
* Segmented control
* Number input
* Number range
* Slider
* Range slider
* Date
* Date range
* Top N
* Drill down
* Switch
* Checkbox
* Legend

コントロールを作成するには、「[Create and manage a control element](https://help.sigmacomputing.com/docs/create-and-manage-control-elements)」を参照してください。

##### **List values (リスト値)**
リスト内の選択された値を含めるか除外します。リストコントロールには最大200個の値を表示できます。
* **入力タイプ:** 選択可能な値のリスト。
* **サポートされるデータ型:** Text, Number, Date, Logical
* **パラメータ出力タイプ:** 複数選択が有効な場合は選択されたデータ型の配列。無効な場合は選択されたデータ型の単一値。
* **例:**
    * ウェブサイト分析ワークブックの複数の要素に含める複数のページパスを選択する。
    * テーブルから除外する関連ID番号を選択する。
    * チャートにそれらの四半期のみを含めるために、リストから現在および前の四半期を選択する。
    * テーブルにそれらのみを含めるために、調査列のfalseおよびnull値を選択する。

##### **リスト値コントロールのインタラクティブな例 (Interactive example of a list values control)**
以下のインタラクティブな例では、`Year`リスト値コントロールを操作します。クリックしてドロップダウンメニューを開き、チャートに表示したい販売年を選択します。対象となる両方のデータ要素があなたの変更に応答します。

##### **Text input (テキスト入力)**
入力されたテキストとデータの値との間の完全および部分一致を、対象のデータ要素の列で検索します。
* **入力タイプ:** テキストボックスにテキストを入力。オプションが表示されている場合、ユーザーは演算子を選択できます。
* **サポートされるデータ型:** Text
* **パラメータ出力タイプ:** 単一値のテキスト文字列。コントロール値では演算子は利用できません。
* **例:**
    * テキストに「Total」を含むデータを表示する。
    * 「https://www」で始まるホスト名のデータを表示する。
    * テキストに「Not Applicable」を含まないデータを表示する。
    * テキストが「EOF」で終わるデータを表示する（大文字と小文字を区別）。
    * 正規表現`total|subtotal`を使用して、テキストが「total」または「subtotal」に一致するデータを表示する。

##### **テキスト入力を構成する (Configure text input)**
テキスト入力コントロールには、入力されたテキストの一致条件を制御する演算子を構成できます。これには`Contains`, `Starts with`, `Ends with`, `Like`、およびそれらに対応する除外演算子`Does not contain`, `Does not start with`, `Does not end with`, `Not like`が含まれます。`Matches Regexp`および`Does not match RegExp`演算子で正規表現を提供することもできます。

##### **Text area (テキストエリア)**
入力されたテキストと対象のデータ値との間の完全および部分一致を検索します。また、コントロールをパラメータとして参照することにより、数式にテキスト入力を提供するのにも役立ちます。
* **入力タイプ:** テキストエリアにテキストを入力。
* **サポートされるデータ型:** Text
* **パラメータ出力タイプ:** 単一値のテキスト文字列。
* **例:**
    * AIクエリ関数に渡すためのテキストプロンプトを提供する。
    * 会話からのメモをフォームに追加して、入力テーブルを更新する。

##### **Segmented control (セグメント化されたコントロール)**
ユーザーが選択するための、単一選択の限定されたオプションセットを提供します。
* **入力タイプ:** セグメントを選択。
* **サポートされるデータ型:** Text, Number, Date, Logical
* **パラメータ出力タイプ:** 選択されたデータ型の単一値。
* **例:**
    * チャートの時間粒度を四半期、月次、または週次から調整するための複数のオプションを提供する。
    * 新規、見込み、既存、すべての異なる顧客グループを切り替える。
    * 選択された製品四半期の結果のみを表示する。

詳細は、「[Create and configure a segmented control](https://help.sigmacomputing.com/docs/create-and-configure-a-segmented-control)」を参照してください。

##### **Number input (数値入力)**
単一の数値を入力してデータ要素をフィルタリングするか、カスタムSQLまたは数式のパラメータとして使用します。
* **入力タイプ:** 数値入力ボックス。
* **サポートされるデータ型:** Number
* **パラメータ出力タイプ:** 単一値の数値。フィルター演算子は出力に含まれません。
* **例:**
    * 入力された数値を定数として使用して集計計算を実行する。例えば、線形回帰の異なる重みをテストするために、異なる数値入力コントロールを数式のパラメータとして使用する。
    * 一致するID番号の行のみを表示する。

* **数値入力を構成する (Configure number input)**
    テキスト入力コントロールには、入力された数値の一致条件を制御するフィルターを構成できます。`<=` (以下)、`=` (等しい)、`>=` (以上)から選択します。デフォルトは`=`です。

##### **Number range (数値範囲)**
範囲の最小数および/または最大数を入力して、対象のデータ要素の結果をフィルタリングします。範囲は入力された数値を含みます。
* **入力タイプ:** 最小および最大の入力ボックス。
* **サポートされるデータ型:** Number
* **パラメータ出力タイプ:** 一つの最小数、一つの最大数。
* **例:**
    * 最小値を5に設定して、5件未満の回答しかない調査結果を除外する。
    * 45歳から55歳までの人口統計データを含める（両端を含む）。
    * 最大値を100に設定して、100回以上のクリックがあるユーザーセッションをウェブサイト分析データから除外する。

##### **Slider (スライダー)**
スライダーを使用して特定の範囲から数値を選択します。数値入力コントロールと同様に、スライダーオプションは利用可能な入力オプションを制限できます。
* **入力タイプ:** スライダーを動かす。
* **サポートされるデータ型:** Number
* **パラメータ出力タイプ:** 単一値の数値。
* **例:**
    * 選択された値以上の年齢の人口統計データのみを表示する。(フィルターは`>=`)
    * 選択された利益率以下の取引のみを表示する。(フィルターは`<=`)
    * 購入されたアイテム数が選択された数のトランザクションのみを表示する。(フィルターは`=`)

##### **Range slider (範囲スライダー)**
スライダーを使用して指定された範囲内の数値範囲を指定します。数値範囲コントロールと同様に、範囲スライダーは利用可能な入力オプションを制限できます。
* **入力タイプ:** 2つのポイントを持つスライダー。
* **サポートされるデータ型:** Number
* **パラメータ出力タイプ:** 一つの最小数、一つの最大数。
* **例:**
    * 5歳刻みで、異なる年齢範囲の人口統計データを含める。例えば、50歳から60歳まで（両端を含む）。

##### **Date (日付)**
列をフィルタリングしたり、パラメータとして使用したりするために単一の日付を選択します。固定日（2024-12-12）と相対日（Now minus 7 days）の両方がサポートされています。
* **入力タイプ:** カレンダー日付ピッカー。
* **サポートされるデータ型:** Date
* **パラメータ出力タイプ:** 単一値の日付。
* **例:**
    * 特定の日付のデータを表示する。
    * フォームでプロジェクトの期日を指定する。
    * 次の7日間が期日のプロジェクトを表示する。

##### **Date range (日付範囲)**
対象のデータ要素をフィルタリングするために日付範囲を選択するか、選択した日付範囲をパラメータとして使用します（例えば、カスタムSQLステートメントをフィルタリングするためなど）。選択された範囲は両端を含みます。固定および相対的な日付範囲がサポートされています。
* **入力タイプ:** 最小値と最大値のカレンダー日付ピッカー。
* **サポートされるデータ型:** Date
* **パラメータ出力タイプ:** 一つの最小日付、一つの最大日付。
* **例:**
    * 1か月間のキャンペーンを評価するために、過去30日間のデータを表示する。
    * 問題のトラブルシューティングのために、過去15分間のテレメトリデータを表示する。
    * 現在の四半期累計の財務データを表示する。
    * 例えば、2024年11月4日のように、月の最初の月曜日からのデータを表示する。

##### **Top N (トップN)**
トップ15やボトム10%など、ランキングに従って利用可能なデータを制限します。
仕様に基づいて列のデータをランク付けし、制限します。
* **入力タイプ:** ランク順序と方向、数値入力
* **サポートされるデータ型:** Text, Number, Date
* **パラメータ出力タイプ:** 入力されたデータ型の単一値。演算子（Top, Bottom）は出力に含まれません。
* **例:**
    * 最後の20人の従業員を名前でアルファベット順に表示する。
    * ウェブサイト分析データで最も閲覧された上位10ページを表示する。
    * 日付順で最初の5件の調査回答を表示する。

詳細は、「[Top N Filter](https://help.sigmacomputing.com/docs/top-n-filter)」を参照してください。

##### **Drill down (ドリルダウン)**
ユーザーがデータの事前定義されたレイヤー（例えば、データ粒度で一つ上または下のレベル）にドリルできるようにします。ドリルダウンコントロールは、ダブルクリックでのドリルを可能にします。
* **入力タイプ:** クリック可能なテキスト。
* **サポートされるデータ型:** Text, Number, Date, Logical
* **パラメータ出力タイプ:** 単一値のテキスト。選択されたドリルカテゴリの列名と一致します。
* **例:**
    * 製品タイプ別の製品売上を示すチャートで、閲覧者が製品ファミリー別の売上にドリルダウンするためのドリルダウンコントロールを提供する。

詳細は、「[Drill Down Control](https://help.sigmacomputing.com/docs/drill-down-control)」を参照してください。

##### **Switch (スイッチ)**
トグルスイッチをオンまたはオフにして、ユーザーがTrue（オン）またはFalse（オフ）の値を選択できるようにします。
* **入力タイプ:** トグルスイッチ。
* **サポートされるデータ型:** Logical
* **パラメータ出力タイプ:** 論理値 (Boolean)。
* **例:**
    * 内部ソースを含むリファラーデータを表示するかどうかを選択する。

##### **Checkbox (チェックボックス)**
チェックボックスを選択または選択解除して、True（選択済み）またはFalse（未選択）の値を表します。
* **入力タイプ:** チェックボックス。
* **サポートされるデータ型:** Logical
* **パラメータ出力タイプ:** 論理値 (Boolean)。
* **例:**
    * 未完了の調査からの調査回答を表示するかどうかを選択する。

##### **Legend (凡例)**
> 🚩
> このド-キュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このページは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

一つ以上のチャートに使用する凡例を追加します。
* **入力タイプ:** 凡例アイテムを選択。
* **サポートされるデータ型:** Text, Number, Date, Logical
* **パラメータ出力タイプ:** 選択されたデータ型の配列。
* **例:**
    * 複数のチャートにわたって同じチャートカラーを適用する。
    * 上位5つ以外の値を、一つ以上のチャートで「others」カテゴリにグループ化する。
    * 複数のチャートを一度にフィルタリングする。

詳細は、「[Create and configure a legend control (Beta)](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control-beta)」を参照してください。

### 7-2-1. コントロール要素の作成と管理 (Create and manage a control element)

ワークブックにコントロール要素を追加して、データの変更、データのフィルタリングや表示データの変更、ドリルダウンパス、またはその他のデータ操作方法など、ワークブックを閲覧またはカスタマイズするユーザーに事前定義されたインタラクションを提供します。データモデルにコントロール要素を追加して、ワークブックコントロールで選択された値に応じて、データモデル内のテーブルをフィルタリングするパラメータとして機能させます。

コントロール要素を追加した後、ターゲットを追加して要素やデータソースをフィルタリングしたり、データセットパラメータやデータモデルのコントロール要素に値を渡したりすることができます。

既存のコントロールを複製することもできます。利用可能なコントロールのタイプに関する詳細は、「[Intro to control elements](https://help.sigmacomputing.com/docs/intro-to-control-elements)」を参照してください。

#### **要件 (Requirements)**
* ワークブックまたはデータモデルに対する`Can edit`アクセス権、またはワークブックに対する`Can explore`アクセス権が必要です。

#### **コントロール要素を追加する (Add a control element)**
一つ以上のコントロール要素をワークブックまたはデータモデルに追加できます。データセットのワークシートにコントロールを追加することはできませんが、パラメータを持つデータセットでワークブックのコントロール値を参照できます。

コントロール要素を追加するには：
1.  編集のためにワークブックまたはデータモデルを開きます。
2.  `Add element`バーで、`Controls`を選択し、追加したい`control type`を選択します。
3.  新しいコントロールがキャンバスに表示されます。
4.  コントロール要素を選択し、エディタパネルの`Properties`タブでコントロールを構成します。`Settings`タブで利用可能な構成オプションは、コントロールのタイプによって異なります。
5.  (任意) `Targets`を選択して、ユーザーがコントロールを操作したときにフィルタリングまたは変更する要素を指定します。「[コントロールのターゲットを指定する](#specify-the-target-of-the-control)」を参照してください。
> 💡
> ワークブックを公開する前に、各コントロールに指定された値を確認してください。ワークブックと対話するユーザーに特定の体験を提供するために、各コントロールに特定の値を設定したい場合があります。

コントロールを作成した後、デザインをカスタマイズできます。

##### **コントロールのコントロールタイプを変更する (Change the control type for a control)**
日付コントロールなど、一部のコントロールタイプは直接追加できません。代わりに、ワークブックまたはデータモデルにコントロール要素を追加した後にコントロールタイプを変更できます。
1.  編集またはカスタマイズのためにワークブックまたはデータモデルを開きます。
2.  コントロール要素を選択します。
3.  エディタパネルの`Properties`タブで、`Control type`に別のコントロールタイプを選択します。
4.  コントロールタイプが変更されます。

##### **既存の要素フィルターをコントロールに変換する (Convert an existing element filter into a control)**
既存の[データ要素フィルター](https://help.sigmacomputing.com/docs/data-element-filters)をコントロールに変換でき、これによりコントロールの構成とターゲット設定のプロセスが簡素化されます。
データ要素フィルターをコントロール要素に変換すると、元のフィルタリングされたデータ要素が新しいコントロールのターゲットとして自動的に追加されます。エディタパネルを使用して、コントロールにカスタマイズや追加のターゲットを追加できます。

#### **コントロールのターゲットを指定する (Specify the target of the control)**
コントロールに入力または選択された内容に基づいてフィルタリングするデータ要素とデータソースを指定するために、コントロールにターゲットを追加します。
コントロールはターゲットを必要としません。例えば、ターゲットのないコントロールをパラメータとして使用し、選択または入力された値を計算列やカスタムSQLステートメントの数式に渡すことができます。

> 🚩
> コントロールがデータ要素をターゲットにしている場合、そのコントロールはデータ要素のフィルターメニューからも変更できます。

1.  編集のためにワークブックまたはデータモデルを開きます。
2.  コントロールを選択します。
3.  エディタパネルの`Properties`で、`Targets`タブを選択します。
4.  `+ Add filter target`をクリックします。
5.  コントロールによって変更させたい、ワークブックで使用されている一つ以上のワークブック要素またはデータソースを選択します。
6.  テーブルが`Targets`の下に表示され、コントロールのターゲット数が1に増えます。
7.  コントロールによってターゲットとされる列を更新します。デフォルトでは、コントロールはテーブルの最初の列をターゲットにします。ターゲット列を変更するには、現在の列をクリックして新しいターゲット列を選択します。

#### **ワークブックコントロールからデータモデルコントロールに値を渡す (Pass a value from a workbook control to a data model control)**
ワークブックでのユーザー入力に基づいてデータモデルをフィルタリングするには、ワークブックのコントロール要素からパラメータとしてデータモデルのコントロールIDをターゲットにすることで、ワークブックのコントロール要素からデータモデルのコントロール要素に値を渡すことができます。この機能は、データセットパラメータをターゲットにするのと似ていますが、データモデルで行います。

ワークブックからデータモデルにパラメータとして値を渡すには、以下が真である必要があります。
* データモデルは、ワークブックのデータソースでなければなりません。
* データモデルには、データモデル内の一つ以上の要素をターゲットにするコントロール要素が必要です。データモデルにコントロール要素を追加するには、このページの「[コントロール要素を追加する](https://help.sigmacomputing.com/docs/create-and-manage-control-elements#add-a-control-element)」を参照してください。
* データモデルのコントロール要素は、ワークブックのコントロール要素の出力と同じデータ型でなければなりません。例えば、数値入力コントロール要素の出力は単一値の数値であり、データモデルの単一値リストコントロール、スライダーコントロール、または数値入力コントロールに渡すことができます。

ワークブックからデータモデルにパラメータとして値を渡すには：
1.  編集またはカスタマイズのためにワークブックを開きます。
2.  コントロール要素を選択します。
3.  エディタパネルの`Properties`タブで、`Targets`タブを選択します。
4.  `Add source parameter`を選択し、ターゲットにしたいコントロールを持つデータモデルを選択します。
5.  ドロップダウンリストで、ワークブックのコントロール要素の値で設定したいデータモデル内のコントロールIDを選択します。サポートされているデータ型のコントロール要素のみが選択可能です。
6.  ターゲットを追加した後、コントロールをカスタマイズおよび構成します。「[Types of controls](https://help.sigmacomputing.com/docs/intro-to-control-elements#types-of-controls)」を参照してください。

#### **ワークブックコントロールからデータセットパラメータに値を渡す (Pass a value from a workbook control to a dataset parameter)**
ワークブックでのユーザー入力に基づいてデータセットをフィルタリングするには、コントロール要素からパラメータをターゲットにすることで、コントロールからデータセットパラメータに値を渡すことができます。

データセットパラメータをターゲットにするには、コントロールの出力タイプがパラメータのデータ型と同じである必要があります。例えば、単一値の数値と数値などです。
1.  編集のためにワークブックを開きます。
2.  コントロール要素を選択します。
3.  エディタパネルの`Properties`タブで、`Targets`タブを選択します。
4.  `Add source parameter`を選択し、ターゲットにしたいパラメータを持つデータセットを選択します。
5.  ドロップダウンリストで、ワークブックのコントロール要素の値で設定したいデータセットパラメータを選択します。サポートされているデータ型のパラメータのみが選択可能です。
6.  データセットパラメータを作成するには、「[データセットパラメータの作成と管理](https://help.sigmacomputing.com/docs/create-and-manage-dataset-parameters)」を参照してください。
7.  ターゲットを追加した後、コントロールをカスタマイズおよび構成します。「[Types of controls](https://help.sigmacomputing.com/docs/intro-to-control-elements#types-of-controls)」を参照してください。

#### **コントロールを複製する (Duplicate a control)**
コントロール要素を作成した後、それを複製できます。コントロールを複製すると、書式設定、ターゲット、およびその他の設定が保持されつつ、元のコントロールとは別に複製コントロールを変更できます。
> 💡
> コントロールの構成を全く同じに保ちたい場合は、同期されたコピーを作成します。「[Synced controls](https://help.sigmacomputing.com/docs/synced-controls)」を参照してください。

同期されたコピーを作成せずにコントロールを複製するには：
1.  編集のためにワークブックまたはデータモデルを開きます。
2.  複製したいコントロール要素を選択し、`More`を選択します。
3.  要素メニューで、`Duplicate`を選択します。キーボードショートカットも使用できます。複製コントロールは元のコントロールの下に表示され、構成の変更やカスタマイズができます。

#### **コントロールを必須に設定する (Set a control as required)**
コントロール要素を必須にすると、コントロールと同じページにあるすべてのデータ要素は、コントロールで値が選択されるまでデータを表示しません。たとえその要素がコントロールを参照しておらず、ターゲットにされていなくてもです。ユーザーが必須コントロールで選択を行うと、ページ上のデータ要素はデータをロードして表示します。

データモデルでコントロールを必須にすることはできますが、データモデルの動作は変わりません。

コントロールを必須にするには、以下を実行します。
1.  編集のためにワークブックを開きます。
2.  コントロールを選択します。
3.  `Settings`タブで、`Required`のチェックボックスを選択します。
4.  変更は即座に保存されます。編集アクセス権のない人に変更を表示するには、ワークブックを公開します。
> 📘
> ドリルダウンコントロールは必須にできません。

### 7-2-2. セグメント化されたコントロールの作成と構成 (Create and configure a segmented control)

セグメント化されたコントロールには、ユーザーがターゲット要素のデータをフィルタリングするために選択できる1つから7つのセクションがあります。コントロール内のセグメントは単一選択であるため、各セグメントはラジオボタンのように機能し、一致するものを選択し、他のデータを除外します。

リストコントロールの代替としてセグメント化されたコントロールを使用して、選択するための関連性の高い値の小さなセットを提示することができます。また、関連コンテンツの異なるビューを切り替えるために、トグルスイッチのようにセグメント化されたコントロールを使用することもできます。例えば、顧客タイプ別にウェビナー登録をセグメント化する場合、すべての関連データを含む1つのワークブックを構築し、セグメント化されたコントロールを使用して、新規、見込み、既存、すべての関連する顧客グループを切り替えることができます。

#### **セグメント化されたコントロールを作成する (Create a segmented control)**
セグメント化されたコントロールを作成するには、以下を実行します。
1.  ワークブックの編集モードで、`+ Add element`をクリックします。
2.  左のナビゲーションパネルで、`Control elements`までスクロールし、`Segmented control`を選択します。
3.  新しいセグメント化されたコントロールがキャンバスに表示されます。
4.  `Element properties`パネルで、コントロールに列ベースの値を使用するか、手動の値を使用するかを選択します。「[コントロールを構成する](#configure-the-control)」を参照してください。
5.  ユーザーがコントロールを操作したときにどのような変更が発生するかを指定します。「[コントロールのターゲットを指定する](https://help.sigmacomputing.com/docs/create-and-manage-control-elements#specify-the-target-of-the-control)」を参照してください。
> 📘
> コントロールが関連データをフィルタリングできるようになる前に、[ターゲットを指定](https://help.sigmacomputing.com/docs/create-and-manage-control-elements#specify-the-target-of-the-control)し、[セグメントのソースを選択](https://help.sigmacomputing.com/docs/create-and-configure-a-segmented-control#configure-the-control)する必要があります。

#### **コントロールを構成する (Configure the control)**
コントロールの動作を構成するには、`Settings`をクリックし、セグメント化されたコントロールの属性を選択します。
セグメント化されたコントロールで使用される値は、さまざまな方法で設定できます。
* [手動リストを作成する](#use-a-manual-list)。コントロールが機能するためには、リストがターゲットデータ要素のデータと何らかの形で対応している必要があります。
* Sigmaによって定義された[プリセットからリストを作成する](https://help.sigmacomputing.com/docs/create-and-configure-a-segmented-control#use-a-list-from-a-preset)。
* [データ内の列を使用する](https://help.sigmacomputing.com/docs/create-and-configure-a-segmented-control#use-a-column-in-your-data)。列の最初の7つの値がコントロールに使用されます。ソート順を変更して、どの列の値が使用されるかを変更できます。

コントロール値が設定された後、追加の構成ステップを実行できます。
* (任意) コントロールのユーザーが何も選択されていない状態にコントロールをリセットできるようにするには、`Show clear option`のチェックボックスを選択します。デフォルトでは、このオプションのラベルは`None`ですが、変更できます。
* (任意) ユーザーがコントロールで選択を行った後にのみターゲットのデータ要素がロードされるようにするには、`Required`のチェックボックスを選択します。
* (任意) デフォルトの`Control ID`を更新するかどうかを決定します。「[コントロールIDについて](https://help.sigmacomputing.com/docs/intro-to-control-elements#about-control-ids)」を参照してください。

##### **手動リストを使用する (Use a manual list)**
手動リストを作成して、カスタム値を選択できます。引き続きデータテーブルまたはデータ要素を参照しますが、データ内の相対的な頻度に関係なく、使用したいデータセグメントを直接命名できます。
1.  コントロールの`Properties`タブで、`Settings`タブを選択します。
2.  `Value source`で、`Create manual list`を選択します。
3.  `Value type`で、手動で追加する値のデータ型を指定します。データ型は、コントロールの対象となる列のデータ型と一致する必要があります。`Text`（デフォルト）、`Number`、`Date`、`Boolean`から選択します。
4.  `Values`で、コントロールに使用するカスタム値のリストを入力します。`enter`または`return`を押して新しい値を追加します。任意で、生データ値の代わりにコントロールに表示する表示値を指定できます。

##### **プリセットからリストを使用する (Use a list from a preset)**
このオプションでは、月名、曜日名、日付パーツといった一般的なプリセットのセットから選択できます。これらのオプションのいずれかを選択すると、コントロールは手動リストになります。それを変更したり、値を削除したり、新しい値を追加したりできます。

1.  コントロールの`Properties`タブで、`Settings`タブを選択します。
2.  `Value source`で、`Create list from preset`を選択し、プリセットオプションのいずれかを選択します。
    * Month names (月名)
    * Weekday names (曜日名)
    * Date parts (日付パーツ)
3.  プリセットリストを選択すると、`Value type`と`Values`が自動的に更新されます。`Value source`は、プリセットリストが事前に設定された手動リストであることを反映して`Create manual list`に変わります。
4.  必要に応じてプリセットリストを修正し、不要な値を削除し、表示値を変更します。値を削除するには、値にカーソルを合わせて`x`を選択します。

##### **データ要素またはデータソースの列を使用する (Use a column from a data element or data source)**
1.  コントロールの`Element properties`パネルで、`Settings`タブを選択します。
2.  `Value source`で、ワークブックで使用されているデータソースまたはデータ要素を選択します。
3.  `Source column`には、データソースの最初の列が表示されます。列を選択してドロップダウンメニューを開き、コントロールを設定するために使用したい列を選択します。
    * デフォルトでは、その列で最も頻繁に出現する上位7つの値がコントロールに使用されます。`Sort`()を選択して、デフォルトの`Descending by count`から`Ascending by count`、`Ascending by alphanumeric`、または`Descending by alphanumeric`にソート順を変更します。カスタムソート順はサポートされていません。
4.  (任意) データの表示値として別の関連する列を使用するには、`Set display column`のトグルスイッチをオンにし、同じデータソースから表示列を選択します。例えば、データソースとしてID列を使用し、表示値として名前列を使用することができます。
5.  (任意) コントロールのユーザーが何も選択されていない状態にコントロールをリセットできるようにするには、`Show clear option`のチェックボックスを選択します。
6.  (任意) ユーザーがコントロールで選択を行った後にのみターゲットのデータ要素がロードされるようにするには、`Required`のチェックボックスを選択します。
7.  (任意) デフォルトの`Control ID`を更新するかどうかを決定します。「[コントロールIDについて](https://help.sigmacomputing.com/docs/intro-to-control-elements#about-control-ids)」を参照してください。

#### **コントロールのターゲットを指定する (Specify the target of the control)**
コントロールにターゲットを追加して、フィルタリングするデータ要素とデータソースを指定します。
1.  コントロールを選択し、`Element properties`で`Targets`をクリックします。
2.  `+ Add filter target`をクリックします。
3.  コントロールによって変更させたい、ワークブック内の要素を一つ以上選択します。
4.  テーブルが`Targets`の下に表示され、コントロールのターゲット数が1に増えます。
5.  コントロールによってターゲットとされる列を更新します。デフォルトでは、コントロールはテーブルの最初の列をターゲットにします。ターゲット列を変更するには、現在の列をクリックして新しいターゲット列を選択します。

#### **セグメント化されたコントロールの書式設定とデザイン (Format and design a segmented control)**
セグメント化されたコントロールを書式設定・デザインして、ワークブックのスタイリングに合わせることができます。書式設定オプションを確認・更新するには、`Element format`をクリックします。

##### **要素のスタイルを更新する (Update the element style)**
背景など、要素のスタイルをカスタマイズできます。「[要素の背景をカスタマイズする](https://help.sigmacomputing.com/docs/customize-element-background-and-styles-beta)」を参照してください。

##### **コントロールラベルを更新する (Update the control label)**

| オプション | 説明 |
| :--- | :--- |
| **Show label** | コントロールにラベルを表示するには、チェックボックスを選択します。デフォルトではラベルが表示されます。|
| **Bold** | ラベルテキストを太字にします。|
| **Text color** | ラベルテキストの色を更新します。|
| **Label position** | ラベルをコントロールの`Top`または`Left`に配置するかを選択します。|
| **Show description** | コントロールに説明を表示するには、チェックボックスを選択します。最大200文字の説明を提供できます。|
| **Description formatting** | 説明が表示されている場合、説明テキストを太字にしたり、テキストの色を更新したりできます。|
| **Description display** | 説明が表示されている場合、説明を`Subtitle`または`Tooltip`として表示するか、`Auto`設定を使用するかを選択できます。|

##### **コントロールの配置を更新する (Update the alignment of the control)**
ワークブックキャンバス上の要素の境界内で、セグメント化されたコントロールを配置できます。
以下の水平方向の配置オプションから選択します。

| 配置設定 | 例 |
| :--- | :--- |
| **Left align () (default)** | (画像) |
| **Right align ()** | (画像) |
| **Stretch ()** | (画像) |

### 7-2-3. ドリルダウンコントロール (Drill down control)

#### **要件 (Requirements)**
ドリルコントロールを作成するには、ワークブックに対する`Can Edit`アクセス権が必要です。
このページで説明されているアクティビティは、編集モードでのみ利用可能です。編集を開始するには、ページの右上隅にある`Edit`をクリックします。詳細は、「[Workbook Lifecycle](https://help.sigmacomputing.com/docs/workbook-lifecycle)」を参照してください。

#### **ドリルコントロールを作成する (Create a drill control)**
1.  エディタパネルで、`+ ADD NEW`をクリックします。
2.  `ADD NEW`パネルが開きます。
3.  `CONTROL ELEMENTS`セクションで、`Drill Down`を選択します。
4.  新しいドリルダウン要素がページに表示されます。
5.  エディタパネルの`SETTINGS` > `Value source`セクションで、ドロップダウンリストを使用して、ドリルパスで使用する予定の列を含むデータ要素を選択します。
6.  選択したデータ要素がドリルダウンをサポートしている場合、Sigmaは`DRILL CATEGORIES`の下に列を追加します。これを保持するか、変更するか、さらに追加することができます。
7.  `DRILL CATEGORIES`セクションの隣にある`+ Add drill category`をクリックします。
8.  リストから列を選択します。
9.  (任意) 上記のステップを繰り返して、ドリルパスに追加の列を追加します。要素はパスを表示します。
10. コントロールに一つ以上のターゲットを追加します。ターゲットは、コントロールが操作するデータ要素です。エディタパネルで、`TARGETS`タブをクリックします。
11. `+ Add Target`をクリックします。
12. リストからターゲットデータ要素を選択します。
13. `Map with columns in target`セクションが表示されます。ドロップダウンメニューを使用して、ドリルパスの列をターゲットデータ要素の対応する列にマッピングします。
14. `SETTINGS`タブには、すべてのドリルカテゴリが表示されます。コントロールのIDやラベルを変更できます。
15. ステップ8-10を繰り返して、追加のターゲットを追加します。
16. テストするには、ドリルコントロール要素のドリルパスでカテゴリ名をクリックして、そのカテゴリにドリルダウンします。ターゲットデータ要素はそれに応じて更新されます。

#### **既存のドリルパスからドリルコントロールを作成する (Create a drill control from an existing drill path)**
1.  データ要素のビジュアライゼーションで値を右クリックして、メニューを開きます。
2.  `Drill up` > `Create drill control`を選択します。
3.  Sigmaはコントロールを追加し、必要に応じてさらに編集できます。

#### **既存のドリルコントロールにカテゴリを追加する (Add categories to an existing drill control)**
1.  既存のドリルダウンコントロールを選択します。
2.  エディタパネルの`SETTINGS`セクションで、`DRILL CATEGORIES` > `+ Add drill category`をクリックします。
    * 注：`+ Add drill category`ボタンは、上記の`Value source`が選択されている場合にのみ有効になります。
3.  リストから列を選択します。
4.  上記のステップを繰り返して、ドリルパスに追加の列を追加します。Sigmaは、ドリルコントロールのドリルパスに各ドリルカテゴリを表示します。

#### **既存のドリルコントロールにターゲットを追加する (Add targets to an existing drill control)**
1.  既存のドリルダウンコントロールを選択します。
2.  エディタパネルで、`TARGETS`タブをクリックします。
3.  `+ Add Target`をクリックします。
4.  リストからターゲット要素を選択します。
    ターゲット要素を表すボックスが表示されます。
5.  ドロップダウンメニューを使用して、ドリルパスのドリルカテゴリをターゲット要素の対応する列にマッピングします。
6.  ステップ3-5を繰り返して、追加のターゲットを追加します。
7.  テストするには、コントロール要素のドリルパスでカテゴリ名をクリックして、そのカテゴリにドリルダウンします。新しいターゲット要素はそれに応じて更新されます。

### 7-2-4. Top N フィルター (Top N filter)

フィルター基準に基づいて、列を上位N個の行でフィルタリングすることは非常に一般的です。これは、リスト全体ではなく、ソートされたリストの上位の値を見たい場合に便利です。

**重要:** Sigmaが自動的に集計とグループ化を処理する方法のため、Top Nフィルターは他の製品で経験したものとは少し異なる動作をする場合があります。詳細については、以下の例とヒントを参照してください。

#### **Top Nの例 (Examples of Top N)**

##### **Top Nを適用すると棒グラフがどのように変わるか**
例えば、州別にソートされた、最も商品を動かしている上位5店舗に興味があるとします。Top Nフィルターを適用する前は、棒グラフは次のようになります。

> **ヒント:** チャートを最大化して、その下にあるデータテーブルを表示します。フィルターを適用する際に、フィルターがテーブルをどのように変更するかを確認すると役立つことがあります。

[Sum of Quantity]にTop Nを適用すると、チャートは次のようになります。

##### **Top N棒グラフとそのテーブルの関係**
この例は、チャートの最大化されたビューを示しており、そのデータテーブルが含まれています。Top Nフィルターは[Sum of Price]列にあります。（もしフィルターを[Store City]列に置いた場合、Sigmaは都市をアルファベット順にフィルタリングします。）これにより、販売されたすべての商品の合計価格が最も高い10都市のリストが得られます。

##### **複数のグルーピングを持つピボットテーブルでのTop N**
複数のグルーピングレベルがある場合、Top Nフィルターは全体の上位10項目をフィルタリングするのではなく、2番目に低いグルーピングレベルで定義されたビン内でフィルタリングします。この例では、Top Nは上位10の[Store Region]や[Store State]ではなく、上位10の[Store City]に適用されます。

#### **Top Nを使用してフィルタリングする方法 (How to Filter Using Top N)**
1.  棒グラフに列を設定します。
2.  Y軸に列を追加します。
3.  X軸に列を追加します。デフォルトの集計を維持します。
    * **重要:** SigmaはTop Nを使用する際に集計列を必要とします。
4.  必要であれば、ソート基準を設定します。
5.  フィルタリングしたい列について、そのメニュー > Filterを選択します。
    * **重要:** ランク付けしたい列にTop Nフィルターを設定します。これは直感的でない場合があります。上記の例では、上位10店舗を表示したいので、[Sum of Quantity]ではなく[Store Name]でランク付けします。
6.  フィルターパネルで、3つの点をクリックしてオプションを表示します。
7.  `Top N`を選択します。
8.  表示する結果の数を入力します。
9.  フィルタリングされたチャートを最もよく説明するように、デフォルトのチャートヘッダーを変更します。

#### **ランキング関数を変更する (Change the Ranking Function)**
デフォルトでは、Top Nフィルターは`Rank`関数を使用します。場合によっては、代わりに`RankDense`または`RowNumber`関数に変更したいことがあります。オプションは以下の通りです。
* **Rank:** 重複する値に同じランクを割り当て、ランク間にギャップを置きます。デフォルトです。
* **Rank Dense:** 重複する値に同じランクを割り当て、ランク間にギャップはありません。
* **Row Number:** 最も高い行番号に従ってランク付けします。

ランキング関数を変更するには：
1.  コントロールの右上にあるフィルターアイコンから、コントロールのFILTERS & CONTROLSパネルを開きます。
2.  フィルターの`More`メニューから、`Ranking function`を選択します。
3.  希望するランクの種類を選択します。

#### **Top Nのヒント (Tips for Top N)**
* フィルターを適用する際にテーブルフィールドが見えるように、チャートを最大化します。
* ランク付けされている列にのみTop Nフィルターを適用します。
    * 例えば、上位10の製品タイプを示す棒グラフが必要な場合、X軸に[Product Type]を、Y軸に[Sum of Revenue]を配置し、次にTop Nフィルターを[Sum of Revenue]列に適用します。これにより、[Product Type]でグループ化された[Sum of Revenue]の上位10の値が得られます。
    * そうしないと、Top Nを[Product Type]列に適用した場合、チャートは製品をアルファベット順にソートします。
* SigmaはTop Nに集計列を必要とします。
* Top Nは、text, number, date型の列にのみ適用されます。
* テキスト列の場合、Top Nは英数字のソートによって決定されます。

### 7-2-5. 凡例コントロールの作成と構成 (Create and configure a legend control)

ワークブックに凡例コントロールを追加して、色を揃えたり、共有値を持つ複数のチャート間でインタラクティブな選択を実行したりします。ユーザーは一度クリックするだけで、複数のチャートをフィルタリングできます。

例えば、凡例コントロールを使用して、焦点を当てたい製品タイプの凡例を一つ作成し、その後複数のチャートをターゲットにすることができます。ターゲットとなるチャートの色が製品タイプカテゴリで分割されている場合、それらは同時にフィルタリングされ、凡例コントロールで定義されたのと同じ色を使用できます。

#### **制限事項 (Limitations)**
カテゴリによって色プロパティが設定されているチャートのみをターゲットにできます。以下のチャートタイプはサポートされていません。
* KPI
* 箱ひげ図
* ウォーターフォール
* サンキー
* ゲージ

色のカテゴリを定義するために使用される列が削除された場合、または色がスケールや単色に変更された場合、凡例コントロールはチャートに影響を与えません。チャート要素のフィルターメニューに警告が表示されますが、凡例コントロールは引き続きそのチャート要素をターゲットにします。

#### **要件 (Requirements)**
* ワークブックに対する`Can edit`[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。

#### **凡例コントロールを追加する (Add a legend control)**
ワークブックに凡例コントロールを追加します。
> 💡
> 既存のチャートの凡例を右クリックし、`Convert to legend control`を選択することで、凡例コントロールを作成できます。

1.  ワークブックの編集モードで、ワークブックキャンバスの下部にある`Add element bar`を探します。
2.  `Add element`バーで、`Controls` > `Legend`を選択します。
3.  新しいコントロールがキャンバスに表示されます。
4.  エディタパネルの`Properties`タブで、コントロールのソース値を選択します。「[コントロールを構成する](#configure-the-control)」を参照してください。
5.  ユーザーがコントロールを操作したときにどのチャートが影響を受けるかを指定します。「[コントロールのターゲットを指定する](https://help.sigmacomputing.com/docs/create-and-manage-control-elements#specify-the-target-of-the-control)」を参照してください。
> 📘
> 凡例が関連するデータ要素と対話できるようになる前に、[凡例の値のソースを選択](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control-beta#configure-the-control)し、[凡例コントロールのターゲットを指定](https://help.sigmacomputing.com/docs/create-and-manage-control-elements#specify-the-target-of-the-control)する必要があります。

#### **コントロールを構成する (Configure the control)**
コントロールの動作を構成するには、`Settings`をクリックし、凡例コントロールの属性を選択します。
凡例コントロールで使用される値は、さまざまな方法で設定できます。
* [手動リストを作成する](https://help.sigmacomputing.com/docs/create-and-configure-a-segmented-control#use-a-manual-list)。
* Sigmaによって定義された[プリセットからリストを作成する](https://help.sigmacomputing.com/docs/create-and-configure-a-segmented-control#use-a-list-from-a-preset)。
* [データ内の列を使用する](https://help.sigmacomputing.com/docs/create-and-configure-a-segmented-control#use-a-column-from-a-data-element-or-data-source)。

コントロールに使用する値を設定した後、他の構成ステップを実行できます。
* [値に色を割り当てる](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control-beta#assign-colors-to-values)
* [追加の値を「others」としてグループ化する](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control-beta#group-additional-values-as-others)
* デフォルトの`Control ID`を更新するかどうかを決定します。「[コントロールIDについて](https://help.sigmacomputing.com/docs/intro-to-control-elements#about-control-ids)」を参照してください。

##### **手動リストを使用する (Use a manual list)**
手動リストを作成して、凡例で管理するカスタム値を設定できます。
1.  コントロールの`Properties`タブで、`Settings`タブを選択します。
2.  `Value source`で、`Create manual list`を選択します。
3.  `Value type`で、手動で追加する値のデータ型を指定します。データ型は、コントロールの対象となる列のデータ型と一致する必要があります。`Text`（デフォルト）、`Number`、`Date`、`Boolean`から選択します。
4.  `Values`で、コントロールに使用するカスタム値のリストを入力します。`enter`または`return`を押して新しい値を追加します。任意で、生データ値の代わりにコントロールに表示する表示値を指定できます。
5.  コントロールの値を設定した後、[値に色を割り当て](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control-beta#assign-colors-to-values)、[追加の値を「others」としてグループ化](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control-beta#group-additional-values-as-others)します。

##### **プリセットからリストを使用する (Use a list from a preset)**
このオプションでは、月名、曜日名、日付パーツといった一般的なプリセットのセットから選択できます。これらのオプションのいずれかを選択すると、コントロールは手動リストになります。それを変更したり、値を削除したり、新しい値を追加したりできます。
1.  コントロールの`Properties`タブで、`Settings`タブを選択します。
2.  `Value source`で、`Create list from preset`を選択し、プリセットオプションのいずれかを選択します。
    * Month names (月名)
    * Weekday names (曜日名)
    * Date parts (日付パーツ)
3.  プリセットリストを選択すると、`Value type`と`Values`が自動的に更新されます。`Value source`は、プリセットリストが事前に設定された手動リストであることを反映して`Create manual list`に変わります。
4.  必要に応じてプリセットリストを修正し、不要な値を削除し、表示値を変更します。値を削除するには、値にカーソルを合わせて`x`を選択します。
5.  コントロールの値を設定した後、[値に色を割り当て](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control-beta#assign-colors-to-values)、[追加の値を「others」としてグループ化](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control-beta#group-additional-values-as-others)します。

##### **データ要素またはデータソースの列を使用する (Use a column from a data element or data source)**
データ要素またはデータソースの列を使用して、凡例コントロールの値を提供することもできます。コントロール要素のデータソースは、ターゲットとなるデータ要素のいずれであってもいけません。そうしないと、予期しないフィルタリング動作が発生する可能性があります。
1.  コントロールの`Properties`タブで、`Settings`タブを選択します。
2.  `Value source`で、ワークブックで使用されているデータソースまたはデータ要素を選択します。
3.  `Source column`には、データソースの最初の列が表示されます。列を選択してドロップダウンメニューを開き、コントロールを設定するために使用したい列を選択します。
4.  [任意] データの表示値として別の関連する列を使用するには、`Set display column`のトグルスイッチをオンにし、同じデータソースから表示列を選択します。例えば、データソースとしてID列を使用し、表示値として名前列を使用することができます。
5.  コントロールの値を設定した後、[値に色を割り当て](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control-beta#assign-colors-to-values)、[追加の値を「others」としてグループ化](https://help.sigmacomputing.com/docs/create-and-configure-a-legend-control-beta#group-additional-values-as-others)します。

#### **値に色を割り当てる (Assign colors to values)**
カラーパレットを選択し、任意でカスタムカラーを凡例に適用します。ワークブックまたは組織のテーマを適用する場合、テーマのカテゴリカルカラーが凡例コントロールに使用されます。
1.  コントロールの`Properties`タブで、`Settings`タブを選択します。
2.  `Color assignment`で、使用するカラーパレットを選択します。各凡例アイテムに色が割り当てられます。
3.  [任意] 各凡例の値の色をカスタマイズするには、色を選択するか、カラーパレット全体をカスタマイズします。「[カスタムカラースケールを追加する](https://help.sigmacomputing.com/docs/add-a-custom-color-scale)」を参照してください。
4.  値に色を割り当てた後、任意で凡例で他のカテゴリがどのように扱われるかをカスタマイズします。

#### **チャートで追加の値を「others」としてグループ化する (Group additional values as others in a chart)**
凡例コントロールがチャートをターゲットにしている場合、凡例に存在しないターゲットチャートの列に存在する値は、デフォルトで別のカテゴリにグループ化されます。例えば、特定の価​​値の手動リスト、またはソースとして使用される列からのフィルタリングされた値などです。カテゴリは`Others`とラベル付けされますが、名前を変更したり、削除したりできます。
1.  コントロールの`Properties`タブで、`Settings`タブを選択します。
2.  `Other categories`で、`Use other color`（デフォルト）と`Use legend palette`のいずれかを選択します。
    * **Use other color**を使用すると、凡例に表現されていないターゲットチャートの値を共通のラベルと色でグループ化できます。デフォルトでは、ラベルは`Others`で、色は灰色ですが、ラベルと色を変更できます。
    * **Use legend palette**は、`Color assignment`セクションで選択されたカラーパレットの色を、凡例に表現されていない値に適用します。
  
#### **コントロールのターゲットを指定する (Specify the target of the control)**
コントロールにターゲットを追加して、フィルタリングするデータ要素とデータソースを指定します。
1.  コントロールを選択し、`Properties`で`Targets`をクリックします。
2.  `+ Add interaction target`をクリックします。
3.  凡例を適用したいワークブック内のチャートを一つ以上選択します。
4.  選択された各チャートは`Targets`の下に表示され、コントロールのターゲット数が増加します。このコントロールによってターゲットとされた各チャートでは、既存の凡例は非表示になります。
    > 💡
    > 凡例コントロールでチャートをターゲットにした後、個々のチャートの凡例を表示することができます。
5.  コントロールによってターゲットとされる列を更新します。デフォルトでは、コントロールはチャートの色を管理するために使用される列をターゲットにします。ターゲット列を変更するには、現在の列をクリックして新しいターゲット列を選択します。
    * ターゲット列を変更すると、コントロールのデフォルト名が選択された列と一致するように更新されます。

#### **凡例コントロールの書式設定とデザイン (Format and design a legend control)**
凡例コントロールを書式設定・デザインして、ワークブックのスタイリングに合わせることができます。
書式設定オプションを確認・更新するには、コントロールを選択し、`Format`タブを選択します。

##### **要素のスタイルを更新する (Update the element style)**
背景など、要素のスタイルをカスタマイズできます。「[要素の背景をカスタマイズする](https://help.sigmacomputing.com/docs/customize-element-background-and-styles-beta)」を参照してください。

##### **コントロールラベルを更新する (Update the control label)**

| オプション | 説明 |
| :--- | :--- |
| **Show label** | コントロールにラベルを表示するには、チェックボックスを選択します。デフォルトではラベルが表示されます。|
| **Bold** | ラベルテキストを太字にします。|
| **Text color** | ラベルテキストの色を更新します。|
| **Label position** | ラベルをコントロールの`Top`または`Left`に配置するかを選択します。|
| **Show description** | コントロールに説明を表示するには、チェックボックスを選択します。最大200文字の説明を提供できます。|
| **Description formatting** | 説明が表示されている場合、説明テキストを太字にしたり、テキストの色を更新したりできます。|
| **Description display** | 説明が表示されている場合、説明を`Subtitle`または`Tooltip`として表示するか、`Auto`設定を使用するかを選択できます。|

##### **凡例コントロールを書式設定する (Format legend control)**
凡例コントロールの外観を書式設定できます。
1.  凡例を選択した後、`Format`タブを選択します。
2.  `Legend`を選択して、関連するオプションを確認・修正します。

| オプション | 説明 |
| :--- | :--- |
| **Orientation** | 凡例コントロールのオプションをどのように表示するか。`Vertical`（デフォルト）、`Horizontal`、または`Horizontal with wrap`から選択します。|
| **Font size** | 凡例ラベルに使用するフォントサイズ。|
| **Text color** | 凡例ラベルに使用するテキストの色。|
| **Mark shape** | 凡例マークに使用する形状。`Circle`, `Square`（デフォルト）, `Cross`, `Diamond`, `Triangle`, `Solid line`, `Dashed line`, `Dotted line`から選択します。|

### 7-3-1. コントロール値をパラメータとして参照する (Reference control values as parameters)

コントロール要素で入力または選択された値は、数式またはSQLステートメントで参照できます。

例えば：
* 構成可能な日付から1か月以内に契約満了日が発生するかどうかを評価するために、日付コントロールを作成し、その日付コントロールの値を数式で参照します。
* 各構成可能な重みに対して数値入力コントロールを作成し、線形回帰を計算する数式でそのコントロール値を参照することで、線形回帰計算の重みを動的に調整します。
* チャートのタイトルで選択されたコントロール値を参照するために、選択されたコントロール値を参照する数式を追加して、チャートで動的テキストを使用します。
* SQLクエリの結果をフィルタリングします。

ワークブックまたはデータモデルでコントロール値をパラメータとして参照できます。データセットは異なるタイプのパラメータを使用しますが、コントロールからデータセットパラメータに値を渡すこともできます。「[データセットパラメータの作成と管理](https://help.sigmacomputing.com/docs/create-and-manage-dataset-parameters)」を参照してください。

コントロール値を参照するには：
1.  コントロールのコントロールIDを特定します。
2.  コントロールによって出力されるデータ型を決定します。「[コントロール要素の概要](https://help.sigmacomputing.com/docs/intro-to-control-elements)」の「コントロールのタイプ」を参照してください。
3.  コントロール値を参照します。
    * 計算列や動的テキストなどの数式で。「[数式でコントロール値を参照する](#reference-a-control-value-in-a-formula)」を参照してください。
    * SQLステートメントで。「[SQLステートメントでワークブックのコントロール値を参照する](https://help.sigmacomputing.com/docs/reference-workbook-control-values-in-sql-statements)」を参照してください。

#### **要件 (Requirements)**
* ワークブックに対する`Can Edit`アクセス権が必要です。
* `Create, edit, and publish workbooks`権限が有効になっているアカウントタイプを割り当てられている必要があります。

#### **コントロールのコントロールIDを特定する (Identify the control ID for a control)**
コントロール値をパラメータとして参照するには、コントロールIDを使用します。コントロールIDを見つけるには：
1.  コントロールを選択します。
2.  要素プロパティの`Settings`タブで、`Control ID`を探します。以下のスクリーンショットでは、コントロールIDは`text-area`です。

コントロールIDをパラメータとして参照するには、IDを角括弧で囲みます。
`[New-Control-1]`

数式バーは、オートコンプリート候補としてコントロールIDも表示します。
コントロールIDを別の値に更新できますが、IDを変更すると、そのコントロールを参照している既存のパラメータが壊れる可能性があります。
> 🚧
> コントロールIDを変更した場合は、数式やカスタムSQL内のコントロールIDへの参照を更新してください。コントロールを参照する要素は、`Targets`タブの`Currently referenced by:`セクションにリストされます。

コントロールIDの詳細については、「[About control IDs](https://help.sigmacomputing.com/docs/intro-to-control-elements#about-control-ids)」を参照してください。

#### **数式でコントロール値を参照する (Reference a control value in a formula)**
数式でコントロール値を参照するために使用する構文は、コントロール値の出力タイプにより、コントロールタイプごとに異なります。
* **単一の値 (Single value)** (ほとんどのコントロールタイプ)
* **最小/最大値 (Min/max values)** (数値範囲または範囲スライダー)
* **開始/終了値 (Start/end values)** (日付範囲コントロール)
* **複数の値 (Multiple values)** (複数選択リストコントロール)

##### **数式で単一値コントロールの値を参照する (Reference a single value control value in a formula)**
一度に単一の値を返すコントロールの場合、数式またはカスタムSQLでコントロール値をパラメータとして参照できます。

* **サポートされるコントロールタイプ:**
    Single select list values, Text input, Text area, Number input, Date, Segmented, Drilldown, Slider, Checkbox, Switch, Top N

* **構文 (Syntax):**
    数式でコントロール値を参照するには、コントロールIDを角括弧で囲み、以下の構文を使用します。
    `[New-Control-ID]`

    コントロール値をパラメータとして参照する場合、数式またはカスタムSQLステートメントが期待するデータ型が、コントロール値のデータ型と完全に一致することを確認してください。

##### **数式で単一値コントロールの値を参照する (Reference a single value control value in a formula)**
一度に単一の値を返すコントロールの場合、数式またはカスタムSQLでコントロール値をパラメータとして参照できます。

* **サポートされるコントロールタイプ:**
    Single select list values, Text input, Text area, Number input, Date, Segmented, Drilldown, Slider, Checkbox, Switch, Top N

* **構文 (Syntax):**
    数式でコントロール値を参照するには、コントロールIDを角括弧で囲み、以下の構文を使用します。
    `[New-Control-ID]`

    コントロール値をパラメータとして参照する場合、数式またはカスタムSQLステートメントが期待するデータ型が、コントロール値のデータ型と完全に一致することを確認してください。例えば、数値入力コントロールは数値データ型の値しか持てないため、数式内で最初に変換しない限り、テキスト関数では使用できません。

##### **数式で数値範囲または範囲スライダーコントロールの値を参照する (Reference a number range or range slider control value in a formula)**
数値範囲または範囲スライダーコントロールには、最小値と最大値が含まれます。コントロールをパラメータとして参照する場合、どちらの値を取得するかを指定します。

* **サポートされるコントロールタイプ:**
    Number range, Range slider

* **構文 (Syntax):**
    最小値を取得するには、以下の構文を使用します。
    `[Range-Control-ID].min`
    最大値を取得するには、以下の構文を使用します。
    `[Range-Control-ID].max`

##### **数式で日付範囲コントロールの値を参照する (Reference a date range control value in a formula)**
日付範囲コントロールには、開始値と終了値が含まれます。コントロールをパラメータとして参照する場合、どちらの値を取得するかを指定します。

* **サポートされるコントロールタイプ:**
    Date range

* **構文 (Syntax):**
    開始値を取得するには、以下の構文を使用します。
    `[Date-Range-Control-ID].start`
    終了値を取得するには、以下の構文を使用します。
    `[Date-Range-Control-ID].end`

    数式で日付範囲コントロールをパラメータとして使用する場合、日付列のデータ型**と**フォーマットが一致する必要があります。日付フォーマットが一致しない場合、数式で日付範囲の開始値を参照することはできません。

    例えば、日付範囲コントロール`Date-Range-Control-One`が`2024-09-03 00:00:00`のフォーマットで値を出力し、別の列`Contract Expiry Date`が`2024-09-03`の構造で日付を含んでいる場合、計算列`Contract Status`でコントロール値と列値を評価する数式を記述することがあります。
    `If([Date-Range-Control-One].end = [Contract Expiry Date], "Renew", [Date-Range-Control-One].end > [Contract Expiry Date], "Past Due", [Date-Range-Control-One].end < [Contract Expiry Date], "Valid")`
    しかし、列の日付値が一致しないため、この数式は無効です。

##### **数式で複数選択コントロールの値を参照する (Reference a multi-select control value in a formula)**
複数選択を許可するリストコントロールは、値を配列として返します。結果として、それらのコントロール値を取得するパラメータを配列データ型として扱います。

* **サポートされるコントロールタイプ:**
    List values, Legend

* **構文 (Syntax):**
    例えば、選択されたオプションに特定のオプションが含まれているかどうかを評価するには、`ArrayContains`関数を使用します。
    `ArrayContains([Weekday-List-Multi-ID], "monday")`

    「[Array functions](https://help.sigmacomputing.com/docs/array-functions)」を参照してください。

#### 7-3-2. URLクエリ文字列パラメータを使用してコントロール値を設定する (Set control values in a URL using query string parameters)

URLクエリ文字列パラメータでコントロールIDと値をエンコードすることにより、ワークブックを埋め込む際にワークブックのコントロール値を事前に設定（pre-populate）できます。ワークブックを埋め込む際、URLでコントロール値を設定し、他のサポートされているクエリ文字列パラメータを指定できます。サポートされているクエリ文字列パラメータの完全なリストについては、「[Embed URL parameters](https://help.sigmacomputing.com/docs/embed-url-parameters)」を参照してください。JSONウェブトークン（JWT）署名付きURLも、クエリ文字列パラメータを使用したURLでのコントロール値の設定をサポートしています。

他のSigmaユーザーと事前に設定されたコントロール値を持つワークブックを共有したい場合は、希望のコントロール値でワークブックの保存済みビューを作成し、その保存済みビューを関連するユーザーやチームと共有することを検討してください。「[Create and share saved views](https://help.sigmacomputing.com/docs/create-and-share-saved-views)」を参照してください。

> 🚧
> PDFまたはPNG形式へのスケジュールされたエクスポートまたは直接ダウンロードを実行する際、Sigmaはデバッグおよびトラブルシューティング目的で使用されるトレースログに、該当するコントロール値をURLパラメータとして保存することがあります。コントロールを使用して機密データをフィルタリングする際は注意してください。

##### **URLにクエリ文字列パラメータを追加する (Add query string parameters to a URL)**
URLにクエリパラメータを追加する際、最初のものはURLの末尾に`?`を追加します。後続のパラメータは`&`で追加できます。
Sigmaの任意のリンクで、クエリ文字列パラメータを使用してURLでコントロール値を設定できます。
* ワークブックURLの例
* パブリック埋め込みURLの例
* JWT署名付き埋め込みURLの例

異なるコントロールに関するより具体的なガイダンスについては、以下を参照してください。
* [URLで単一のコントロール値を設定する](https://help.sigmacomputing.com/docs/set-control-values-in-a-url-using-query-string-parameters#set-a-single-control-value-in-a-url)
* [URLで数値範囲または範囲スライダーコントロールの値を設定する](https://help.sigmacomputing.com/docs/set-control-values-in-a-url-using-query-string-parameters#set-a-number-range-or-range-slider-control-value-in-a-url)
* [URLで日付範囲コントロールの値を設定する](https://help.sigmacomputing.com/docs/set-control-values-in-a-url-using-query-string-parameters#set-a-date-range-control-value-in-a-url)
* [URLで複数選択コントロールの値を設定する](https://help.sigmacomputing.com/docs/set-control-values-in-a-url-using-query-string-parameters#set-a-multi-select-control-value-in-a-url)

##### **ワークブックURLの例 (Workbook URL example)**
例えば、クエリ文字列パラメータがないワークブックURLは次のようになります。
`https://app.sigmacomputing.com/workbook/{workbookID}`

ワークブックURLでコントロールID `Region` を持つコントロールを事前に設定したい場合、コントロールの値を設定するクエリ文字列パラメータを次のように追加します。
1.  現在のURL構造に基づいて、コントロール値を設定するためのクエリ文字列パラメータを追加します。
    * URLにクエリ文字列パラメータ（例えば、選択されたワークブックページを示す`?:nodeId=`）が含まれている場合は、アンパサンド(&)を追加して別のクエリ文字列パラメータを追加します。
    * URLにクエリ文字列パラメータが含まれていない場合は、URLに疑問符(?)を追加します。
2.  コントロールIDと値をキーと値のペアとして提供し、必要に応じて値を[URLエンコード](https://help.sigmacomputing.com/docs/set-control-values-in-a-url-using-query-string-parameters#encode-url-parameters)します。
    * 例えば、`Region`というコントロールIDに`Metro West`という値を設定する場合： `?Region=Metro%20West`

更新されたURLは次のようになります。
`https://app.sigmacomputing.com/workbook/{workbookID}?Region=Metro%20West`

複数のクエリ文字列パラメータを含めるには、各キーと値のペアをアンパサンド(&)で区切ります。
`https://app.sigmacomputing.com/workbook/{workbookID}?Region=Metro%20West&Year=2022`

##### **パブリック埋め込みURLの例 (Public embed URL example)**
[パブリック埋め込み](https://help.sigmacomputing.com/docs/create-a-public-embed)のURLでコントロール値を設定するには、次の例を参照してください。
`https://app.sigmacomputing.com/embed/{embedID}?Region=Metro%20West&Year=2022`

##### **JWT署名付き埋め込みURLの例 (JWT-signed embed URL example)**
[JWT署名付きセキュア埋め込みURL](https://help.sigmacomputing.com/docs/example-embed-api-and-url#example-embed-api-via-jwt-secure-method)のURLでコントロール値を設定するには、次の例を参照してください。コントロール値はJWTクレームではないため、他の埋め込みURLと同じようにクエリ文字列パラメータを使用できます。

* **URLに署名する前にURLでコントロール値を設定する:**
    `https://app.sigmacomputing.com/{organization-name}/workbook/{workbookname}-{workbookUrlId}/page/{pageId}?foods=cheeseburger,grilled%20cheese`
    この例では、コントロールIDと値が唯一のクエリ文字列パラメータであるため、`?`を使用してURLに追加します。

* **JWT値を生成した後にURLでコントロール値を設定する:**
    `https://app.sigmacomputing.com/{org-slug}/{workbook_id}?:jwt={JWT VALUE}&:embed=true&foods=cheeseburger,grilled%20cheese`
    この例では、コントロールIDと値は`:jwt`および`:embed`パラメータの後に追加されるクエリ文字列パラメータであるため、`&`を使用してURLに追加します。

##### **URLパラメータをエンコードする (Encode URL parameters)**
URLにコントロール値を追加する際、それらはエンコードされなければなりません。
プログラムで埋め込みURLを生成する場合、JavaScript関数 `encodeURIComponent` を使用して、URLに追加する前にパラメータをエンコードします。このオプションは、[インバウンドJavaScriptイベント](https://help.sigmacomputing.com/docs/implement-inbound-and-outbound-events-in-embeds)を使用する場合、またはJavaScriptイベントハンドラを使用してクエリ文字列パラメータをURLに渡す場合に使用します。
コントロールIDと値を含むURLを手動で構築する場合は、[URLパラメータの特殊文字](https://help.sigmacomputing.com/docs/embed-url-parameters#special-characters-for-url-parameters)のリストを参照し、手動で値をエンコードします。

##### **考慮事項 (Considerations)**
* 埋め込みがパブリックの場合、参照されるコントロールはパブリックなワークブックページ上にある必要があります。
* コントロールが表示値を使用している場合、URLクエリ文字列パラメータは表示値ではなく、生のコントロール値を参照する必要があります。
* URLのクエリ文字列パラメータを使用してドリルダウンコントロールの値を指定することはできません。
* 使用するURLは編集URLであってはなりません。公開またはタグ付けされたバージョンのワークブック、またはワークブックをカスタマイズ中にのみ、URLでコントロール値を設定できます。

##### **特別なパラメータ値 (Special parameter values)**
URLでコントロール値を設定する際、特別なオプションが利用可能です。
* コントロールを`null`に設定するには、コントロール値として`:null`を使用します。
* コントロールを空文字列`""`に設定するには、コントロール値として`:empty`を使用します。

##### **URLで単一のコントロール値を設定する (Set a single control value in a URL)**
単一の値を入力として受け取るコントロールの場合、URLクエリ文字列パラメータでコントロール値を次のように設定できます。

* **サポートされるコントロールタイプ**
    Single select list, Text input, Text area, Number input, Date, Segmented, Slider, Checkbox, Switch, Top N

* **構文 (Syntax)**
    `Control-ID=Value`

* **プログラムによるエンコード (Programmatically encode)**
    テキストまたは数値の値をエンコードする：
    `encodeURIComponent('<control-ID>')=encodeURIComponent('<control_value>')`

    日時値はエンコードしない：
    `encodeURIComponent('<control-ID>')=<control_value>`

    論理値はエンコードしない：
    `encodeURIComponent('<control-id>')=true`
    `encodeURIComponent('<control-id>')=false`

* **利用可能な値 (Available values)**
    コントロールの値は、コントロールへの入力として期待されるのと同じデータ型でなければなりません。「[Intro to control elements](https://help.sigmacomputing.com/docs/intro-to-control-elements)」を参照してください。

    日付コントロール、または日付をサポートするリストコントロールの場合、以下のいずれかを指定できます。
    * ISO 8601日付形式 `YYYY-MM-DDTHH:MM:SS` を使用した正確な日付。
    * ミリ秒単位のUnixタイムスタンプ。
    * 事前選択された値をクリアするための空白または`:null`。
    > 📘
    > デフォルトでは、日時値はSigma組織のアカウントタイムゾーンで解析されます。この動作を上書きしてUTC +0タイムゾーンを使用するには、タイムスタンプの末尾に「Z」を追加します。

    日付コントロールの場合、以下も指定できます。
    * 相対日付。`<type>-<date_part>-<number>`の形式を使用します。

* **テキストの例 (Text examples)**
    コントロールIDが`Customer-Name`のコントロールで、一つのテキスト値を指定する：
    `Customer-Name=Merchandise%20Store`

    コントロールIDが`Instructions`のテキストエリアコントロールにテキストを入力する：
    `Instructions=Start%20making%20changes%20in%20the%20afternoon`

* **日付の例 (Date examples)**
    コントロールIDが`start_date`の日付コントロールまたは単一選択リストコントロールで、日付を指定する：
    * 2024年5月1日を指定：`start_date=2024-05-01`
    * アカウントタイムゾーンで2024年5月1日午前8時を指定：`start_time=2024-05-01T08:00`
    * UTCタイムゾーンで2024年5月1日午前8時を指定：`start_time=2024-05-01T08:00Z`
    * 3か月前の日付を指定：`start_time=prior-month-3`

* **数値の例 (Number examples)**
    コントロールIDが`Amount`の数値入力またはスライダーコントロールで、数値を指定する：
    `Amount=1000`

* **論理値（ブール値）の例 (Logical (Boolean) examples)**
    コントロールIDが`is_weekend`のスイッチコントロールまたはチェックボックスコントロールで、trueまたはfalseの値を指定する：
    * 週末の日付のみのデータを表示：`is_weekend=true`
    * 平日の日付のみのデータを表示：`is_weekend=false`
    Trueまたはfalseの値は小文字でなければなりません。

##### **URLで数値範囲または範囲スライダーコントロールの値を設定する (Set a number range or range slider control value in a URL)**
数値範囲コントロールまたは範囲スライダーコントロールには、最小値と最大値が含まれます。URLクエリ文字列パラメータでコントロールを設定する際、どの値を設定するかを指定します。

* **サポートされるコントロールタイプ**
    * Number range
    * Range slider

* **構文 (Syntax)**
    最小値と最大値の両方を設定するには、以下の構文を使用します。
    `Control-ID=min:Value,max:Value`

    最小値のみを設定するには、以下の構文を使用します。
    `Control-ID=min:Value,max:`

    最大値のみを設定するには、以下の構文を使用します。
    `Control-ID=min:,max:Value`

* **プログラムによるエンコード (Programmatically encode)**
    `encodeURIComponent('<control_id>')=min:<min_value>,max:<max_value>`

    数値にカンマなどの特殊文字が含まれる可能性がある場合は、値もエンコードします。
    `encodeURIComponent('<control_id>')=min:encodeURIComponent('<min_value>'),max:encodeURIComponent('<max_value>')`

* **数値範囲の例 (Number range examples)**
    コントロールIDが`User-Revenue`の場合：
    * 4000.5より大きい任意の値を指定： `User-Revenue=min:4000.5,max:`
    * 4000.5から5000の間の任意の値を指定： `User-Revenue=min:4000.5,max:5000`
    * 1,000から3,000の間の任意の値を指定： `User-Revenue=min:1%2C000,max:3%2C000`
    * 100,000未満の任意の値を指定： `User-Revenue=min:,max:100%2C000`

##### **URLで日付範囲コントロールの値を設定する (Set a date range control value in a URL)**
日付範囲コントロールには、範囲の開始値（最小日付）と終了値（最大日付）が含まれます。URLクエリ文字列パラメータでコントロール値を設定する際、どの値を設定するかを指定します。

* **サポートされるコントロールタイプ**
    * Date range control

* **構文 (Syntax)**
    開始値のみを設定： `Control-ID=min:Value,max:`
    終了値のみを設定： `Control-ID=min:,max:Value`
    両方を設定： `Control-ID=min:Value,max:Value`
    > 💡
    > `min`と`max`の代わりに`start`と`end`を使用することもできます。

* **利用可能な値 (Available values)**
    日付範囲コントロールに`min_date`または`max_date`を設定する際、以下のいずれかを指定できます。
    * ISO 8601形式の正確な日付： `YYYY-MM-DDTHH:MM:SS`
    * ミリ秒単位のUnixタイムスタンプ
    * 空白または`:null`
    * 相対日付： `<type>-<date_part>-<number>`

* **日付範囲の例 (Date range examples)**
    コントロールIDが`Analysis-Time-Frame`の場合：
    * 特定の日付から3日前までの日付範囲を設定： `Analysis-Time-Frame=min:2024-04-01,max:prior-day-3`
    * 2024年4月1日から現在までの日付範囲を設定： `Analysis-Time-Frame=min:2024-04-01,max:`
    * 空の日付範囲コントロールを設定： `Analysis-Time-Frame=min:,max:`

##### **URLで複数選択コントロールの値を設定する (Set a multi-select control value in a URL)**
リストコントロールは、複数選択が許可されている場合、複数の値を入力として受け取ることができます。URLクエリ文字列パラメータでコントロール値を設定する際、設定する値を指定します。

* **サポートされるコントロールタイプ**
    * List
    * Legend

* **構文 (Syntax)**
    `Control-ID=Value[,Value-2,Value-3,Value-4...]`

* **利用可能な値 (Available values)**
    提供される値は、コントロールが期待するデータ型と一致する必要があります。リストコントロールは、Text, Number, Datetime, Logicalの値を受け取ることができます。

* **複数選択リストコントロールの例 (Multi-select list control examples)**
    コントロールIDが`Employee-Name`の場合、3つのテキスト値を指定：
    `Employee-Name=Greg%20Humphrey,Xiaoyu%20Xu,Meera%20Deshpande`

    コントロールIDが`birthday`の場合、2つの日付を指定：
    `birthday=1970-05-01,1991-01-24`

    コントロールIDが`is_weekend`の場合、trueとfalseの両方の値を指定：
    `is_weekend=true,false`

### 7-3-3. 同期されたコントロール (Synced controls)

同期されたコントロールは、同一で同期されたコピーを持つワークブックのコントロール要素です。フィルターコントロールとパラメータの両方が、同期されたコピーをサポートしています。ここでは、同期されたコントロールがどのように機能するか、同期されたコントロールを作成・識別する方法、およびコントロールの同期を解除する方法について説明します。

同期されたコピーは、コントロールが複数のワークブックページにわたる要素に影響を与える場合に、コンテキストを維持するのに役立ちます。例えば、あるページで組織のハイレベルな売上データを追跡し、別のページで地域固有のデータにドリルダウンしたい場合があります。同じフィルターコントロールが両方のページの要素を対象としている場合、両方のページにコントロールを表示することをお勧めします。これにより、あなたとワークブックの閲覧者は、ページを切り替えることなく、どちらのページからでもコントロールの値を編集できます。「[例#2：ページ間でコンテキストを維持する](#example-2-maintain-context-across-pages)」を参照してください。

また、同期されたコントロールを使用して、他のページのデータがロードされる前にコントロール値の事前選択を促すこともできます。閲覧者がデータ表示ページの前に見るランディングページにコントロールのコピーを配置します。クエリはページが開いた後にCDWに対して実行されるため、フィルター値を事前に選択することでパフォーマンスが向上し、CDWのコンピューティングコストが削減されます。「[例#3：コントロール値を事前選択する](#example-3-preselect-control-values)」を参照してください。

#### **要件 (Requirements)**
* 個々のワークブックに対する`Can Edit`[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)と、編集モードである必要があります。
* 既存のコントロールから直接、同期されたコピーを作成します。コピーを作成する前に、機能するコントロールが必要です。
* 既存の2つのコントロールを同期させることはできません。

#### **同期されたコピー vs. 複製 (Synced copies vs. duplicates)**
同期されたコピーは、複製とは異なります。

* **複製 (Duplicates)**
    * 独立して動作するコントロール。
    * コントロールの設定や値への編集は、複製コピーには転送されません。
    * 複製されたコントロールは、異なるコントロールIDを持ちます。

* **同期されたコピー (Synced copies)**
    * 完全に同一で同期されたコントロール。
    * 同期されたコピーは、他のすべての同期されたコピーと自動的に同期されます。
    * 同期されたコントロールは、同じコントロールIDを共有します。

#### **コントロールの同期されたコピーを作成する (Create a synced copy of a control)**
同期されたコントロールは、既存のコントロールから直接作成されます。同期されたコピーを作成する前に、コントロールが必要です。同期されたコピーが作成されると、そのコピーは他のすべての同期されたコピーと自動的に同期されます。

既存の2つのコントロールを同期させることはできません。コントロールまたはコントロールを持つページを複製しても、同期されたコピーにはなりません。

同期されたコントロールを作成するには、編集モードに変更し、以下のステップを完了します。
1.  要素にカーソルを合わせ、そのmore()メニューを開きます。
2.  `Create a synced copy`をクリックします。
3.  同期されたコピーがページに表示されます。
4.  コントロールを新しいページに移動するには、そのMore()メニューを開き、`Move to`メニューからページを選択します。

#### **同期されたコントロールを識別する (Identify synced controls)**
コントロールの同期されたコピーを識別するには、編集モードに入り、以下を実行します。
1.  コントロールを選択します。
2.  エディタパネルで、`SYNCED COPIES`タブを開きます。
3.  タブには、選択したバージョンを含む、すべての同期されたコピーがリストされます。
4.  コピーをクリックして、それに移動します。

#### **コントロールの同期を解除する (Unsync controls)**
コントロールの同期を解除すると、それは独立して動作する複製としてページに残ります。
コントロールの同期を解除するには、編集モードでこれらのステップを実行します。
1.  要素にカーソルを合わせ、そのmore()メニューを開きます。
2.  `Unsync control`をクリックします。

#### **同期されたコントロールの例 (Synced control examples)**

##### **例#1：2つのコントロール、1つのターゲット (Example #1: Two controls, one target)**
これら2つのコントロール要素は同期されています。それらは同じコントロールの同一のコピーです。
これらのコントロール要素のいずれかで新しい値を選択すると、Sigmaは両方のコントロールを更新します。
これを同期されたコントロールとターゲットテーブルの両方で観察してください。

##### **例#2：ページ間でコンテキストを維持する (Example #2: Maintain context across pages)**
コントロールがワークブックの複数のページの要素に影響を与える場合、同期されたコピーはコンテキストを維持します。

##### **例#3：コントロール値を事前選択する (Example #3: Preselect control values)**
同期されたコントロールを使用して、データをロードする前にコントロール値を事前選択し、データウェアハウスから取得する必要があるデータの量を削減します。
例えば、閲覧者が関連データを選択し、そのデータを表示する関連ページに移動できるように、ランディングページにコントロールのコピーを配置します。
閲覧者がデータのあるページを開いた後、クエリが実行され、データウェアHausからデータが取得されます。

### 8-1-1. UI要素の概要 (Intro to UI elements)

UI要素は、ワークブックのページに追加のコンテキスト、スタイリング、およびナビゲーションを追加します。これらには、ボタン、区切り線、画像、スペーサー、埋め込み、およびテキストが含まれます。

#### **ユーザー要件 (User requirements)**
UI要素を作成および編集するには：
* 個々のワークブックに対する`Can edit`または`Can explore`の[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。
* ワークブックのドラフト、カスタムビュー、または保存済みビューにいる必要があります。

#### **UI要素のタイプ (UI element types)**
UI要素は、それぞれが独自の目的とカスタマイズレベルを持つ、いくつかの異なるタイプに分類できます。

* **テキスト (Text)**
    テキストUI要素を使用すると、ワークブックのページにタイトルやキャプションを追加できます。サイズ、スタイル、フォントを選択できます。テキストには、数式からの動的なコンテンツを含めることができます。詳細は、「[Text elements](https://help.sigmacomputing.com/docs/text-elements)」を参照してください。

* **画像 (Image)**
    ファイルをアップロードするか、URLを参照して画像を追加します。要素コンテナ内で画像がどのように収まるかをカスタマイズし、要素のスタイルを変更します。また、URLで動的テキストを使用して、コントロール値や数式からURLをソースとすることもできます。

* **ボタン (Button)**
    ボタンを追加して、ワークブックでワンクリックのアクションを作成します。ボタンの表示をカスタマイズし、特定の宛先にナビゲートしたり、要素を修正・更新したり、データをダウンロード・エクスポートしたりする[アクションのトリガー](https://help.sigmacomputing.com/docs/actions-overview)として構成できます。詳細は、「[Create a button element](https://help.sigmacomputing.com/docs/create-a-button-element)」を参照してください。

* **区切り線 (Divider)**
    水平の区切り線を追加して、ページ上の要素または要素のグループを視覚的に分割します。ニーズとワークブックのデザインに合わせて、向き、色、太さ、配置をカスタマイズできます。

* **改ページ (Page break)**
    改ページ要素は、PDFファイルのレイアウトと書式設定をより細かく制御できます。エクスポートされたPDFで改ページが発生すべき場所を指定します。ワークブックページ上でのその書式設定や外観はカスタマイズできません。

* **埋め込み要素 (Embed element)**
    埋め込み要素は、ウェブページ、ビデオ、またはSigmaワークブックをワークブックページに追加します。iFrameが有効な任意のURLを埋め込むことができます。埋め込みURL内でコントロール変数と動的テキストを使用して、異なる入力に応じて表示されるコンテンツをカスタマイズします。
    > 🚧
    > iFrameが有効なURLの末尾にあるアンカータグなどのURLフラグメントは、埋め込み要素では機能せず、要素が壊れたり、コンテンツが誤って表示されたりする原因となります。埋め込み要素に追加する前に、iFrame URLからフラグメントを削除してください。

#### **UI要素を作成する (Create a UI element)**
1.  `Add element`バーで、`UI`をクリックします。
2.  UI要素を選択します。新しい要素がページに表示されます。
3.  (任意) 要素をページキャンバス上の任意の場所にドラッグ＆ドロップして移動します。
4.  (任意) エディタパネルを使用して、新しい要素を構成します。

### 8-1-2. ボタン要素を作成する (Create a button element)

ボタン[UI要素](https://help.sigmacomputing.com/docs/intro-to-ui-elements)を追加して、ワークブックでワンクリックのアクションを作成します。ボタンの表示をカスタマイズし、特定の宛先にナビゲートしたり、要素を修正・更新したり、データをダウンロード・エクスポートしたりするアクションのトリガーとして構成できます。

このドキュメントでは、ボタン要素を作成・カスタマイズする方法について説明します。ボタンがクリックされたときに実行できるアクションとアクションシーケンスに関する情報については、「[Action effects](https://help.sigmacomputing.com/docs/action-effects)」を参照してください。

#### **ユーザー要件 (User requirements)**
ワークブックにボタン要素を作成・カスタマイズする機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、ワークブックに対する`Can explore`または`Can edit`のアクセス権を付与されている必要があります。

#### **ボタン要素を追加する (Add a button element)**
ワークブックに`Button`要素を追加します。
1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  `Add element`バーで、`UI`にカーソルを合わせ、`Button`を選択します。

#### **ボタンのプロパティをカスタマイズする (Customize button properties)**
ラベル、スタイル、配置、形状、サイズなど、ボタンの外観を定義する要素プロパティをカスタマイズします。
1.  エディタパネルで、`Properties`タブを選択し、ボタンのプロパティを構成します。
    * **Appearance (外観):** ボタンのバリアントを選択します。
    * **Text (テキスト):** ボタンに表示するラベルまたはコールトゥアクション（CTA）を追加します。`=`を入力して、数式表現によって定義される動的な値を含めます。
    * **Style (スタイル):** フォントの太さ、テキストの色、ボタンの色をカスタマイズします。
    * **Horizontal (水平方向):** 要素の全幅に対してボタンを配置または引き伸ばします。
    * **Vertical (垂直方向):** 要素の全高に対してボタンを配置します。
    * **Shape (形状):** ボタンの形状を選択します。
    * **Size (サイズ):** ボタンのサイズを選択します。

#### **ボタンのアクションを構成する (Configure button actions)**
ボタンがクリックされたときに実行されるアクションとアクションシーケンスを構成します。
1.  エディタパネルで、`Actions`タブを選択します。
2.  必要に応じてアクションとアクションシーケンスを構成します。特定のアクション効果とその構成方法に関する情報については、「[Action effects](https://help.sigmacomputing.com/docs/action-effects)」および表にリンクされているドキュメントを参照してください。

### 8-1-3. テキスト要素 (Text elements)

テキスト要素は、ワークブックのページにラベル、ヘッダー、フッター、およびタイトルを追加します。色やフォントを変更するように書式設定でき、また数式を使用して動的にテキストを生成することもできます。

#### **ユーザー要件 (User requirements)**
テキスト要素を追加および編集するには：
* 個々のワークブックに対する`Can edit`または`Can explore`の[アクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)が必要です。
* ワークブックの`Edit`または`Explore`モードである必要があります。「[workbook modes overview](https://help.sigmacomputing.com/docs/workbook-modes-overview)」を参照してください。

#### **テキスト要素を作成する (Create a text element)**
1.  `Add element`バーで、`UI` > `Text`を選択します。新しいテキスト要素がページに表示されます。
2.  入力を開始してテキストを入力します。
3.  (任意) ページ上部のツールバーを使用してカスタム書式設定を追加するか、`Link`を選択してハイパーリンクを追加します。
4.  (任意) テキスト要素をドラッグ＆ドロップして、ページキャンバス上の任意の場所に移動します。

#### **テキスト要素に書式設定を適用する (Apply formatting to a text element)**
1.  書式設定したいテキストを選択します。
2.  ページ上部のツールバーを使用して、書式設定オプションを選択します。

#### **データに基づいて動的テキストを追加する (Add dynamic text based on your data)**
ワークブックを編集中に、テキスト要素に動的テキストを注入できます。動的テキストは、数式に基づいて生成されるテキストです。これは、データに基づいて自動的に更新される要素ヘッダーやインラインテキストを表示したい場合に役立ちます。

1.  テキスト要素を選択し、動的テキストを追加したい場所にカーソルを置きます。
2.  キーボードで`=`を押すか、ワークブックのツールバーにある関数()ボタンをクリックします。
3.  テキスト要素の上に数式バーがポップアップ表示されます。
    任意のデータ要素の数式バーで行うのと同じように、数式を入力します。目的のフィールドを持つオブジェクトまたはテーブルの名前を入力し始めると、Sigmaが選択肢を提案します。
4.  キーボードで`Enter`を押して、結果の動的テキストを表示します。
5.  (任意) 書式設定を適用するには：
    * 新しい動的テキストを選択します。
    * ツールバーから書式設定オプションを選択します。

### 8-2-1. ワークブック設定の概要 (Workbook settings overview)

Sigmaのワークブックには、そのすべてのページと要素に適用される設定があります。これらの設定により、プロジェクト、ブランド、分析に最適に合うようにワークブックをカスタマイズできます。設定内では、以下のことが可能です。
* 会社のブランディングやプロジェクトに合わせて、[ワークブックのテーマ設定](https://help.sigmacomputing.com/docs/workbook-settings-overview#theme-settings)、[色の設定](https://help.sigmacomputing.com/docs/workbook-settings-overview#color-settings)、[フォントの設定](https://help.sigmacomputing.com/docs/workbook-settings-overview#font-settings)を変更する
* サイズの異なるページや画面に対応するために、[レイアウトスタイル](https://help.sigmacomputing.com/docs/workbook-settings-overview#layout-style-settings)と[レイアウト設定](https://help.sigmacomputing.com/docs/workbook-settings-overview#layout-settings)を修正する
* 重要な情報をハイライトするために、[テーブルスタイル設定](https://help.sigmacomputing.com/docs/workbook-settings-overview#table-style-settings)を編集する
* ワークブックを翻訳するために、[ワークブックのロケールを管理する](https://help.sigmacomputing.com/docs/manage-workbook-localization)

このドキュメントでは、ワークブックの設定にアクセスする方法と、構成可能なオプションについて説明します。
ワークブックのレイアウト設計に関する詳細は、「[ワークブックのレイアウトをデザインする](https://help.sigmacomputing.com/docs/design-workbook-layouts)」を参照してください。

#### **ユーザー要件 (User requirements)**
* 保存済みまたはカスタムビューで（ただし、ワークブックの公開バージョンではなく）変更を加えるには、`Full explore`権限が必要です。
* ワークブックの公開バージョンの設定を変更して保存するには、`Create, edit, and publish workbooks`権限が必要です。
詳細は、「[Account type and license overview](https://help.sigmacomputing.com/docs/account-type-and-license-overview)」を参照してください。

#### **ワークブック設定にアクセスする (Access workbook settings)**
ワークブック設定にアクセスするには、複数の方法があります。`Edit`モード中、またはカスタムビューで作業中に：
* ドキュメントメニューを選択し、`Edit` > `Show workbook settings`を選択します。
* ワークブックの背景をクリックします。サイドパネルから、`Workbook settings`を選択します。

#### **テーマ設定 (Theme settings)**
ワークブックに事前定義されたテーマを選択するか、独自のカスタムテーマを作成できます（「[ワークブックテーマの作成と管理](https://help.sigmacomputing.com/docs/workbook-themes)」を参照）。テーマは、ワークブックのカラーパレット、フォント、タイトルとテーブルのテキストサイズを含み、選択されるとワークブック全体に適用されます。個々の設定はさらに修正できます。
テーマを選択するには：
* `Theme`ドロップダウンメニューで、希望のテーマを選択します。

#### **色の設定 (Color settings)**
`Color`設定は、ワークブック内のテキスト、ボタン、背景、要素、およびビジュアライゼーションの色を制御します。

| 設定 | 説明 |
| :--- | :--- |
| **Appearance** | ワークブックの`Light`または`Dark`テーマを選択します。|
| **Theme colors > Swap preset** | ワークブックのテキスト、ボタン、背景、チャートに事前定義されたカラーテーマを設定します。|
| **Theme colors > Text** | テーマのワークブックテキストの色を設定します。|
| **Theme colors > Highlight** | テーマのボタン、リンクテキスト、選択インジケータの色を設定します。|
| **Theme colors > Surface** | テーマの要素の背景、境界線、アイコンの色を設定します。|
| **Override colors > Canvas** | テーマのキャンバス色とは異なる、ワークブックキャンバスのカスタム色を設定します。`Clear override`を選択してデフォルトに戻します。|
| **Categorical colors/Sequential colors/diverging colors** | これらはワークブック内のチャートのカラースキームです。事前定義されたパレットを選択するか、チャートに使用するカスタム色を設定できます。|
| **Invert visualization tooltips** | ツールチップのテーマのテキストと背景色を反転させます。|

色を指定する際、事前定義されたパレットから色を選択したり、16進コードを指定したり、スポイトを使用してコンピュータで開いているウィンドウやドキュメントから色を選んだり、グラデーションから色を選択したりできます。
変更を元に戻して設定をデフォルトにリセットするには、`Revert to default`を選択します。

#### **フォント設定 (Font settings)**
`Font`設定は、ワークブック全体のフォントを制御します。

| 設定 | 説明 |
| :--- | :--- |
| **Text font** | 要素のタイトル、説明、テーブルヘッダーなど、非データワークブックテキストのフォントを設定します。デフォルトはSource Sans Proです。|
| **Data font** | ワークブックデータのフォントを設定します。デフォルトはRobotoです。|
| **Title font** | 要素タイトルのフォントサイズと色を設定します。|

変更を元に戻して設定をデフォルトにリセットするには、`Revert to default`を選択します。

#### **レイアウトスタイル設定 (Layout style settings)**
`Layout style`設定は、ワークブックのページと要素のレイアウトを制御します。

| 設定 | 説明 |
| :--- | :--- |
| **Page width** | ワークブックのすべてのページの幅を設定します。デフォルトは`Full`です。`Custom`を選択して、ワークブックページの最大幅を設定します。|
| **Spacing** | 要素間の間隔のサイズを設定します。|
| **Corner** | 要素の角の形状を設定します。四角、丸、またはピル形状の角から選択します。デフォルトは丸です。|
| **Data element style > Padding** | データ要素のパディングを設定します。チェックボックスを選択または選択解除して、データまたはコントロール要素の周りにパディングを追加または削除します。|
| **Data element style > Background** | データまたはコントロール要素のカスタム背景色を設定します。`Auto`に設定して、テーマの要素の背景と一致させます。|

変更を元に戻して設定をデフォルトにリセットするには、`Revert to default`を選択します。

#### **テーブルスタイル設定 (Table style settings)**
`Table style`設定は、テーブル、ピボットテーブル、入力テーブルの書式と表示を制御します。テーブルスタイルオプションの詳細については、「[Customize table style](https://help.sigmacomputing.com/docs/format-and-customize-a-table)」を参照してください。

| 設定 | 説明 |
| :--- | :--- |
| **Table style presets** | すべてのテーブルスタイルオプションを構成するためにプリセットを適用します。|
| **Cell spacing** | テーブルセル内のテキストの周りのパディングを設定します。|
| **Grid lines** | セルの境界線の表示方法を決定します。|
| **Show banding** | データ行の背景色を交互に表示します。|
| **Header** | テーブルヘッダーを書式設定します。|
| **Subheader** | サブヘッダーを書式設定します（ピボットテーブルにのみ適用可能）。|
| **Cell** | データセルを書式設定します。|

変更を元に戻して設定をデフォルトにリセットするには、`Revert to default`を選択します。

#### **レイアウト設定 (Layout settings)**
`Layout`設定は、ワークブックのレイアウトを制御します。

| 設定 | 説明 |
| :--- | :--- |
| **Always show grid** | グリッド線のオン/オフを切り替えます。デフォルトでは、レイアウトグリッドはオフです。グリッドがオフの場合でも、キャンバス上で要素を移動する際には表示されます。グリッドがオンの場合、編集時や保存済み・カスタムビューでは常に表示されますが、ワークブックの閲覧時には表示されません。|
| **Custom mobile layout** | レイアウトがデスクトップとモバイルデバイスの両方で使用されるかどうかを切り替えます。詳細は、「[Design workbook layouts](https://help.sigmacomputing.com/docs/design-workbook-layouts)」の「Previewing and editing different device layouts」を参照してください。|

変更を元に戻して設定をデフォルトにリセットするには、`Revert to default`を選択します。

#### **ロケールを管理する (Manage locales)**
`Manage locales`リンクは、Manage localesパネルを開きます。「[Manage workbook localization](https://help.sigmacomputing.com/docs/manage-workbook-localization)」を参照してください。

### 8-2-3. データ要素のソート順をカスタマイズする (Customize the sort order of data elements)

Sigmaでは、テーブル、ピボットテーブル、およびビジュアライゼーションのソート順をカスタマイズできます。データ内の任意の列でソートでき、その列が非表示であったり、ビジュアライゼーションで使用されていなくてもかまいません。テーブルとピボットテーブルでは、列内のnull値のソート順も定義できます。

#### **ビジュアライゼーションのソート順をカスタマイズする (Customize the sort order of a visualization)**
棒グラフなどのビジュアライゼーションのソート順をカスタマイズするには、以下を実行します。

* **始める前に:** カスタムソートを構成するには、ワークブックを編集中またはカスタマイズ中である必要があります。

1.  ビジュアライゼーション上の任意の場所を右クリックするか、`More`を選択します。
2.  表示されるメニューで、`Sort` > `Custom sort...`を選択します。
3.  `Custom Sort`モーダルで、`Sort by`にソート基準となる列を選択します。
4.  `Order`で、`Ascending`または`Descending`を選択します。
5.  `Aggregation`で、集計タイプを選択します。テキスト列は集計を必要としません。
6.  `Save`をクリックします。
    > 💡
    > エリアチャートや散布図のようなレイヤー化されたビジュアライゼーションでは、値のソート順がレイヤーの表示順に影響します。

#### **ピボットテーブルのソート順をカスタマイズする (Customize the sort order of a pivot table)**
ピボットテーブルを1つの列でソートし、その列のnull値のソート順を選択するには、以下を実行します。

* **始める前に:** カスタムソートを構成するには、ワークブックを編集中またはカスタマイズ中である必要があります。

1.  ピボット列またはピボット行について、下矢印()を選択して列メニューを開きます。
2.  表示されるメニューで、`Sort` > `Custom sort...`を選択します。
3.  `Custom Sort`モーダルに、選択した列が表示されます。
4.  `Sort by`で、選択した列をソートするための基準となる列を選択します。ソート列は、表示されていなくてもピボットテーブル内に存在する必要があります。
5.  `Order`で、`Ascending`または`Descending`を選択します。
6.  `Aggregation`で、集計タイプを選択します。
7.  `Nulls`で、`Connection Default`, `First`, `Last`から選択します。
8.  `Save`をクリックします。

##### **特定の値の列をソートする (Sort a specific values column)**
他の列とは異なる方法で特定の値の列をソートすることを選択できます。例えば、ピボットテーブルの`High Risk`列のみを降順でソートするには、以下を実行します。
1.  ピボットテーブルで、異なるソートをしたい列を探し、右クリックしてコンテキストメニューを開きます。
2.  値に対して昇順()または降順()のソートを選択します。

#### **テーブルのソート順をカスタマイズする (Customize the sort order of a table)**
テーブルを1つまたは複数の列でソートし、それらの列のnull値のソート順を選択できます。
> 💡
> 複数の列でソートしたい場合は、テーブルに適用すべき順序でソート規則を定義します。定義した後でカスタムソート規則の順序を変更することはできません。

テーブルのソート順をカスタマイズするには、以下を実行します。
1.  テーブルの任意の列で、下矢印()を選択して列メニューを開きます。
2.  表示されるメニューで、`Sort`オプションの隣にある`Custom sort...`()を選択します。
3.  `Sort`モーダルで、`Column name`にソート基準となる列を選択します。
4.  `Sort order`で、`A to Z`または`Z to A`を選択します。
5.  `Nulls`で、`Default`, `First`, `Last`から選択します。
6.  複数の列でソートするには、`Add new`を選択し、別の列に対して手順を繰り返します。
7.  `Save`をクリックします。

#### **例：ヘルパー列を使用して順序のない列をソートする**
非表示の列でソート順をカスタマイズできるため、文字列値の列の順序を定義するためにヘルパー列を作成できます。曜日の名前、月の名前、または定義した順序に従って他のテキスト列をソートするためにヘルパー列を作成できます。

例えば、Sigmaサンプルデータベースの`EXAMPLES.SF_RESTAURANTS.VIOLATION_TYPES`テーブルには、"High Risk", "Moderate Risk", "Low Risk"の3つのリスクタイプをリストする`Risk Category`列が含まれています。リスクカテゴリを最も深刻なものから順にソートしたい場合、ソート順を定義する列を作成し、そのヘルパー列を使用するビジュアライゼーションのカスタムソートを設定できます。
1.  ワークブックを編集中に、SigmaサンプルデータベースのExamplesスキーマから`VIOLATION_TYPES`テーブルをデータソースとして使用するテーブルを追加します。
2.  テーブルに`Risk Category Sort`という名前の列を追加します。列には以下の数式を使用します。
    `Switch([Risk Category], "High Risk", 1, "Moderate Risk", 2, "Low Risk", 3)`
3.  テーブルから子ビジュアライゼーションとして棒グラフを作成し、X軸に`Risk Category`列を、Y軸に`Violation Type Id`を使用します。
4.  `More` > `Sort` > `Custom sort...`を選択して棒グラフをソートします。
5.  `Sort By`で、`Risk Category Sort`列を選択します。
6.  `Order`で、デフォルトの`Ascending`を選択したままにして、最も深刻(1)から最も深刻でない(3)の順にソートします。
7.  `Aggregation`で、`Sum`を選択します。
8.  `Save`をクリックし、チャートが期待通りにソートされていることを確認します。

### 8-2-2. 要素のタイトルをカスタマイズする (Customize element title)

タイトルを使用すると、ワークブック内の個々のデータ要素（ビジュアライゼーション、テーブル、ピボットテーブル）と入力テーブルを識別できます。要素のタイトルをカスタマイズして、コンテキストを提供したり、インサイトを伝えたり、アクセシビリティを向上させたりすることができます。

このドキュメントでは、タイトルの表示/非表示を変更し、動的な値、書式設定ツール、および説明を使用してカスタムタイトルを作成する方法について説明します。

#### **ユーザー要件 (User requirements)**
ワークブック要素のタイトルをカスタマイズする機能には、以下が必要です。
* `Create, edit, and publish workbooks`および/または`Full Explore`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

#### **デフォルトの要素タイトル (Default element titles)**
Sigmaは、要素タイプに応じてデフォルトの要素タイトルを作成します。
* **ビジュアライゼーション:** タイトルは、チャートプロパティに適用されたメトリック値やその他のデータ属性に基づいて自動生成されます。ユーザーがビジュアライゼーション要素のタイトルをカスタマイズするまで、Sigmaはチャートプロパティが変更されるたびに自動更新します。タイトルがカスタマイズされると、自動更新は適用されなくなります。
* **テーブル:** タイトルは、データソース（データベーステーブル名、CSVファイル名、または親要素）またはデータ統合のタイプ（カスタムSQL、結合、または和集合）を反映します。
* **ピボットテーブル:** タイトルはデフォルトで`New Pivot Table`になります。
* **入力テーブル:** タイトルはデフォルトで`New Input Table`または`New Linked Input Table`になります。

#### **タイトルを表示または非表示にする (Show or hide the title)**
要素のタイトルの表示/非表示を変更します。
1.  ワークブックのカスタマイズを開始するか、編集用に開いてから、変更したい要素を選択します。
2.  サイドパネルで`Format`を選択し、`Title`ヘッダーをクリックしてセクションを展開します。
3.  要素タイトルの表示/非表示を変更するには、`Show title`トグルをオンまたはオフにします。
    * タイトルを表示するには、トグルをオンにします。
    * タイトルを非表示にするには、トグルをオフにします。

#### **タイトルテキストを編集する (Edit the title text)**
要素のタイトルテキストは、サイドパネルの`Format`タブの`Title`セクション、または要素内で直接インライン編集を使用して、2つの方法で編集できます。

##### **要素フォーマットパネル (Element format panel)**
1.  ワークブックのカスタマイズを開始するか、編集用に開いてから、変更したい要素を選択します。
2.  サイドパネルで`Format`を選択し、`Title`ヘッダーをクリックしてセクションを展開します。
3.  `Show title`の下のテキストフィールドに、希望のタイトルを入力し、`Enter`を押すか、テキストフィールドの外側をクリックして変更を適用します。

##### **インライン編集 (Inline edit)**
1.  ワークブックのカスタマイズを開始するか、編集用に開きます。
2.  変更したい要素を探し、タイトルをクリックしてテキスト編集を有効にします。
3.  希望のタイトルを入力し、`Enter`を押すか、テキストフィールドの外側をクリックして変更を適用します。

#### **動的タイトルを作成する (Create a dynamic title)**
動的な値を使用して、選択されたコントロール値に適応する、より関連性が高く詳細な要素タイトルを作成します。数式でコントロール値を参照する詳細については、「[コントロール値をパラメータとして参照する](https://help.sigmacomputing.com/docs/reference-control-values-as-parameters)」を参照してください。

1.  ワークブックのカスタマイズを開始するか、編集用に開いてから、変更したい要素を選択します。
2.  「[タイトルテキストを編集する](#edit-the-title-text)」セクションで説明されているいずれかの方法でタイトルの編集を開始します。
3.  タイトルテキスト内で、動的な値を追加したい場所に`=`を入力します。Sigmaはすぐに数式バーと`Reference label`フィールドを含むオーバーレイを表示します。
4.  動的な値を構成します。
    * 数式バーに、角括弧で囲んだコントロールIDまたは要素タイトル/列を入力します。例：`[date-range]`または`[Plugs_Electronics/Store Region]`。
    * 関数を使用してカスタム計算を生成したり、必要に応じてコントロールや列の値を変換したりすることもできます。
    > 💡
    > 日付または日付範囲コントロールを参照する場合、`date functions`を使用して値の表示をカスタマイズします。
    > 例えば、選択された日付範囲の終了日が`01/01/2024`の場合、`DateFormat([date-range].end, “%Y-%m”)`と入力すると、動的タイトルの値が`2024-01`として表示されます。
    > あるいは、`DateFormat([date-range].end, “%b %Y”)`と入力すると、動的タイトルの値が`Jan 2024`として表示されます。
5.  [任意] `Reference label`フィールドに、動的な値を識別するラベルを入力します。このラベルは、数式、ワークブックのリネージ、および利用可能な要素ソースのリストなど、製品の他の場所で要素タイトルが参照される際に、動的な値の代わりに使用されます。

#### **タイトルフォーマットをカスタマイズする (Customize the title format)**
タイトルのフォントの太さ、サイズ、色をカスタマイズし、タイトルのテキスト配置を決定します。

1.  ワークブックのカスタマイズを開始するか、編集用に開いてから、変更したい要素を選択します。
2.  サイドパネルで`Format`を選択し、`Title`ヘッダーをクリックしてセクションを展開します。
3.  書式設定ツールを使用して、必要に応じてタイトルをカスタマイズします。

| | |
| :--- | :--- |
| **Bold (太字)** | フォントの太さを変更します。太字フォントが適用されると、アイコンは灰色の背景で表示されます。 |
| **Font color (フォントの色)** | 16進数値を入力するか、カラーパレットまたはピッカーからオプションを選択します。 |
| **Font size (フォントサイズ)** | フォントサイズを選択します (10-48px)。 |
| **Alignment (配置)** | 要素内のテキスト配置を選択します（左、中央、または右）。 |

#### **説明を追加する (Add a description)**
要素に関する追加のコンテキストを提供し、それをサブタイトルまたはツールチップとして表示します。
> 💡
> 要素には簡潔なタイトルを付け、要素の内容に関する追加の詳細は説明を使用してください。

1.  ワークブックのカスタマイズを開始するか、編集用に開いてから、変更したい要素を選択します。
2.  サイドパネルで`Format`を選択し、`Title`ヘッダーをクリックしてセクションを展開します。
3.  `Show description`トグルをオンにします。
4.  説明（最大200文字）を入力し、書式設定ツールを使用して必要に応じてテキストの色、サイズ、太さをカスタマイズします。
5.  `Description display`セクションで、説明が要素内でどのように表示されるかを決定するオプションを選択します。
    * **Auto (自動):** 要素の高さに応じて、サブタイトルまたはツールチップとして表示されます。
        * 高さが13グリッド行以上の場合、説明はサブタイトルとして表示されます。
        * 高さが12グリッド行以下の場合、説明はツールチップとして表示されます。
    * **Subtitle (サブタイトル):** 要素タイトルの下に表示されます。
        * サブタイトルは最大2行までテキストを折り返します。テキストが2行目を超えると、省略記号(...)で切り捨てられます。ユーザーは、切り捨てられたサブタイトルにカーソルを合わせることで完全な説明を表示できます。
    * **Tooltip (ツールチップ):** 要素タイトルの隣に情報アイコン()のツールチップとして表示されます。

#### **データがない場合のテキストをカスタマイズする (Customize no data text)**
ユーザーがデータ要素をターゲットとするコントロールに無効な値を入力した場合など、要素に表示するデータがない場合に表示されるテキストをカスタマイズするには、以下を実行します。
1.  ワークブックのカスタマイズを開始するか、編集用に開いてから、変更したい要素を選択します。
2.  サイドパネルで`Format`を選択し、`Title`ヘッダーをクリックしてセクションを展開します。
3.  `Display label for no data`に、代わりに使用するテキストを入力します。例えば、チャートをターゲットとするテキストコントロールを参照して「有効な店舗名を入力してください」など。

### 8-2-3. 要素の背景とスタイルをカスタマイズする (Customize element background and styles)

すべてのデータ要素（チャート、テーブル、ピボットテーブル）、入力テーブル、およびテキスト要素のスタイルをカスタマイズして、背景色、境界線、パディングを追加し、角の形状を変更することができます。

スタイルは[ワークブックテーマ](https://help.sigmacomputing.com/docs/workbook-themes)の一部として設定することもでき、個々の要素のデザインをカスタマイズして、アクセシビリティを向上させたり、視覚的な階層を作成したり、会社のブランディングとの整合性を確保したりすることができます。

#### **ユーザー要件 (User requirements)**
ワークブック要素のスタイルをカスタマイズする機能には、以下が必要です。
* `Explore workbook`および/または`Create, edit, and publish workbooks`権限が有効になっているアカウントタイプを割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`のワークブック権限を付与されている必要があります。

#### **要素にパディングを追加する (Add padding to an element)**
ほとんどの要素にパディングを追加できます。マップビジュアライゼーションや画像要素にはパディングを追加できません。
1.  `Explore`または`Edit`モードでワークブックを開き、変更したい要素を選択します。
2.  エディタパネルで`Format`を選択し、`Element style`ヘッダーをクリックしてセクションを展開します。
3.  `Padding`チェックボックスを選択して、要素の周りにパディングを追加します。パディングを削除するには、チェックボックスの選択を解除します。
4.  要素は、スタイルの変更を反映して更新されます。

#### **カスタム背景色を追加または変更する (Add or change a custom background color)**
ほとんどの要素に背景色を追加できます。マップビジュアライゼーションや画像要素には背景色を追加できません。
1.  `Explore`または`Edit`モードでワークブックを開き、変更したい要素を選択します。
2.  エディタパネルで`Format`を選択し、`Element style`ヘッダーをクリックしてセクションを展開します。
3.  `Background color`ドロップダウンをクリックし、16進数値を入力するか、カラーパレットまたはピッカーからオプションを選択します。
4.  要素は、カスタム背景色を使用するように更新されます。

#### **カスタム背景色を削除する (Remove a custom background color)**
1.  `Explore`または`Edit`モードでワークブックを開き、変更したい要素を選択します。
2.  エディタパネルで`Format`を選択し、`Element style`ヘッダーをクリックしてセクションを展開します。
3.  `Background color`ドロップダウンをクリックし、`None`を選択します。
4.  要素は、透明な背景色を使用するように更新されます。

#### **要素に境界線を追加する (Add a border to an element)**
ほとんどの要素に境界線を追加できます。マップビジュアライゼーションや画像要素にはいつでも境界線を追加できますが、他の要素では境界線を追加するためにパディングが必要です。「[要素にパディングを追加する](#add-padding-to-an-element)」を参照してください。
1.  `Explore`または`Edit`モードでワークブックを開き、変更したい要素を選択します。
2.  エディタパネルで`Format`を選択し、`Element style`ヘッダーをクリックしてセクションを展開します。
3.  `Border`で、デフォルトの`None`のままにするか、ドロップダウンメニューを開いて`1`, `2`, `3`ピクセル幅の境界線を選択します。境界線を選択すると、色も選択できます。境界線を削除するには、ドロップダウンメニューを選択して`None`を選択します。
4.  要素は、スタイルの変更を反映して更新されます。

#### **要素の角の形状を変更する (Change the corner shape of an element)**
任意の要素の角の形状を変更できます。
1.  `Explore`または`Edit`モードでワークブックを開き、変更したい要素を選択します。
2.  エディタパネルで`Format`を選択し、`Element style`ヘッダーをクリックしてセクションを展開します。
3.  `Corner`で、要素の角を四角、丸、またはピル形状にするかを選択します。
4.  要素は、スタイルの変更を反映して更新されます。

#### **テキスト要素の配置を変更する (Change the alignment of a text element)**
1.  `Explore`または`Edit`モードでワークブックを開き、変更したい要素を選択します。
2.  エディタパネルで`Format`を選択し、`Element style`ヘッダーをクリックしてセクションを展開します。
3.  `Alignment`で、要素内のテキストを上揃え、中央揃え、または下揃えにするかを選択します。
     要素は、スタイルの変更を反映して更新されます。

### 8-2-4. データ要素のソート順をカスタマイズする (Customize the sort order of data elements)

Sigmaでは、テーブル、ピボットテーブル、およびビジュアライゼーションのソート順をカスタマイズできます。データ内の任意の列でソートでき、その列が非表示であったり、ビジュアライゼーションで使用されていなくてもかまいません。テーブルとピボットテーブルでは、列内のnull値のソート順も定義できます。

#### **ビジュアライゼーションのソート順をカスタマイズする (Customize the sort order of a visualization)**
棒グラフなどのビジュアライゼーションのソート順をカスタマイズするには、以下を実行します。

* **始める前に:** カスタムソートを構成するには、ワークブックを編集中またはカスタマイズ中である必要があります。

1.  ビジュアライゼーション上の任意の場所を右クリックするか、`More`を選択します。
2.  表示されるメニューで、`Sort` > `Custom sort...`を選択します。
3.  `Custom Sort`モーダルで、`Sort by`にソート基準となる列を選択します。
4.  `Order`で、`Ascending`または`Descending`を選択します。
5.  `Aggregation`で、集計タイプを選択します。テキスト列は集計を必要としません。
6.  `Save`をクリックします。
    > 💡
    > エリアチャートや散布図のようなレイヤー化されたビジュアライゼーションでは、値のソート順がレイヤーの表示順に影響します。

#### **ピボットテーブルのソート順をカスタマイズする (Customize the sort order of a pivot table)**
ピボットテーブルを1つの列でソートし、その列のnull値のソート順を選択するには、以下を実行します。

* **始める前に:** カスタムソートを構成するには、ワークブックを編集中またはカスタマイズ中である必要があります。

1.  ピボット列またはピボット行について、下矢印()を選択して列メニューを開きます。
2.  表示されるメニューで、`Sort` > `Custom sort...`を選択します。
3.  `Custom Sort`モーダルに、選択した列が表示されます。
4.  `Sort by`で、選択した列をソートするための基準となる列を選択します。ソート列は、表示されていなくてもピボットテーブル内に存在する必要があります。
5.  `Order`で、`Ascending`または`Descending`を選択します。
6.  `Aggregation`で、集計タイプを選択します。
7.  `Nulls`で、`Connection Default`, `First`, `Last`から選択します。
    * **Connection Default**は、データウェアハウスで使用されているのと同じ順序に一致します。
    * **First**は、列の最初にnull値をリストし、残りの列の値をソート順でソートします。
    * **Last**は、ソートされた列の値の後に、列の最後にnull値をリストします。
8.  `Save`をクリックします。

##### **特定の値の列をソートする (Sort a specific values column)**
他の列とは異なる方法で特定の値の列をソートすることを選択できます。例えば、ピボットテーブルの`High Risk`列のみを降順でソートするには、以下を実行します。
1.  ピボットテーブルで、異なるソートをしたい列を探し、右クリックしてコンテキストメニューを開きます。
2.  値に対して昇順()または降順()のソートを選択します。
    その列の値はそれに応じてソートされます。
3.  [任意] カスタムソートを調整します。例えば、その列でnull値がどのようにソートされるかを変更するには：
    * a. 関連するピボット行について、下矢印()を選択して列メニューを開きます。
    * b. 表示されるメニューで、`Sort` > `Custom sort...`を選択します。
    * c. 値のソートを希望通りに調整します。例えば、`Nulls`については、null値を最後にソートすることを選択します。
    * d. `Save`をクリックします。

#### **テーブルのソート順をカスタマイズする (Customize the sort order of a table)**
テーブルを1つまたは複数の列でソートし、それらの列のnull値のソート順を選択できます。
> 💡
> 複数の列でソートしたい場合は、テーブルに適用すべき順序でソート規則を定義します。定義した後でカスタムソート規則の順序を変更することはできません。

* **始める前に:** カスタムソートを構成するには、ワークブックを編集中または探索中である必要があります。

テーブルのソート順をカスタマイズするには、以下を実行します。
1.  テーブルの任意の列で、下矢印()を選択して列メニューを開きます。
2.  表示されるメニューで、`Sort`オプションの隣にある`Custom sort...`()を選択します。
3.  `Sort`モーダルで、`Column name`にソート基準となる列を選択します。
4.  `Sort order`で、`A to Z`または`Z to A`を選択します。異なる列は異なるオプションを表示します。日付列は`Oldest to Newest`または`Newest to Oldest`でソートでき、数値列は`Largest to smallest`または`Smallest to largest`でソートできます。
5.  `Nulls`で、`Default`, `First`, `Last`から選択します。
6.  複数の列でソートするには、`Add new`を選択し、別の列に対して手順を繰り返します。
7.  `Save`をクリックします。

#### **例：ヘルパー列を使用して順序のない列をソートする (Example: Use a helper column to sort an unordered column)**

非表示の列でソート順をカスタマイズできるため、文字列値の列の順序を定義するためにヘルパー列を作成できます。曜日の名前、月の名前、または定義した順序に従って他のテキスト列をソートするためにヘルパー列を作成できます。

例えば、Sigmaサンプルデータベースの`EXAMPLES.SF_RESTAURANTS.VIOLATION_TYPES`テーブルには、"High Risk", "Moderate Risk", "Low Risk"の3つのリスクタイプをリストする`Risk Category`列が含まれています。リスクカテゴリを最も深刻なものから順にソートしたい場合、ソート順を定義する列を作成し、そのヘルパー列を使用するビジュアライゼーションのカスタムソートを設定できます。

1.  ワークブックを編集中に、SigmaサンプルデータベースのExamplesスキーマから`VIOLATION_TYPES`テーブルをデータソースとして使用するテーブルを追加します。
2.  テーブルに`Risk Category Sort`という名前の列を追加します。列には以下の数式を使用します。
    `Switch([Risk Category], "High Risk", 1, "Moderate Risk", 2, "Low Risk", 3)`
    この数式は、`Risk Category`列の各テキスト値に、最も深刻なものから最も深刻でないものへと数値を適用します。
3.  テーブルから子ビジュアライゼーションとして棒グラフを作成し、X軸に`Risk Category`列を、Y軸に`Violation Type Id`を使用します。`Violation Type Id`列は、すべての違反のカウントになるように集計されます。
4.  `More` > `Sort` > `Custom sort...`を選択して棒グラフをソートします。
5.  `Sort By`で、`Risk Category Sort`列を選択します。
6.  `Order`で、デフォルトの`Ascending`を選択したままにして、最も深刻(1)から最も深刻でない(3)の順にソートします。
7.  `Aggregation`で、`Sum`を選択します。この例では集計は無関係です。
8.  `Save`をクリックし、チャートが期待通りにソートされていることを確認します。

別の例については、Sigmaコミュニティの「[How to sort a fiscal date column](https://community.sigmacmacomputing.com/dashboards-and-workbooks/how-to-sort-a-fiscal-date-column-292)」を参照してください。


### 8-2-5. データ要素で表示される値を制限する (Limit displayed values in a data element)

グループ化されたテーブル、ピボットテーブル、またはチャートの列で表示される値を制限できます。

例えば、ピボットテーブルで各店舗地域のトップ3のパフォーマンス店舗のみを表示するには、表示される店舗を総販売製品数でソートされたトップ3に制限できます。

[Top Nフィルター](https://help.sigmacomputing.com/docs/data-element-filters#top-n)とは異なり、表示値を制限すると、計算された合計やその他の値に影響を与えることなく、表示される値を変更できます。この制限は`VisibilityLimit`関数を使用して適用することもできます。

#### **表示値を制限する (Limit the display values)**
グループ化されたテーブル、ピボットテーブル、またはチャートで表示される値を制限するには、以下を実行します。

1.  下矢印()を選択し、`Transform > Limit display values`を選択します。
2.  `Display`で、値の上位または下位の数を表示するかどうかを選択し、数値を入力します。
    * 例えば、下位10個の値を表示し、残りの値を「Others」カテゴリにグループ化することを選択します。
3.  `by`で、集計された列を順序付けるために使用する関数を選択します。`Rank`、`RankDense`、または`RowNumber`のいずれかを選択します。
4.  `Sort by`で、上位または下位の数の値を選択する際にソートする列を選択します。列が集計されていない場合は、集計する関数を選択します。
5.  `Done`をクリックします。

集計されていない列を集計することを選択した場合、Sigmaは表示値が制限された列をグループ化列として、集計された列をグルーピング内の計算として、テーブルにグルーピングを作成します。
ピボット行またはテーブル列で表示値を制限すると、「Others」カテゴリは列のリストの末尾に追加されます。

#### **制限を解除する (Remove a limit)**
表示値を制限した後、制限を解除できます。
1.  表示値が制限されている列について、下矢印()を選択して列メニューを開き、`Transform > Limit display values`を選択します。
2.  `Limit display values`モーダルで、`Remove limit`を選択します。

#### **制限事項 (Limitations)**
* テキスト列の表示値のみを制限できます。数値や日付などの他のデータ型はサポートされていません。
* 表示値を制限するために使用される列のソート順を変更すると、「Others」カテゴリの値は、RankおよびRankDense関数がソート順に依存するため、ソートに応じて変化します。

### 9-1-1. Sigmaデータアプリについて (About Sigma data apps)

データアプリは、あなたのデータプラットフォームに直接接続し、ライブデータ、ワークフロー、およびユーザー入力をシームレスに統合する、目的別に構築されたソリューションです。Sigmaの書き戻し機能、高度なレイアウト機能、およびリッチなユーザーインタラクティビティを活用して、標準的なデータ分析やレポートを超えた、動的でユーザー主導のアプリケーションを構築できます。単純なデータ収集フォームや承認フローから、より複雑なパイプライン管理やチケット発行システムまで、Sigmaは増え続ける実用的なデータアプリのユースケースをサポートしています。

#### **データアプリを構成するもの (What makes a data app?)**
ワークブックのどの機能もデータアプリに組み込むことができますが、インタラクティブなデータアプリ体験には3つの主要なコンポーネントがあります：入力テーブル、レイアウト要素、およびアクションです。

1.  **データ収集のための入力テーブル (Input tables for data collection)**
    入力テーブルを使用すると、ユーザーは安全に新しいデータポイントを追加したり、既存の入力を更新したり、データプラットフォームからのデータを補強したりできます。ユーザーからデータを収集するこの能力は、データアプリの中核機能にとって不可欠であり、ユーザーのインタラクションがデータを変更し、シナリオモデリング、予測、照合などのための特定の出力を生成することを可能にします。
    入力テーブルに関する詳細は、「[Intro to input tables](https://help.sigmacomputing.com/docs/input-tables-overview)」を参照してください。

2.  **インターフェースデザインのためのレイアウト要素 (Layout elements for interface design)**
    レイアウト要素は、ナビゲートしやすいクリーンで焦点の合ったインターフェースをデザインするためのツールを提供します。コンテナとモーダルは、データとコンテンツの配信方法を最適化し、情報を整理し、ワークフローをガイドし、ユーザーが必要なときに必要な場所でインサイトを浮かび上がらせることを可能にします。レイアウト要素を実装して、ユーザーが効率的にデータ入力や詳細へのドリルダウンを行えるようにし、不要なワークブックの散らかりから解放します。
    レイアウト要素に関する詳細は、「[Intro to layout elements](https://help.sigmacomputing.com/docs/intro-to-layout-elements)」を参照してください。

3.  **ユーザーインタラクティビティのためのアクション (Actions for user interactivity)**
    アクションは、ユーザーインタラクティビティを自動化するレスポンシブなデータアプリを構築するために不可欠です。アクションの条件、トリガー、および効果を構成して、適応的なデータ探索をサポートし、反復可能なプロセスを実行し、迅速で関連性の高いインサイトを生成する、スケーラブルでデータ駆動型のワークフローを合理化します。
    詳細は、「[Intro to actions](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

#### **データアプリのリソース (Data apps resources)**
以下のリソースは、始めたばかりの方でも、ワークフローを最適化するさらなる方法を探している方でも、独自のデータアプリを開発するのに役立ちます。

### 9-1-2. データアプリチュートリアル：従業員フィードバックアンケートの構築

このチュートリアルでは、基本的なデータ収集アプリを効率的に構築するために必要な基本とベストプラクティスを学びます。このアプリには、入力テーブルに以下の情報を収集・記録する、シンプルな従業員フィードバックフォームが含まれています。
* 従業員のセンチメント
* ネットプロモータースコア（NPS）評価
* 職場の好み
* リーダーシップへのフィードバック
* フォーム送信日

基本的なデータ収集アプリとして、結果として得られるソリューションはユーザー入力をあなたのデータプラットフォームに書き戻しますが、ソースデータを統合したり、分析機能を備えたりはしません。しかし、両方とも、拡張された目的に合わせてデータアプリに組み込むことができます。

このチュートリアルを正常に完了すると、以下に埋め込まれているような動作するデータアプリが完成します。フォームを送信して、データが`Form submissions`入力テーブルにどのように記録されるかを確認できます。
> 📘
> 以下の入力テーブルは、フォームの送信がどのように記録されるかを示すために表示されています。このデータアプリの実際の運用では、入力テーブルはフォーム回答者には表示されません。

#### **必要なタスク (Required tasks)**
従業員アンケートデータアプリを構築するには、以下のタスクを記載された順序で完了する必要があります。
* **タスク1:** ワークブックを作成して保存する
* **タスク2:** 入力テーブルを構築する
* **タスク3:** フォームを構築する
* **タスク4:** インタラクティビティを構成する

#### **データアプリの主要な考慮事項 (Key considerations for data apps)**
データアプリは、多くの場合、複数のデータテーブル、コントロール要素、アクションなどを含む、いくつかの依存関係と相互接続されたコンポーネントのレイヤーで構築されます。単純なデータ収集フォームを構築する場合でも、既存のワークブックコンテンツを活用する場合でも、データアプリのスコープを拡張する場合でも、参照整合性（データ、要素などの間の関係の有効性と一貫性）を維持することは課題となる可能性があります。

参照の問題を防ぐためには、ワークブックアーキテクチャとレイアウト要素を利用してデータアプリのコンポーネントを整理しつつ、明確で一貫した命名規則を実装することが重要です。

#### **タスク1：ワークブックを作成して保存する (Task 1: Create and save a workbook)**
ワークブックはデータアプリが構築される基盤であるため、最初のタスクは新しいワークブックを作成して保存することです。
> 💡
> Sigmaは、保存されていない/名前のないすべてのワークブックを、タイムスタンプ付きの探索として`Recent`ページに自動的に保存します。

1.  Sigmaの**ホーム**ページから、`Create New`をクリックし、メニューから`Workbook`を選択します。
2.  新しい、保存されていないワークブックが探索として開きます。名前付きのワークブックとして保存するには、ドキュメントヘッダーの`Save as`をクリックします。
3.  `Save as`モーダルで、ワークブックに名前を付け、保存場所を選択します。
    * `Name`フィールドに、`Employee survey`と入力します。
    * `Destination`セクションで、`My documents`フォルダを選択したままにします（デフォルト）。
    * モーダルのフッターで`Create folder`をクリックして`My documents`にサブフォルダを追加し、サブフォルダ名として`My data apps`と入力します。
    * 新しい`My data apps`サブフォルダを選択します。
4.  `Save`をクリックします。

#### **タスク2：入力テーブルを構築する (Task 2: Build an input table)**
これで、データアプリの構築準備が整いました。まず、フォームの送信からデータを記録するための入力テーブルを作成することから始めます。
> 💡
> 入力テーブルから始めることで、収集したいデータに基づいてテーブルスキーマを確立できます。

##### **2.1 入力テーブル要素を作成する**
入力テーブルは、フォームの送信を新しいデータポイントとして記録し、データプラットフォームに書き込みます。
1.  `Add element`バーで、`Input` > `Empty`を選択します。
2.  `Select source`モーダルで、`Sigma Sample Database`接続を選択し、`Create`をクリックします。
3.  ワークブックに、デフォルトのテキスト列を持つ新しい入力テーブル要素が表示されます。デフォルトのタイトル（"New input table"）をダブルクリックして編集を有効にし、`Form submissions`と入力して名前を変更します。

##### **2.2 入力テーブルに列を追加する**
各列は、フォームの送信を通じて収集されるデータポイントに対応します。
> 💡
> 明確な構造と関連するデータ型で入力テーブルを構築することで、データアプリのインタラクティビティを構成する際に、列とフォームフィールドの効率的なマッピングが保証されます。

* **従業員の満足度を記録する列を追加する：**
    1.  デフォルトのテキスト列のヘッダーをダブルクリックし、`Sentiment`と入力して名前を変更します。
* **NPS評価を記録する列を追加する：**
    1.  テーブルヘッダーでプラス(+)アイコンをクリックし、メニューから`Number`を選択します。
    2.  新しい列のヘッダーをダブルクリックし、`NPS rating`と入力して名前を変更します。
* **従業員の職場の好みを記録する列を追加する：**
    1.  テーブルヘッダーでプラス(+)アイコンをクリックし、`Text`を選択します。
    2.  新しい列のヘッダーをダブルクリックし、`Workplace preference`と入力して名前を変更します。
* **リーダーシップに関する従業員のフィードバックを記録する列を追加する：**
    1.  テーブルヘッダーでプラス(+)アイコンをクリックし、`Text`を選択します。
    2.  新しい列のヘッダーをダブルクリックし、`Feedback`と入力して名前を変更します。
* **各フォーム送信の日時を記録する列を追加する：**
    1.  テーブルヘッダーでプラス(+)アイコンをクリックし、`Date`を選択します。
    2.  新しい列のヘッダーをダブルクリックし、`Date received`と入力して名前を変更します。

これで、入力テーブルは下のスクリーンショットのようになっているはずです。フォーム送信を収集する前に入力テーブルに直接データを事前入力する予定がない場合は、デフォルトの空の行を削除してください。

#### **タスク3：フォームを構築する (Task 3: Build the form)**
次に、UI要素とコントロール要素を構成して、アンケートの質問とフォームフィールドを提示することで、フォームを構築します。
> 💡
> コントロール要素を構成する際、明確で一貫した命名規則を実装することが重要です。そうすることで、個々のコントロールを識別しやすくなり、参照の問題を防ぐことができます。このチュートリアルの命名規則は、`form-<topic>`という形式に従います。ここで`topic`は、コントロールを通じて収集される情報を説明する単一の単語です。

##### **3.1 従業員センチメントフィールドを作成する**
従業員センチメントフィールドは、折りたたまれた`List value`コントロール要素を使用し、従業員にドロップダウンから5つのオプションのいずれかを選択させます。従業員の選択は、折りたたまれたフィールドに表示されます。
> 💡
> 折りたたまれたリストを使用すると、フォーム内の最小限のスペースでいくつかのオプションを提供できます。

1.  **`Text`要素を追加して、アンケートの質問を表示します。**
    * `Add element`バーで、`UI` > `Text`を選択します。
    * 新しい要素に、次の質問を入力します：`Overall, how satisfied or dissatisfied are you with your current role and responsibilities?`
2.  **`List value`コントロール要素を回答フィールドとして追加・構成します。**
    * `Add element`バーで、`Controls` > `List value`を選択します。
    * 新しい要素を選択した状態で、サイドパネルの`Properties`タブを開き、値の設定を構成します。
        * デフォルトの値ソース（manual list）とタイプ（text）を維持します。
        * `Values`セクションで、`Set display values`スイッチをオフの位置に切り替え、`Add text value`フィールドに以下の値を（記載された順序で）追加します。
            * Very satisfied
            * Somewhat satisfied
            * Neither satisfied nor dissatisfied
            * Somewhat dissatisfied
            * Very dissatisfied
        * `Allow multiple selection`と`Show null option`のチェックボックスをオフにします。
        * `Control ID`フィールドで、デフォルトIDをクリアし、`form-sentiment`に置き換えます。
    * サイドパネルで`Format`タブを開き、要素のスタイルとラベルを編集します。
        * `Placeholder`フィールドで、デフォルトのテキストをクリアし、`Select an option`と入力します。
        * `Show label`チェックボックスをオフにして、ラベルを非表示にします。

##### **3.2 NPS評価フィールドを作成する**
NPS評価フィールドは、`Slider`コントロール要素を使用し、従業員がトラックに沿ってハンドルをスライドさせるか、トラック上の特定の位置をクリックすることで評価を設定できるようにします。
> 💡
> `Slider`コントロール要素を使用すると、スペースを節約し、直感的な視覚的フィードバックでワンクリック入力を可能にします。

1.  **`Text`要素を追加して、アンケートの質問を表示します。**
    * `Add element`バーで、`UI` > `Text`を選択します。
    * 新しい要素に、次の質問を入力します：`How likely are you to recommend this company as a great place to work? (0 being not at all likely and 10 being extremely likely)`
2.  **`Slider`コントロール要素を回答フィールドとして追加・構成します。**
    * `Add element`バーで、`Controls` > `Slider`を選択します。
    * `Properties`タブで、スライダーの設定を構成します。
        * `Max`値を10に設定し、`Min`(0)、`Step`(1)のデフォルト設定を維持します。
        * `Filter`設定で、ドロップダウンから`=`を選択します。
        * `Control ID`フィールドで、デフォルトIDをクリアし、`form-nps`と入力します。
    * `Format`タブで、`Show label`チェックボックスをオフにしてラベルを非表示にします。

##### **3.3 職場の好みフィールドを作成する**
職場の好みフィールドは、`Segmented`コントロール要素を使用し、従業員が表示された3つのオプションのいずれかを選択できるようにします。
> 💡
> このフィールドには`List value`コントロール要素も使用できますが、`Segmented`コントロール要素は、コンパクトな表示で明確でスキャンしやすいオプションを提供し、直感的な視覚的フィードバックでワンクリック入力を可能にします。

1.  **`Text`要素を追加して、アンケートの質問を表示します。**
    * `Add element`バーで、`UI` > `Text`を選択します。
    * 新しい要素に、次の質問を入力します：`What work environment do you prefer?`
2.  **`Segmented`コントロールを回答フィールドとして追加・構成します。**
    * `Add element`バーで、`Controls` > `Segmented`を選択します。
    * `Properties`タブで、値の設定を構成します。
        * `Values`セクションで、`Set display values`スイッチをオフにし、以下の値を追加します：`Remote`, `Hybrid`, `In-office`。
        * `Control ID`フィールドで、デフォルトIDをクリアし、`form-preference`と入力します。
    * `Format`タブで、`Show label`チェックボックスをオフにしてラベルを非表示にします。

##### **3.4 フィードバックフィールドを作成する**
フィードバックフィールドは、`Text area`コントロール要素を使用し、従業員が自由形式のコメントを入力できるようにします。
> 💡
> このフィールドには`Text input`コントロール要素も使用できますが、`Text area`コントロールは、より長い自由形式の入力に適しています。

1.  **`Text`要素を追加して、アンケートの質問を表示します。**
    * `Add element`バーで、`UI` > `Text`を選択します。
    * 新しい要素に、次の質問を入力します：`What can leadership do to make your work experience more positive?`
2.  **`Text area`コントロールを回答フィールドとして追加・構成します。**
    * `Add element`バーで、`Controls` > `Text area`を選択します。
    * `Properties`タブで、`Control ID`フィールドを`form-feedback`に編集します。
    * `Format`タブで、`Placeholder`フィールドに`Share feedback to help us improve`と入力します。
    * `Label`ヘッダーで、`Show label`チェックボックスをオフにします。

##### **3.5 フォームボタンを作成する (Create the form buttons)**
フォームには、インタラクティビティを構成する2つのボタン（`Submit`と`Clear`）が含まれます。`Submit`ボタンは、従業員がフォームのエントリを送信できるようにし、それらは入力テーブルに記録されます。`Clear`ボタンは、フォームフィールドをリセットする簡単な方法を提供します。

* **`Submit`ボタンを作成する:**
    1.  `Add element`バーで、`UI` > `Button`を選択します。
    2.  新しい要素を選択した状態で、サイドパネルの`Properties`タブを開き、ボタンのテキストを編集します。
    3.  `Text`フィールドで、デフォルトのテキストをクリアし、`Submit`と入力し、キーボードでEnterを押して変更を保存します。
    4.  `Alignment`セクションで、`Horizontal`設定を`Stretch`に設定します。
        > 💡
        > 両方のボタンの水平方向の配置をストレッチすることで、同じ幅にすることができます。

* **`Clear`ボタンを作成する:**
    1.  `Add element`バーで、`UI` > `Button`を選択します。
    2.  新しい要素を選択した状態で、サイドパネルの`Properties`タブを開き、ボタンのテキストを編集します。
    3.  `Appearance`フィールドで、ドロップダウンから`Outline`を選択します。
        > 💡
        > アウトラインの外観は、`Clear`ボタンが`Submit`ボタンに対して二次的であることを示します。これは、視覚的な階層とよりクリーンなデザインを作成するUI/UXのベストプラクティスです。
    4.  `Text`フィールドで、デフォルトのテキストをクリアし、`Clear`と入力し、キーボードでEnterを押して変更を保存します。
    5.  `Alignment`セクションで、`Horizontal`設定を`Stretch`に設定します。

ボタン要素を選択してドラッグし、フォームフィールドの下に並べて配置します。

##### **3.6 コンテナを作成する (Create a container)**
コンテナは、フォームの必須コンポーネントを囲みます。
> 💡
> コンテナや他のレイアウト要素は、主にデータアプリのデザインをカスタマイズするために利用されますが、すべてのフォームアイテムをコンテナで囲むことは、このデータアプリのインタラクティビティを構成するプロセスを簡素化することもできます。アクションがフォーム全体に適用される必要がある場合、各コントロール要素に個別のアクションを構成するのではなく、コンテナ内のすべての要素を参照する単一のアクションを構成できます。

1.  前のサブタスクで作成したすべてのUIおよびコントロール要素を、クリック＆ドラッグで複数選択します。入力テーブル要素は含めないでください。
2.  要素ツールバーで、`Create container`を選択して、要素を単一のコンテナで囲みます。
3.  コンテナを選択した状態で、サイドパネルのヘッダーにデフォルトのコンテナ名（Container 1）が表示されます。ヘッダーをダブルクリックして編集を有効にし、`Form fields`と入力して名前を変更します。

フィードバックフォームは、これで下のスクリーンショットのようになっているはずです。

---

#### **タスク4：インタラクティビティを構成する (Task 4: Configure interactivity)**
フォームフィールドが設定されたので、`Submit`および`Clear`ボタンにアクションシーケンスを構成できます。
> 💡
> アクションを構成する際、個々のアクションとシーケンスの名前を変更すると有益です。より具体的で説明的な名前を適用することで、一目でアクションの明確さを提供できます。

##### **4.1 `Submit`ボタンのアクションを構成する**
従業員が`Submit`ボタンをクリックすると、データアプリはまずフォームのエントリに基づいて新しい入力テーブルの行を挿入し、次にフォームフィールドをクリアして初期状態にリセットします。

1.  `Submit`ボタン要素を選択します。
2.  サイドパネルで、`Actions`タブを開きます。
3.  デフォルトの空のアクションシーケンスで、`+ Add action`をクリックします。
4.  `Action`モーダルで、入力テーブルに新しい行を挿入する最初のアクションを構成します。
    * `Action`フィールドで、ドロップダウンから`Insert row`を選択します。
    * `Into`フィールドで、以前に作成した`Form Submissions`入力テーブルを選択します。
    * `With values`セクションには、入力テーブルのすべての列がリストされ、挿入される行の各列の値のソースを指定する必要があります。
        > 💡
        > コントロールは、列のタイプと互換性がある場合にのみ列にマッピングできます。
    * 各列のソースを次のように構成します。
        * **Sentiment**列には、`Control`を選択し、次に`Form Sentiment` (form-sentiment)コントロールを選択します。
        * **NPS rating**列には、`Control`を選択し、次に`Form Nps` (form-nps)コントロールを選択します。
        * **Workplace preference**列には、`Control`を選択し、次に`Form Preference` (form-preference)コントロールを選択します。
        * **Feedback**列には、`Control`を選択し、次に`Form Feedback` (form-feedback)コントロールを選択します。
        * **Date received**列には、`Formula`を選択し、数式バーに`Now()`関数を入力します。
5.  アクションシーケンスで、アクションをダブルクリックし、`Record form submission`と入力して名前を変更します。
6.  同じアクションシーケンスで、`+ Add action`をクリックして2番目のアクションを追加します。
7.  `Action`モーダルで、フォームフィールドとして構成されたすべてのコントロールをクリアする2番目のアクションを構成します。
    * `Action`フィールドで、`Clear control`を選択します。
    * `Apply to`フィールドで、`Container`を選択します。
    * `Container`フィールドで、`Form fields`コンテナを選択します。
8.  アクションシーケンスで、2番目のアクションをダブルクリックし、`Reset form`と入力して名前を変更します。

##### **4.2 `Clear`ボタンのアクションを構成する**
従業員が`Clear`ボタンをクリックすると、データアプリはフォームフィールドをクリアします。

1.  `Clear`ボタン要素を選択します。
2.  サイドパネルで、`Actions`タブを開きます。
3.  デフォルトの空のアクションシーケンスで、`+ Add action`をクリックします。
4.  `Action`モーダルで、フォームフィールドとして構成されたすべてのコントロールをクリアするアクションを構成します。
    * `Action`フィールドで、`Clear control`を選択します。
    * `Apply to`フィールドで、`Container`を選択します。
    * `Container`フィールドで、`Form fields`コンテナを選択します。
5.  アクションシーケンスで、アクションをダブルクリックし、`Reset form`と入力して名前を変更します。

これでフォームがインタラクティブになるはずです！フォームフィールドに入力し、エントリと送信タイムスタンプが入力テーブルに正確に記録されることを確認して、データアプリをテストしてください。

##### **次のステップ (Next steps)**
* **デザインのカスタマイズ:** データアプリを展開する前に、スタイルをカスタマイズし、UIコンポーネントを追加して、プレゼンテーションを洗練させ、会社のブランドガイドラインに準拠させます。
* **ページ上で要素を整理する:** フォームと入力テーブル用に別々のページを作成し、入力テーブルを含むページを非表示にして、ワークブックへのアクセス権を付与された従業員に表示されないようにします。
* **データ入力権限を編集する:** 入力テーブルを更新して、公開バージョンでのみ編集を許可するようにします。
* **セキュアな埋め込みを作成する:** フォームを別のアプリケーションに埋め込んで、ワークブック外の従業員に提示します。

### 9-2-1. 入力テーブルの概要 (Intro to input tables)

> 🚩
> 入力テーブルは、書き込みアクセスが有効になっているSnowflake, Databricks, Amazon Redshift接続で一般的に利用可能です。
> BigQuery接続では、入力テーブルはパブリックベータであり、以下の情報が適用されます。
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このドキュメントは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

入力テーブルは、構造化されたデータ入力をサポートする動的なワークブック要素です。これらを使用すると、分析に新しいデータポイントを統合し、データプラットフォームからの既存のデータを補強して、迅速なプロトタイピング、高度なモデリング、予測、what-if分析などを、ソースデータを上書きすることなく促進できます。

入力テーブルをテーブル、ピボットテーブル、ビジュアライゼーションのソースとして使用したり、ルックアップや結合を使用してデータを組み込んだりします。そして、入力テーブルの[ウェアハウスビューを作成](https://help.sigmacomputing.com/docs/warehouse-views)すると、手動で入力したデータをより広範なデータエコシステム全体で再利用できます。

このドキュメントでは、入力テーブルの基本（機能、タイプ、列）を紹介し、Sigmaがデータをどのように扱うかを説明します。

#### **入力テーブルの機能 (Input table functionality)**
入力テーブルを使用すると、以下のことができます。
* 新しい行を追加する（空およびCSV入力テーブルのみ）
* 新しい列を追加する（データ入力、計算、行編集履歴、およびシステム列を含む）
* CSVデータをアップロードおよび編集する（最大200MB、UTF-8のみ）
* キーボード入力で値を入力する
* クリップボードから一度に最大50,000セル（2,000行および25列）を貼り付ける
* データ入力権限を構成する
* データ検証を構成する
* 編集を防ぐために列を保護する

この機能の使用に関する情報については、「[新しい入力テーブルの作成](https://help.sigmacomputing.com/docs/create-new-input-tables)」、「[入力テーブルのデータガバナンスオプションの構成](https://help.sigmacomputing.com/docs/configure-data-governance-options-in-input-tables)」、および「[既存の入力テーブル列の編集](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns)」を参照してください。

#### **入力テーブルのタイプ (Types of input tables)**
Sigmaは3つのタイプの入力テーブルを提供しています。
* 空の入力テーブル (Empty input tables)
* CSV入力テーブル (CSV input tables)
* リンクされた入力テーブル (Linked input tables)

##### **空の入力テーブル (Empty input tables)**
空の入力テーブルは、既存のデータとは独立したスタンドアロンのテーブルでデータ入力をサポートする、空白のテーブルです。セルレベルでデータを編集し、編集可能な行と列を追加して、好みに合わせてテーブルを構築できます。

##### **CSV入力テーブル (CSV input tables)**
CSV入力テーブルもスタンドアロンのテーブルでデータ入力をサポートしますが、アップロードされたCSVデータ（最大200MB、UTF-8のみ）でテーブルを事前に埋めることができます。その後、アップロードされたデータをセルレベルで編集し、他の編集可能な行と列を追加して、好みに合わせてテーブルを構築できます。

##### **リンクされた入力テーブル (Linked input tables)**
リンクされた入力テーブルは、同じワークブック内の他の要素からの既存のデータと並行してデータ入力をサポートします。

子要素として、リンクされた入力テーブルには、親要素のデータを参照する一つ以上のリンクされた列が含まれます。これには、テーブルの粒度を確立する行識別子を含む主キー列が含まれます。その後、親要素からソースされたリンクデータを補強するために他の列を追加できます。

入力テーブルの行と親要素のソースデータとの間のデータ関係を維持するために、主キー列は静的な値を参照する必要があります。他のすべてのリンクされた列は可変データを参照でき、これはソースからのライブデータを反映するために、入力テーブルで継続的に更新されます。
> 🚧
> 計算列を主キー列として使用しないでください。リンクされた入力テーブルで計算列、特に生成された行番号（`RowNumber()`関数などから）を主キーとして使用すると、ワークブックで一貫性のない動作を引き起こす可能性があります。これらのキーは計算から派生するため、挿入、削除、または単純な編集などのデータ変更で変わる可能性があります。この不安定さは、以下の結果をもたらす可能性があります。
> * **キーの重複:** 行の順序の変更が重複を引き起こし、キー制約に違反する可能性があります。
> * **データ整合性の問題:** これらのキーに依存する関係が壊れ、参照整合性の問題を引き起こす可能性があります。
> 主キーは、常に安定した、ユニークな識別子であるべきで、できれば基盤となる安定したデータから派生したものであるべきです。

#### **入力テーブルの列のタイプ (Types of input table columns)**
入力テーブルは、以下のタイプの列をサポートしています。

| タイプ | 説明 | 利用可能な列 |
| :--- | :--- | :--- |
| **Data entry column** | 個々のセルレベルでの直接的なユーザー入力をサポートします。 | Text, Number, Date, Checkbox, Multi-select |
| **Computed column** | ユーザー定義の数式またはルックアップに基づいて値を生成します。 | Calculation, Via lookup |
| **Row edit history column** | 行レベルの編集に関連するシステム生成のメタデータを表示します。 | Last updated at, Last updated by, Created at, Created by |
| **System column** | テーブルコンポーネントに関連するシステム生成のメタデータを表示します。 | Row ID<br>(空またはCSV入力テーブルのみで利用可能) |

#### **入力テーブルのデータガバナンス (Input table data governance)**
データガバナンス機能（データ検証とデータ入力権限）により、入力テーブルのデータの整合性を維持し、セキュリティを強化できます。また、監査やその他のデータ管理目的で入力テーブルのメタデータを表示するために、システム生成の列（行編集履歴と行ID）を含めることもできます。

詳細は、以下のドキュメントを参照してください。
* [入力テーブルの列にデータ検証を適用する](https://help.sigmacomputing.com/docs/apply-data-validation-to-input-table-columns)
* [入力テーブルのデータ入力権限をカスタマイズする](https://help.sigmacomputing.com/docs/customize-data-entry-permission-on-input-tables)
* [入力テーブルにシステム生成の列を追加する](https://help.sigmacomputing.com/docs/add-system-generated-columns-to-input-tables)

#### **入力テーブルデータがどのように扱われるか (How input table data is handled)**
Sigmaは、データのその場限りの性質のため、入力テーブルを独自の方法で扱います。以下の情報は、入力テーブルデータがどのように保存、取得、削除されるかを説明します。

##### **ストレージ (Storage)**
Sigmaは、入力テーブルデータを、データプラットフォーム内の指定された書き戻しスキーマのテーブルに書き込みます。このデスティネーションスキーマは、接続の詳細（Admin > Connections）で識別され、Sigmaが上書きできない既存のソースデータとは別に、入力テーブルデータを保存します。
入力テーブルデータを保存するテーブルを作成することに加えて、Sigmaは、ユーザーアクティビティと結果として生じるシステム操作に関連する情報を含む、すべての入力テーブルの変更のシーケンシャルな記録を含む編集ログ（先行書き込みログまたはWALとも呼ばれる）を作成します。入力テーブルデータを含むテーブルには`SIGDS`というプレフィックスが付いたオブジェクト名があり、編集ログを含むテーブルには`SIGDS_WAL`というプレフィックスが付いています。

##### **取得 (Retrieval)**
Sigmaは入力テーブルデータをストレージに最適化された書き戻しスキーマに書き込むため、結果のテーブルを直接クエリすることはできません。クエリフレンドリーな形式で間接的に入力テーブルデータにアクセスするには、個々の入力テーブルの[ウェアハウスビューを作成し](https://help.sigmacomputing.com/docs/warehouse-views)、SQLの`FROM`句を使用してビューからデータを取得します。

##### **削除 (Removal)**
ワークブック内の入力テーブル**要素**は削除できますが、Sigmaはあなたのデータプラットフォームに書き込まれた対応する入力テーブルデータを削除しません。このデータを削除するには、データプラットフォームで直接削除する必要があります。

### 9-2-2. 新しい入力テーブルの作成 (Create new input tables)

入力テーブルを作成して、分析に新しいデータポイントを統合し、既存のデータを補強します。テーブル構造の管理、セル値の入力、およびデータ検証、列の保護、データ入力権限、行編集履歴などの高度なオプションを構成します。

このドキュメントでは、空の、CSV、およびリンクされた入力テーブルを作成・構築する方法について説明します。入力テーブルの機能とその構成方法の概要については、「[入力テーブルの概要](https://help.sigmacomputing.com/docs/intro-to-input-tables)」および「[入力テーブルのデータガバナンスオプションを構成する](https://help.sigmacomputing.com/docs/configure-data-governance-options-for-input-tables)」を参照してください。入力テーブルデータの編集に関する情報については、「[既存の入力テーブル列を編集する](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns)」を参照してください。

> 📘
> この機能は、すべてのデータプラットフォーム接続でサポートされているわけではありません。あなたの接続がサポートしているかを確認するには、「[サポートされているデータプラットフォームと機能の互換性](https://help.sigmacomputing.com/docs/region-and-feature-support)」を参照してください。

#### **システムとユーザー要件 (System and user requirements)**
新しい入力テーブルを作成する機能には、以下が必要です。
* 入力テーブルをサポートし、書き込みアクセスが有効になっている接続に対する`Can use`[データ権限](https://help.sigmacomputing.com/docs/data-permissions)が付与されている必要があります。
    * OAuthが有効な接続で入力テーブルを使用する場合、追加の要件については「[書き込みアクセスでOAuthを構成する](https://help.sigmacomputing.com/docs/oauth-with-write-access)」を参照してください。
    * Amazon Redshift接続で入力テーブルを使用する場合、Redshiftの`enable_case_sensitive_identifier`構成値は`false`に設定されている必要があります。`true`に設定されている場合、新しい入力テーブルの作成試行は失敗します。
* `Create input tables`および`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。他のワークブック要素とは異なり、入力テーブルはカスタムビューでは作成できません。新しい入力テーブルは、ワークブックのドラフトバージョンでのみ作成できます。

入力テーブルデータを**編集**するために必要な権限については、「[既存の入力テーブル列を編集する](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns)」を参照してください。

#### **新しい入力テーブルを作成する (Create a new input table)**
Sigmaは、アドホックなデータ入力のさまざまなユースケースをサポートするために、複数のタイプの入力テーブルを備えています。以下のサブセクションでは、次の入力テーブルタイプの作成方法を説明します。
* [空の入力テーブル](#create-an-empty-input-table)
* [CSV入力テーブル](#create-a-csv-input-table)
* [リンクされた入力テーブル](https://help.sigmacomputing.com/docs/link-input-tables)

##### **空の入力テーブルを作成する (Create an empty input table)**
既存のデータとは独立したデータ入力をサポートするために、空の入力テーブルを作成します。
1.  `Edit`モードでワークブックを開きます。
2.  ナビゲーションメニューで、`+ Add element`をクリックして`Add new element`パネルを開きます。
3.  `Input Tables`セクションで、`Empty`を選択します。
4.  入力テーブルデータの接続と書き込み先を選択します。
    * `Select a connection`ドロップダウンで、Sigmaが入力テーブルデータをあなたのデータプラットフォームに書き込むために使用する接続を選択します。Sigmaは書き込みアクセスが有効な接続の選択のみを許可します。
    * `Destination`ドロップダウンで、書き戻しスキーマを選択します。
5.  `Create`をクリックします。
    * 選択した接続内で一つの接続または一つの書き戻しスキーマへの書き込み権限しか持っていない場合、Sigmaは自動的にそのオプションを適用し、選択を要求しません。
Sigmaは、空の単一列の入力テーブルをワークブックに追加します。入力テーブルの構築を続けるには、このドキュメントの「[入力テーブルの構造をカスタマイズする](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns#customize-input-table-structure)」を参照してください。

##### **CSV入力テーブルを作成する (Create a CSV input table)**
CSVアップロードからの事前入力された編集可能なデータでデータ入力をサポートするために、CSV入力テーブルを作成します。
1.  `Edit`モードでワークブックを開きます。
2.  ナビゲーションメニューで、`+ Add element`をクリックして`Add new element`パネルを開きます。
3.  `Input Tables`セクションで、`CSV`を選択します。
4.  `Upload CSV`ページで、指定されたエリアにCSVファイルをドラッグ＆ドロップするか、`Browse`をクリックしてファイルダイアログで選択します。
    > 📘
    > CSVファイルはサイズが200MBを超えてはならず、UTF-8エンコーディングを使用している必要があります。
5.  解析されたデータと警告（該当する場合）を確認し、必要に応じて解析オプションと列タイプを更新します。
6.  `Save`をクリックして、CSVデータを入力テーブルに適用します。
Sigmaは、事前入力されたCSV入力テーブルをワークブックに追加します。入力テーブルの構築を続けるには、このドキュメントの「[入力テーブルの構造をカスタマイズする](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns#customize-input-table-structure)」を参照してください。

##### **リンクされた入力テーブルを作成する (Create a linked input table)**
同じワークブック内の他の要素からの既存のデータと並行してデータ入力をサポートするために、リンクされた入力テーブルを作成します。

1.  `Edit`モードでワークブックを開きます。
2.  ナビゲーションメニューで、`+ Add element`をクリックして`Add New`パネルを開きます。
3.  `Input tables`セクションで、`Linked`を選択します。
4.  `Select source`モーダルで、入力テーブルのデータソースとして使用するワークブック内の要素を選択します。
5.  `Create linked input table`モーダルで、入力テーブルにリンクするソース列を選択します。
    > 📘
    > 主キーを含むリンクされた列は、入力テーブルのセルレベルでは編集できません。値はソース要素から継承され、その要素が更新されると継続的にライブデータを反映します。
6.  主キー列に行識別子を設定するために、少なくとも一つの列を選択します。
    > 💡
    > 入力テーブルの主キー列の行識別子は、選択されたソース列のユニークな値に基づいています。一貫性のある信頼できる行識別子を確保するために、不変の値（静的なID、製品名、地域など）を含むソース列を選択してください。主キー列の動的な値は、行識別子が変更されると行データの損失につながる可能性があります。
7.  入力テーブルに追加のソースデータを設定するために、追加の列を選択します。
8.  `Create input table`をクリックします。

Sigmaは、リンクされた入力テーブルをワークブックに追加します。デフォルトでは、選択されたソース列と単一のデータ入力列が含まれます。入力テーブルの構築を続けるには、このドキュメントの「[入力テーブルの構造をカスタマイズする](#customize-input-table-structure)」を参照してください。

#### **入力テーブルの構造をカスタマイズする (Customize input table structure)**
Sigmaでは、分析とレポーティングを最適化するために、入力テーブルの構造をカスタマイズできます。以下のサブセクションでは、次のタスクを完了する方法を説明します。
* [行を挿入する](#insert-rows)
* [列を追加する](#add-columns)
* [列を移動する](#move-columns)
* [列の名前を変更する](#rename-columns)
* [列のタイプを変更する](#change-column-types)

##### **行を挿入する (Insert rows)**
空またはCSV入力テーブルに新しい行を挿入して、分析用の新しいデータレコードを作成します。リンクされた入力テーブルは、行数と粒度が主キー列によって定義されるため、手動での行の追加をサポートしていません。

* 新しい行を挿入するには、既存の行のどこかを右クリックし、`Insert 1 row above`または`Insert 1 row below`を選択します。
* 複数の新しい行を挿入するには、連続する複数の行を選択し、選択範囲を右クリックして`Insert [#] rows above`または`Insert [#] rows below`を選択します。
* 入力テーブルの末尾に行を追加するには、ヘッダー列にプラス(+)が含まれる最後の行をクリックします。
> 📘
> 入力テーブルの一つ以上の列に[列の保護](https://help.sigmacomputing.com/docs/configure-data-governance-options-for-input-tables#protect-columns-from-edits)が適用されている場合、行を挿入することはできません。

##### **列を追加する (Add columns)**
データ入力、行編集履歴の表示、またはユニークな行識別子を含めるために列を追加します。
1.  任意の列ヘッダーのキャレット()（または`Columns`パネルの任意の列名に関連付けられたキャレット）をクリックします。
2.  列メニューで、`Add new column`にカーソルを合わせ、列オプションを選択します。

| | |
| :--- | :--- |
| **Text, Number, Date, Checkbox, or Multi-select** | セルレベルのユーザー入力を可能にするデータ入力列。 |
| **Calculation** or **Via lookup** | 数式またはルックアップに基づいてデータを生成する計算列。 |
| **Last updated at, Last updated by, Created at, or Created by** | 行の編集に関連するメタデータを表示する行編集履歴列。詳細は「[行編集履歴を追加する](https://help.sigmacomputing.com/docs/add-system-generated-columns-to-input-tables#add-row-edit-history)」を参照してください。 |
| **Row ID** | 各行にユニークなIDを生成するシステム列。詳細は「[行IDを追加する](https://help.sigmacomputing.com/docs/add-system-generated-columns-to-input-tables#add-row-id)」を参照してください。 |

Sigmaは、前のステップで参照された列の後に空の列を追加します。

##### **列を移動する (Move columns)**
入力テーブルを再編成するために列を移動します。
* 単一の列を移動するには、列ヘッダー（または`Columns`パネルの列名）をクリックして押し続け、列を希望の位置にドラッグ＆ドロップします。
* 複数の列を移動するには、`Columns`パネルで複数の列名を選択し、選択範囲を希望の位置にドラッグ＆ドロップします。
* 一つ以上の列をテーブルの最初または最後に移動するには、テーブルで直接（またはColumnsパネルで）列を選択します。選択範囲を右クリックして列メニューを開き、`Move to`にカーソルを合わせて`Start`または`End`を選択します。

##### **列の名前を変更する (Rename columns)**
列のデータの内容を反映するように列の名前を変更します。
1.  任意の列ヘッダーのキャレット()（または`Columns`パネルの任意の列名に関連付けられたキャレット）をクリックします。
2.  列メニューで、`Rename column`を選択してインプレース編集を有効にします。
3.  列名を編集し、`Enter`キーを押します。
> 💡
> 列ヘッダーまたは名前をダブルクリックしてインプレース編集を有効にすることもできます。

##### **列のタイプを変更する (Change column types)**
ストレージ、クエリパフォーマンス、および全体的な分析を最適化するために、列のタイプ（text, number, date, checkbox）を変更します。
1.  列ヘッダーのキャレット()（または`Columns`パネルの任意の列名に関連付けられたキャレット）をクリックします。
2.  列メニューで、`Change column type`にカーソルを合わせ、`Text`, `Number`, `Date`, `Checkbox`のいずれかを選択します。列にデータが含まれている場合、Sigmaは選択されたデータ型に対応しない値を自動的に削除します。
> 📘
> 特定の列に[データ検証](https://help.sigmacomputing.com/docs/apply-data-validation-to-input-table-columns)または[列の保護](https://help.sigmacomputing.com/docs/configure-data-governance-options-for-input-tables#protect-columns-from-edits)が適用されている場合、データ型を変更することはできません。

#### **テーブルデータを入力する (Enter table data)**
キーボード入力、コピー＆ペースト、チェックボックスのトグル、またはドロップダウン選択を通じて、入力テーブルにセルレベルのデータを入力します。また、カスタム数式を使用して計算列のセル値を定義することもできます。

ワークブックのドラフトと公開バージョンでの継続的なデータ入力ワークフローに関する情報については、「[既存の入力テーブル列を編集する](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns)」および「[入力テーブルのデータガバナンスオプションを構成する](https://help.sigmacomputing.com/docs/configure-data-governance-options-for-input-tables)」を参照してください。
> 📘
> 入力テーブルのセルは、列のデータ型に沿った値のみを受け入れます。無効な値を入力すると、セルはデータをクリアします。

* キーボード入力でデータを入力するには、セルを選択して値を入力します。
* コピーした値を貼り付けるには、セルまたはセル範囲を選択し、選択範囲を右クリックして`Paste`を選択します。
* チェックボックス列のセル値を変更するには、チェックボックスをクリックしてtrue（選択済み）とfalse（クリア済み）を切り替えます。
* [複数選択列](https://help.sigmacomputing.com/docs/apply-data-validation-to-input-table-columns#create-a-multi-select-column)または[データ検証](https://help.sigmacomputing.com/docs/apply-data-validation-to-input-table-columns)を含む列で事前定義された値を選択するには、セルのキャレット()をクリック（またはセルをダブルクリック）し、ドロップダウンからオプションを選択します。
* 計算列の値を定義するには、列ヘッダーまたは列内の任意のセルをクリックし、数式バーに式を入力します。

### 9-2-3. 入力テーブルのデータを追加または編集する (Add or edit input table data)

個々の入力テーブル要素の[ワークブックアクセス権](https://help.sigmacomputing.com/docs/folder-and-document-permissions)と[データ入力権限](https://help.sigmacomputing.com/docs/customize-data-entry-permission-on-input-tables)に応じて、ワークブックのドラフト版または公開版で直接入力テーブルのデータを追加または編集できます。

このドキュメントでは、編集可能な入力テーブルを識別し、編集可能な状態にアクセスし、対話しているワークブックのバージョンに基づいてデータを追加または編集する方法について説明します。

特定の入力テーブルのデータ入力権限を変更する方法については、「[入力テーブルのデータ入力権限をカスタマイズする](https://help.sigmacomputing.com/docs/customize-data-entry-permission-on-input-tables)」を参照してください。入力テーブルに関する一般的な情報については、「[入力テーブルの概要](https://help.sigmacomputing.com/docs/intro-to-input-tables)」を参照してください。

#### **システムとユーザー要件 (System and user requirements)**
既存の入力テーブルの列にデータを追加または編集する機能には、以下が必要です。

* **ワークブックのドラフトで:**
    * `Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
    * あなたがワークブックの所有者であるか、ワークブックに対する`Can edit`アクセス権を付与されている必要があります。
* **ワークブックの公開バージョンで:**
    * `Basic explore`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
    * あなたがワークブックの所有者であるか、ワークブックに対する`Can explore`または`Can edit`アクセス権を付与されている必要があります。

新しい入力テーブルの作成とテーブル構造の管理に必要な権限については、「[新しい入力テーブルの作成](https://help.sigmacomputing.com/docs/create-new-input-tables)」を参照してください。データガバナンス機能の構成に必要な権限については、「[入力テーブルのデータガバナンスオプションを構成する](https://help.sigmacomputing.com/docs/configure-data-governance-options-for-input-tables)」を参照してください。

#### **編集可能な入力テーブルを識別する (Identify editable input tables)**
データ入力権限は個々の入力テーブルレベルで構成されるため、ワークブックにはドラフトでのみ編集可能な入力テーブルと、公開バージョンでのみ編集可能な入力テーブルが混在することがあります。特定の入力テーブルがワークブックのドラフト版または公開版で編集可能かどうかを判断するには、以下のセクションを参照してください。

##### **ワークブックのドラフトで編集可能な入力テーブルを識別する**
ワークブックのドラフトを操作しているとき、入力テーブル要素はテーブルの上に`Editable in`ラベルを表示し、データ入力がドラフト版と公開版のどちらで許可されているかを示します。
> 📘
> データ入力権限は、既存の入力テーブルの列にデータを追加または編集する能力にのみ影響します。ワークブックのドラフトでは、データ入力権限に関係なく、テーブル構造のカスタマイズ、列設定の管理、データガバナンスオプションの構成が引き続き可能です。

要素に`Editable in draft`ラベルが表示されている場合、入力テーブルのデータはすぐに編集可能です。「[ワークブックのドラフトでデータを追加または編集する](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns#add-or-edit-data-in-a-workbook-draft)」を参照してください。
> 🚧
> 入力テーブルデータをデータプラットフォームに書き込むために使用される接続が利用できないか、誤って構成されている場合、入力テーブルはすべての編集から制限されることがあります。これが発生すると、要素は`Editable in draft`ラベルの隣に「Editing restricted」という警告メッセージを表示し、入力テーブルのデータを追加または編集することはできません。この制限に遭遇した場合は、Sigma組織の管理者に連絡して問題を解決してください。詳細は、「[入力テーブルのエラー処理](https://help.sigmacomputing.com/docs/input-table-error-handling)」を参照してください。

要素に`Editable in published version`ラベルが表示されている場合、入力テーブルのデータはすぐには編集できません。データを追加または編集するには、[データ入力権限を変更する](https://help.sigmacomputing.com/docs/customize-data-entry-permission-on-input-tables)か、[ワークブックの公開バージョンに切り替える](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns#add-or-edit-data-in-a-workbook-s-published-version)ことができます。

##### **ワークブックの公開バージョンで編集可能な入力テーブルを識別する**
ワークブックの公開バージョンを操作しているとき、データ入力が公開バージョンで許可されている場合、入力テーブル要素は`Edit data`ボタンを表示します。以下で説明する追加の要因によって、データを追加または編集するために編集可能な状態にアクセスできるかどうかが決まる場合があります。

* `Edit data`ボタンが表示され、有効になっている場合、編集可能な状態にアクセスし、既存の列に直接データを追加または編集できます。「[ワークブックの公開バージョンでデータを追加または編集する](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns#add-or-edit-data-in-a-workbook-s-published-version)」を参照してください。
* `Edit data`ボタンが表示されているが無効になっている場合、入力テーブルは公開バージョンで編集可能ですが、現在、データを追加または編集するために編集可能な状態にアクセスすることはできません。この制限は、不十分なワークブックアクセス権が原因である可能性が高いです。必要であれば、ワークブックの所有者に連絡してアクセス権のアップグレードをリクエストしてください。
> 🚧
> 入力テーブルの編集は、接続が利用できないか誤って構成されている場合にも制限されることがあります。これが発生すると、要素は無効化されたボタンの隣に「Editing restricted」という警告メッセージを表示します。この制限に遭遇した場合は、Sigma組織の管理者に連絡してください。
* `Edit data`ボタンが表示されていない場合、入力テーブルは公開バージョンで編集できません。該当するワークブックアクセス権がある場合は、ドラフトで入力テーブルのデータを追加または編集できます（「[ワークブックのドラフトでデータを追加または編集する](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns#add-or-edit-data-in-a-workbook-draft)」を参照）。それ以外の場合は、入力テーブルを表示することしかできません。

#### **データを追加または編集する (Add or edit data)**
入力テーブルのデータを追加または編集する際、編集可能な状態へのエントリーポイントと変更を保存するメカニズムは、操作しているワークブックのバージョンによって異なります。ワークブックのドラフト版または公開版で入力テーブルのデータを追加または編集するには、以下のワークフローを参照してください。

##### **ワークブックのドラフトでデータを追加または編集する (Add or edit data in a workbook draft)**
入力テーブルのデータ入力権限がワークブックのドラフトでの編集を許可している場合、編集可能な列に直接データを追加または編集できます。

1.  ワークブックのドラフトを開き、編集したい入力テーブルを探します。
2.  入力テーブル要素がテーブルの上に`Editable in draft`ラベルを表示している場合、以下の方法を使用して編集可能な列にすぐにデータを追加または編集できます。要素が`Editable in published version`ラベルを表示している場合は、まず[データ入力権限を変更する](https://help.sigmacomputing.com/docs/customize-data-entry-permission-on-input-tables)か、[ワークブックの公開バージョンに切り替える](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns#add-or-edit-data-in-a-workbook-s-published-version)必要があります。
    > 📘
    > 編集可能な列は、列ヘッダーに鉛筆アイコン()を表示します。リンクされた列（リンクされた入力テーブル内）、計算、ルックアップ、およびシステム列は編集できません。
3.  キーボード入力でデータを入力するには、セルを選択して値を入力します。
4.  コピーした値を貼り付けるには、セルまたはセル範囲を選択し、選択範囲を右クリックして`Paste`を選択します（または`⌘+V`または`Ctrl+V`のキーボードショートカットを使用します）。
    > 💡
    > 一度に最大50,000セル（列ヘッダーを含む2,000行および25列）の値を選択して貼り付けることができます。複数行のデータをコピーし、入力テーブルで列ヘッダーまたは列ヘッダーを含むセル範囲を選択すると、コピーされたデータの最初の行がヘッダーに貼り付けられます。
5.  チェックボックス列のセル値を変更するには、チェックボックスをクリックして`true`（選択済み）と`false`（クリア済み）を切り替えます。チェックボックスを削除してnull値を生成するには、セルを選択して`Delete`キーを押します。
6.  [複数選択列](https://help.sigmacomputing.com/docs/apply-data-validation-to-input-table-columns#create-a-multi-select-column)または[データ検証](https://help.sigmacomputing.com/docs/apply-data-validation-to-input-table-columns)を含む列で事前定義された値を選択するには、セルの下矢印()をクリック（またはセルをダブルクリック）し、ドロップダウンからオプションを選択します。
7.  計算列の値を定義するには、列ヘッダーまたは列内の任意のセルをクリックし、数式バーに式を入力します。
    > 💡
    > 数式バーが表示されていない場合は、ワークブックヘッダーの`Show panels`をクリックして、ツールバー（数式バーを含む）とエディタパネルを表示します。

Sigmaはすべての編集をドラフトに自動的に保存します。変更をワークブックの公開バージョンに保存するには、ワークブックヘッダーの`Publish`をクリックします。

> 🚧
> 接続またはデータプラットフォームの構成または可用性の問題により、入力テーブルの編集が失敗することがあります（これは顧客側で解決する必要があります）。接続が誤って構成されているか利用できない場合にデータの整合性を向上させ、予期しないデータ損失を防ぐために、Sigmaは関連する入力テーブルへの編集をブロックし、入力テーブル要素に直接「Editing restricted」メッセージを表示します。誤って構成された、または利用できない接続のために編集が制限されている場合は、Sigma組織の管理者に連絡して問題を解決してください。詳細は、「[入力テーブルのエラー処理](https://help.sigmacomputing.com/docs/input-table-error-handling)」を参照してください。

##### **ワークブックの公開バージョンでデータを追加または編集する (Add or edit data in a workbook's published version)**
入力テーブルのデータ入力権限がワークブックの公開バージョンでの編集を許可している場合、入力テーブルの編集可能な状態にアクセスして、既存の編集可能な列に直接データを追加または編集できます。

1.  ワークブックの公開バージョンを開き、編集したい入力テーブルを探します。
    * ドラフトから公開バージョンに切り替えるには、ワークブックヘッダーの`Publish`ボタンの隣にある下矢印()をクリックし、`Go to published version`を選択します。
2.  入力テーブル要素で、`Edit data`をクリックして編集を有効にします。
    * ボタンが無効になっている場合、編集可能な状態にアクセスできません。詳細は、「[ワークブックの公開バージョンで編集可能な入力テーブルを識別する](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns#identify-editable-input-tables-in-a-workbook-s-published-version)」を参照してください。
3.  以下の方法を使用して、既存の編集可能な列にデータを追加または編集します。
    > 📘
    > 編集可能な列は、列ヘッダーに鉛筆アイコン()を表示します。
4.  キーボード入力、コピー＆ペースト、チェックボックスのトグル、またはドロップダウン選択でデータを入力します。
5.  入力テーブルは、未保存のデータを持つセルを示すために黄色のセルインジケータを表示します。`Save`をクリックして、変更をドラフトおよび公開バージョンに適用します。

### 9-2-4-1. 入力テーブルのデータガバナンスオプションを構成する (Configure data governance options for input tables)

データガバナンス機能（データ検証とデータ入力権限）により、入力テーブルのデータの整合性を維持し、セキュリティを強化できます。また、システム生成の列（行編集履歴と行ID）を含めて、監査やその他のデータ管理目的で入力テーブルのメタデータを表示することもできます。

詳細については、以下のドキュメントを参照してください。
* [入力テーブルの列にデータ検証を適用する](https://help.sigmacomputing.com/docs/apply-data-validation-to-input-table-columns)
* [入力テーブルのデータ入力権限をカスタマイズする](https://help.sigmacomputing.com/docs/customize-data-entry-permission-on-input-tables)
* [入力テーブルにシステム生成の列を追加する](https://help.sigmacomputing.com/docs/add-system-generated-columns-to-input-tables)

### 9-2-5-1. 入力テーブルの列にデータ検証を適用する (Apply data validation to input table columns)

データ検証は、データ入力を特定の値のセットに制限することにより、データの正確性と一貫性を保証します。入力テーブルの列にデータ検証を適用すると、ユーザーはドロップダウンから事前定義された値のいずれかを入力または選択することしかできなくなります。

> 📘
> Sigmaは、テキスト、数値、および日付の列に対してのみデータ検証をサポートしています。Sigmaが既に値をtrue（選択済み）またはfalse（クリア済み）に制限しているため、チェックボックスデータ列にはデータ検証は適用されません。

このドキュメントでは、入力テーブルにデータ検証を適用する方法について説明します。

#### **システムとユーザー要件 (System and user requirements)**
入力テーブルにデータ検証を適用する機能には、以下が必要です。
* あなたの組織が入力テーブルと互換性のあるデータプラットフォームに接続されている必要があります。「[Region, warehouse, and feature support](https://help.sigmacomputing.com/docs/region-and-feature-support)」を参照してください。
* 書き込みアクセスが有効になっている接続に対する`Can use`[データ権限](https://help.sigmacomputing.com/docs/data-permissions)が付与されている必要があります。OAuthが有効な接続を使用する場合、追加の要件については「[Configure OAuth with write access](https://help.sigmacomputing.com/docs/oauth-with-write-access)」を参照してください。
* `Create input tables`および`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

#### **データ検証を適用する (Apply data validation)**
1.  列ヘッダーのキャレット()をクリックして列メニューを開き、`Data validation`を選択します。
2.  `Data validation`モーダルで、事前定義された値の手動リストを作成するか、ワークブック内の既存のデータソースまたは要素の列から値を適用します。

* **値の手動リストを作成する:**
    1.  `Value source`ドロップダウンで、`Create manual list`を選択します。
    2.  `Define values`フィールドに、列のデータ型に沿った値を入力します。
        > 💡
        > 個々の値を入力するか、Sigmaまたは外部ソース（スプレッドシートやテキストドキュメントなど）からコピーした複数の値を貼り付けます。
    3.  `Save`をクリックします。

* **既存のデータソースまたは要素の列から値を適用する:**
    1.  `Value source`ドロップダウンで、データソースまたは要素を選択します。
    2.  セカンダリドロップダウンで、値を定義するソース列を選択します。
    3.  列の値を確認し、`Save`をクリックして続行します。

Sigmaは既存のデータを定義された値と照合し、無効なデータを含むセルに赤いインジケータを表示します。
無効なデータを置き換えるには、手動で有効な値を入力するか、セルのキャレット()をクリックしてドロップダウンから事前定義された値を選択します。

### 9-2-5-2. 入力テーブルのデータ入力権限をカスタマイズする (Customize data entry permission on input tables)

データ入力権限により、誰がいつ入力テーブルのデータを編集できるかを制御できます。個々の入力テーブルについて、どのワークブックバージョン（ドラフトまたは公開版）でユーザーが行を追加したりセル値を編集したりできるかを指定できます。

このドキュメントでは、個々の入力テーブルのデータ入力権限を変更する方法について説明します。

#### **システムとユーザー要件 (System and user requirements)**
入力テーブルのデータ入力権限を構成する機能には、以下が必要です。
* あなたの組織が入力テーブルと互換性のあるデータプラットフォームに接続されている必要があります。「[サポートされているリージョン、データプラットフォーム、および機能](https://help.sigmacomputing.com/docs/region-and-feature-support)」を参照してください。
* 書き込みアクセスが有効になっている接続に対する`Can use`[データ権限](https://help.sigmacomputing.com/docs/data-permissions)が付与されている必要があります。OAuthが有効な接続を使用する場合、追加の要件については「[書き込みアクセスでOAuthを構成する](https://help.sigmacomputing.com/docs/oauth-with-write-access)」を参照してください。
* `Create input tables`および`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

#### **データ入力権限を設定する (Set the data entry permission)**
個々の入力テーブルのデータ入力権限を設定して、どのワークブックバージョン（ドラフトまたは公開版）でユーザーがその特定の入力テーブルに行を追加したり値を編集したりできるかを指定します。

> 📘
> 入力テーブルの作成と構築の能力は、常にドラフトバージョンに制限されています。つまり、`Can edit`のワークブック権限を付与されたユーザーのみが、ワークブックに[新しい入力テーブルを追加](https://help.sigmacomputing.com/docs/create-new-input-tables)したり、[テーブル構造を修正](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns#customize-input-table-structure)したりできます。デフォルトでは、データ入力もワークブックのドラフトバージョンに限定されていますが、個々の入力テーブルの権限を変更して、代わりに公開バージョンでの編集を許可することができます。入力テーブルが公開バージョンで編集可能な場合、`Can explore`または`Can edit`のワークブック権限を持つユーザーが入力テーブルのデータと対話できます。

ワークブックのドラフト版と公開版でのデータ入力ワークフローに関する詳細は、「[既存の入力テーブル列を編集する](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns)」を参照してください。

1.  更新したい入力テーブルを含むワークブックのドラフトバージョンを開きます。
2.  入力テーブル要素で、`Editable in`ラベルをクリックし、ドロップダウンから以下のいずれかのオプションを選択します。

| | |
| :--- | :--- |
| **Only editable in draft** | `Can edit`のワークブック権限を付与されたユーザーが、ワークブックのドラフトバージョンで入力テーブルデータを編集できるようにします。 |
| **Only editable in published version** | `Can explore`または`Can edit`のワークブック権限を付与されたユーザーが、カスタムビューを含むワークブックの公開バージョンで入力テーブルデータを編集できるようにします。 |

> 📘
> データ入力は、必要に応じてドラフト版と公開版の間で切り替えることができますが、ワークブックは両方で同時にデータ入力をサポートすることはできません。

3. 更新されたデータ入力権限でワークブックを公開する前に、入力テーブル要素は`Pending publish`通知を表示して、選択された権限がまだ有効でないことを示します。データ入力権限の更新を適用するには、ワークブックヘッダーの`Publish`をクリックします。

### 9-2-5-3. 入力テーブルにシステム生成の列を追加する (Add system-generated columns to input tables)

入力テーブルにシステム生成の列を追加して、監査やその他のデータ管理プロセスのためのメタデータを公開します。

* **行編集履歴 (Row edit history):** 各行の作成または最新の更新に関連付けられたタイムスタンプとユーザーのメールアドレスを記録します。
* **行ID (Row ID):** データ管理と参照整合性をサポートするユニークな行識別子を設定します。

このドキュメントでは、システム生成の行編集履歴と行ID列を入力テーブルに追加する方法について説明します。他の入力テーブルのデータガバナンスオプションに関する情報については、「[入力テーブルのデータガバナンスオプションを構成する](https://help.sigmacomputing.com/docs/configure-data-governance-options-for-input-tables)」を参照してください。

#### **行編集履歴を追加する (Add row edit history)**
行編集履歴を含む列を追加して、データの透明性を提供し、説明責任を促進します。行編集履歴列は、[直接入力](https://help.sigmacomputing.com/docs/edit-existing-input-table-columns)や[アクション](https://help.sigmacomputing.com/docs/actions-overview)を通じて発生する行の編集に関連付けられたタイムスタンプとユーザーのメールを追跡します。

1.  列ヘッダーの末尾にあるプラス()アイコンをクリックし、`Row edit history`にカーソルを合わせてオプションを選択します。

| | |
| :--- | :--- |
| **Last updated at** | 行に最新の編集が適用された日時。 |
| **Last updated by** | 行に最新の編集を適用したユーザーのメールアドレス。 |
| **Created at** | 行が入力テーブルに追加された日時。 |
| **Created by** | 最初に行を入力テーブルに追加したユーザーのメールアドレス。 |

この列は、入力テーブル内のすべての既存の行の編集履歴を設定します。
> 📘
> ユーザーが入力テーブルを複製すると、コピー内のすべての行編集履歴（`Created at/by`および`Last updated at/by`）は、最初に複製の日時とそれを開始したユーザーを反映します。

#### **行IDを追加する (Add row ID)**
行IDを含む列を追加して、入力テーブルの各行を一意に識別する主キーを確立します。
> 📘
> システム生成の行IDは、リンクされた入力テーブルには無関係であり、空およびCSV入力テーブルでのみ利用可能です。

1.  列ヘッダーの末尾にあるプラス()アイコンをクリックし、`Row ID`を選択します。

この列は、空の行を含む、入力テーブル内のすべての既存の行にユニークなIDを設定します。
> 📘
> ユーザーが入力テーブルを複製すると、Sigmaは既存の行の行IDを保持するため、オリジナルとコピーでIDが同一になります。ただし、複製後に追加された新しい行については、SigmaはユニークなIDを生成します。

### 9-3-1. レイアウト要素の概要 (Intro to layout elements)

レイアウト要素は、他のワークブック要素を分離、グループ化、および可視性を管理する動的なワークブック要素です。これらを使用すると、ユーザーフレンドリーなレイアウトを設計し、多種多様なユースケースに対応する直感的なワークフローを構築できます。

レイアウト要素を使用して、単一ページ上の既存の要素を整理したり、[アクション](https://help.sigmacomputing.com/docs/actions-overview)と組み合わせて、ページ、タブ、ポップアップにわたる複数のコンテンツレイヤーを非表示にしたり表示したりします。

このドキュメントでは、機能、タイプ、ユースケースなど、レイアウト要素の基本を紹介します。

#### **レイアウト要素の機能 (Layout element functionality)**
レイアウト要素を使用すると、以下のことができます。
* 要素をグループ化する
* 同じページ上の関連のない要素を分離する
* 要素をグループとしてスタイル設定する
* 必要なフィルターやオプションにユーザーの注意を向ける
* データ入力のためのユーザーワークフローを管理する
* 複数のフィルターやコントロールによる視覚的な散らかりを減らす

#### **レイアウト要素のタイプ (Types of layout elements)**
Sigmaは以下のタイプのレイアウト要素を提供しています。
* **コンテナ (Containers)**
* **タブ付きコンテナ (Tabbed containers)**
* **モーダル (Modals)**
* **ポップオーバー (Popovers)**

##### **コンテナ (Containers)**
コンテナは、ページ上のいくつかの要素をグループ化できるカスタマイズ可能な要素です。既存の要素の周りにコンテナを配置したり、必要に応じて個々の要素を出し入れしたりできます。これらを使用すると、ページのレイアウトを管理し、要素をグループとしてスタイル設定できます。

##### **タブ付きコンテナ (Tabbed containers)**
タブ付きコンテナは、標準的なコンテナのように要素をグループ化するために使用されますが、複数のコンテンツタブ間を移動する機能も提供します。提供されているコントロールを使用してタブ間を移動するか、コントロールを非表示にしてアクションを使用してタブ間を移動することができます。

##### **モーダル (Modals)**
モーダルは、ワークブック上にオーバーレイとして表示されるページのような要素です。アクションによってモーダルを開閉するように構成でき、現在のページを覆い隠して、ユーザーがモーダルのコンテンツと対話するように誘導します。

##### **ポップオーバー (Popovers)**
ポップオーバーは、トリガーボタンに固定された、より小さなレイアウト要素です。ポップオーバー内に複数のフィルターやコントロールをグループ化して、視覚的な散らかりを減らすことができます。
ポップオーバーはモーダルに似ていますが、2つの重要な点で異なります。
* ポップオーバーは常にトリガーボタンに固定されます。
* ポップオーバーは現在のページを覆い隠さないため、ユーザーの注意をあまり妨げません。

#### **使用例 (Example use cases)**
各レイアウト要素は、ワークブックにインタラクティビティを追加する際に特定の目的を果たします。例えば、コンテナは単一ページのコンテンツを整理するのに優れています。しかし、ページに多くの要素を収めるのに苦労している場合、コンテナはタブ付きコンテナやモーダルほど役立ちません。これは、タブ付きコンテナとモーダルは両方とも要素を配置できる新しいワークブックスペースを作成するのに対し、コンテナはそうではないためです。

ニーズに合ったレイアウト要素を決定する際に、以下の使用例を検討してください。

* **ダッシュボード上のメトリクスをコンテナで分離する**
    コンテナを使用すると、ページ上の要素をグループ化できます。1つのワークブックページを使用して2つの別々のメトリクスを表示する場合、各メトリクスに関連する要素をそれぞれのコンテナにグループ化できます。
    要素間に視覚的な区切りを作成し、各コンテナに背景色などのスタイルを適用することで、ユーザーは一目でどの要素がどのメトリクスを参照しているかを明確に理解できます。

* **モーダルで複数のユーザー入力を処理する**
    モーダルを使用すると、現在のページを覆い隠し、ユーザーが対話するための新しいコンテンツセットを提供できます。データアプリを使用してユーザー入力をキャプチャする場合、モーダルを使用して、必要な入力にユーザーの注意を向けさせることができます。ボタンクリックでモーダルを開くアクションを構成することで、データアプリとのユーザーインタラクションをさらに合理化できます。
    この例では、プロジェクトトラッカーのデータアプリで、エンドユーザーが新しいプロジェクトに関する情報を入力できます。「プロジェクトを作成」ボタンは、必要な情報を入力できるモーダルを開くように構成されており、その後、モーダルで入力した情報に基づいて新しい行を挿入できます。

### 9-4-1. アクションの概要 (Intro to actions)

アクションは、ワークブックの要素内および要素間で構成できる、ユーザー定義のインタラクティビティです。特定のユーザーインタラクションへの応答を自動化することで、迅速で関連性の高いデータインサイトを生み出す効率的なワークブックのワークフローを作成できます。

このドキュメントでは、アクションの条件、トリガー、および効果について紹介します。アクションの使用に関する情報については、このページの最後にある「[関連リソース](#related-resources)」セクションを参照してください。

#### **アクションを理解する (Understanding actions)**
個々のアクションは、条件（任意）、トリガー、および効果で構成されます。

| | |
| :--- | :--- |
| **条件 (Condition) (任意)** | アクションまたはアクションシーケンス¹がいつ実行されるかを決定するルール。 |
| **トリガー (Trigger)** | 一つ以上のアクションまたはアクションシーケンスの応答を開始する、特定の要素（トリガー要素）とのユーザーインタラクション。 |
| **効果 (Effect)** | ユーザーインタラクションに対する定義された応答。 |

¹ ワークブック要素に単一のアクションを構成するか、指定された順序で実行される[複数のアクションのシーケンス](https://help.sigmacomputing.com/docs/create-and-manage-actions#create-an-action-sequence)を構成できます。

##### **アクションの条件 (Action conditions)**
任意のアクションシーケンスに対して、オプションの条件を定義できます。条件はカスタム数式にすることも、コントロールのアクションを構成している場合はコントロールの値にすることもできます。
詳細は、「[Make an action conditional](https://help.sigmacomputing.com/docs/create-and-manage-actions#make-an-action-conditional)」を参照してください。

##### **アクションのトリガー (Action triggers)**
アクションのトリガーは、ほとんどの要素タイプで構成できます。以下の表は、サポートされているトリガータイプを説明しています。
> 📘
> トリガー要素が最大化されている場合、アクションは開始されません。この動作は、最大化された要素がブラウザウィンドウ全体に広がっている間は見えないアクション効果をユーザーがトリガーするのを防ぎます。

| 要素タイプ | トリガータイプ（ユーザーインタラクション） |
| :--- | :--- |
| **テーブル、ピボットテーブル、または入力テーブル** | **On select:** ユーザーが特定の列のセルを選択する。<br>**Cell context menu:** ユーザーがセルの[カスタムコンテキストメニュー](https://help.sigmacomputing.com/docs/create-and-manage-actions#add-a-custom-context-menu-item)項目を選択する。 |
| **ビジュアライゼーション** | **On select:** ユーザーがチャート上のデータポイントまたはカテゴリを選択する。<br>**Cell context menu:** ユーザーがデータポイントの[カスタムコンテキストメニュー](https://help.sigmacomputing.com/docs/create-and-manage-actions#add-a-custom-context-menu-item)項目を選択する。 |
| **UI要素 (ボタンまたは画像のみ)** | **On click:** ユーザーが要素をクリックする。 |
| **コントロール要素** | **On change:** ユーザーがコントロールの値を変更する。 |
| **モーダル** | **On click - primary:** ユーザーがプライマリボタンをクリックする。<br>**On click - secondary:** ユーザーがセカンダリボタンをクリックする。<br>**On close:** ユーザーがXをクリックするか、モーダルの外側をクリックする。 |
| **プラグイン** | ユーザーが構成したインタラクション。「[Configure plugins to use as trigger elements](https://help.sigmacomputing.com/docs/configure-plugins-to-use-as-trigger-elements)」を参照。 |

##### **アクションの効果 (Action effects)**
以下の表は、トリガー要素で構成できるアクションと、対応する効果をリストアップしたものです。

| カテゴリ | アクション | 効果 |
| :--- | :--- | :--- |
| **ナビゲーション** | **Open link** | Sigma内の外部リンクまたは宛先にナビゲートします。 |
| | **Open Sigma doc** | 別のSigmaワークブックにナビゲートします。 |
| | **Navigate in this workbook** | 現在のワークブックの特定のページまたは個々の要素の先頭にフォーカスを移動します。 |
| **ダウンロードとエクスポート** | | 直接ダウンロード、またはメール、Slack、Webhook、クラウドストレージへのエクスポートを開始します。 |
| **コントロール** | **Set control value** | 現在のワークブックの特定のコントロール要素の値を設定します。 |
| | **Clear control** | 現在のワークブックの特定のコントロール要素の値をクリアします。 |
| **要素** | **Modify element** | 要素の列、グルーピング、プロパティ、または軸スケールを修正します。 |
| | **Refresh element** | 現在のワークブックの特定の要素のデータを更新します。このアクションはマテリアライズされた要素には適用されません。 |
| **モーダルとタブ付きコンテナ** | **Open modal** | 現在のワークブックでモーダルを開きます。 |
| | **Close modal** | 開いているモーダルを閉じます。 |
| | **Select tab** | 特定のタブが開いた状態でタブ付きコンテナを表示します。 |
| **入力テーブル** | **Insert row** | 既存の入力テーブルに新しい行を追加します。 |
| | **Update row** | 既存の入力テーブルの行の値を更新します。 |
| | **Delete row** | 既存の入力テーブルから行を削除します。 |
| **高度な設定** | **Call stored procedure** | ストアドプロシージャを呼び出します。 |
| | **Generate iframe event (for embedding)** | アウトバウンドのiframeイベントを生成します。 |
| | **Trigger plugin** | プラグイン内の効果をトリガーします。 |

#### **アクションの構成 (Action configurations)**
アクションは、あなたの特定のニーズや好みに非常に関連性の高い応答をサポートするための、多目的な構成を備えています。

例：
* `Open URL`アクションを構成して静的なリンクを開くか、動的テキストを利用して現在のワークブックのコントロールや列の値に応じて調整されるURLを生成します。
* `Set control value`アクションを構成してトリガー要素自体をフィルタリングするか、子要素をフィルタリングする要素間のアクションを作成します。
* `Open Sigma doc`アクションを構成して別のワークブックを公開状態で開くか、宛先ワークブックのコントロール要素に値を渡してカスタムのドリルダウンビューを開きます。

異なるタイプのアクションの構成に関する詳細情報については、このページの最後にある「関連リソース」セクションを参照してください。

### 9-4-2. コンテナを使用してワークブックのレイアウトを整理する (Use containers to organize workbook layouts)

ワークブックページにコンテナを追加して、キャンバス上の要素を整理し、要素を視覚的にグループ化します。コンテナを使用すると、レイアウトの管理や要素のグループとしてのスタイル設定が容易になります。

コンテナは[レイアウト要素](https://help.sigmacomputing.com/docs/intro-to-layout-elements)であり、Sigmaで[データアプリ](https://help.sigmacomputing.com/docs/about-sigma-data-apps)を構築する際に、ユーザーをガイドし、焦点の合ったインターフェースを作成することができます。

コンテナは、以下のような場合に使用します。
* チャートとそのフィルター/コントロールとの間に明確な視覚的接続を作成する。
* 同じページ上で一つの要素グループを別のグループから分離する。
* 複数の要素を同時に移動する。

#### **前提条件 (Prerequisites)**
* ワークブックの所有者であるか、ワークブックに対する`Can edit`または`Can explore`の権限を持っている必要があります。

#### **ワークブックにコンテナを追加する (Add a container to a workbook)**
空のコンテナを追加するか、既存の要素の周りにコンテナを追加することができます。
* [空のコンテナを追加する](#add-an-empty-container)
* [既存の要素の周りにコンテナを追加する](#add-a-container-around-existing-elements)

##### **空のコンテナを追加する (Add an empty container)**
1.  `Add element`バーで、`Layout`を選択し、次に`Container`を選択します。
2.  `Add element`バーから任意の要素を選択し、コンテナ内にドラッグします。

##### **既存の要素の周りにコンテナを追加する (Add a container around existing elements)**
既存の要素の周りにコンテナを追加するには、複数の方法があります。
* ドラッグして複数の要素を選択し、`Create container`()をクリックするか、`ctrl/cmd+g`を押します。
* `Cmd/ctrl+click`で複数の要素を選択し、`Create container`()をクリックするか、`ctrl/cmd+g`を押します。

コンテナはキャンバス上に作成され、デフォルトで選択されます。
> 📘
> コンテナやタブ付きコンテナをネストする場合、4レベルまでしかネストできません。既に3つのコンテナやタブ付きコンテナ要素に囲まれているレイアウト要素の内側にコンテナを配置しようとすると、Sigmaは「Cannot nest more than 4 levels of layouts」というエラーを表示します。

#### **コンテナをカスタマイズする (Customize a container)**
コンテナの場所、サイズ、スタイルをカスタマイズするには、以下のセクションを参照してください。

##### **コンテナを移動する (Move a container)**
コンテナとその要素の場所を変更するには、コンテナの端を選択してコンテナを選択し、コンテナを新しい場所にドラッグします。

##### **コンテナのサイズを変更する (Resize a container)**
デフォルトでは、コンテナのグリッド幅は12で、必要に応じてサイズを変更できます。コンテナの端をドラッグしてサイズを変更します。
コンテナを内部の要素より小さくサイズ変更することはできません。
コンテナを水平方向にサイズ変更すると、コンテナ内のグリッドスペースの幅が変わり、コンテナ内の要素は水平方向にサイズ変更されてフィットします。
コンテナを垂直方向にサイズ変更すると、コンテナ内の垂直グリッドスペースの数が変わりますが、要素は自動的にサイズ変更されません。

##### **コンテナのレイアウトグリッド密度を変更する (ベータ版) (Change the layout grid density of a container (Beta))**
> 🚩
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です...

コンテナには、キャンバス上のグリッドと同様に、独自のグリッドがあります。デフォルトでは、コンテナのグリッドには12の水平グリッドスペース、つまり12の「列」があり、コンテナのサイズに合わせて伸縮します。この密度は、エディタパネルの`Properties`タブにある`Layout grid density`設定を使用して変更できます。
> 💡
> 高密度はより多くの（そしてより狭い）列を意味し、これにより、より多くの要素を並べて配置し、その幅をより細かく制御できます。低密度はより少ない（そしてより広い）列を意味し、これにより、ブラウザウィンドウの幅が縮小されたときに要素のコンテンツの過密を防ぎ、可視性を確保します。

* `Low`列密度のコンテナには6つのグリッド列があります。
* `Medium`列密度のコンテナには12のグリッド列があります。これがデフォルトの密度です。
* `High`列密度のコンテナには24のグリッド列があります。キャンバスの全幅にドラッグすると、高列密度のコンテナ内のグリッドは、完全なキャンバスグリッドと整列します。

##### **コンテナをスタイル設定する (Style a container)**
エディタパネルで、`Format`を選択してコンテナをスタイル設定します。

| スタイル | 詳細 |
| :--- | :--- |
| **Spacing (間隔)** | コンテナ内の要素間に含めるスペースの量を指定します。パディングがオンの場合、間隔設定はパディングの量も決定します。 |
| **Padding (パディング)** | コンテナにパディングを追加します。デフォルトでオンです。トグルをオフにして、要素とコンテナの間のパディングを削除します。 |
| **Background color (背景色)** | コンテナの背景色を選択します。 |
| **Border (境界線)** | コンテナの境界線を指定します。デフォルトはnoneですが、1, 2, 3ピクセルに設定できます。境界線の色も選択できます。 |
| **Corner (角)** | コンテナの角の形状を選択します。四角、丸、ピルから選択します。デフォルトは丸です。 |
| **Element gap (要素のギャップ)** | コンテナ内の要素間にパディングを追加します。デフォルトでオンです。トグルをオフにして要素間のパディングを削除します。 |

##### **コンテナを削除する (Remove or delete a container)**
要素の周りのコンテナを削除するには、囲んでいるコンテナを選択し、`More` > `Remove container`を選択します。コンテナは削除され、コンテナ内のすべての要素はキャンバスに配置されます。要素は同じ書式設定を保持します。

コンテナとコンテナ内のすべての要素を削除することもできます。そのためには、囲んでいるコンテナを選択し、`More` > `Delete container`を選択します。コンテナと内部のすべての要素が削除されます。

### 9-4-3. タブ付きコンテナを使用してワークブックのコンテンツを整理する (Use tabbed containers to organize workbook content)

ワークブックキャンバスの同じセクションで複数のコンテンツセットを提供したい場合は、ワークブックページにタブ付きコンテナを追加します。タブ付きコンテナは、ワークブック要素の整理、グループ化、および管理に関しては、通常の[コンテナ](https://help.sigmacomputing.com/docs/use-containers-to-organize-workbook-layouts)とまったく同じように機能します。さらに、タブ付きコンテナには複数のタブがあり、コンテナの上部に表示することも、エンドユーザーから非表示にすることもできます。異なるタブにコンテンツを配置し、どのタブを表示すべきかに関するロジックを構成することで、ユーザーがスクロールしたり他の場所に移動したりすることなく、同じスペースで異なるビューを体験できるようにすることができます。

タブ付きコンテナは[レイアウト要素](https://help.sigmacomputing.com/docs/intro-to-layout-elements)であり、Sigmaで[データアプリ](https://help.sigmacomputing.com/docs/about-sigma-data-apps)を構築する際に、ユーザーをガイドし、焦点の合ったインターフェースを作成することができます。

タブ付きコンテナは、以下のような場合に使用します。
* チャートとその基盤となるデータを同じダッシュボードスペースに表示する。
* コントロールで選択されたアイテムの数に基づいて異なるチャートを表示する。
* 空の要素に対してカスタムの「データなし」メッセージを表示する。
* あるチャートタイプから別のチャートタイプに変わるドリルダウンを作成する。

#### **制限事項 (Limitations)**
* 個々のタブを非表示にすることはサポートされていません。タブバー全体を表示または非表示にすることはできますが、個々のタブはできません。タブバーを非表示にした場合、デフォルトタブ以外のタブを表示する唯一の方法は、`Select tab`アクションを介することです。「[要素を修正または更新するアクションを作成する](https://help.sigmacomputing.com/docs/create-actions-that-modify-or-refresh-elements)」を参照してください。
* タブ付きコンテナを持つワークブックからエクスポートする場合、エクスポートは常に、エディタパネルのプロパティタブでデフォルトタブとしてラベル付けされた最初のタブをレンダリングします。
* コンテナやタブ付きコンテナをネストする場合、4レベルまでしかネストできません。

#### **前提条件 (Prerequisites)**
* ワークブックの所有者であるか、ワークブックに対する`Can edit`または`Can explore`の権限を持っている必要があります。

#### **ワークブックにタブ付きコンテナを追加する (Add a tabbed container to a workbook)**
編集モードまたは探索モードで、以下の手順に従ってタブ付きコンテナを追加します。
1.  `Add element`バーで、`Layout`を選択し、次に`Tabbed container`を選択します。
2.  空のタブ付きコンテナが表示されます。
    > 💡
    > キャンバスに既にある他の要素の幅にコンテナのサイズをすばやく合わせるには、タブ付きコンテナを追加する前に、合わせたい要素を選択します。

#### **タブ付きコンテナをカスタマイズする (Customize a tabbed container)**
タブコントロール、コンテナのレイアウト、およびスタイルをカスタマイズするには、以下のセクションを参照してください。

##### **タブ付きコンテナを構成する (Configure a tabbed container)**
最初にワークブックにタブ付きコンテナを追加すると、Tab 1、Tab 2、Tab 3という名前の3つの空のタブが含まれています。
タブ付きコンテナの構成をカスタマイズするには、エディタパネルの`Properties`タブを使用します。
* タブの名前を変更するには、`Properties`タブで、デフォルトのタブ名をダブルクリックします。
* タブを並べ替えるには、`Properties`タブでタブ名の左にあるドラッグハンドルをクリックし、リスト内の希望の場所にドラッグします。
    > 📘
    > コンテナの最初のタブがデフォルトタブです。デフォルトタブは、ユーザーがビューまたは探索モードでワークブックにアクセスしたときに表示されるものです。
* タブを複製するには、`More`をクリックし、`Duplicate`をクリックします。
* ユーザーのアクションに基づいて異なるタブを表示するように構成するには、`Select tab`アクションを構成します。

##### **タブ付きコンテナのサイズを変更する (Resize a tabbed container)**
デフォルトでは、タブ付きコンテナのグリッド幅は12で、必要に応じてサイズを変更できます。コンテナの端をドラッグしてサイズを変更します。
コンテナを内部の要素より小さくサイズ変更することはできません。
タブ付きコンテナのすべてのタブは、同じ幅と高さを共有します。

##### **タブ付きコンテナのグリッド列密度を変更する (ベータ版) (Change the grid column density of a tabbed container (Beta))**
> 🚩
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このページは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

コンテナには、キャンバス上のグリッドと同様に、独自のグリッドがあります。デフォルトでは、コンテナのグリッドには12の水平グリッドスペース、つまり12の「列」があり、コンテナのサイズに合わせて伸縮します。この密度は、エディタパネルの`Properties`タブにある`Column density`設定を使用して変更できます。
> 💡
> 高密度はより多くの（そしてより狭い）列を意味し、これにより、より多くの要素を並べて配置し、その幅をより細かく制御できます。低密度はより少ない（そしてより広い）列を意味し、これにより、ブラウザウィンドウの幅が縮小されたときに要素のコンテンツの過密を防ぎ、可視性を確保します。

* `Low`列密度のコンテナには6つのグリッド列があります。
* `Medium`列密度のコンテナには12のグリッド列があります。これがデフォルトの密度です。
* `High`列密度のコンテナには24のグリッド列があります。キャンバスの全幅にドラッグすると、高列密度のコンテナ内のグリッドは、完全なキャンバスグリッドと整列します。

##### **タブ付きコンテナをスタイル設定する (Style a tabbed container)**
エディタパネルで、`Format`タブを選択してコンテナをスタイル設定します。

| スタイル | 詳細 |
| :--- | :--- |
| **Spacing (間隔)** | コンテナ内の要素間に含めるスペースの量を指定します。タブバーが表示されている場合、間隔設定はタブ付きコンテナの上部とタブバーの間のスペースの量も変更します。パディングがオンの場合、間隔設定はパディングの量も決定します。 |
| **Padding (パディング)** | タブ付きコンテナにパディングを追加します。デフォルトで選択されています。チェックボックスの選択を解除して、要素の外側の端とコンテナの間のパディングを削除します。 |
| **Background color (背景色)** | タブ付きコンテナの背景色を選択します。 |
| **Border (境界線)** | タブ付きコンテナの境界線を指定します。デフォルトはnoneですが、1, 2, 3ピクセルに設定できます。境界線の色も選択できます。 |
| **Corner (角)** | タブ付きコンテナの角の形状を選択します。四角、丸、ピルから選択します。デフォルトは丸です。 |
| **Element gap (要素のギャップ)** | タブ付きコンテナ内の要素間にパディングを追加します。デフォルトで選択されています。チェックボックスの選択を解除して要素間のパディングを削除します。 |

`Tab bar style`セクションを開いて、タブバーをスタイル設定します。

| スタイル | 詳細 |
| :--- | :--- |
| **Show tab bar** | トグルをオフにして、表示モードおよび探索モードのエンドユーザーからタブバーを非表示にします。デフォルトでは、タブバーは表示されます。タブバーを非表示にした場合、デフォルトタブ以外のタブを表示する唯一の方法は、`Select tab`アクションを使用することです。「[要素を修正または更新するアクションを作成する](https://help.sigmacomputing.com/docs/create-actions-that-modify-or-refresh-elements)」を参照してください。 |
| **Tab style** | `Open`, `Box`, `Button`を選択します。デフォルトのスタイルは`Open`です。 |
| **Alignment** | `Left`, `Center`, `End`, `Justify`を選択して、タブバー内のタブの配置を指定します。デフォルトの配置は`Left`です。 |
| **Size** | タブのサイズを`Small`, `Medium`, `Large`から選択します。デフォルトのサイズは`Medium`です。 |

##### **タブ付きコンテナを削除する (Remove or delete a tabbed container)**
タブ付きコンテナを削除すると、タブ付きコンテナのすべてのタブ内のすべての要素も削除されます。そのためには、タブ付きコンテナを選択し、`More` > `Delete element`を選択します。タブ付きコンテナと内部のすべての要素が削除されます。

### 9-4-4. モーダルを使用して焦点の合ったコンテンツビューを作成する (Use modals to create focused content views)

モーダルは、ワークブックのデザインを簡素化し、合理化されたアプリのような体験を構築するのに役立ちます。開いたモーダルは、ワークブックページを覆い隠して、モーダルのコンテンツに焦点を合わせたビューを提供します。これにより、視覚的な散らかりが減り、フォームフィールドの提示、カスタマイズされたドリルダウンの提供、専用コンテナでのコントロールとフィルターの表示などが可能になります。

モーダルは[レイアウト要素](https://help.sigmacomputing.com/docs/intro-to-layout-elements)であり、Sigmaで[データアプリ](https://help.sigmacomputing.com/docs/about-sigma-data-apps)を構築する際に、ユーザーをガイドし、焦点の合ったインターフェースを作成することができます。

モーダルは、以下のような場合に使用します。
* 特定の要素または要素のセットにスポットライトを当てる。
* 追加のページを作成せずにダッシュボードに要素を追加する。
* ユーザーのデータ入力にアプリのような体験を提供する。

このドキュメントでは、モーダルの作成とカスタマイズの方法について説明します。ワークブックにモーダルを組み込むには、`Open modal`アクションを構成する必要があります。このアクションの使用に関する詳細は、「[宛先にナビゲートするアクションを作成する](https://help.sigmacomputing.com/docs/create-actions-that-navigate-to-destinations)」を参照してください。

#### **ユーザー要件 (User requirements)**
モーダルを作成および修正する機能には、以下が必要です。
* この機能を使用するには、個々のワークブックに対する`Can edit`または`Can explore`のアクセス権が必要です。
* ワークブックの`Edit`または`Explore`モードである必要があります。「[workbook modes overview](https://help.sigmacomputing.com/docs/workbook-modes-overview)」を参照してください。

#### **ワークブックにモーダルを追加する (Add a modal to your workbook)**
ワークブックにモーダルを追加するには、以下を含むいくつかの方法があります。
* `Add element`バーで、`Layout`を選択し、次に`Modal`を選択します。
* ワークブックのフッターで、下矢印()を選択し、`Add modal`を選択します。
* 既存の要素を移動中に新しいモーダルを作成します。要素ツールバーで`More`を選択し、ドロップダウンから`Move to` > `New modal`を選択します。
* モーダルを開くワークブックアクションを作成します。`Select modal`フィールドで、`New modal`を選択します。

モーダルは、事前定義されたサイズを持つ、ワークブックの新しい非表示のページタブとして表示されます。ワークブックのページと同じように、要素を追加し、モーダルをカスタマイズします。すべての要素タイプがサポートされていますが、要素を追加する際にはモーダルのサイズとレイアウトを考慮してください。

デフォルトでは、モーダルにはデフォルトのタイトルとプライマリおよびセカンダリボタンが含まれています。モーダルの外観をカスタマイズするには、「[モーダルをカスタマイズする](https://help.sigmacomputing.com/docs/customize-a-modal)」を参照してください。

任意で、ワークブックを整理するためにモーダルの名前を変更できます。モーダルのページタブで、下矢印()を選択し、`Rename`を選択するか、モーダルタブをダブルクリックして名前を変更します。モーダル名は、モーダルに表示されるタイトルとは別です。

### 9-4-5. モーダルをカスタマイズする (Customize a modal)

ユースケースに合わせてモーダルの外観をカスタマイズします。例えば、ドキュメントを表示するモーダルにはボタンは不要かもしれませんし、ワークブックページを修正するモーダルはタイトルの動的テキスト書式設定が役立つかもしれません。

デフォルトでは、モーダルにはタイトルと閉じるアイコンを持つヘッダー、および2つのボタンを持つフッターが含まれています。ヘッダーやフッターに追加の要素を配置することはできませんが、ボタンを含むヘッダーとフッターの両方の表示をカスタマイズし、非表示にすることができます。

モーダルの外観と機能をカスタマイズするには、以下のセクションを参照してください。
* [モーダルの外観をカスタマイズする](#customize-modal-appearance)
* [モーダルにタイトルを追加する](#add-a-title-to-the-modal)
* [モーダルのフッターとボタンをカスタマイズする](#customize-the-footer-and-buttons-on-the-modal)

#### **モーダルの外観をカスタマイズする (Customize modal appearance)**
モーダルの幅とモーダル上の要素の間隔をカスタマイズできます。また、パディングや要素間のギャップを表示するかどうかも選択できます。必要であれば、モーダルに背景色を追加します。背景色はモーダルのフッターには適用されません。

##### **モーダルの幅をカスタマイズするには：**
1.  ワークブックページでモーダルを選択します。
2.  エディタパネルで、`Width`を選択します。デフォルトでは、モーダルの幅は`Small`です。`Extra small`, `Small`, `Medium`, `Large`, `Extra large`から選択します。

##### **モーダルの外観（追加された要素を含む）をカスタマイズするには：**
1.  ワークブックページでモーダルを選択します。
2.  エディタパネルで、`Format`を選択します。
3.  `Modal style`をクリックしてセクションを展開し、スタイルオプションを表示します。

| スタイル | 詳細 |
| :--- | :--- |
| **Spacing (間隔)** | モーダルの外側と行の間のスペースを管理します。`Small`, `Medium`（デフォルト）, `Large`から選択します。 |
| **Padding (パディング)** | モーダルにパディングを追加します。デフォルトで選択されています。トグルをオフにして、要素とモーダルの間のパディングを削除します。 |
| **Background color (背景色)** | モーダルの背景色を選択します。フッターには適用されません。 |
| **Element gap (要素のギャップ)** | 要素間にパディングを追加します。デフォルトで選択されています。トグルをオフにして要素間のすべてのスペースを削除します。 |

#### **モーダルにタイトルを追加する (Add a title to the modal)**
デフォルトでは、モーダルにはデフォルトのタイトル`New Modal`と閉じるアイコンを持つヘッダーが含まれています。モーダルのタイトルまたは閉じるアイコンを非表示または修正するには：
1.  ワークブックページでモーダルを選択します。
2.  エディタパネルで、`Format`を選択します。
3.  `Header`をクリックしてヘッダーの書式設定オプションを展開します。
4.  (任意) `Show title`をオフにしてタイトルを非表示にします。`Show title`はデフォルトで有効です。
5.  タイトルが表示されている場合、テキストボックスを使用してタイトルを追加または更新します。`=`を入力して動的テキスト数式を使用します。「[データに基づいて動的テキストを追加する](https://help.sigmacomputing.com/docs/text-elements#add-dynamic-text-based-on-your-data)」を参照してください。
6.  (任意) タイトルテキストの書式設定を変更するには、書式設定ツールを使用して太字を追加したり、テキストの色やサイズを変更したりします。
7.  (任意) 閉じるアイコンを表示または非表示にするには、`Show close icon`をオンまたはオフにします。
    * タイトルと閉じるアイコンの両方を非表示にすると、ヘッダーが非表示になります。

#### **モーダルのフッターとボタンをカスタマイズする (Customize the footer and buttons on the modal)**
デフォルトでは、フッターには2つのボタンがあり、色のスタイリングに合わせて`Primary`と`Secondary`とラベル付けされています。`Add element`バーを使用して、フッターの外側にカスタムボタンをモーダルに追加することもできます。

##### **プライマリまたはセカンダリボタンをカスタマイズするには：**
1.  ワークブックページでモーダルを選択します。
2.  エディタタブで、`Format`を選択します。
3.  `Footer`をクリックしてフッターの書式設定オプションを展開します。
4.  (任意) プライマリボタンを非表示にするには、`Show primary button`をオフにします。
5.  `Text`で、テキストボックスを使用してプレースホルダーテキストを特定のコールトゥアクションに更新します。例えば、`Submit`や`Acknowledge`などです。
6.  (任意) セカンダリボタンを非表示にするには、`Show secondary button`をオフにします。
7.  `Text`で、テキストボックスを使用してプレースホルダーテキストをセカンダリのコールトゥアクションに更新します。例えば、`Cancel`や`Clear`などです。
    * 両方のボタンを非表示にすると、フッターが非表示になります。

#### **モーダルを削除する (Delete a modal)**
モーダルを削除するには、タブのキャレット()をクリックしてモーダルメニューを開き、`Delete`を選択します。
モーダルを削除すると、モーダル内のすべての要素も削除されます。

### 9-4-6. ポップオーバーを使用してワークブックのインターフェースを簡素化する (ベータ版)

> 🚩
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このページは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

ポップオーバーを使用して、特定のトリガーボタンに固定されたフローティングコンテナに、文脈に応じた情報（テーブル、チャート、フィルター、テキストなど）を表示します。ポップオーバーは、ワークブックページの他の部分を覆い隠すことなくオンデマンドで開くため、より効率的で簡素化されたワークブックインターフェースを作成するのに役立ちます。

ポップオーバーは[レイアウト要素](https://help.sigmacomputing.com/docs/intro-to-layout-elements)であり、Sigmaで[データアプリ](https://help.sigmacomputing.com/docs/about-sigma-data-apps)を構築する際に、ユーザーをガイドし、焦点の合ったインターフェースを作成することができます。

ポップオーバーは、以下のような場合に使用します。
* 1つのテーブルに対して複数のフィルターを単一のボタンで表示する。
* フィルター、コントロール、ボタンをグループ化して、視覚的な散らかりを減らす。
* 現在のページから移動させることなく、ユーザーに追加機能を提供する。

ワークブックページを覆い隠し、ワークブック要素に固定されていないフローティングコンテナを作成するには、「[モーダルの作成とカスタマイズ](https://help.sigmacomputing.com/docs/customize-a-modal)」を参照してください。

#### **ユーザー要件 (User requirements)**
ポップオーバーを作成およびカスタマイズする機能には、以下が必要です。
* `Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、ワークブックに対する`Can edit`アクセス権を付与されている必要があります。

#### **制限事項 (Limitations)**
* Sigmaは現在、他のポップオーバー内にポップオーバーをネストすることをサポートしていません。ただし、ポップオーバーは[モーダル](https://help.sigmacomputing.com/docs/use-modals-to-create-focused-content-views)内にネストすることができます。

#### **ポップオーバーを作成する (Create a popover)**
ポップオーバーを作成するには、まずワークブックに`Popover`要素を追加します。
1.  ワークブックのドラフトを開きます。
2.  `Add element`バーで、`Layout`を選択し、次に`Popover`を選択します。

Sigmaは、以下のスクリーンショットで説明および識別されている2つのポップオーバーコンポーネントを追加します。
* **トリガーボタン (Trigger button):** ポップオーバーを開きます。
* **ポップオーバー構成ページ (Popover configuration page):** ポップオーバーのコンテンツ、プロパティ、およびスタイルをカスタマイズできます。構成ページと対応するタブは、ワークブックのドラフトでのみ表示されます。

#### **ポップオーバーをカスタマイズする (Customize a popover)**

ポップオーバーのコンテンツ、幅、またはスタイルをカスタマイズするには、以下のセクションを参照してください。
* [ポップオーバーのコンテンツを追加または編集する](#add-or-edit-the-popover-content)
* [ポップオーバーの幅を変更する](#change-the-popover-width)
* [ポップオーバーのスタイルをカスタマイズする](#customize-the-popover-style)

#### **ポップオーバーのコンテンツを追加または編集する (Add or edit the popover content)**
ポップオーバーに表示する文脈に応じた情報を追加または編集します。
1.  ポップオーバー構成ページのタブを選択します。
2.  `Add element`バーを使用して、ワークブックページに要素を追加するのと同じ方法で要素を追加します。ポップオーバーを除き、任意のデータ、入力、チャート、コントロール、UI、またはレイアウト要素を含めることができます。Sigmaはネストされたポップオーバーをサポートしていません。

#### **ポップオーバーの幅を変更する (Change the popover width)**
ポップオーバーの幅を調整して、そのコンテンツとワークブック内での配置に対応させます。
1.  ポップオーバー構成ページのタブを選択します。
2.  エディタパネルで、`Properties`タブを選択します。
3.  `Width`ドロップダウンで、オプションを選択してポップオーバーの幅を調整します。

#### **ポップオーバーのスタイルをカスタマイズする (Customize the popover style)**
ポップオーバーの間隔、パディング、背景色、および要素間のギャップを構成します。
1.  ポップオーバー構成ページのタブを選択します。
2.  エディタパネルで、`Format`タブを選択します。
3.  `Popover style`セクションを展開して、スタイル設定を表示します。
4.  スタイル設定を構成します。
    * **Spacing (間隔):** パディングと要素ギャップのサイズを選択します。
    * **Padding (パディング):** ポップオーバーの境界とそのコンテンツの間のスペースを有効または無効にします。
    * **Background color (背景色):** ポップオーバー内の要素の背後に表示される色を選択します。
    * **Element gap (要素のギャップ):** ポップオーバー内の要素間のスペースを有効または無効にします。

#### **ポップオーバーのトリガーボタンをカスタマイズする (Customize a popover trigger button)**
ポップオーバーが固定されているトリガーボタンをカスタマイズします。ラベル、スタイル、配置、形状、サイズなど、ボタンの外観を定義するプロパティを構成できます。

トリガーボタンに直接移動するには：
1.  ポップオーバー構成ページのタブを選択します。
2.  エディタパネルで、`Properties`タブを選択します。
3.  `Trigger button`セクションで、`Edit`をクリックします。

Sigmaはトリガーボタンを含むワークブックページを開き、エディタパネルで自動的にボタンのプロパティを開きます。
エディタパネルで、ボタンのプロパティを構成します。
* **Appearance (外観):** ボタンのバリアントを選択します。
* **Text (テキスト):** ボタンに表示するラベルまたはコールトゥアクション（CTA）を追加します。
* **Style (スタイル):** フォントの太さ、テキストの色、ボタンの色をカスタマイズします。
* **Horizontal (水平方向):** ボタンを配置または引き伸ばします。
* **Vertical (垂直方向):** ボタンを配置します。
* **Shape (形状):** ボタンの形状を選択します。
* **Size (サイズ):** ボタンのサイズを選択します。
* **Show filter count (フィルター数を表示):** ポップオーバーから発生するアクティブなフィルターの数を表示するには、チェックボックスを選択します。アクティブなフィルターとは、ポップオーバー内のコントロール要素で、デフォルト値から変更されたものです。

#### **ポップオーバーを削除する (Delete a popover)**
以下のいずれかの方法を使用して、トリガーボタン、構成ページ、およびポップオーバー内のすべての要素を含むポップオーバーを削除します。

##### **トリガーボタンからポップオーバーを削除する**
1.  トリガーボタンを含むワークブックページを開きます。
2.  トリガーボタンにカーソルを合わせ、`More`をクリックします。
3.  要素メニューで、`Delete element`を選択します。

##### **構成ページタブからポップオーバーを削除する**
1.  ポップオーバー構成ページのタブで、下矢印()をクリックします。
2.  ページメニューで、`Delete`を選択します。

### 9-5-1. アクションの概要 (Intro to actions)

アクションは、ワークブックの要素内および要素間で構成できる、ユーザー定義のインタラクティビティです。特定のユーザーインタラクションへの応答を自動化することで、迅速で関連性の高いデータインサイトを生み出す効率的なワークブックのワークフローを作成できます。

このドキュメントでは、アクションの条件、トリガー、および効果について紹介します。アクションの使用に関する情報については、このページの最後にある「関連リソース」セクションを参照してください。

#### **アクションを理解する (Understanding actions)**
個々のアクションは、条件（任意）、トリガー、および効果で構成されます。

| | |
| :--- | :--- |
| **条件 (Condition) (任意)** | アクションまたはアクションシーケンス¹がいつ実行されるかを決定するルール。 |
| **トリガー (Trigger)** | 一つ以上のアクションまたはアクションシーケンスの応答を開始する、特定の要素（トリガー要素）とのユーザーインタラクション。 |
| **効果 (Effect)** | ユーザーインタラクションに対する定義された応答。 |

¹ ワークブック要素に単一のアクションを構成するか、指定された順序で実行される[複数のアクションのシーケンス](https://help.sigmacomputing.com/docs/create-and-manage-actions#create-an-action-sequence)を構成できます。

##### **アクションの条件 (Action conditions)**
任意のアクションシーケンスに対して、オプションの条件を定義できます。条件はカスタム数式にすることも、コントロールのアクションを構成している場合はコントロールの値にすることもできます。
詳細は、「[Make an action conditional](https://help.sigmacomputing.com/docs/create-and-manage-actions#make-an-action-conditional)」を参照してください。

##### **アクションのトリガー (Action triggers)**
アクションのトリガーは、ほとんどの要素タイプで構成できます。以下の表は、サポートされているトリガータイプを説明しています。
> 📘
> トリガー要素が最大化されている場合、アクションは開始されません。この動作は、最大化された要素がブラウザウィンドウ全体に広がっている間は見えないアクション効果をユーザーがトリガーするのを防ぎます。

| 要素タイプ | トリガータイプ（ユーザーインタラクション） |
| :--- | :--- |
| **テーブル、ピボットテーブル、または入力テーブル** | **On select:** ユーザーが特定の列のセルを選択する。<br>**Cell context menu:** ユーザーがセルの[カスタムコンテキストメニュー](https://help.sigmacomputing.com/docs/create-and-manage-actions#add-a-custom-context-menu-item)項目を選択する。 |
| **ビジュアライゼーション** | **On select:** ユーザーがチャート上のデータポイントまたはカテゴリを選択する。<br>**Cell context menu:** ユーザーがデータポイントの[カスタムコンテキストメニュー](https://help.sigmacomputing.com/docs/create-and-manage-actions#add-a-custom-context-menu-item)項目を選択する。 |
| **UI要素 (ボタンまたは画像のみ)** | **On click:** ユーザーが要素をクリックする。 |
| **コントロール要素** | **On change:** ユーザーがコントロールの値を変更する。 |
| **モーダル** | **On click - primary:** ユーザーがプライマリボタンをクリックする。<br>**On click - secondary:** ユーザーがセカンダリボタンをクリックする。<br>**On close:** ユーザーがXをクリックするか、モーダルの外側をクリックする。 |
| **プラグイン** | ユーザーが構成したインタラクション。「[Configure plugins to use as trigger elements](https://help.sigmacomputing.com/docs/configure-plugins-to-use-as-trigger-elements)」を参照。 |

##### **アクションの効果 (Action effects)**
以下の表は、トリガー要素で構成できるアクションと、対応する効果をリストアップしたものです。

| カテゴリ | アクション | 効果 |
| :--- | :--- | :--- |
| **ナビゲーション** | **Open link** | Sigma内の外部リンクまたは宛先にナビゲートします。 |
| | **Open Sigma doc** | 別のSigmaワークブックにナビゲートします。 |
| | **Navigate in this workbook** | 現在のワークブックの特定のページまたは個々の要素の先頭にフォーカスを移動します。 |
| **ダウンロードとエクスポート** | | 直接ダウンロード、またはメール、Slack、Webhook、クラウドストレージへのエクスポートを開始します。 |
| **コントロール** | **Set control value** | 現在のワークブックの特定のコントロール要素の値を設定します。 |
| | **Clear control** | 現在のワークブックの特定のコントロール要素の値をクリアします。 |
| **要素** | **Modify element** | 要素の列、グルーピング、プロパティ、または軸スケールを修正します。 |
| | **Refresh element** | 現在のワークブックの特定の要素のデータを更新します。このアクションはマテリアライズされた要素には適用されません。 |
| **モーダルとタブ付きコンテナ** | **Open modal** | 現在のワークブックでモーダルを開きます。 |
| | **Close modal** | 開いているモーダルを閉じます。 |
| | **Select tab** | 特定のタブが開いた状態でタブ付きコンテナを表示します。 |
| **入力テーブル** | **Insert row** | 既存の入力テーブルに新しい行を追加します。 |
| | **Update row** | 既存の入力テーブルの行の値を更新します。 |
| | **Delete row** | 既存の入力テーブルから行を削除します。 |
| **高度な設定** | **Call stored procedure** | ストアドプロシージャを呼び出します。 |
| | **Generate iframe event (for embedding)** | アウトバウンドのiframeイベントを生成します。 |
| | **Trigger plugin** | プラグイン内の効果をトリガーします。 |

#### **アクションの構成 (Action configurations)**
アクションは、あなたの特定のニーズや好みに非常に関連性の高い応答をサポートするための、多目的な構成を備えています。

例：
* `Open URL`アクションを構成して静的なリンクを開くか、動的テキストを利用して現在のワークブックのコントロールや列の値に応じて調整されるURLを生成します。
* `Set control value`アクションを構成してトリガー要素自体をフィルタリングするか、子要素をフィルタリングする要素間のアクションを作成します。
* `Open Sigma doc`アクションを構成して別のワークブックを公開状態で開くか、宛先ワークブックのコントロール要素に値を渡してカスタムのドリルダウンビューを開きます。

異なるタイプのアクションの構成に関する詳細情報については、このページの最後にある「関連リソース」セクションを参照してください。

### 9-5-2-1. 宛先にナビゲートするアクションを作成する (Create actions that navigate to destinations)

ワークブックは、ユーザーを事前定義されたURL、他のSigmaドキュメント、または現在のワークブック内の異なる場所にナビゲートするアクションをサポートしています。

このドキュメントでは、ユーザーを特定の宛先にナビゲートするアクションを作成する方法について説明します。Sigmaのアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

#### **ユーザー要件 (User requirements)**
> 📘
> 以下の要件は、アクションを構成するユーザーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

#### **リンクを開く (Open a link)**
外部リンクまたはSigma内の宛先にナビゲートするアクションを作成します。静的なリンクを開くか、現在のワークブックのコントロールや列の値に応じて調整される[動的なURL](#open-a-link-with-a-dynamic-url)を生成します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。
    * **Action:** `Open link`を選択します。
    * **Link URL:** 外部リンクまたはSigma内の宛先のURLを入力します。
    * **Open in:** リンクがブラウザでどのように開くかを決定するオプションを選択します。
        * **New window:** 新しいブラウザウィンドウでリンクを開きます。
        * **Same window:** ユーザーがSigma内で直接トリガー要素と対話する場合、現在のブラウザウィンドウでリンクを開きます。
        * **Parent window:** ユーザーが埋め込みでトリガー要素と対話する場合、現在のブラウザウィンドウでリンクを開きます。
7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

##### **動的URLでリンクを開く (Open a link with a dynamic URL)**
現在のワークブックのコントロールや列の値に応じて調整される動的なURLを生成するには、前のセクションのステップ6で`Link URL`フィールドを構成する際に、Sigmaの動的テキスト機能を利用します。
1.  `Link URL`フィールドに、ベースURLを入力し、動的な値を追加したい場所に`=`を入力します。
2.  `=`を入力すると、Sigmaはすぐに数式バーを含むオーバーレイを表示します。
    * コントロールの値を渡すには、角括弧でコントロールIDを入力します：`[<control-ID>]`。
    * 列で行われた選択を渡すには、選択を参照する変数を追加します：`[Selection/<Column Name>]`。
    * 列のすべての値を渡すには、角括弧で囲んだ要素の列名を入力します：`[<Element name>/<Column name>]`。

#### **ワークブックまたはテンプレートを開く (Open a workbook or template)**
別のSigmaワークブックまたはテンプレートにナビゲートするアクションを作成します。宛先ドキュメントを公開状態で開くか、[既存のコントロール要素に特定の値を渡して](https://help.sigmacomputing.com/docs/create-actions-that-navigate-to-destinations#pass-values-to-controls-in-the-destination-workbook)、即座にドリルダウンされたビューを開きます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素を選択します。
3.  `Actions`タブを開きます。
4.  `+ Add action`をクリックします。
5.  モーダルで、応答を定義するために必要なフィールドを構成します。
    * **Action:** `Open Sigma doc`を選択します。
    * **Destination:** 開くワークブックまたはテンプレートを選択します。
    * **Pass control values:** このドキュメントの「[宛先ワークブックのコントロールに値を渡す](#pass-values-to-controls-in-the-destination-workbook)」を参照してください。
    * **Open in:** リンクがブラウザでどのように開くかを決定するオプションを選択します。

##### **宛先ワークブックのコントロールに値を渡す (Pass values to controls in the destination workbook)**
宛先ワークブックのドリルダウンされたビューを開くには、前のセクションのステップ5で`Pass control values`フィールドにコントロールターゲットとルールを追加します。
1.  `Pass control values`セクションで、`+ Add a control target`をクリックします。
2.  必要なフィールドを構成して、コントロールターゲットを識別し、ルールを定義します。
    * **Update control:** 宛先ワークブックで更新するコントロール要素を選択します。
    * **Set value as:** Sigmaがコントロールに渡す値のタイプを決定するオプションを選択し、値を定義します。

#### **現在のワークブックをナビゲートする (Navigate the current workbook)**
現在のワークブック内の特定の場所にナビゲートするアクションを作成します。ページの先頭または個々の要素にフォーカスを移動します。
1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素を選択します。
3.  `Actions`タブを開きます。
4.  `+ Add action`をクリックします。
5.  モーダルで、応答を定義するために必要なフィールドを構成します。
    * **Action:** `Navigate in this workbook`を選択します。
    * **Destination:** ワークブックビューでフォーカスするページまたは要素を選択します。
  
#### **ワークブックまたはテンプレートを開く (Open a workbook or template)**
別のSigmaワークブックまたはテンプレートにナビゲートするアクションを作成します。宛先ドキュメントを公開状態で開くか、[既存のコントロール要素に特定の値を渡して](https://help.sigmacomputing.com/docs/create-actions-that-navigate-to-destinations#pass-values-to-controls-in-the-destination-workbook)、即座にドリルダウンされたビューを開きます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Open Sigma doc`を選択します。 |
| **Destination** | 開くワークブックまたはテンプレートを選択します。<br>対話するユーザーは、アクセス権が付与されている場合にのみ宛先ドキュメントを表示できます。 |
| **Pass control values** | このドキュメントの「[宛先ワークブックのコントロールに値を渡す](#pass-values-to-controls-in-the-destination-workbook)」を参照してください。 |
| **Open in** | ワークブックまたはテンプレートがブラウザでどのように開くかを決定するオプションを選択します。<br>**New window:** 新しいブラウザウィンドウでドキュメントを開きます。<br>**Same window:** ユーザーがSigma内で直接トリガー要素と対話する場合、現在のブラウザウィンドウでドキュメントを開きます。<br>**Parent window:** ユーザーが埋め込みでトリガー要素と対話する場合、現在のブラウザウィンドウでドキュメントを開きます。<br>対話するユーザーのブラウザ設定により、選択した`Open in`の動作が変更される場合があります。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
    * アクションシーケンスをユーザーが特定の列のセルを選択したときにのみトリガーするには、`On select`ヘッディングに続くドロップダウンをクリックし、列を選択します。ユーザーが任意の列のセルを選択したときにアクションシーケンスをトリガーするには、`Any column`を選択します。
    * [任意] 要素内でのキーボードナビゲーションが要素のアクションシーケンスをトリガーできるかどうかを制御するには、`Actions`パネルで`More`をクリックし、`Allow keyboard to trigger actions`を選択します。
    > 💡
    > トリガーインタラクションとしてのキーボードナビゲーションは、ユーザーエクスペリエンスを妨げる可能性があります。

8.  トリガー要素がプラグインの場合、`Custom plugin`の下でプラグイン構成オブジェクトの名前を選択します。
9.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

##### **宛先ワークブックのコントロールに値を渡す (Pass values to controls in the destination workbook)**
宛先ワークブックのドリルダウンされたビューを開くには、前のセクションのステップ6で`Pass control values`フィールドにコントロールターゲットとルールを追加します。

1.  `Pass control values`セクションで、`+ Add a control target`をクリックします。
2.  必要なフィールドを構成して、コントロールターゲットを識別し、ルールを定義します。
    * **Update control:** 宛先ワークブックで更新するコントロール要素を選択します。
    * **Set value as:** Sigmaがコントロールに渡す値のタイプを決定するオプションを選択し、値を定義します。
        * **Specific values:** 指定された（固定の）値を渡します。
        * **Values from a column:** トリガー要素の基盤となるデータ内の指定された列から値を渡します（該当する場合）。
        * **Custom formula:** 定義された数式に基づいて値を渡します。
3.  [任意] ステップ1と2を繰り返して、追加のコントロールターゲットとルールを構成します。

#### **現在のワークブックをナビゲートする (Navigate the current workbook)**
現在のワークブック内の特定の場所にナビゲートするアクションを作成します。ページの先頭または個々の要素にフォーカスを移動します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、既存のシーケンスを探します。
5.  `+ Add action`をクリックします。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。
    * **Action:** `Navigate in this workbook`を選択します。
    * **Destination:** ワークブックビューでフォーカスするページまたは要素を選択します。
7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、`More`をクリックし、`Add condition`を選択します。

### 9-5-2-2. コントロール値を管理するアクションを作成する (Create actions that manage control values)

ワークブックは、特定のコントロール要素の値を設定またはクリアするアクションをサポートしており、対話するユーザーが異なる焦点のビューのためにデータを迅速にフィルタリングおよび解除できるようにします。

このドキュメントでは、コントロール値を管理するアクションを作成する方法について説明します。Sigmaのアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

#### **ユーザー要件 (User requirements)**
> 📘
> 以下の要件は、アクションを構成するユーザーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

#### **コントロール値を設定する (Set a control value)**
現在のワークブックの特定のコントロール要素の値を設定するアクションを作成します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Set control value`を選択します。 |
| **Update control** | 現在のワークブックで更新するターゲットコントロール要素を選択します。 |
| **Set value as** | Sigmaがターゲットコントロールに渡す値のタイプを決定するオプションを選択し、値を定義します。<br>**Static values:** 指定された（固定の）値を渡します。<br>**Column:** トリガー要素の基盤となるデータ内の指定された列から値を渡します（該当する場合）。<br>**Control:** 指定されたソースコントロールで選択された値を渡します。<br>**Formula:** 定義された数式に基づいて値を渡します。 |
| **Set control selection to** | インタラクションがターゲットコントロール値にどのように影響するかを決定するオプションを選択します。<br>**Replace previous selection:** コントロールに渡された値が、選択されているすべての値を置き換えます。<br>**Add to existing selection:** コントロールに渡された値が、現在選択されている値に追加されます。<br>**Remove from existing selection:** コントロールに渡された値が、選択されている値から削除されます。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

#### **一つ以上のコントロール値をクリアする (Clear one or more control values)**
現在のワークブックの一つ以上のコントロール要素の値をクリアするアクションを作成します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Clear control`を選択します。 |
| **Apply to** | アクションのスコープを選択して、以下のいずれかの粒度レベルでコントロールをクリアします：`Specific control`, `Container`, `Tabbed container`, `Page / modal`, `Entire workbook`。 |
| **Control, Container, Tabbed container, or Page / modal** | `Apply to`フィールドでの選択に応じて、ドロップダウンからターゲットのコントロール、コンテナ、タブ付きコンテナ、ページ、またはモーダルを指定します。`Apply to`フィールドで`Entire workbook`を選択した場合、このフィールドは適用されません。 |
| **Tab** | `Apply to`フィールドで`Tabbed container`を選択した場合、クリアしたいコントロールを含む一つまたはすべてのタブを選択します。 |
| **Reset to published value** | [任意] チェックボックスを選択して、コントロール値を最後に公開された値にリセットします。ワークブックのタグ付きバージョンでは、この設定はタグ付きバージョンの値にリセットされます。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
    * アクションシーケンスをユーザーが特定の列のセルを選択したときにのみトリガーするには、`On select`ヘッディングに続くドロップダウンをクリックし、列を選択します。ユーザーが任意の列のセルを選択したときにアクションシーケンスをトリガーするには、`Any column`を選択します。
    * [任意] 要素内でのキーボードナビゲーションが要素のアクションシーケンスをトリガーできるかどうかを制御するには、`Actions`パネルで`More`をクリックし、`Allow keyboard to trigger actions`を選択します。
    > 💡
    > トリガーインタラクションとしてのキーボードナビゲーションは、ユーザーエクスペリエンスを妨げる可能性があります。

8.  トリガー要素がプラグインの場合、`Custom plugin`の下でプラグイン構成オブジェクトの名前を選択します。
9.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

### 9-5-2-3. 要素を修正または更新するアクションを作成する (Create actions that modify or refresh elements)

ワークブックは、列の可視性の決定、要素のグルーピングとプロパティの更新、軸スケールの変更、データの更新、およびタブ付きコンテナのタブ選択を行うアクションをサポートしています。これらのアクションにより、対話するユーザーは、異なる基盤となるデータセグメントを迅速に表示・ドリルダウンしたり、チャートの表示を調整したり、要素が最新のデータを表示するようにしたりすることができます。

このドキュメントでは、`Modify element`、`Refresh element`、および`Select tab`アクションの構成方法について説明します。Sigmaのアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

#### **ユーザー要件 (User requirements)**
> 📘
> 以下の要件は、アクションを構成するユーザーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

#### **要素を修正する (Modify elements)**
`Modify elements`アクションは、以下の効果をサポートしています。
* [列を表示する](#show-columns)
* 列を非表示にする
* 列を移動する
* 列を交換する
* 軸スケールを設定する

##### **列を表示する (Show columns)**
ターゲット要素に（グループ化されていない）列を表示するアクションを作成します。列は、静的な選択に基づいて、または列名がトリガー要素で選択されたコントロール値と一致する場合に表示できます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Modify element`を選択します。 |
| **Target element** | 修正する要素を選択します。 |
| **What to modify** | `Show columns`を選択し、ターゲット要素に表示する一つ以上の列を選択します。<br>トリガー要素が`List values`または`Segmented`コントロールの場合、セカンダリフィールドでオプションを選択します。<br>**From a static selection:** ターゲット要素に表示する特定の列を選択できます。<br>**With names matching control values:** 列名がトリガー要素で選択されたコントロール値と一致する場合に、ターゲット要素の列を動的に表示します。 |
| **Hide unselected columns** | 残りの列（`What to modify`フィールドで選択されていない）を非表示にするにはチェックボックスを選択するか、ターゲット要素に既に表示されているすべての列を引き続き表示するにはチェックボックスをオフのままにします。 |

> 💡
> 列名をコントロール値として設定するには、以下のいずれかの方法を使用します。
> * 入力テーブルの列に列名を入力し、その列をコントロール要素の値ソースとして選択します。
> * コントロール要素の値ソースとして、列名の手動リストを作成します。

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

##### **列を非表示にする (Hide columns)**
ターゲット要素の（グループ化されていない）列を非表示にするアクションを作成します。列は、静的な選択に基づいて、または列名がトリガー要素で選択されたコントロール値と一致する場合に非表示にできます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Modify element`を選択します。 |
| **Target element** | 修正する要素を選択します。 |
| **What to modify** | `Hide columns`を選択し、ターゲット要素で非表示にする一つ以上の列を選択します。<br>トリガー要素が`List values`または`Segmented`コントロールの場合、セカンダリフィールドでオプションを選択します。<br>**From a static selection:** ターゲット要素で非表示にする特定の列を選択できます。<br>**With names matching control values:** 列名がトリガー要素で選択されたコントロール値と一致する場合に、ターゲット要素の列を動的に非表示にします。 |
| **Show unselected columns** | 残りの列（`What to modify`フィールドで選択されていない）を表示するにはチェックボックスを選択するか、ターゲット要素で既に非表示になっているすべての列を引き続き非表示にするにはチェックボックスをオフのままにします。 |

> 💡
> 列名をコントロール値として設定するには、以下のいずれかの方法を使用します。
> * 入力テーブルの列に列名を入力し、その列をコントロール要素の値ソースとして選択します。
> * コントロール要素の値ソースとして、列名の手動リストを作成します。

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

##### **列を移動する (Move columns)**
ターゲット要素のテーブルグルーピング、ピボットテーブルプロパティ（行、列、または値）、またはチャートプロパティ（軸、色、ツールチップなど）に列を移動したり、そこから移動させたりするアクションを作成します。列は、静的な選択に基づいて、または列名がトリガー要素で選択されたコントロール値と一致する場合に移動できます。
> 📘
> ターゲット要素がテーブルの場合、`Move columns`オプションは、テーブルに既存のグルーピングが含まれている場合にのみ利用可能です。
> ターゲット要素がピボットテーブルまたはチャートの場合、プロパティが1つの列しかサポートしていない場合を除き、アクションはターゲットプロパティから既存の列を削除しません。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Modify element`を選択します。 |
| **Target element** | 修正する要素を選択します。 |
| **What to modify** | `Move columns`を選択し、次にターゲット要素からグルーピングまたはプロパティを選択します。<br>`to base`オプションは、列をグルーピングまたはプロパティから移動させ、基盤となるデータに戻します。他の利用可能なグルーピングとプロパティは、選択されたターゲット要素のタイプによって異なります。 |
| **Which column** | ほとんどの要素は`From a static selection`オプションのみをサポートしており、これによりターゲットのグルーピングまたはプロパティに移動する特定の列を選択できます。<br>トリガー要素が`List values`または`Segmented`コントロールの場合、`Column names matching control values`オプションを選択して、列名がトリガー要素で選択されたコントロール値と一致する場合に列を動的に移動できます。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

##### **列を交換する (Swap columns)**
テーブルグルーピング、チャートプロパティ（軸、色、ツールチップなど）、またはピボットテーブルプロパティ（行、列、または値）のすべての列を交換するアクションを作成します。このアクションは、ターゲットのグルーピングまたはプロパティ内のすべての既存の列を削除し、選択した列に置き換えます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、既存のシーケンスを探します。
5.  `+ Add action`をクリックします。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Modify element`を選択します。 |
| **Target element** | 修正する要素を選択します。 |
| **What to modify** | `Swap columns`を選択し、次にターゲット要素からグルーピングまたはプロパティを選択します。 |
| **Swap with** | ターゲットのグルーピングまたはプロパティ内の既存の列を置き換える列を選択します。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

##### **要素を更新する (Refresh an element)**
現在のワークブックのターゲット要素のデータを更新するアクションを作成します。親要素を更新すると、ワークブック内のすべての子要素も更新されます。
> 🚧
> このアクションは、要素がマテリアライズされている場合はデータを更新しません。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Refresh element`を選択します。 |
| **Element** | 更新する要素を選択します。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

---

##### **タブを選択する (ベータ版) (Select tab (beta))**
> 🚩
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このページは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

[タブ付きコンテナ](https://help.sigmacomputing.com/docs/use-tabbed-containers-to-organize-workbook-content)要素で特定のタブを表示するアクションを作成します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、既存のシーケンスを探します。
5.  `+ Add action`をクリックします。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Select tab`を選択します。 |
| **Tabbed container** | このワークブック内のタブ付きコンテナを選択します。 |
| **Tab** | 表示するタブを選択します。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

### 9-5-2-4. モーダルとタブ付きコンテナを制御するアクションを作成する (Create actions that control modals and tabbed containers)

ワークブックは、モーダルとタブ付きコンテナの状態を変更するアクションをサポートしており、関連するコンテンツビュー間のシームレスな移行を可能にします。

このドキュメントでは、モーダルを開いたり、閉じたり、タブ付きコンテナで特定のタブを選択したりするアクションを作成する方法について説明します。Sigmaのアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

#### **ユーザー要件 (User requirements)**
> 📘
> 以下の要件は、アクションを構成するユーザーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

#### **モーダルを開くまたは閉じる (Open or close a modal)**
現在のワークブックでモーダルを開いたり閉じたりするアクションを作成します。モーダルの詳細については、「[ワークブックにモーダルを追加する](https://help.sigmacomputing.com/docs/add-a-modal-to-a-workbook)」を参照してください。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Open modal`または`Close modal`を選択します。 |
| **Select modal** | `Open modal`アクションを構成する場合、開くモーダルを選択するか、`New modal`を選択します。<br>`Close modal`アクションは、閉じるモーダル内の要素で構成する必要があるため、モーダルの選択は不要です。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
    * アクションシーケンスをユーザーが特定の列のセルを選択したときにのみトリガーするには、`On select`ヘッディングに続くドロップダウンをクリックし、列を選択します。ユーザーが任意の列のセルを選択したときにアクションシーケンスをトリガーするには、`Any column`を選択します。
    * [任意] 要素内でのキーボードナビゲーションが要素のアクションシーケンスをトリガーできるかどうかを制御するには、`Actions`パネルで`More`をクリックし、`Allow keyboard to trigger actions`を選択します。
    > 💡
    > トリガーインタラクションとしてのキーボードナビゲーションは、ユーザーエクスペリエンスを妨げる可能性があります。

8.  トリガー要素がプラグインの場合、`Custom plugin`の下でプラグイン構成オブジェクトの名前を選択します。
9.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

#### **タブを選択する (ベータ版) (Select tab (beta))**
> 🚩
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このページは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

[タブ付きコンテナ](https://help.sigmacomputing.com/docs/use-tabbed-containers-to-organize-workbook-content)要素で特定のタブを表示するアクションを作成します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Select tab`を選択します。 |
| **Tabbed container** | このワークブック内のタブ付きコンテナを選択します。 |
| **Tab** | 表示するタブを選択します。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
    * アクションシーケンスをユーザーが特定の列のセルを選択したときにのみトリガーするには、`On select`ヘッディングに続くドロップダウンをクリックし、列を選択します。ユーザーが任意の列のセルを選択したときにアクションシーケンスをトリガーするには、`Any column`を選択します。
    * [任意] 要素内でのキーボードナビゲーションが要素のアクションシーケンスをトリガーできるかどうかを制御するには、`Actions`パネルで`More`をクリックし、`Allow keyboard to trigger actions`を選択します。
    > 💡
    > トリガーインタラクションとしてのキーボードナビゲーションは、ユーザーエクスペリエンスを妨げる可能性があります。

8.  トリガー要素がプラグインの場合、`Custom plugin`の下でプラグイン構成オブジェクトの名前を選択します。
9.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

### 9-5-2-5. 入力テーブルデータを修正するアクションを作成する (Create actions that modify input table data)

ワークブックは、入力テーブルの行を追加、更新、または削除するアクションをサポートしています。これらのアクションは、フォーム機能をサポートするために設計されていますが、他のデータアプリのユースケースに対応するために他の方法で使用することもできます。

このドキュメントでは、`Insert row`、`Update row`、および`Delete row`アクションの構成方法について説明します。Sigmaのアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

#### **ユーザー要件 (User requirements)**
> 📘
> 以下の要件は、アクションを構成するユーザーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

#### **行を挿入する (Insert row)**
ターゲットの入力テーブルに新しい行を追加するアクションを作成します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| フィールド | 構成 |
| :--- | :--- |
| **Action** | `Insert row`を選択します。 |
| **Into** | 追加された行で更新するターゲットの入力テーブル（空のみ）を選択します。 |
| **With values** | 入力テーブルの各列について、Sigmaが行に渡さなければならない値（または値のソース）を定義します。<br>**Static values:** 指定された（固定の）値を渡します。<br>**Column:** 指定されたテーブル列の値を渡します。<br>**Control:** 指定されたコントロール要素の値を渡します。<br>**Formula:** 定義された数式に基づいて値を渡します。<br>列を空白のままにするには、`Static values`を選択し、値を未設定のままにします。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。
9.  入力テーブルのデータ入力権限が、公開バージョンでの編集を受け入れるように設定されていることを確認します。詳細は、「[データ入力権限を設定する](https://help.sigmacomputing.com/docs/customize-data-entry-permission-on-input-tables)」を参照してください。

##### **行を更新する (Update row)**
ターゲットの入力テーブルの既存の行の値を更新するアクションを作成します。
> 📘
> `Update row`アクションは、2023年4月23日以降に作成された入力テーブルのみを修正できます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| フィールド | 構成 |
| :--- | :--- |
| **Action** | `Update row`を選択します。 |
| **In** | 更新する行を含むターゲットの入力テーブル（空またはリンク済み）を選択します。 |
| **Which row** | 更新する行の一意の識別子と一致する必要がある値（または値のソース）を定義します。これは、空の入力テーブルのシステム生成の行ID、またはリンクされた入力テーブルの主キー列の値です。<br>ターゲット要素が`row ID`列を含まない空の入力テーブルの場合、モーダルから直接追加できます。 |
| **Update with values** | ターゲット入力テーブルで更新したい各列について、Sigmaが行に渡さなければならない値（または値のソース）を定義します。<br>**Static values:** 指定された（固定の）値を渡します。<br>**Column:** 指定されたテーブル列の値を渡します。<br>**Control:** 指定されたコントロール要素の値を渡します。<br>**Formula:** 定義された数式に基づいて値を渡します。<br>更新したくない列がある場合は、対応する値フィールドの隣にある`x Delete`をクリックして削除します。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。
9.  入力テーブルのデータ入力権限が、公開バージョンでの編集を受け入れるように設定されていることを確認します。詳細は、「[データ入力権限を設定する](https://help.sigmacomputing.com/docs/customize-data-entry-permission-on-input-tables)」を参照してください。

##### **行を削除する (Delete row)**
ターゲットの入力テーブルの既存の行を削除するアクションを作成します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| フィールド | 構成 |
| :--- | :--- |
| **Action** | `Delete row`を選択します。 |
| **In** | 削除する行を含むターゲットの入力テーブル（空またはリンク済み）を選択します。 |
| **Which row** | 削除する行のシステム生成の行IDと一致する必要がある値（または値のソース）を定義します。<br>ターゲットの入力テーブルに`row ID`列が含まれていない場合、`Action`モーダルから直接追加できます。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
    * アクションシーケンスをユーザーが特定の列のセルを選択したときにのみトリガーするには、`On select`ヘッディングに続くドロップダウンをクリックし、列を選択します。ユーザーが任意の列のセルを選択したときにアクションシーケンスをトリガーするには、`Any column`を選択します。
    * [任意] 要素内でのキーボードナビゲーションが要素のアクションシーケンスをトリガーできるかどうかを制御するには、`Actions`パネルで`More`をクリックし、`Allow keyboard to trigger actions`を選択します。
    > 💡
    > トリガーインタラクションとしてのキーボードナビゲーションは、ユーザーエクスペリエンスを妨げる可能性があります。

8.  トリガー要素がプラグインの場合、`Custom plugin`の下でプラグイン構成オブジェクトの名前を選択します。
9.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。
10. 入力テーブルのデータ入力権限が、公開バージョンでの編集を受け入れるように設定されていることを確認します。詳細は、「[データ入力権限を設定する](https://help.sigmacomputing.com/docs/customize-data-entry-permission-on-input-tables)」を参照してください。

### 9-5-2-6. データをダウンロードおよびエクスポートするアクションを作成する (Create actions that download and export data)

ワークブックは、直接ダウンロードや、メール、Slackチャネル、Webhook、およびクラウドストレージへのエクスポートを開始するアクションをサポートしています。

このドキュメントでは、ワークブックのコンテンツを特定の宛先にダウンロードおよびエクスポートするアクションを作成する方法について説明します。Sigmaのアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

#### **ユーザー要件 (User requirements)**
> 📘
> 以下の要件は、アクションを構成するユーザーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

#### **直接ダウンロードを開始する (Initiate direct download)**
ワークブック全体、特定のページ、または個々の要素を、対話しているユーザーのデバイスに直接ダウンロードするアクションを作成します。
> 📘
> このアクションは、`Download or Send Now`権限が有効になっているアカウントタイプを割り当てられたユーザーのみが構成およびトリガーできます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Download and export`を選択します。 |
| **Destination** | `Download`を選択します。 |
| **Attachment** | ダウンロードするワークブックのコンテンツを選択し、次にファイルタイプを選択します。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

#### **メールにエクスポートする (Export to email)**
ワークブック全体、特定のページ、または個々の要素を選択した受信者にメールで送信するアクションを作成します。
> 📘
> このアクションは、`Download or Send Now`権限が有効になっているアカウントタイプを割り当てられたユーザーのみが構成およびトリガーできます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、既存のシーケンスを探します。
5.  `+ Add action`をクリックします。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Download and export`を選択します。 |
| **Destination** | `Email`を選択します。 |
| **Recipient** | エクスポート受信者のメールアドレスを1つ以上、カンマ区切りで入力します。 |
| **Subject** | メールの件名に含めるテキストを入力します。 |
| **Message** | [任意] メールの本文に含めるメッセージを入力します。 |
| **Attachment** | エクスポートするワークブックのコンテンツを選択し、次にファイルタイプを選択します。 |
| **More options** | [任意] `Include link to workbook`チェックボックスを選択して、エクスポート受信者がメールから直接ワークブックを開けるようにします。<br>[任意] `Run queries as recipient`チェックボックスを選択して、メールの受信者としてワークブックのクエリを実行します。<br>[任意] `Send as .zip file`チェックボックスを選択して、添付ファイルを圧縮zipファイルとして送信します。 |

トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
* アクションシーケンスをユーザーが特定の列のセルを選択したときにのみトリガーするには、`On select`ヘッディングに続くドロップダウンをクリックし、列を選択します。ユーザーが任意の列のセルを選択したときにアクションシーケンスをトリガーするには、`Any column`を選択します。
* [任意] 要素内でのキーボードナビゲーションが要素のアクションシーケンスをトリガーできるかどうかを制御するには、`Actions`パネルで`More`をクリックし、`Allow keyboard to trigger actions`を選択します。オプションにチェックマークが表示されている場合、キーボードナビゲーションとポインタイベント（例：マウスクリック）がアクションシーケンスをトリガーできます。オプションにチェックマークがない場合（デフォルト）、ポインタイベントのみがトリガーできます。
> 💡
> トリガーインタラクションとしてのキーボードナビゲーションは、ユーザーエクスペリエンスを妨げる可能性があります。例えば、要素のアクションシーケンスにリンクや他のワークブックを開くアクションが含まれている場合、ユーザーは意図せず現在のタスクから離れてしまう可能性があります。これは、アクションシーケンスが任意の列のセルを選択することでトリガーされる場合に特に混乱を招く可能性があります。
> 構成されたアクションシーケンスを促進し、使いやすさを妨げる可能性が低い場合にのみ、キーボードナビゲーションによるアクションのトリガーを許可することを検討してください。

トリガー要素がプラグインの場合、`Custom plugin`の下でプラグイン構成オブジェクトの名前を選択します。コードエディタでプラグインを更新し、ワークブックでアクションをテストします。詳細は、「[トリガー要素として使用するプラグインを構成する](https://help.sigmacomputing.com/docs/configure-plugins-to-use-as-trigger-elements)」を参照してください。

[任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。条件に関する詳細は、「[アクションの条件を定義する](https://help.sigmacomputing.com/docs/create-and-manage-actions#define-an-action-condition)」を参照してください。

#### **Slackにエクスポートする (Export to Slack)**
ワークブック全体、特定のページ、または個々の要素をSlackにエクスポートするアクションを作成します。
> 📘
> このアクションは、`Export to Slack`権限が有効になっているアカウントタイプを割り当てられたユーザーのみが構成およびトリガーできます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Download and export`を選択します。 |
| **Destination** | `Slack`を選択します。 |
| **To** | エクスポートを受け取る必要があるSlackチャネルの名前を入力します。 |
| **Message** | [任意] Slack通知に含めるメッセージを入力します。 |
| **Attachment** | エクスポートするワークブックのコンテンツを選択し、次にファイルタイプを選択します。 |
| **More options** | [任意] `Include link to workbook`チェックボックスを選択して、チャネルメンバーがSlackメッセージから直接ワークブックを開けるようにします。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
    * アクションシーケンスをユーザーが特定の列のセルを選択したときにのみトリガーするには、`On select`ヘッディングに続くドロップダウンをクリックし、列を選択します。ユーザーが任意の列のセルを選択したときにアクションシーケンスをトリガーするには、`Any column`を選択します。
    * [任意] 要素内でのキーボードナビガーションが要素のアクションシーケンスをトリガーできるかどうかを制御するには、`Actions`パネルで`More`をクリックし、`Allow keyboard to trigger actions`を選択します。
    > 💡
    > トリガーインタラクションとしてのキーボードナビゲーションは、ユーザーエクスペリエンスを妨げる可能性があります。

8.  トリガー要素がプラグインの場合、`Custom plugin`の下でプラグイン構成オブジェクトの名前を選択します。
9.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

#### **Webhookにエクスポートする (Export to a webhook)**
個々の要素のデータをWebhookを使用して別のアプリケーションにエクスポートするアクションを作成します。
> 📘
> このアクションは、`Export to webhook`権限が有効になっているアカウントタイプを割り当てられたユーザーのみが構成およびトリガーできます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Download and export`を選択します。 |
| **Destination** | `Webhook`を選択します。 |
| **Endpoint** | 受信側アプリケーションのエンドポイントを入力します。 |
| **Attachment** | エクスポートする要素を選択し、次にデータフォーマットを選択します。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

#### **クラウドストレージにエクスポートする (Export to cloud storage)**
個々の要素のデータをクラウドストレージにエクスポートするアクションを作成します。
> 📘
> このアクションは、`Export to cloud`権限が有効になっているアカウントタイプを割り当てられたユーザーのみが構成およびトリガーできます。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、既存のシーケンスを探します。
5.  `+ Add action`をクリックします。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Download and export`を選択します。 |
| **Destination** | `Cloud Storage`を選択します。 |
| **Storage integration** | インテグレーション名を入力します。 |
| **Cloud Storage URI** | エクスポート先のファイルパスを入力します。 |
| **Element** | エクスポートする要素を選択し、次にファイル形式を選択します。 |
| **More options** | [任意] `Prefix file name with current date and time`チェックボックスを選択して、ファイル名にエクスポート日時（ISO形式）を含めます。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、`More`をクリックし、`Add condition`を選択します。

### 9-5-2-7. 埋め込みiframeイベントを生成するアクションを作成する (Create actions that generate embed iframe events)

埋め込まれたワークブックで構成されたワークブックアクションは、ホストアプリケーションとのインタラクションをサポートします。埋め込まれたコンテンツからホストアプリケーションにiframeイベントを送信するアクションを構成でき、ホストアプリケーションはそのイベントに対して何らかの結果で応答できます。例えば、これらのイベントを使用して、カスタムトラッキングを追加したり、アプリケーションのUIを変更したり、独自のアプリケーションAPIをトリガーしたりすることができます。

このドキュメントでは、埋め込まれたワークブックで`Generate iframe event`アクションを構成する方法について説明します。Sigmaのアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。埋め込みに関する詳細は、「[埋め込み分析の概要](https://help.sigmacomputing.com/docs/intro-to-embedded-analytics)」を参照してください。

#### **システムとユーザー要件 (System and user requirements)**
> 📘
> 以下の要件は、アクションを構成するユーザーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

このワークブックアクションは、埋め込まれたワークブックにのみ関連します。パブリックおよびセキュアな埋め込みの特定の要件については、「[埋め込み分析の概要](https://help.sigmacomputing.com/docs/intro-to-embedded-analytics)」を参照してください。

#### **前提条件 (Prerequisites)**
埋め込まれたワークブックでのユーザーインタラクションに関するメッセージを受信するために、アプリケーションでイベントリスナーと`action:outbound`イベントを構成します。その後、ホストアプリケーションでカスタムロジックを開発して、これらのイベントに応答できます。

親子アプリケーション間でイベントを送受信する方法については、「[埋め込みでインバウンドおよびアウトバウンドイベントを実装する](https://help.sigmacomputing.com/docs/implement-inbound-and-outbound-events-in-embeds)」を参照してください。
このワークブックアクションが有効になるために必要なアウトバウンドイベントを構成するには、「[action:outbound](https://help.sigmacomputing.com/docs/outbound-event-reference#action-outbound)」の構成手順を参照してください。

#### **アウトバウンドiframeイベントを生成する (Generate an outbound iframe event)**
アウトバウンドiframeイベントを生成するアクションを作成します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Generate iframe event`を選択します。 |
| **Event name** | ホストアプリケーションの`action:outbound`イベントの`name`プロパティで構成されたイベントの名前を入力します。 |
| **Event key** と **Key value** | ホストアプリケーションの`action:outbound`イベントの`values`プロパティで構成されたキー名と値を入力します。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

### 9-5-2-8. プラグインを修正するアクションを作成する (Create actions that modify plugins)

ワークブック要素がプラグイン内の効果をトリガーできるようにするアクションを作成できます。例えば、テーブルのセルを選択するなどのアクションが、特定のプラグイン効果をトリガーできます。このドキュメントでは、プラグイン効果をトリガーするアクションを作成する方法について説明します。

アクションをサポートするようにプラグインコードを構成するには、「[アクションと連携するようにプラグインを構成する](https://help.sigmacomputing.com/docs/configure-plugins-to-work-with-actions)」を参照してください。Sigmaのアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

#### **ユーザー要件 (User requirements)**
> 📘
> 以下の要件は、アクションを構成するユーザーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

#### **前提条件 (Prerequisites)**
アクションと互換性があるようにプラグインを構成する必要があります。「[ターゲット要素として使用するプラグインを構成する](https://help.sigmacomputing.com/docs/configure-plugins-to-use-as-target-elements)」を参照してください。

#### **プラグインを修正する (Modify a plugin)**
プラグインを修正するアクションを作成します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
    > 🚧
    > 無限ループを引き起こさないように、トリガーとターゲット要素の両方として同じプラグインを含むアクションシーケンスを構成しないでください。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Trigger plugin`を選択します。 |
| **Target plugin** | 修正したいプラグイン要素の名前を選択します。 |
| **Select effect** | 「[ターゲット要素として使用するプラグインを構成する](https://help.sigmacomputing.com/docs/configure-plugins-to-use-as-target-elements)」の手順で作成された構成オブジェクトの名前を選択します。 |

7.  トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、ユーザーのインタラクションがいつ、どのようにアクションシーケンスをトリガーするかを決定する追加の設定を構成します。
8.  [任意] 特定の条件が満たされた場合にのみアクションシーケンスを実行するには、アクションシーケンスで`More`をクリックし、`Add condition`を選択して基準を構成します。

### 9-5-2-9. ストアドプロシージャを呼び出すアクションを作成する (ベータ版)

> 🚩
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このページは公開されたドキュ-メントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

ワークブックは、[ストアドプロシージャを呼び出し](https://help.sigmacomputing.com/docs/create-actions-that-call-stored-procedures-beta#call-a-stored-procedure)、その出力を[変数として使用](https://help.sigmacomputing.com/docs/use-variables-in-actions)できるアクションをサポートしています。

例えば、データプラットフォームに複雑な計算を実行するために使用する既存のストアドプロシージャがある場合、Sigmaのカスタム関数や数式でロジックを再作成する代わりに、ストアドプロシージャを呼び出してその出力をSigmaで使用できます。

このドキュメントでは、[ストアドプロシージャを呼び出す](https://help.sigmacomputing.com/docs/create-actions-that-call-stored-procedures-beta#call-a-stored-procedure)アクションを作成する方法について説明します。Sigmaのアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

#### **制限事項 (Limitations)**
* BigQuery, PostgreSQL, Redshift, Snowflakeのみがサポートされています。
* ストアドプロシージャは、Sigmaによってインデックス化されたスキーマ（データカタログの接続を通じて利用可能）に含まれている必要があります。書き戻しに使用される同じスキーマにストアドプロシージャを配置しないでください。
* バリアント引数タイプはサポートされていません。
* デフォルト値を持つ引数はサポートされていません。
* ストアドプロシージャの戻り値または出力を扱うには、ストアドプロシージャがスカラー値を返す必要があります。
* ストアドプロシージャが表形式のデータを返す場合、その出力を変数として扱うことはできず、代わりに接続のデータカタログで作成されたテーブルを探してSigmaで扱う必要があります。
* ストアドプロシージャが配列を返す場合、配列をテキストに変換（シリアライズ）し、ストアドプロシージャ内でデータを逆シリアル化するようにストアドプロシージャを修正する必要があります。

#### **ユーザーとシステムの要件 (User and system requirements)**
ストアドプロシージャアクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限と、`Create stored procedure actions`権限が有効になっているアカウントタイプを割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`のワークブックアクセス権を付与されている必要があります。

¹ `Can explore`のワークブックアクセス権が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

Sigmaでストアドプロシージャを定義することはできません。Sigmaでストアドプロシージャを呼び出すアクションを作成する前に、データウェアハウスまたはデータプラットフォームでストアドプロシージャを作成する必要があります。

##### **アクションからストアドプロシージャを呼び出すための要件**
アクションからストアドプロシージャを呼び出すには、以下が適用されます。
* `Call stored procedure action`権限が有効になっているアカウントタイプを割り当てられている必要があります。
* 接続に対する`Can use`以上のアクセス権、またはSigmaのストアドプロシージャに対する`Can use`アクセス権が付与されている必要があります。
* 接続されたデータプラットフォームに関連付けられたユーザーとロールは、データプラットフォームでストアドプロシージャを使用および実行する権限を持っている必要があります。
    * **BigQuery接続の場合:** サービスアカウントにBigQuery Data Viewerロールが付与されていれば、追加の権限は不要です。
    * **PostgreSQL接続の場合:** サービスアカウントには、ストアドプロシージャに対する`EXECUTE`権限が付与されている必要があります。
    * **Redshift接続の場合:** サービスアカウントには、ストアドプロシージャを含むスキーマに対する`USAGE`と、ストアドプロシージャに対する`EXECUTE`が付与されている必要があります。
    * **Snowflake接続の場合:** ユーザーのデフォルトロールまたはサービスアカウントロールには、以下の権限が付与されている必要があります：ストアドプロシージャを含むスキーマに対する`USAGE`、ストアドプロシージャに対する`USAGE`または`OWNERSHIP`。

> 📘
> ワークブックへの`Can Explore`または`Can Edit`アクセス権を持つユーザーが、ストアドプロシージャまたは関連する接続に対する`Can use`アクセス権を持っておらず、データプラットフォームでストアドプロシージャを実行するアクセス権もない場合、彼らはストアドプロシージャを表示または修正できません。

#### **アクションからストアドプロシージャを呼び出す (Call a stored procedure from an action)**
データプラットフォームでストアドプロシージャを呼び出すアクションを作成します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。

| | |
| :--- | :--- |
| **When selecting cells in** | クリックされたときにアクションを開始するトリガー要素から列を選択します。このフィールドは、トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合にのみ適用されます。 |
| **Condition** | [任意] アクションが有効になるために満たすべき条件を構成するには、スイッチをオンにします。 |
| **Action** | `Advanced`で、`Call stored procedure`を選択します。 |
| **Select a stored procedure** | 呼び出したいストアドプロシージャを検索または参照し、そのストアドプロシージャを選択します。 |

7.  ストアドプロシージャのセットアップを構成します。これらのステップは、ストアドプロシージャが期待する引数とシグネチャによって異なる場合があります。
    * **Select signature:** ストアドプロシージャに複数のシグネチャがある場合、シグネチャのリストから、ストアドプロシージャの希望のシグネチャを選択します。
    * **Set value for: <argument>:** 以下のオプションのいずれかを使用して、ストアドプロシージャの引数に値を割り当てます。
        - **Static values:** 引数の値を入力します。
        - **Column:** アクションがデータ要素からトリガーされる場合、アクションが適用されるデータ要素内の列を選択して引数値を提供します。
        - **Control:** ワークブック内のコントロール要素を選択して引数値を提供します。
        - **Formula:** 引数値を提供するために使用する数式を入力します。提供される引数値は、ストアドプロシージャが期待するデータ型と一致する必要があります。
    * **Outputs:** ストアドプロシージャが出力を提供する場合、出力が利用可能になる変数名とデータ型を確認します。例えば、「echo_args」という名前のストアドプロシージャの場合、アクション変数は`echo_args`です。
> 📘
> アクションシーケンスでストアドプロシージャアクションを使用する場合、Sigmaはストアドプロシージャの実行が終了するのを待ってから、シーケンスの次のアクションをトリガーします。ストアドプロシージャがエラーで失敗した場合、アクションシーケンスは実行を停止し、シーケンス内の後続のアクションは実行されません。

アクションでストアドプロシージャを呼び出す詳細については、以下の例を参照してください。

##### **例：列データでストアドプロシージャを実行する (Example: Run a stored procedure with column data)**
エンドツーエンドの例として、データ要素でのユーザーの選択に基づいてストアドプロシージャを実行します。

例えば、BigQueryに`GET_CAMPAIGN_STATUS`というストアドプロシージャがあり、これがサードパーティツールで実行されたメールキャンペーンの最新のクリックスルーデータをコンパイルおよび計算するとします。ストアドプロシージャは、メールキャンペーンの名前という1つの引数を取り、メールのプレーンテキスト本文を含むテキストを出力します。

1.  編集用にワークブックを開きます。
2.  関連するワークブック要素を追加します。
    * マーケティング部門から送信された各メールキャンペーンの行を持つテーブルなど、データ要素を追加します。列には`Campaign Name`や`Date Sent`などがあります。
    * データ要素の隣にテキストエリアコントロールを追加し、コントロールの名前を`Campaign details`に変更します。
3.  データ要素で、`Campaign Name`列からの`On select`で実行されるアクションシーケンスを定義します。
    1.  `Call stored procedure`アクションを追加し、それを構成します。
        * BigQuery接続に移動し、`GET_CAMPAIGN_STATUS`ストアドプロシージャを検索します。
        * `Set value for arg1: name`に、`Column`を選択し、次にメールキャンペーンの名前を含むデータ要素の`Campaign Name`列を選択します。
        * 応答に使用されるアクション変数`get_campaign_status`をメモします。
    2.  `Set control value`アクションを追加し、値を`Action variable: get_campaign_status`に設定します。
4.  ワークフローをテストします。この例では、メールキャンペーンのテキストを含むモーダルが表示されます。
5.  ワークブックを公開します。
> 💡
> 出力コントロールをモーダルに追加して、インタラクティビティを追加し、視覚的な散らかりを減らします。モーダルのプライマリボタンのアクションシーケンスを、コントロールをクリアしてモーダルを閉じるように設定します。

### 9-5-3-1. アクションシーケンスを構成する (Configure an action sequence)

アクションシーケンスを構成して、特定の順序で一連のワークブックアクションを実行します。

アクションシーケンスは、特定のワークブックの応答を達成するために必要な順序で、ユーザーのインタラクションが複数のアクションをトリガーすることを保証します。Sigmaでは、シーケンス内でアクションを追加・並べ替えたり、異なるシーケンス間でアクションを移動したり、既存のシーケンスを複製したりすることができます。また、シーケンスが実行されるかどうかを決定する[条件を構成する](https://help.sigmacomputing.com/docs/create-and-manage-actions#define-an-action-condition)こともできます。

このドキュメントでは、アクションシーケンスを作成・管理する方法について説明します。利用可能なワークブックアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

> 📘
> アクションシーケンスは、そのシーケンス内でアクションが実行される順序のみを定義します。異なるシーケンスのアクションは同時に実行され、シーケンスが構成・表示される順序で終了しない場合があります。

#### **ユーザー要件 (User requirements)**
> 📘
> 以下の要件は、アクションを構成するユーザーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

#### **制限事項 (Limitations)**
`Trigger plugin`アクションは、シーケンス通りに実行されることが保証されていません。コントロールを設定またはクリアするアクションを使用し、プラグインが更新された値を読み取ることを期待する場合、プラグインは代わりに元の値を読み取る可能性があります。

#### **アクションシーケンスを作成する (Create an action sequence)**
新しいアクションシーケンスを作成するには、以下の手順に従います。
1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  以下のいずれかの方法でアクションを追加します。
    * 既存のシーケンス内で`+ Add action`をクリックします。この要素に以前に構成されたアクションがなかった場合は、空のシーケンスグループ内にアクションを追加します。
    * アクションパネルの上部にある`+ Add action sequence`をクリックして、既存のシーケンスの外にアクションを追加します。このオプションを選択すると、以前に存在していたものの下に新しいアクションシーケンスグループが作成されます。
5.  アクションを構成します。
6.  シーケンスに別のアクションを追加するには、`+ Add action`をクリックします。Sigmaは、シーケンスの直前のアクションを複製し、それを修正できます。
7.  その要素に対して望む動作が得られるまで、シーケンスにアクションを追加・構成し続けます。シーケンス内のアクションをドラッグ＆ドロップして、順序を変更できます。
8.  [任意] 特定の状況でのみシーケンスを実行したい場合は、`More`をクリックし、`Add condition`をクリックします。アクションの条件に関する詳細は、「[アクションの条件を作成する](https://help.sigmacomputing.com/docs/create-and-manage-actions#make-an-action-conditional)」を参照してください。
9.  [任意] シーケンスやシーケンス内の個々のアクションの名前をダブルクリックして変更します。単一の要素から多数のアクションがトリガーされる場合に、アクションとシーケンスにより意味のある名前を付けると、それらをすばやく区別するのに役立ちます。

##### **複数のアクションをシーケンスに整理する (Organize multiple actions into a sequence)**
要素に複数のアクションが構成されている場合、各アクションはデフォルトで並行して実行されます。要素上の複数のアクションの実行順序を制御したい場合は、それらを同じシーケンスに移動し、希望する順序で配置します。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  持っているアクションを確認し、どれをシーケンスに整理するかを決定します。
    * アクションが実行されるかどうかを決定する異なる条件がある場合は、それらを異なるシーケンスに配置します。各シーケンスは単一の条件しか持てません。アクションの条件に関する詳細は、「[アクションの条件を作成する](https://help.sigmacomputing.com/docs/create-and-manage-actions#make-an-action-conditional)」を参照してください。
    * アクションの実行順序が重要である場合は、それらを同じシーケンスに配置します。
5.  アクションをドラッグ＆ドロップして、シーケンス間を移動させたり、シーケンス内の順序を変更したりします。
6.  ワークブックを保存し、ワークブックでアクションをテストして、実行ロジックが意図と一致することを確認します。

##### **シーケンスを一時停止または再開する (Pause or resume sequences)**
アクションをデバッグおよびテストするために、アクションシーケンスを一時停止または再開します。個々のシーケンスの一時停止/再開状態を制御するか、ワークブック内のすべてのシーケンスの状態をグローバルに変更できます。古い一時停止状態を防ぎ、ワークフローの中断を避けるため、一時停止されたシーケンスはワークブックがリフレッシュされると自動的に再開されます。

* **個々のシーケンスを一時停止または再開するには、** シーケンス名の隣にある`More`をクリックし、`Pause sequence`または`Resume sequence`を選択します。
* **ワークブック内のすべてのシーケンスを一時停止または再開するには、** ドキュメントヘッダーの`More options`をクリックし、`Pause all action sequences`を選択します。

シーケンスが一時停止されると、Sigmaはシーケンス名の隣に`Action sequence paused`アイコン()を表示します。
> 📘
> 新しく追加されたすべてのシーケンスは、ワークブックレベルの一時停止/再開設定を継承します。
> 個々のシーケンスを一時停止または再開すると、その変更はワークブックレベルの設定を上書きします。
> その後のワークブックレベルの一時停止/再開設定への変更は、個々のシーケンスレベルの設定に関係なく、すべてのシーケンスに適用されます。

### 9-5-3-2. アクションの条件を定義する (Define an action condition)

任意のアクションシーケンスに対してオプションの条件を定義して、そのシーケンス内のアクションが有効になる状況を制御できます。条件はカスタム数式にすることも、選択されたコントロールのアクションシーケンスを構成している場合はコントロールの値にすることもできます。カスタム数式に基づく条件は、[アクション変数](https://help.sigmacomputing.com/docs/use-variables-in-actions)を参照して、ユーザーがテーブルやビジュアライゼーションで選択した値を参照できます。Sigmaのアクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

アクションシーケンスを条件付きにするには、アクションを作成または編集中に`More`をクリックし、`Add condition`をクリックします。

複数のアクションシーケンスを構成でき、それぞれにオプションの条件を付けることができます。ユーザーが複数のアクションシーケンスが構成された要素と対話すると、各アクションシーケンスは、その条件（もしあれば）がtrueと評価された場合にトリガーされます。

#### **例：セグメント化されたコントロールに基づいてチャートの表示を変更する**
セグメント化されたコントロールのアクションを構成して、ユーザーがコントロールで選択した値に基づいてビジュアライゼーションの表示を変更できます。セグメント化されたコントロールの使用に関する詳細は、「[セグメント化されたコントロールの作成と構成](https://help.sigmacomputing.com/docs/create-and-configure-a-segmented-control)」を参照してください。

例えば、地域別に分類された総売上を示すチャートがある場合、セグメント化されたコントロールを追加して、ユーザーがチャートの表示を好みのビューに変更できるようにすることができます。

これを達成するには、以下の手順に従います。
1.  ビジュアライゼーションをターゲットとするセグメント化されたコントロールを追加し、`Individual trend`と`Comparison`の2つの値を与えます。
2.  コントロールに、以下の構成でアクションシーケンスを追加します。

| | |
| :--- | :--- |
| **Condition** | `Control value is equal to`に設定します。この例では、`Individual trend`を選択します。 |
| **Action** | `Modify element`を選択します。 |
| **Target element** | コントロールによってターゲットとされるビジュアライゼーションを選択します。 |
| **What to modify** | `Move columns`および`to trellis column`を選択します。 |
| **Column to move** | この例では、列は`Country`です。 |

3.  コントロールに、以下の構成で2番目のアクションシーケンスを追加します。

| | |
| :--- | :--- |
| **Condition** | `Control value is equal to`に設定します。この例では、`Comparison`を選択します。 |
| **Action** | `Modify element`を選択します。 |
| **Target element** | コントロールによってターゲットとされるビジュアライゼーションを選択します。 |
| **What to modify** | `Move columns`および`to color - category`を選択します。 |
| **Column to move** | この例では、列は`Country`です。 |

これで、セグメント化されたコントロールに2つのアクションシーケンスが構成され、それぞれがセグメント化されたコントロールの値に基づいてビジュアライゼーション要素を修正します。
ワークブックへの変更を公開します。
閲覧者がコントロールを操作すると、ビジュアライゼーション内のデータの個別トレンドビューと比較ビューを切り替えることができます。

#### **例：締め切りでフォームの送信を制限する**
締め切りが過ぎた場合にアクションシーケンスが発生しないように、条件を構成できます。

例えば、フォームを作成している場合、送信ボタンのアクションを、締め切りがまだ過ぎていない場合にのみ入力テーブルに行を挿入するように構成できます。入力テーブルに行を挿入するアクションに関する詳細は、「[入力テーブルデータを修正するアクションを作成する](https://help.sigmacomputing.com/docs/create-actions-that-modify-input-table-data)」を参照してください。

これを達成するには、以下の手順に従います。
1.  空の入力テーブル、一つ以上のテキストコントロール、およびボタン要素を持つワークブックを作成します。
2.  入力テーブルのデータ入力権限を、公開バージョンでの編集を許可するように構成します。
3.  ワークブックに任意のタイプの別のコントロールを追加し、エディタパネルを開いて`Control type`を`Date`に設定します。この例では、日付コントロールのコントロールIDは`Deadline-Control`です。
4.  日付コントロールの日付を未来の日付に設定します。この日付は、条件を設定する際の締め切りとして使用されます。
5.  ボタン要素を選択します。
6.  エディタパネルで、`Actions`タブを開きます。
7.  以下の構成でアクションシーケンスを追加します。
    * **Condition:** `Custom formula`に設定します。この例では、`DateDiff("day", Today(), [Deadline-Control]) > 0`と入力します。この数式は、現在の日付とIDが「Deadline-Control」の日付コントロールで設定された日付との間の日数がゼロより大きい場合にTrueと評価されます。
    * **Action:** `Insert row`を選択します。
    * **Into:** 入力テーブルの名前を選択します。
    * **With values:** フォームを構成するコントロール要素を選択します。
8.  ワークブックを公開し、公開バージョンを表示します。
9.  テキストコントロールにテキストを入力し、ボタンをクリックしてアクションをテストします。
    * 日付コントロールの日付が今日より後の日付に設定されている場合、テキストコントロールの値は入力テーブルに新しい行として表示されるはずです。
    * 日付コントロールの日付を今日または過去の日付に更新すると、締め切りが過ぎているため、ボタンをクリックしても行は挿入されません。
  
### 9-5-3-3. アクションで変数を使用する (Use variables in actions)

アクション変数を使用すると、アクション内で記述された数式が、ユーザーがテーブルやビジュアライゼーションで選択した値、または[ストアドプロシージャアクション](https://help.sigmacomputing.com/docs/create-actions-that-call-stored-procedures-beta)のような以前に実行されたアクションの結果を参照できます。アクション変数は、条件を含む、アクションの任意のカスタム数式で使用できます。

アクションがテーブルまたはビジュアライゼーションからトリガーされると、Sigmaは`Selection`と呼ばれるデータの一部を生成します。これは、ユーザーがテーブルで選択した行の値、またはビジュアライゼーションで選択したデータポイントの値を表します。

`Selection`変数を参照して、選択されたデータポイントを操作します。例えば、ユーザーが選択した特定の行でアクションの条件を実行したり、ユーザーが選択した特定の値を動的テキスト数式で表示したり、選択した値を別の数式に渡したりします。`Selection`アクション変数を参照する際、集計、条件、ルックアップなど、テーブルがサポートする通常の関数をすべて実行できます。

> 📘
> アクション変数は、アクションシーケンスの実行中にのみ存在し、アクションまたはアクションシーケンスの条件の数式内でのみ参照できます。アクションシーケンスの外でユーザーが選択した値またはストアドプロシージャの結果を参照したい場合は、コントロールをアクション変数に設定し、代わりにそのコントロールの値を参照してください。

#### **ユーザー要件 (User requirements)**
> 📘
> 以下の要件は、アクションを構成するユーザーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを構成する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、カスタム、保存済み、および共有ビューでアクションを構成できます。ビューに保存されたアクションは、ワークブックの公開バージョンには適用されません。

#### **アクションのカスタム数式で変数を参照する (Reference a variable in a custom formula for an action)**
アクションで変数を参照するには、以下を実行します。
1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  パネルで、以下のいずれかの方法でアクションを追加または編集します。
    * シーケンスグループ内で`+ Add action`をクリックして、既存のシーケンス内にアクションを追加します。
    * アクションパネルの上部にある`+ Add action sequence`をクリックして、既存のシーケンスの外にアクションを追加します。
    * 既存のアクションの名前にカーソルを合わせ、`Edit`をクリックして`Action`モーダルを開きます。
5.  `Action`モーダルで、`Insert row`や`Set control value`など、値を設定するためにカスタム数式を使用するアクションタイプを選択します。
6.  `Set value as`または`With values`フィールドで、`Formula`を選択します。
7.  数式バーで、`[Selection/<Column Name>]`という構文を使用して、要素でユーザーが選択した値を参照します。要素のタイプに応じて、ユーザーはテーブルのセルまたはチャートのデータポイントの値を選択している場合があります。
8.  [任意] 要素がテーブルの場合、シーケンスの`When selecting cells in`フィールドをテーブルの特定の列に設定します。この値を設定すると、構成したアクションは、ユーザーがその列をクリックしたときにのみトリガーされるように制限されます。

#### **アクションの条件で変数を参照する (Reference a variable in a condition for an action)**
アクション変数は、条件内でも機能します。アクションの条件の構成に関する詳細は、「[アクションの条件を作成する](https://help.sigmacomputing.com/docs/create-and-manage-actions#make-an-action-conditional)」を参照してください。

アクションの条件で変数を参照するには、以下を実行します。
1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  シーケンスにまだ条件が定義されていない場合は、`More`をクリックし、`Add condition`をクリックします。
5.  灰色の条件バーをクリックして、`Condition`モーダルを開きます。
6.  `Custom formula`を選択します。
7.  数式バーで、`[Selection/<Column Name>]`という構文を使用して、要素でユーザーが選択した値を参照します。要素のタイプに応じて、ユーザーはテーブルのセルまたはチャートのデータポイントの値を選択している場合があります。

##### **例 (Examples)**

| アクション変数を使用した数式 | 用途 |
| :--- | :--- |
| `[Selection/Region] = "South" or [Selection/Region] = "East"` | この数式は、`Region`列の「North」または「East」の値に対応する、ユーザーが選択したテーブルセルまたはビジュアライゼーションの対応するデータポイントを識別します。<br>この数式を条件で使用して、ユーザーのデータの選択に応じてアクションの実行を制限します。ユーザーが選択した値に応じてユニークなアクションを構成するには、それぞれがアクション変数に基づく条件を持つ複数のアクションシーケンスを構成します。 |
| `Lookup([Selection/Company Name], Max([Selection/Revenue]), [Selection/Revenue])` | この数式は、`Revenue`列で最大値を持つ`Company Name`列の値を返します。<br>ユーザーがグループ化された列をクリックしたときに、グルーピング内から特定の値を特定するためにコントロール値を設定するために、この数式を使用します。 |

ストアドプロシージャの結果をアクション変数として使用する例については、「[ストアドプロシージャを呼び出すアクションを作成する](https://help.sigmacomputing.com/docs/create-actions-that-call-stored-procedures-beta)」の例を参照してください。

### 9-5-3-2. 要素間のフィルターを作成する (Create cross-element filters)

アクションは動的な要素間フィルタリングをサポートしており、これにより、ある要素とのユーザーインタラクションが、同じワークブック内の他の要素のデータをフィルタリングできるようになります。例えば、ユーザーがあるチャート（トリガー要素）のデータポイントをクリックすると、Sigmaはクリックされたデータポイントのディメンション値を使用して、別のチャート（ターゲット要素）に自動的にフィルターを適用します。

このドキュメントでは、コントロール要素とアクションを使用して要素間フィルタリングを構成する方法について説明します。アクションに関する詳細は、「[アクションの概要](https://help.sigmacomputing.com/docs/actions-overview)」を参照してください。

#### **ユーザー要件 (User requirements)**
ワークブック要素の要素間フィルタリングを構成する機能には、以下が必要です。
* `Explore workbooks`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。
> 📘
> これらの要件は、要素間フィルターを**構成**するユーザーにのみ適用されます。構成された要素間フィルターは、ワークブックを閲覧できる任意のユーザーのインタラクションに適用されます。

#### **要素間フィルターを構成する (Configure a cross-element filter)**
Sigmaでは、要素間フィルターは少なくとも3つのワークブック要素で構成されます：トリガー要素、コントロール要素、およびターゲット要素です。

要素間フィルターのトリガー要素は、通常、テーブル、ピボットテーブル、入力テーブル、またはビジュアライゼーションです。ユーザーが特定の列のテーブルセルをクリックするか、チャート上の任意のデータポイントをクリックしてトリガー要素と対話すると、（トリガー要素で構成された）ワークブックアクションがコントロール要素の値を更新し、それが続いてターゲット要素をフィルタリングします。

この要素間のインタラクティビティを構成するには、以下を完了する必要があります。
1.  [ターゲット要素をフィルタリングするコントロールを作成する](#create-a-control-that-filters-the-target-element)
2.  [コントロール値を設定するワークブックアクションを作成する](https://help.sigmacomputing.com/docs/create-actions-that-manage-control-values)

> 💡
> このドキュメントで示されているワークフローは、単一のターゲット要素上の単一のディメンションに対して要素間フィルターを構成するために使用されます。
> * 同じターゲット要素上の複数のディメンションをフィルタリングするには、ディメンションごとに個別のコントロールとアクションを作成します。
> * 複数のターゲット要素上の単一のディメンションをフィルタリングするには、1つのコントロールを作成し、コントロール要素のプロパティですべてのターゲット要素をフィルターターゲットとして追加します。
> * 複数のターゲット要素上の複数のディメンションをフィルタリングするには、ディメンションごとに個別のコントロールとアクションを作成し、各コントロール要素のプロパティですべてのターゲット要素をフィルターターゲットとして追加します。

##### **ターゲット要素をフィルタリングするコントロールを作成する (Create a control that filters the target element)**
以下の手順は、要素フィルターを作成し、それを事前構成済みのリストまたは日付コントロール要素に迅速に変換する方法を説明しています。異なるコントロールタイプを使用してターゲット要素をフィルタリングしたい場合は、「[コントロール要素の概要](https://help.sigmacomputing.com/docs/intro-to-control-elements)」で、ゼロから新しいコントロールを作成する方法に関する情報を参照してください。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開き、少なくとも1つのトリガー要素と1つのターゲット要素を追加します。
2.  ターゲット要素にカーソルを合わせるか選択し、要素メニューで`Filters`をクリックします。
3.  `Filters & controls`モーダルで、フィルターを作成し、それをコントロール要素に変換します。
    a. `+ Add filter`をクリックし、フィルタリングしたい基盤となるデータ列を選択します。この時点でフィルター値を選択する必要はありません。
    b. `More`をクリックしてフィルターメニューを開き、`Convert to page control`を選択します。
4.  Sigmaは、変換したフィルターに沿った事前構成済みのコントロール要素を追加します。コントロールの値ソース、ソース列、およびフィルターターゲットは、ターゲット要素をフィルタリングするように自動的に設定されます。

##### **コントロール値を設定するワークブックアクションを作成する (Create a workbook action to set the control value)**
以下の手順は、前のセクションで作成したコントロール要素の値を設定するために、トリガー要素にワークブックアクションを構成する方法を説明しています。

1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  新しいシーケンスを作成するか、変更したい既存のシーケンスを探します。
5.  デフォルトのアクションを選択するか（新しいシーケンスを作成する場合）、`+ Add action`をクリックしてシーケンスに新しいアクションを追加します。
6.  モーダルで、応答を定義するために必要なフィールドを構成します。
    * トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、`When clicking cells in`フィールドで列を選択します。Sigmaは、ユーザーがこの列のセルをクリックしたときにのみ、要素間フィルターを開始します。
    * トリガー要素がビジュアライゼーション、ボタン、画像、またはコントロールの場合、このステップをスキップしてステップ3bに進みます。
    * [任意] アクションシーケンスが有効になるために満たすべき条件を構成します。条件を追加するには、`More`をクリックし、`Add condition`をクリックします。
7.  開始したい応答のタイプに基づいて、残りのフィールドを構成します。

| | |
| :--- | :--- |
| **Action** | `Set control value`を選択します。<br>この特定のアクションタイプが、要素間フィルターを有効にします。 |
| **Update control value** | 前のセクション「ターゲット要素をフィルタリングするコントロールを作成する」で作成したコントロール要素を選択します。<br>Sigmaは、ターゲット要素をフィルタリングするように事前構成されている、この特定のコントロールの値を設定します。 |
| **Set value as** | **Option 1:** `Specific values`を選択して、常にコントロールを一つ以上の固定値に設定し、その値を選択します。<br>**Option 2:** `Values from a specific column`を選択して、特定の列の値にコントロールを設定し、その列を選択します。コントロールは、クリックされたセルまたはデータポイントと同じ行の列値に基づいて動的に設定されます。 |

要素間フィルターが正しく機能するためには、選択された値または列が、コントロール要素のフィルターターゲットの値と一致している必要があります。フィルターターゲットは、コントロールの`Element properties` > `Targets`タブで構成され、前のセクション「ターゲット要素をフィルタリングするコントロールを作成する」のステップ3aで選択した列です。

ワークブックアクションが構成されると、トリガー要素とのユーザーインタラクションが、コントロール値を即座に更新し、ターゲット要素をフィルタリングするワークフローを開始します。この要素間フィルターのリアルタイムデモンストレーションについては、インタラクティブデモを参照してください。

##### **インタラクティブデモ (Interactive demo)**
以下の埋め込み例では、円グラフの任意のスライスをクリックして`State`コントロール値を設定し、州によってマップをフィルタリングします。その後、州の郡ごとの人口データにドリルダウンできます。

> 💡
> トリガー要素がビジュアライゼーションの場合、要素間フィルターは以下のインタラクションもサポートします。
> * 複数のコントロール値を設定するには、チャートのデータポイント（例えば、円のスライス）をクリックしながら`⌘ Command`（Mac OS）または`Ctrl`（Windows）を押し続けます。
> * トリガー要素の選択をクリアし、コントロール値とフィルターをリセットするには、トリガー要素の任意の空白スペースをクリックします。このクリックしてクリアする機能は、このデモのようなビジュアライゼーションでのみ機能し、テーブルやピボットテーブルでは機能しないことに注意してください。

トリガー要素がテーブル、ピボットテーブル、または入力テーブルの場合、複数のコントロール値を設定することはできません。複数のセルを選択した場合、最後にクリックしたセルがコントロール値を決定します。

### 9-5-3-3. カスタムコンテキストメニューアクションを作成する (ベータ版)

> 🚩
> このドキュメントはパブリックベータ機能について説明しており、現在作成中です。この通知およびSigmaサービス内の機能に対応するベータフラグが削除されるまで、このページは公開されたドキュメントの一部とは見なされません。他のベータ機能と同様、以下で説明する機能は、迅速で反復的な変更の対象となります。Sigmaサービスでの最新の体験は、このドキュメントの内容と異なる場合があります。
> ベータ機能は、[ベータ機能](https://help.sigmacomputing.com/docs/beta-features)の免責事項の対象となります。

テーブル、ピボットテーブル、入力テーブル、およびチャートにカスタムコンテキストメニュー項目を追加して、選択されたセルやデータポイントに関連するアクションのための明確で発見しやすいトリガーを提供します。[ストアドプロシージャの呼び出し](https://help.sigmacomputing.com/docs/create-actions-that-call-stored-procedures-beta)、[iframeイベントの生成](https://help.sigmacomputing.com/docs/create-actions-that-generate-embed-iframe-events)、[モーダルの表示](https://help.sigmacomputing.com/docs/create-actions-that-control-modals-and-tabbed-containers)など、任意のアクション効果を実行するスタンドアロンのメニュー項目やネストされたサブメニューを作成できます。

このドキュメントでは、カスタムコンテキストメニュー項目を追加し、それらをアクショントリガーとして定義する方法について説明します。

#### **ユーザー要件 (User requirements)**
カスタムコンテキストメニュー項目を追加し、それらをアクショントリガーとして定義する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`または`Can edit`の[ワークブックアクセス権](https://help.sigmacomputing.com/docs/share-a-workbook)を持っている必要があります。`Can explore`アクセス権がある場合、カスタムビューでのみカスタムコンテキストメニュー項目を作成および構成できます。

#### **カスタムコンテキストメニュー項目を追加する (Add custom context menu items)**
既存のセルまたはデータポイントのコンテキストメニューを補完するために、スタンドアロンのメニュー項目を追加したり、ネストされたサブメニューを作成したりします。

1.  カスタマイズしたい要素を選択します。
2.  エディタパネルで、`Format`タブを開きます。
3.  `Custom context menu`セクションを展開し、追加したいメニュー項目ごとに`+ Add an option`をクリックします。
4.  各メニュー項目カードで、「Option」というプレースホルダーテキストをダブルクリックし、メニューに表示するラベルを入力します。`More`をクリックして`Rename`を選択してテキストを編集することもできます。
5.  [任意] メニュー項目を並べ替えるには、任意のカードのドラッグハンドル()をクリックして押し続け、目的の位置に移動します。
6.  [任意] ネストされたサブメニューを作成するには、カードのドラッグハンドル()をクリックして押し続け、親メニュー項目の下に少し右にドラッグします。`More`をクリックし、`Move to`にカーソルを合わせて親メニュー項目の名前を選択することもできます。
    メニュー項目がサブメニューに正常にネストされると、親メニュー項目の下にインデントされたカードとして表示されます。
    > 📘
    > ネストされたサブメニューでは、子メニュー項目にのみアクションを構成できます。親メニュー項目はアクションをトリガーできません。
7.  [任意] メニュー項目を削除するには、カードにカーソルを合わせ、`More`をクリックして`Delete`を選択します。親メニュー項目を削除すると、すべての子メニュー項目も削除されます。

#### **カスタムコンテキストメニュー項目をアクショントリガーとして定義する (Define custom context menu items as action triggers)**
カスタムコンテキストメニュー項目をトリガーとしてアクションシーケンスを構成します。

1.  カスタムコンテキストメニュー項目を含む要素を選択します。
2.  エディタパネルで、`Actions`タブを開きます。
3.  `+ Add action sequence`をクリックして新しいシーケンスを作成するか、デフォルトの空のシーケンスに以下の手順を適用します。各メニュー項目には個別のシーケンスが必要です。
4.  シーケンスで、メニュー項目をアクショントリガーとして構成します。
    * トリガータイプフィールド（上のフィールド）をクリックし、`Cell context menu`を選択します。
    * トリガーターゲットフィールド（下のフィールド）をクリックし、特定のメニュー項目の名前を選択します。
5.  メニュー項目の残りのロジックを構成します。利用可能な効果と対応する構成手順に関する情報については、「[Action effects](https://help.sigmacomputing.com/docs/action-effects)」を参照してください。
6.  すべての単一メニュー項目とネストされた子メニュー項目について、ステップ3から5を繰り返します。

### 9-5-3-4. 既存のアクションの表示と管理 (View and manage existing actions)

各ワークブックページには、アクションを含むすべての要素をリストした概要があります。このリストから（またはページ上で直接）要素を選択して、そのアクションを表示および管理します。

このドキュメントでは、ワークブックで既存のアクションを表示、編集、複製、削除する方法について説明します。新しいアクションの作成に関する情報については、このページの最後にある「関連リソース」セクションを参照してください。

#### **ユーザー要件 (User requirements)**
> 📘
> 以下の要件は、アクションを表示および管理するメンバーに適用されます。ワークブックにアクセスして対話するユーザーは、通常、その中のすべての既存のアクションをトリガーできます。制限事項はこのドキュメントに記載されています。

アクションを表示および管理する機能には、以下が必要です。
* `Full explore`または`Create, edit, and publish workbooks`権限が有効になっている[アカウントタイプ](https://help.sigmacomputing.com/docs/account-type-and-license-overview)を割り当てられている必要があります。
* あなたがワークブックの所有者であるか、`Can explore`¹または`Can edit`の[ワークブック権限](https://help.sigmacomputing.com/docs/share-a-workbook)を付与されている必要があります。

¹ `Can explore`のワークブック権限が付与されている場合、アクションを構成できますが、変更をワークブックの公開バージョンに保存することはできません。

#### **構成済みのアクションを表示する (View configured actions)**
ワークブックの特定のページで構成されているすべてのアクションを表示します。
1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  既存の要素を選択せずに、エディタパネルに移動し、`Actions`タブを開きます。
3.  パネルには、アクションを含むすべてのページ要素がリストされ、それぞれに構成されているアクションの数が表示されます。要素を選択して、その構成済みのアクションを表示します。

#### **アクションを編集する (Edit an action)**
既存のアクションの構成を編集します。
1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素（アクションを開始するためにユーザーが対話する必要がある要素）を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  編集したいアクションを探し、`More`をクリックして`Edit`を選択します。
5.  モーダルで、必要に応じてアクションの構成を更新します。

#### **シーケンスまたはアクションを複製する (Duplicate a sequence or action)**
既存のシーケンスまたはアクションを複製して、その構成を活用および修正します。
1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  パネルで、複製したいシーケンスまたは個々のアクションを探します。
5.  シーケンスまたはアクション名の隣にある`More`をクリックし、`Duplicate`を選択します。

#### **シーケンスまたはアクションを削除する (Delete a sequence or action)**
シーケンスまたはアクションを削除して、ワークブックから永久に削除します。
1.  ワークブックのドラフト、カスタムビュー、または保存済みビューを開きます。
2.  トリガー要素を選択します。
3.  エディタパネルで、`Actions`タブを開きます。
4.  パネルで、削除したいシーquenceまたは個々のアクションを探します。
5.  シーケンスまたはアクション名の隣にある`More`をクリックし、`Delete`を選択します。
