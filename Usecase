# 1. 背景と目的

## 1-1 対象読者：
* マーケティング部門の分析業務担当者およびマネージャー
* 商品企画、イベント企画の立案担当者
* 販売戦略・営業企画の担当者

## 1-2 従来の分析プロセスにおける課題
本ユースケースにおける従来の分析プロセスでは、以下の3つの主要な課題に直面しています。

### 1. 分析準備における非効率な手作業
キャンペーン施策の分析に着手する前段階において、手作業による非効率が常態化しています。
* **キャンペーン毎の分析ロジックの再構築**
    * 施策ごとに設問やデータ構造が異なるため、その都度、結合や集計のロジックをExcel上で手作業で組み立て直す必要がある。
* **複数データソースの手作業による結合・前処理**
    * DWHの購買履歴や会員情報、ローカルのアンケートファイルなど、分散したデータを手動で突合・クレンジングしている。
* **ヒューマンエラーによる手戻りと検証コストの増大**
    * 手作業に起因する計算ミスや参照範囲の誤りが、後工程での手戻りや、ダブルチェックといった検証コストを発生させている。

### 2. Excelの性能限界に起因する技術的制約
分析に使用するツールの性能が、分析の質とスピードを律速しています。
* **大規模データ処理時のパフォーマンス低下**
    * キャンペーン参加者数や購買データが数万行を超えると、Excelの動作が極端に遅延、あるいは応答不能（クラッシュ）となる。
* **リアルタイムな対話的分析の実行困難**
    * パフォーマンスの問題により、会議中に新たな切り口でデータを再集計するといった、対話的・探索的な分析が事実上不可能となっている。

### 3. 属人化・中央集権化がもたらす組織的障壁
分析業務の進め方が、組織全体としての俊敏性や継続性を損なっています。
* **個人のスキルに依存する「Excelのブラックボックス化」**
    * 特定の担当者しか解読・編集できない複雑なExcelファイルが作成され、業務の属人化を招き、担当者不在時の業務継続リスクとなっている。
* **IT部門への依頼が集中する「分析のボトルネック化」**
    * データ抽出をIT部門に都度依頼する運用では、マーケターが仮説を思いついてから検証するまでのリードタイムが長くなり、主体的なデータ探索を阻害している。

## 1-3 Sigmaによって実現する新しい分析の在り方
* **分析準備プロセスの標準化と自動化**
    * キャンペーンごとに異なるデータソースを手作業で都度結合・加工するといったプロセスを効率化・自動化します。
    * Sigmaでは、データのクレンジングや正規化といった前処理をシステム上で標準化可能です。
    * 一度データモデルを構築すれば、参照するファイルやデータが更新されても、定義済みの計算式やダッシュボードが破損することはありません。
    * これにより、これまで準備作業に費やしていたリソースを、インサイトの発見や戦略立案といった、より付加価値の高い業務へシフトさせることが可能になります。
* **対話的なデータ探索による、意思決定の迅速化**
    * 静的な資料を基にした一方的な「報告会」から、チーム全員が参加するインタラクティブな「探索セッション」へ移行できます。
    * Sigmaでは、大規模データであっても、多くの人が使い慣れたピボットテーブルのような直感的な操作で、ストレスなくリアルタイムなアドホック分析が可能です。
    * 会議中に新たな問いが生まれても、その場でデータを深掘りし、根拠に基づいた検証を行うことができます。
    * これにより、問いの発生からインサイト獲得、そして次のアクションプラン策定までのサイクルが劇的に高速化し、データドリブンな意思決定を組織に根付かせます。
* **脱・属人化：専門スキル不要の分析環境**
    * 担当者個人の技巧的なスキルに依存した、ブラックボックス化したExcelファイルは不要になります。
    * Sigmaは、多くのビジネスユーザーが習熟しているスプレッドシート形式のインターフェースと、互換性の高い関数構文を採用しているため、導入時の学習コストを低減します。
    * ドリルスルーやフィルタリングといったGUIベースの操作に加え、AIアシスタントに自然言語で指示するだけで、データ分析を実行できます。
    * これにより、データサイエンティストのような専門職でなくとも、ビジネス担当者自身が主体的にデータを探索・分析する環境が構築されます。

---
**ハンズオンの難易度：** 初心者〜中級者

Excelでのデータ集計・分析（VLOOKUP、ピボットテーブル等）の実務経験がある方を主な対象としています。
（TableauやPower BIなど、他のBIツールの使用経験があれば、よりスムーズにご理解いただけます）

## 2-1 業務シナリオ：2025年上半期キャンペーン施策振り返り会議
本会議の目的は、2025年の上半期に実施したキャンペーンデータに基づいて、施策から得られたインサイトを全員で発見し、次の具体的なアクションプランへと繋げることです。

---

### シーン0：第一回目のキャンペーン分析結果報告会での課題
第一回のキャンペーン分析結果報告会に先立ち、担当者は1週間前よりDWHから抽出した購買履歴やアンケート結果といった複数のデータソースを、PC上の**Excel**を用いて手作業で統合する作業に着手しました。この**VLOOKUP関数**等を多用したデータ結合と集計プロセスは、多くの工数を要するものでした。
会議当日、準備されたレポートに基づく報告は進みましたが、質疑応答の中で「このキャンペーンで初めて商品を購入した『新規顧客』は、どの商品カテゴリに関心を持ったのか？」といった、事前集計の範囲を超える分析要求が発生しました。担当者がその場で対応を試みたところ、大規模な元データを再集計しようとした**Excel**は応答不能となり、即座に回答することができませんでした。
この一連の事象を経て、次回の会議では**Sigma**のBIツールを使って、分析結果の報告会を行うという方針に決まりました。

---

### シーン1：次回の振り返り報告会に向けたサマリーダッシュボードの構築準備
**Sigma**の導入は、まず分析準備のワークフローを抜本的に変革しました。これまで数日を要していたデータ準備作業は、担当者自身が**Sigma**上でデータモデルを構築することで、迅速に完了します。DWH上の大規模データである会員情報や購買履歴、キャンペーン情報、アンケート回答といった5つのデータソースは、**GUIベースのJoin機能**で一度結合ルールを定義すれば、統合・自動更新されます。さらに、分析の過程で商品マスタ等の小規模な補助データを参照する際は、スプレッドシート製品と互換性の高い**Lookup()関数**が有効です。これにより、データモデルの複雑性を上げることなく、必要な情報のみを柔軟に抽出・追加できます。
この「準備作業」の効率化により、担当者は、次回の報告会に向けて、議論の質を最大化するための「対話の起点」となるサマリーダッシュボードの設計・構築に注力できるようになりました。
以下は、その効率化されたプロセスを通じて、担当者が会議の共通認識基盤として準備した、ダッシュボードの可視化項目です。

**【全体像の把握】**
* 主要KPI（応募総数、購買転換率、顧客獲得単価、ROI）
* キャンペーン期間中の応募数や購買金額の時系列推移

**【顧客セグメント分析】**
* 参加者のデモグラフィック（年代、性別、地域）や顧客ランク別構成
* 新規顧客／既存顧客別の参加・購買状況

**【意識と行動の相関分析】**
* アンケート回答（例：満足度、重視ポイント）別の購買率・購入金額
* アンケート回答（例：認知経路）別のLTV（顧客生涯価値）傾向

**【定性データの活用】**
* 自由回答からAIで抽出したキーワードや感情（ポジティブ/ネガティブ）の傾向

これらの項目を可視化させたサマリーダッシュボードを基軸に、第二回の振り返り会議の中ではディスカッションが行われます。

### シーン2： リアルタイム・アドホック分析による「探索セッション」の実現

第二回目のキャンペーン分析結果報告会当日。担当者は事前に構築したインタラクティブなダッシュボードを共通の事実基盤（ファクトベース）として提示し、議論を進行します。会議の場で多角的な分析要求が発生しても、担当者はリアルタイムで対応可能です。

会議が進行する中で、実際に発生した4つの分析要求と、その場で得られたインサイトは以下の通りです。

---

#### **分析例1：コラボ施策における"真の"優良顧客セグメントの発見**

* **【発見】** ダッシュボード上、「参加理由が『コラボキャラクターが好きだから』」と回答した顧客セグメントの応募数が突出して多く、全体の売上にも貢献していることを確認。
* **【仮説】** この売上貢献は、単に既存のヘビーユーザーが"ついで買い"した結果ではないか？それとも、このコラボを機に新規・ライト層が購買してくれたのだろうか？
* **【分析】**
    1.  ワークシート上で、対象データを「参加理由 = 'コラボキャラクターが好きだから'」でフィルタリング。
    2.  顧客ランク（新規/ライト/ミドル/ヘビー）を行に、応募者数と購買転換率、平均購入単価を値とするピボットテーブルをその場で作成。
* **【インサイト】** このコラボ施策は既存の優良顧客層以上に、**これまでリーチしきれていなかった「新規顧客」および「ライト層」に極めて強く響いた**ことが判明。これらの層における購買転換率は、通常施策の2倍以上を記録し、本企画が将来の優良顧客となりうる新規層の獲得に絶大な効果を発揮したことを示しています。

---

#### **分析例2：低迷セグメントの原因特定**

* **【発見】** ダッシュボード上、「50代以上」の顧客セグメントの購買転換率が、他の年代に比べて著しく低いことを確認。
* **【仮説】** なぜ50代以上の転換率は低いのか？価格が障壁か、あるいは求めている価値と訴求内容がミスマッチしているのか？
* **【分析】**
    1.  ワークシート上で、対象データを「年代 = 50代以上」でフィルタリング。
    2.  アンケートの「購入時の重視点」の回答比率をグラフ化し、他の年代（例: 30代）の回答比率と比較。
* **【インサイト】** 50代以上は「機能のシンプルさ」を重視する一方、キャンペーン訴求は「多機能性」に偏っていた、などの**メッセージとターゲットニーズの不一致を発見**。今後のクリエイティブ改善の具体的な指針を得られました。

---

#### **分析例3：流入チャネルと顧客単価の相関分析**

* **【発見】** ダッシュボード上、キャンペーンの流入チャネルとして「Instagram」からの応募数が最も多いことを確認。
* **【仮説】** 応募者の「数」だけでなく、「質」もチャネルによって異なるのではないか？特定のチャネルから流入した顧客は平均購入単価（AOV）が高い傾向にあるのではないか？
* **【分析】**
    1.  ワークシート上で、認知チャネルをX軸に、平均購入金額をY軸とする棒グラフをその場で作成。
    2.  グラフに応募者数を第2軸として追加し、量と質を同時に比較。
* **【インサイト】** 応募者数は「Instagram」が最多だが、**平均購入単価は「Web検索」経由の顧客が30%高い**、といったチャネル毎の収益性の違いを可視化。広告予算の最適な再配分を検討するための、費用対効果の判断材料を得られました。

---

#### **分析例4：AIによる「改善要望」の特定と優先順位付け**

* **【発見】** ダッシュボードのKPIは好調だが、フリーテキストの回答には一定数のネガティブな声も含まれていることを確認。
* **【仮説】** ネガティブな意見の中に、単なる不満だけでなく、我々が次に取り組むべき具体的な『改善のヒント』は含まれているか？もしあるなら、それはどの顧客層から寄せられているのか？
* **【分析】**
    1.  ワークシート上で、自由回答列に対してSigmaのAI関数（感情分析）を適用し、「ネガティブ」な意見に絞り込む。
    2.  さらにその結果に対し、AI関数（分類）を適用。「改善提案」「単なる不満」等を定義し、各コメントを自動で仕分ける。
    3.  分類結果が「改善提案」となったコメントのみを抽出し、その内容と発言者の顧客属性（年代、顧客ランク）を分析する。
* **【インサイト】** KPIには現れないサービス上の具体的な課題（例：「決済方法が少ない」「アプリが使いにくい」）が、特に**ロイヤルティの高い優良顧客層から多く寄せられていることが判明**しました。

## 3. 完成イメージ（成果物の可視化例）
本ハンズオンを完了すると、以下にご紹介するような、キャンペーンの成果を多角的に評価できるインタラクティブなダッシュボードが完成します。このダッシュボードは、単なる静的なレポートではなく、チーム全員でデータと対話し、インサイトを発見するための「分析の出発点」として機能します。

### 3-1 完成ダッシュボードの全体像
（※ここにダッシュボード全体のスクリーンショットが入るイメージ）

### 3-2 主要コンポーネントの説明
ダッシュボードは、以下の主要な可視化コンポーネントで構成されています。

#### **主要KPIサマリー**
* **配置エリア:** 画面上部
* **可視化形式:** KPIカード
* **主な目的:** キャンペーン全体の成果（応募数、総売り上げ、ROI等）を最重要指標で俯瞰的に把握する。

#### **時系列推移**
* **配置エリア:** 画面中央
* **可視化形式:** 折れ線グラフ
* **主な目的:** キャンペーン期間中の応募数や購買金額の盛り上がりを時系列で追い、「いつ」最も反応があったかを確認する。

#### **参加者デモグラフィック**
* **配置エリア:** 画面中央
* **可視化形式:** 棒グラフ
* **主な目的:** 「どのような顧客層（年代、性別、地域）」がキャンペーンに参加したかを理解する。

#### **顧客ランク別構成**
* **配置エリア:** 画面中央
* **可視化形式:** 積み上げ棒グラフ
* **主な目的:** 参加者が「新規、ライト、ミドル、ヘビー」のどの顧客ランクに属しているか、その構成比と購買状況を把握する。

#### **意識と行動の相関分析**
* **配置エリア:** 画面中央
* **可視化形式:** ピボットテーブル
* **主な目的:** アンケートの回答内容（満足度、重視点など）と、実際の購買率や購入金額を掛け合わせ、「なぜ」購買に至ったかのヒントを探る。

#### **LTV傾向分析**
* **配置エリア:** 画面下部
* **可視化形式:** 棒グラフ
* **主な目的:** 認知経路（チャネル）別に、その後のLTVにどのような違いがあるかを比較し、チャネルの「質」を評価する。

#### **AIを用いた自由回答（定性データ）分析**
* **配置エリア:** 画面下部
* **可視化形式:** テーブル / ヒートマップ
* **主な目的:** AIを用いて自由回答から頻出キーワードや感情（ポジティブ/ネガティブ）を抽出し、定量データだけでは見えない顧客の生の声を発見する。

# Phase1：データへの接続と分析基盤の構築（データ結合）

## **目的**
全ての分析の土台となる、Snowflake上の5つのテーブルをSigmaに接続し、それらを正しく結合して、分析の起点となる「**分析用データセット（ワークシート）**」を作成します。

---

## **手順**

### **Step1: ワークブックの新規作成とデータソースの選択**
1.  Sigmaにログインし、左上に位置する「**Create a new**」ボタンから「**Workbook**」を新規作成します。
2.  データソース選択画面が表示されます。

### **Step2: テーブルの複数選択**
1.  接続先にあるデータベースの中から**MY\_HANDSON\_DB**をクリックし、次に**PUBLIC**スキーマをクリックします。
2.  事前にSnowflake上で作成した下記の5つのテーブル一覧が表示されます。
    * **TBL\_CUSTOMERS**
    * **TBL\_PURCHASES**
    * **TBL\_CAMPAIGNS**
    * **TBL\_QUESTIONS**
    * **TBL\_ANSWERS**
3.  キーボードの**Ctrlキー（Macの場合はCmdキー）**を押しながら、5つのテーブル名をすべてクリックして、複数選択状態にします。
4.  選択が完了したら、右上の「**開始**」ボタンをクリックします。

#### **結合（Join）の実行**
画面上部に、選択した5つのテーブルが「箱」として表示されます。ここから、SQLを一切書かずに、視覚的な操作でテーブル同士を結合していきます。

まず、分析の中心となる「**TBL\_ANSWERS（アンケート回答）**」を起点に、他のマスターテーブルを結合します。

* **会員情報とアンケート回答の結合**
    * 「**TBL\_CUSTOMERS（会員情報）**」の箱をドラッグし、「**TBL\_ANSWERS**」の箱の上に重ねます。表示された結合キー設定で、両方のテーブルの「**CUSTOMER\_ID**」を選択し、結合を確定します。
    * 結合が作成されたら、2つの箱を繋いでいる線の中央にある、円が2つ重なったアイコン（結合タイプ）をクリックします。
    * 表示されたメニューから、「**左外部結合（Left Join）**」を選択します。「**TBL\_Answers**」が左側に表示されていることを確認してください。
* 同様に、**TBL\_CAMPAIGNS**を**TBL\_ANSWERS**に「**CAMPAIGN\_ID**」で結合します。
* 同様に、**TBL\_QUESTIONS**を**TBL\_ANSWERS**に「**QUESTION\_ID**」で結合します。
* 後に、**TBL\_PURCHASES（購入履歴）**の箱を、既に結合されている「**TBL\_CUSTOMERS**」の箱の上に重ね、「**CUSTOMER\_ID**」で結合します。

### **Step3: ワークシートの名前の変更**
最後に、このデータセット全体の名前を、後から分かりやすいように変更しておきましょう。画面上部にある要素の名前をクリックし、「**キャンペーン統合分析用統合データ**」など、任意名称に変更してください。

---

### ✅ **このフェーズのゴール**
5つのテーブルが正しく結合され、多角的な分析を行うための準備が整った、一つの大きなデータセット（ワークシート）が完成しました。
これで、次の「集計・可視化フェーズ」に進む準備が万端です。

---

### **コラム：前回のキャンペーン分析報告会での苦労エピソード①**
前回のキャンペーン分析報告会準備の時、担当者はIT部門に依頼して、基幹システムから顧客情報や購買履歴のCSVをダウンロードしてもらい、自部門のフォルダから、最新のアンケート回答やキャンペーン情報のファイルを探し出し、これらの巨大で、形式もバラバラな複数のファイルを、VLOOKUP関数や手作業のコピー＆ペーストで、一つのシートにまとめていました。この作業の中では、参照範囲のミスやPCのフリーズが起こることも少なくありませんでした。今回のSigmaでは、このプロセスを「**接続（Connect）と結合（Join）**」機能によって、一度関係性を保存されるため、キャンペーン分析の度に発生していたデータの突合作業を毎回行わずとも、分析の土台は自動で更新され続けます。

# Phase2: 集計・可visua化フェーズ

## **主要KPIサマリーの作成**

### **目的**
まず、ダッシュボードの「顔」となる、**2025年上半期**全体の成績が一目でわかるサマリー（主要KPI）を作成します。これにより、会議の参加者は、詳細を見る前に「**結論**」から把握することができます。

---

### **手順**

#### **Step1: 新しいページの作成**
ワークブックの下部にある「**＋**」ボタンから、「**UI**」→「**Text**」を選択してください。そして、作成したバナーに「**2025上半期サマリー**」といった任意の分かりやすい名前を付けます。

#### **Step2: KPIカードの作成（応募総数）**
1.  ワークブックの下部にある「**＋**」ボタンから、最初の可視化要素として「**Chart**」を選択し、表示形式として「**KPI**」を選択します。
2.  右側に表示される詳細設定の「**値（Value）**」エリアに、「**TBL\_CUSTOMERS**」の **[Customer Id]** をドラッグ＆ドロップし、集計方法が **CountDistinct** になっていることを確認します。
3.  タイトルを「**応募総数**」に変更します。

#### **Step3 追加KPIの作成（購入者数、購買転換率など）**
同様の手順で、以下のKPIカードを横に並べて作成していきます。

* **購入者数**
    * **値**: `CountDistinct([Purchase Id])`
    * **タイトル**: 購入者数

* **購買転換率**
    * **値**: `CountDistinct([Purchase Id]) / CountDistinct([Customer Id])`
    * **タイトル**: 購買転換率
    * **書式設定**: パーセント（Percent）に変更

#### **Step4: ページ全体へのフィルター設定**
最後に、このページ全体を「**2025年上半期**」のデータだけに絞り込みます。

1.  画面上部にある「**ページコントロール**」エリアに、**TBL\_CAMPAIGNS**の **[Start Date]** をドラッグ＆ドロップします。
2.  表示されたフィルターコントロールで、期間を「**2025年1月1日**」から「**2025年6月30日**」までに設定します。

# Phase2: 集計・可視化フェーズ

## **主要KPIサマリーの作成**

### **目的**
まず、ダッシュボードの「顔」となる、**2025年上半期**全体の成績が一目でわかるサマリー（主要KPI）を作成します。これにより、会議の参加者は、詳細を見る前に「**結論**」から把握することができます。

---

### **手順**

#### **Step1: 新しいページの作成**
ワークブックの下部にある「**＋**」ボタンから、「**UI**」→「**Text**」を選択してください。そして、作成したバナーに「**2025上半期サマリー**」といった任意の分かりやすい名前を付けます。

#### **Step2: KPIカードの作成（応募総数）**
1.  ワークブックの下部にある「**＋**」ボタンから、最初の可視化要素として「**Chart**」を選択し、表示形式として「**KPI**」を選択します。
2.  右側に表示される詳細設定の「**値（Value）**」エリアに、「**TBL\_CUSTOMERS**」の **[Customer Id]** をドラッグ＆ドロップし、集計方法が **CountDistinct** になっていることを確認します。
3.  タイトルを「**応募総数**」に変更します。

#### **Step3 追加KPIの作成（購入者数、購買転換率など）**
同様の手順で、以下のKPIカードを横に並べて作成していきます。

* **購入者数**
    * **値**: `CountDistinct([Purchase Id])`
    * **タイトル**: 購入者数

* **購買転換率**
    * **値**: `CountDistinct([Purchase Id]) / CountDistinct([Customer Id])`
    * **タイトル**: 購買転換率
    * **書式設定**: パーセント（Percent）に変更

#### **Step4: ページ全体へのフィルター設定**
最後に、このページ全体を「**2025年上半期**」のデータだけに絞り込みます。

1.  画面上部にある「**ページコントロール**」エリアに、**TBL\_CAMPAIGNS**の **[Start Date]** をドラッグ＆ドロップします。
2.  表示されたフィルターコントロールで、期間を「**2025年1月1日**」から「**2025年6月30日**」までに設定します。

# 追加ハンズオン：Lookup関数を用いた目標達成率の可視化

---

## **Step1: 実績値のピボットテーブルを作成**
1.  Sigmaの画面で、キャンペーンタイプごとの実績をまとめた表を作成します。Sigmaのワークブックに、新しい「**ピボットテーブル**」要素を追加します。
2.  以下の設定で、実績値を集計します。
    * **行 (Rows)**: `[Campaign Type]`
    * **値 (Values)**: `CountDistinct([Purchase Id]) / CountDistinct([Customer Id])`
3.  「値」に設定した計算列の名前を **[実績CVR]** に変更し、書式を「**パーセント**」にします。

---

## **Step2: 目標管理CSVファイルの準備**
画面下の「**Input**」から「**CSV**」を選択します。そして、「**TBL\_CAMPAIGN\_GOALS.CSV**」のデータを挿入してください。

---

## **Step3: CSVファイルをアップロードし、Lookup()で参照**
作成した「実績」の表に、手元のCSVファイルから「目標」の数値を`Lookup()`関数で持ってきます。

Step2で作成したピボットテーブルに、新しい計算列を追加します。以下の設定で、目標値を参照します。

* **列名**: `[目標CVR]`
* **計算式**:
    ```
    Lookup([GOAL_CONVERSION_RATE], [TBL_CAMPAIGN_GOALS.csv], [Campaign Type])
    ```
* **書式設定**: 「**パーセント**」に設定します。

---

## **Step4: 達成率の計算と可視化**
最後に、実績と目標を比較して「達成率」を計算し、評価を視覚的に分かりやすくします。

ピボットテーブルに、さらに新しい計算列を追加します。

* **列名**: `[達成率]`
* **計算式**: `[実績CVR] / [目標CVR]`
* **書式設定**: 「**パーセント**」に設定します。

**[達成率]** 列に条件付き書式を適用し、「**100%以上なら緑**」「**100%未満なら赤**」のように、セルの背景色を設定します。

# 主要グラフの作成

## **グラフ①：時系列推移グラフ**

### **目的**
キャンペーン期間中の応募者数の推移を、一本の折れ線グラフで可視化します。これにより、「**2025年上半期に、私たちの施策が、いつ、どれくらいの勢いで顧客を惹きつけたのか**」を、一目で分かるようにします。

---

### **手順**

#### **Step1: 新しい可視化要素の追加**
ページに新しい**「可視化」要素を追加し、グラフの種類として「折れ線グラフ（Line Chart）」**を選択します。

#### **Step2: X軸（時間軸）の設定**
* 「**X軸**」エリアに、**TBL\_ANSWERS**テーブルの **[Answered At]** 列をドラッグ＆ドロップします。
* X軸に挿入したカラムの右側に位置するボタンをクリックし、**Truncate Date**を選択して「**Week**」をクリックします。

#### **Step3: Y軸の設定**
* 「**Y軸**」エリアに、**TBL\_CUSTOMERS**の **[Customer Id]** をドラッグ＆ドロップし、集計方法を **CountDistinct**（ユニーク数を数える）に設定します。
* 系列の名前を「**応募者数**」に変更します。

#### **Step4: 画面には以下のグラフが表示されます。**
*(ここにグラフの画像が表示される想定)*

---

### ✅ **このステップのゴール**
横軸が時間、縦軸がキャンペーンの応募人数となった、折れ線グラフが完成しました。

## **グラフ②：キャンペーンタイプ別の成果比較**

### **目的**
上半期に実施した複数のキャンペーンを、「**タイアップ・コラボ型**」や「**新商品ローンチ型**」といった種類ごとに、成果（応募者数、購入者数など）を横並びで比較し、どれが「**当たり**」だったのかを明確にします。

---

### **手順**

#### **Step1: 新しい可視化要素の追加**
ページに新しい「**可視化**」要素を追加し、グラフの種類として「**棒グラフ（Bar Chart）**」を選択します。

#### **Step2: X軸（比較の切り口）の設定**
「**X軸**」エリアに、**TBL\_CAMPAIGNS**テーブルの **[Campaign Type]** 列をドラッグ＆ドロップします。

#### **Step3: Y軸（評価指標）の設定**
「**Y軸**」エリアに、**TBL\_ANSWERS**テーブルの **[Customer Id]** 列をドラッグ＆ドロップし、集計方法を **CountDistinct** に設定します。

---

### ✅ **このステップのゴール**
横軸がキャンペーンタイプ、縦軸が応募者数となった、比較グラフが完成します。 このグラフを見れば、「**新商品ローンチ型**」の施策がいかに多くの顧客を惹きつけたかが一目瞭然となり、成功要因を特定を深堀するというインサイトが得られます。

## **追加ハンズオン：データの深堀をして更なるインサイトを発見する**

### **Step1: 会員ランク別での分析**
作成した棒グラフに、新しい分析の切り口として「会員ランク」を追加し、キャンペーンタイプごとの成果にランクによるばらつきがあるかを確認します。

* 既存の棒グラフの「**色（Color）**」設定エリアに、**TBL\_CUSTOMERS**テーブルの **[Rank]** 列をドラッグ＆ドロップします。これにより、各キャンペーンタイプの棒グラフが、会員ランクごとの内訳で色分けされます。

### **Step2: フィルターを活用した属性別分析**
フィルター機能を用いて、特定の顧客セグメント（性別、地域、年齢層）に絞り込み、それぞれで成果にどのような違いが現れるかを分析します。

1.  グラフ右上（またはページ上部）にある**フィルター**のアイコンをクリックします。
2.  表示された項目から **[Age group]**、**[Gender]**、**[Prefecture]** を選択してフィルターコントロールを追加します。
3.  それぞれのフィルターを操作し（例：性別で「女性」を選択、地域で「東京都」を選択など）、グラフがどのように変化するかを確認して、属性ごとの傾向を分析してみましょう。

# Phase3：ダッシュボードへの集約と公開

## **目的**
作成した各要素を戦略的に配置し、インタラクティブなフィルターや説明文を追加することで、単なるグラフの集合体ではなく、一つの完結した分析レポートとしてダッシュボードを完成させます。

---

## **手順：レイアウト調整**
まず、ページの編集画面で、これまで作成した要素を、私たちが設計した「**結論 → 過程 → 内訳**」という分析ストーリーに沿って配置します。

* **最上段（結論）：**
    * 主要KPIサマリーを配置します。

* **中段（過程と比較）：**
    * 左側に時系列推移グラフ、右側にキャンペーンタイプ別成果比較グラフを並べて配置します。

* **下段（詳細）：**
    * 顧客ランク別積み上げ棒グラフや、今後のアドホック分析で作成する詳細なテーブルなどを配置します。

---

## **手順3：詳細デザインと注釈の追加**
最後に、見る人が迷わないよう、タイトルや説明文を追加して仕上げます。

* **Text（テキスト）**要素を使い、ダッシュボードの最上部に「**2025年上半期 キャンペーン成果報告サマリー**」といった、明確なタイトルを追加します。

* 各グラフの上にも、「**応募者数と購入者数の推移**」といった、グラフが何を表しているかの小タイトルを追加します。

* 特に重要なインサイト（例：「**新商品ローンチ型施策がROIを牽引**」）は、結論としてテキストで書き出しておくと、メッセージがより強力に伝わります。

---

## **手順4：公開（Publish）**
全ての調整が完了したら、画面右上の青い「**公開（Publish）**」ボタンをクリックします。 これで、あなたの行った変更が保存され、ダッシュボードが他のチームメンバーと共有できる状態になります。

---

## ✅ **このフェーズのゴール**
これまで、個々で作成してきた主要なKPIとグラフが一つのダッシュボードに集約されました。これにより、ダッシュボードの閲覧者がインタラクティブにインサイトを見つけられる土壌が完成しました。

---

## **コラム：前回のキャンペーン分析報告会での苦労エピソード②**
前回のキャンペーン分析報告会直前、担当者は最終版のエクセルデータを前日の夕方に関係者に共有していたが、その後データの集計ミスが発覚し、再度修正版を翌日に送ることになり、受け取り手は最新版がどのファイルかわからなくなるということが発生しました。一方で、Sigmaであれば、Publishされたダッシュボードは、修正箇所は瞬時にアップデートされるようになります。

# Phase4：追加要求対処手順

## **分析要求1：コラボ施策における"真の"優良顧客セグメントの発見**

### **目的**
「**コラボ施策は、単に既存ファンが喜んだだけか、それとも、未来の優良顧客となる新規層を獲得できたのか？**」という問いに、データで明確な答えを出します。

---

### **手順**

1.  新しいページを作成し、「**コラボ施策 深掘り分析**」と名前を付けます。
2.  ピボットテーブルを作成します。
3.  このピボットテーブルに、以下の2つのフィルターを設定します。
    * **[Question ID]** が **Q1**
    * **[Answer Text]** が **コラボキャラクターが好きだから**
4.  ピボットテーブルを以下のように構成します。
    * **行 (Rows)**: `[Customer Rank]`
    * **値 (Values)**:
        * **応募者数**: `CountDistinct([Customer Id])`
        * **購買転換率**: `CountDistinct([Purchase Id]) / CountDistinct([Customer Id])`
        * **平均購入単価**: `Avg([Purchase Amount])`

---

### **得られるインサイト**
このテーブルを見れば、応募者数では既存の優良顧客（**プラチナ、ゴールド**）が多くても、購買転換率では、普段は購入に至らない「**レギュラー**」や「**ブロンズ**」といった層が、他のセグメントを圧倒しているという事実を発見できます。これは、**本施策が新規顧客獲得に絶大な効果を発揮したことを示す、強力な証拠となります**。

## **分析要求2：低迷セグメントの原因特定**

### **目的**
「**なぜ、50代以上の顧客は買ってくれないのか？**」という問いに対し、彼らが本当に求めている価値と、我々の訴求メッセージの「**ズレ**」をデータで証明します。

---

### **手順**
1.  新しいページを作成し、「**年代別 価値観分析**」と名前を付けます。
2.  積み上げ棒グラフを作成します。
3.  グラフを以下のように構成します。
    * **X軸**: `[Answer Text]`（Q2の回答）
    * **Y軸**: `CountDistinct([Customer Id])`
    * **色 / 積み上げ**: `[Age Group]`
4.  グラフのフィルターを2つ設定します。
    * **[Question ID]** が **Q2**
    * **[Age Group]** が **30代** と **50代以上** の2つに絞り込む
5.  グラフの設定で、積み上げの表示形式を**「100%」**に切り替えます。

---

### **得られるインサイト**
年代ごとの回答比率の違いが明確になります。「**30代**」は「**新しさ・話題性**」を重視する一方、「**50代以上**」は「**味の信頼性**」を圧倒的に重視している、といった価値観のギャップが可視化され、キャンペーンのメッセージが、ターゲット層に響いていなかったという仮説を裏付けられます。

***

## **分析要求3：流入チャネルと顧客単価の相関分析**

### **目的**
応募者の「**数**」だけでなく、顧客一人あたりの「**質（購入単価）**」を同時に評価し、最も**費用対効果の高い広告チャネル**を特定します。

---

### **手順**
1.  新しいページを作成し、「**チャネル別 費用対効果分析**」と名前を付けます。
2.  バブルチャートを作成します。（グラフの種類で「**散布図**」を選択）
3.  グラフを以下のように構成します。
    * **X軸**: `CountDistinct([Customer Id])` （応募者数 = 量）
    * **Y軸**: `Avg([Purchase Amount])` （平均購入単価 = 質）
    * **点の色 (Color)**: `[Answer Text]`（Q3の回答 = チャネル名）
    * **点の大きさ (Size)**: `Sum([Purchase Amount])` （総売上 = ビジネスインパクト）
4.  グラフのフィルターで、**[Question ID]** が **Q3** のデータだけに絞り込みます。

---

### **得られるインサイト**
「**Instagram**」は応募者数（**X軸**）は多いが、平均購入単価（**Y軸**）は低い（**右下のバブル**）、「**Web検索**」は応募者数は少ないが、単価は高い（**左上のバブル**）といった、チャネルごとの特性がマトリクスで識別可能となり、広告予算の最適な再配分を検討するための、判断材料となります。

## **分析要求4：AIによる「改善提案」の自動抽出と優先順位付け**

### **目的**
アンケートの自由回答という「**宝の山**」から、AIを使って本当に対応すべき「**改善提案**」だけを自動で抽出し、さらに顧客ランクと掛け合わせることで対応の**優先順位**を明確にします。

---

### **手順**

1.  **分析用ページの作成**
    * 新しいページを作成し、「**顧客の声（AI分析）**」と名前を付けます。

2.  **分析対象データの準備**
    * テーブル要素を追加し、フィルター機能でアンケートの設問 `[Question ID]` が **「Q6」（自由回答）** の行だけに絞り込みます。

3.  **AIによる自由回答の自動分類**
    * テーブルに、以下のAI関数を使った計算列を追加します。これが改善提案を自動抽出する心臓部となります。

    * **[感情]列: AI関数**
        * 以下の関数を計算列として入力し、自然言語のテキストから感情スコア（-1から1）を自動で算出します。
        ```sql
        CallNumber("SNOWFLAKE.CORTEX.SENTIMENT", [Answer Text])
        ```
        * 算出されたセンチメントスコアを基に、以下の`If`文などで「Positive」「Negative」「Neutral」の3つに分類します。
        ```sql
        If([センチメント数] > 0.02, "Positive", If([センチメント数] < -0.02, "Negative", "Neutral"))
        ```

    * **[コメント種別]列: AI関数**
        * 以下の関数を計算列として入力します。AIがコメント内容を読み解き、「改善提案」「感想」「その他」のいずれかに自動でタグ付けします。
        ```sql
        CallVariant("SNOWFLAKE.CORTEX.COMPLETE", "llama3-8b", "以下のテキストを、「改善提案」「感想」「その他」の3つのカテゴリの中から最も適切なものを1つだけ選んで分類してください。カテゴリ名だけを返してください。テキスト： " & [Answer Text])
        ```

4.  **改善提案の割合を可視化**
    * AI分析後のテーブルを基にドーナツグラフを作成し、`[コメント種別]` の全体に占める構成比を可視化します。（改善提案が全体の何割あるかを確認します）

5.  **「優先すべき改善提案」をハイライト**
    * 元のテーブルに戻り、条件付き書式を設定します。以下の2つの条件を両方満たす行が、赤色などで強調表示されるようにします。
        * **条件1**: `[コメント種別]` が **改善提案**
        * **条件2**: `[顧客ランク]` が **プラチナ**

---

### **得られるインサイト**
この分析によって、最もロイヤルティの高い「**プラチナ顧客**」から寄せられた、具体的な「**改善提案**」の一覧を瞬時に特定できます。
こちらを「**顧客離反を防ぎ、満足度をさらに向上させるために、最優先で取り組むべきアクションリスト**」として、そのまま次の改善活動に活用できます。
