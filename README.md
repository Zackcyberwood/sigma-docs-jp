<img width="881" height="272" alt="image" src="https://github.com/user-attachments/assets/a8e38ff0-4eaa-45c9-9b2c-af9040be75d3" /><img width="707" height="527" alt="11_テーブルの名前変更" src="https://github.com/user-attachments/assets/e227c94e-126d-494f-b78a-218ab69a6378" /># Sigmaキャンペーン分析ユースケース

# 1. 背景と目的

## 1-1 対象読者：
* マーケティング部門の分析業務担当者およびマネージャー
* 商品企画、イベント企画の立案担当者
* 販売戦略・営業企画の担当者

## 1-2 従来の分析プロセスにおける課題
本ユースケースにおける従来の分析プロセスでは、以下の3つの主要な課題に直面しています。

### 1. 分析準備における非効率な手作業
キャンペーン施策の分析に着手する前段階において、手作業による非効率が常態化しています。
* **キャンペーン毎の分析ロジックの再構築**
    * 施策ごとに設問やデータ構造が異なるため、その都度、結合や集計のロジックをExcel上で手作業で組み立て直す必要がある。
* **複数データソースの手作業による結合・前処理**
    * DWHの購買履歴や会員情報、ローカルのアンケートファイルなど、分散したデータを手動で突合・クレンジングしている。
* **ヒューマンエラーによる手戻りと検証コストの増大**
    * 手作業に起因する計算ミスや参照範囲の誤りが、後工程での手戻りや、ダブルチェックといった検証コストを発生させている。

### 2. Excelの性能限界に起因する技術的制約
分析に使用するツールの性能が、分析の質とスピードを律速しています。
* **大規模データ処理時のパフォーマンス低下**
    * キャンペーン参加者数や購買データが数万行を超えると、Excelの動作が極端に遅延、あるいは応答不能（クラッシュ）となる。
* **リアルタイムな対話的分析の実行困難**
    * パフォーマンスの問題により、会議中に新たな切り口でデータを再集計するといった、対話的・探索的な分析が事実上不可能となっている。

### 3. 属人化・中央集権化がもたらす組織的障壁
分析業務の進め方が、組織全体としての俊敏性や継続性を損なっています。
* **個人のスキルに依存する「Excelのブラックボックス化」**
    * 特定の担当者しか解読・編集できない複雑なExcelファイルが作成され、業務の属人化を招き、担当者不在時の業務継続リスクとなっている。
* **IT部門への依頼が集中する「分析のボトルネック化」**
    * データ抽出をIT部門に都度依頼する運用では、マーケターが仮説を思いついてから検証するまでのリードタイムが長くなり、主体的なデータ探索を阻害している。

## 1-3 Sigmaによって実現する新しい分析の在り方
* **分析準備プロセスの標準化と自動化**
    * キャンペーンごとに異なるデータソースを手作業で都度結合・加工するといったプロセスを効率化・自動化します。
    * Sigmaでは、データのクレンジングや正規化といった前処理をシステム上で標準化可能です。
    * 一度データモデルを構築すれば、参照するファイルやデータが更新されても、定義済みの計算式やダッシュボードが破損することはありません。
    * これにより、これまで準備作業に費やしていたリソースを、インサイトの発見や戦略立案といった、より付加価値の高い業務へシフトさせることが可能になります。
* **対話的なデータ探索による、意思決定の迅速化**
    * 静的な資料を基にした一方的な「報告会」から、チーム全員が参加するインタラクティブな「探索セッション」へ移行できます。
    * Sigmaでは、大規模データであっても、多くの人が使い慣れたピボットテーブルのような直感的な操作で、ストレスなくリアルタイムなアドホック分析が可能です。
    * 会議中に新たな問いが生まれても、その場でデータを深掘りし、根拠に基づいた検証を行うことができます。
    * これにより、問いの発生からインサイト獲得、そして次のアクションプラン策定までのサイクルが劇的に高速化し、データドリブンな意思決定を組織に根付かせます。
* **脱・属人化：専門スキル不要の分析環境**
    * 担当者個人の技巧的なスキルに依存した、ブラックボックス化したExcelファイルは不要になります。
    * Sigmaは、多くのビジネスユーザーが習熟しているスプレッドシート形式のインターフェースと、互換性の高い関数構文を採用しているため、導入時の学習コストを低減します。
    * ドリルスルーやフィルタリングといったGUIベースの操作に加え、AIアシスタントに自然言語で指示するだけで、データ分析を実行できます。
    * これにより、データサイエンティストのような専門職でなくとも、ビジネス担当者自身が主体的にデータを探索・分析する環境が構築されます。

---
**ハンズオンの難易度：** 初心者〜中級者

Excelでのデータ集計・分析（VLOOKUP、ピボットテーブル等）の実務経験がある方を主な対象としています。
（TableauやPower BIなど、他のBIツールの使用経験があれば、よりスムーズにご理解いただけます）

## 2-1 業務シナリオ：2025年上半期キャンペーン施策振り返り会議
本会議の目的は、2025年の上半期に実施したキャンペーンデータに基づいて、施策から得られたインサイトを全員で発見し、次の具体的なアクションプランへと繋げることです。

---

### シーン0：第一回目のキャンペーン分析結果報告会での課題
第一回のキャンペーン分析結果報告会に先立ち、担当者は1週間前よりDWHから抽出した購買履歴やアンケート結果といった複数のデータソースを、PC上のExcelを用いて手作業で統合する作業に着手しました。このVLOOKUP関数等を多用したデータ結合と集計プロセスは、多くの工数を要するものでした。
会議当日、準備されたレポートに基づく報告は進みましたが、質疑応答の中で「このキャンペーンで初めて商品を購入した『新規顧客』は、どの商品カテゴリに関心を持ったのか？」といった、事前集計の範囲を超える分析要求が発生しました。担当者がその場で対応を試みたところ、大規模な元データを再集計しようとしたExcelは応答不能となり、即座に回答することができませんでした。
この一連の事象を経て、次回の会議ではSigmaのBIツールを使って、分析結果の報告会を行うという方針に決まりました。

---

### シーン1：次回の振り返り報告会に向けたサマリーダッシュボードの構築準備
Sigmaの導入は、まず分析準備のワークフローを抜本的に変革しました。これまで数日を要していたデータ準備作業は、担当者自身がSigma上でデータモデルを構築することで、迅速に完了します。DWH上の大規模データである会員情報や購買履歴、キャンペーン情報、アンケート回答といった5つのデータソースは、GUIベースのJoin機能で一度結合ルールを定義すれば、統合・自動更新されます。さらに、分析の過程で商品マスタ等の小規模な補助データを参照する際は、スプレッドシート製品と互換性の高いLookup()関数が有効です。これにより、データモデルの複雑性を上げることなく、必要な情報のみを柔軟に抽出・追加できます。
この「準備作業」の効率化により、担当者は、次回の報告会に向けて、議論の質を最大化するための「対話の起点」となるサマリーダッシュボードの設計・構築に注力できるようになりました。
以下は、その効率化されたプロセスを通じて、担当者が会議の共通認識基盤として準備した、ダッシュボードの可視化項目です。

**【全体像の把握】**
* 主要KPI（応募総数、商品購入人数、購買転換率）
* キャンペーン期間中の週間応募数・商品購入人数の時系列推移

**【顧客セグメント分析】**
* 参加者のデモグラフィック（年代、性別、地域）や顧客ランク別構成

**【チャネル・購買分析】**
* チャネル別 費用対効果分析: 応募者の「量（数）」と「質（平均購入単価）」を同時に評価するためのバブルチャート。

**【定性データの活用】**
* 自由回答からAIで抽出したキーワードや感情（ポジティブ/ネガティブ）の傾向
* アンケートの自由回答をAIを用いた関数で解析し、改善案となるコメントを抽出

これらの項目を可視化させたサマリーダッシュボードを基軸に、第二回の振り返り会議の中ではディスカッションが行われます。

### シーン2： リアルタイム・アドホック分析による「探索セッション」の実現

第二回目のキャンペーン分析結果報告会当日。担当者は事前に構築したインタラクティブなダッシュボードをスクリーンに投影し、議論を開始します。

**1. 全体像の提示と、最初の「問い」**
まず、担当者は主要KPIサマリーと時系列推移グラフを示し、「2025年上半期は、3月と5月に大きな応募の山があり、全体として応募者数は過去最高を記録しました」と報告します。
しかし、目標達成率を示すゲージチャートは、目標の30%にわずかに届かず、黄色信号を灯しています。
これを見た部長が、最初の問いを投げかけます。「応募者数は好調なのに、なぜ目標に届かなかったんだ？どの施策が、足を引っ張っているんだ？」

**2. ドリルダウンによる、原因の特定**
その問いに対し、担当者は**「応募者プロファイル・エクスプローラー」を操作します。
まず、X軸を[Campaign Type]に設定し、「タイアップ・コラボ型」の応募者数が最も多いことを示します。
次に、その「タイアップ・コラボ型」の棒グラフをクリックし、購買転換率でドリルダウン**します。すると、その転換率が、他の施策タイプより著しく低いことが明らかになります。
「足を引っ張っていたのは、応募者数こそ多いものの、購買に繋がらなかった『タイアップ・コラボ型』施策です」と、担当者はデータで回答します。

**3. バブルチャートによる、次の「打ち手」の発見**
「では、逆に、我々が次に注力すべき、最も『質の高い』顧客を連れてきてくれるチャネルはどこだ？」という問いには、「チャネル別 費用対効果分析」のバブルチャートが答えを示します。
応募者の「数」ではInstagramが最大ですが、「平均購入単価」が最も高いのは「Web検索」であることが一目瞭然となり、「下半期は、Web検索チャネルへの予算配分を強化すべきです」という、具体的な提言に繋がります。

**4. AI分析による、潜在リスクの発見**
最後に、担当者は**「AIによる顧客の声 分析」モジュールを提示します。
「そして、これが今回の分析で最も重要な発見です。AIで自由回答を分析したところ、『改善提案』に分類されたコメントの中で、『決済方法を増やしてほしい』という声が、我々の最も大切な『プラチナ』顧客**から、複数寄せられていることが判明しました。これは、将来の離反に繋がりかねない、重要なリスクシグナルです」

結論
会議は、単なる結果報告の場ではなく、ダッシュボードという共通言語の上で、全員がデータと対話し、次々と生まれる問いにその場で答えを見つけ、具体的な次のアクションプラン（Web検索広告の強化と、決済方法の見直し）を決定する、極めて生産的な「探索セッション」へと進化したのです。

# 3. 完成イメージ（成果物の可視化例）
本ハンズオンを完了すると、以下にご紹介するような、キャンペーンの成果を多角的に評価できるインタラクティブなダッシュボードが完成します。このダッシュボードは、単なる静的なレポートではなく、チーム全員でデータと対話し、インサイトを発見するための「分析の出発点」として機能します。

### 3-1 完成ダッシュボードの全体像
<img width="1313" height="853" alt="3-2 キャンペーンサマリー" src="https://github.com/user-attachments/assets/e87a47b7-bd03-4110-9c48-182be517432d" />

### 3-2 主要コンポーネントの説明
ダッシュボードは、以下の主要な可視化コンポーネントで構成されています。

## **主要KPIサマリー & 目標到達度**

* **応募総数 / 購入人数 / 購買転換率:**
    * **役割:** このダッシュボードの「結論」です。上半期全体の成果（応募者数、購入者数、転換率）を一目で把握するための、最も重要な指標を示します。

* **目標到達度（ゲージチャート）:**
    * **役割:** KPIの中でも特に重要な「購買転換率」が、私たちが設定した目標に対して、「良かったのか、悪かったのか」を、スピードメーターのように直感的に評価します。

### **参加者・購買者トレンド分析**

* **参加数・商品購買者数時系列推移（折れ線グラフ）:**
    * **役割:** 上半期の中で、「いつ」**応募の山が来て、**「いつ」**購買の山が来たのか、その**「勢い」**と**「物語」**を可視化します。3月と5月の、性質の異なる2つの山の違いが、ここで明らかになります。

### **顧客セグメント深掘り分析**

* **年齢別カスタマーランク構成（積み上げ棒グラフ）:**
    * **役割：** 参加者が「誰だったのか」、その内訳を「年齢」と「顧客ランク」という2つの軸で分解します。「30代の応募者が最も多いが、その中身を見ると、実は優良顧客である『ゴールド』ランクの割合が高い」といった、顧客の「量」と「質」を同時に評価できます。

* **応募者プロファイル分析（ドリルダウン機能付き棒グラフ）:**
    * **役割：** このダッシュボードの「対話の中心」です。見る人が「では、コラボ施策の内訳は？」と気になった瞬間に、棒グラフをクリックし、年代別、性別、顧客ランク別…と、次々に深掘り（ドリルダウン）していくための、インタラクティブな分析ツールです。

* **チャネル・購買単価相関分析（バブルチャート）:**
    * **役割：** 「広告チャネルの費用対効果」を、一枚の絵で、多角的に評価します。横軸で「応募者の数（量）」、縦軸で「平均購入単価（質）」、そして円の大きさで「総売上（ビジネスインパクト）」を示すことで、「Instagramは集客に強いが、Web検索は収益性が高い」といった、**チャネルごとの明確な「役割」**を特定します。

### **AIによる顧客の声 分析**

* **センチメント分析（ドーナツグラフ）:**
    * **役割：** AI分析の成果を発表するエリアです。顧客の声の全体的な「感情（ポジティブ/ネガティブ）」の割合を示します。

* **アンケート自由回答分析（テーブル）:**
    * **役割：** AIが抽出した**「具体的な改善提案」**を、**顧客ランク**と共に一覧表示します。これにより、「我々が次に取り組むべき、最も価値のある声は何か」を、データに基づいて特定します。

# 第4章：ハンズオン：インタラクティブ・ダッシュボード構築手順

この章では、Snowflakeに準備した5つのテーブルを基に、Sigmaを使って、意思決定を支援するインタラクティブなダッシュボードをゼロから構築します。

---

### **Phase1：データ準備・結合**

**目的：**
全ての分析の土台となる、Snowflake上の5つのテーブルをSigmaに接続し、それらを正しく結合して、分析の起点となる「分析用データセット（ワークシート）」を作成します。

#### **Step 1：新しいワークブックの作成**

まず、分析の作業スペースとなる、まっさらな「ワークブック」を作成します。

**手順：**

1.  Sigmaにログインし、画面左上にある青い**「作成（Create New）」**ボタンをクリックします。
2.  表示されたメニューの中から、**「ワークブック（Workbook）」**を選択してください。

[画像挿入]<img width="1269" height="403" alt="1_ワークブックを開く" src="https://github.com/user-attachments/assets/a65e88c6-48dd-41c1-bf9d-031b2d869847" />


**✅ このステップのゴール**
「データソースを選択」という新しい画面が表示されれば、最初のステップは成功です！



#### **Step 2：分析の「軸」となるデータソースの選択**

次に、分析の中心となるテーブルを、まず一つSigmaに呼び出します。

**手順：**

1.画面中央下の**Data**をクリックし、**Table**を選択します。

<img width="302" height="133" alt="2_データのテーブルを開く" src="https://github.com/user-attachments/assets/42871efb-8692-49e3-a1de-a96413555243" />

2.「データソースを選択」画面でを**「接続（Connections）」** タブを選び、あなたのSnowflake接続をクリックします。その後、接続先にあるデータベースの中から指定のデータベースをクリックし、次にスキーマをクリックします。

<img width="304" height="524" alt="3_Connectionを選択" src="https://github.com/user-attachments/assets/09cabe97-5f3a-412d-8894-4976d9f19515" />

3.テーブルの一覧から、分析の「ハブ（中心）」となる**TBL_ANSWERS（アンケート回答）テーブルを**選択します。

<img width="311" height="520" alt="4 TBL_ANSWERのテーブル選択" src="https://github.com/user-attachments/assets/54a91836-4e89-4fd2-80ca-b2fd204b4533" />

4. 選択が完了したら、右上の「開始」ボタンをクリックします。

**✅ このステップのゴール**
画面が切り替わり、TBL_ANSWERSテーブルだけが表示された、Sigmaのワークシート画面になれば成功です！

#### **Step 3：テーブルの結合（Join）**
**目的：**
TBL_ANSWERSテーブルに、他のテーブルを結合して、分析に必要な情報を追加していきます。この操作で、バラバラだった5つのデータが、意味のある一つの大きなデータセットに生まれ変わります。

**手順：**

1. 画面上部に表示されているTBL_ANSWERSテーブル要素の、右上にある3点リーダー「…」をクリックします。
   表示されたメニューの中から**Edit element source**を選択します。
   ソースパネルが開いたら、**Join** ボタンをクリックします。
   
<img width="1895" height="608" alt="6 Joinの表示png" src="https://github.com/user-attachments/assets/d0362a6a-7df0-451a-84c1-4100b330a6eb" />

2.「新しいソースを追加」画面で、MY_HANDSON_DB.PUBLICスキーマの中から、TBL_CUSTOMERS（会員情報） テーブルを選択し、「Join」をクリックします。
<img width="1076" height="785" alt="7 CustomerIDとのJoin" src="https://github.com/user-attachments/assets/6daf2ba9-32b4-465c-bfeb-f52ec99319fe" />


3. 結合キー設定画面で、両方のテーブルのCUSTOMER_IDが自動で選択されていることを確認し、結合を確定します。
<img width="573" height="475" alt="8  Left Outerjoinで結合" src="https://github.com/user-attachments/assets/b30e79cd-f738-4a33-a8d7-7218d11b1012" />

4. 同様の手順を繰り返し、以下の結合を順番に追加していきます。

* **TBL_ANSWERS と TBL_CAMPAIGNS を CAMPAIGN_ID で結合**

* **TBL_ANSWERS と TBL_QUESTIONS を QUESTION_ID で結合**

* **TBL_CUSTOMERS と TBL_PURCHASES を CUSTOMER_ID で結合**

最後に、TBL_CUSTOMERSとTBL_PURCHASESを繋いでいる線の中央にある、円が2つ重なったアイコン（結合タイプ）をクリックし、「左外部結合（Left Join）」を選択します。

<img width="1903" height="995" alt="10 ５つのデータのJoin画面" src="https://github.com/user-attachments/assets/da63f921-6aa1-4137-88e9-e01b49393dd0" />

**✅ このステップのゴール**
5つのテーブルが正しく結合され、多角的な分析を行うための準備が整った、一つの大きなデータセット（ワークシート）が完成します。

#### Step 4：テーブル名の変更

**目的：**
5つのテーブルを結合して作成した、この分析の土台となるデータセットに、その役割が一目で分かる、適切な名前を付けます。

手順：

1. Sigmaのワークシート画面で、5つのテーブルを結合したテーブルの上部に表示されているタイトルを選択します。

2. 名前が編集できる状態になるので、**キャンペーン統合データ**といった、このデータセットの役割を表す、分かりやすい名前に任意で変更してください。

<img width="707" height="527" alt="11_テーブルの名前変更" src="https://github.com/user-attachments/assets/b8e43e1b-7609-4c64-9011-379b5c586ab4" />

✅ このステップのゴール
分析の土台となるデータセットに、その役割を示す適切な名前が付けられ、この後の分析作業で、誰もが迷うことなく、このデータを参照できるようになります。

### Phase2：データの集計・グラフの作成

**目的：** 

結合したデータを基に、KPIやグラフを作成し、キャンペーンの成果を多角的に可視化します。

**Step 1：主要KPIサマリーの作成** 

**目的：**

ダッシュボードの「顔」となる、上半期全体の成績が一目でわかるサマリーを作成します。このステップでは、3つの異なるKPIカードを、それぞれ独立して作成していきます。

**手順：**

1. 新しいページの作成を行うために、ワークブックの左下にある「＋」ボタンから統合データの複製を作成します。

2. フィルター機能として、画面右上部の「Filter&Control」エリアに、TBL_CAMPAIGNSの[Start Date]をドラッグ＆ドロップし、期間を「2025年1月1日」から「2025年6月30日」まで**に設定します。「上半期キャンペーンデータ」などと名前を変更してください。

<img width="1727" height="561" alt="2-1 統合データのフィルタリング" src="https://github.com/user-attachments/assets/15b12a7f-f701-484e-9d22-a11b4b11a1db" />

3.続いて、応募総数のKPIカードを作成します。
画面中央下の「＋」ボタンから**可視化（Visualization）**　の表示形式として**KPI**を選択します。

<img width="279" height="315" alt="2-3 カスタマーIDを値（Value）へ移行" src="https://github.com/user-attachments/assets/e8cafc4d-632b-4916-a78a-71b8f795ed4c" />

4. 「値（Value）」エリアに、[Customer Id]列をドラッグ＆ドロップし、集計方法が**CountDistinct**（ユニークな数を数える）になっていることを確認します。

<img width="217" height="527" alt="2-4 CountDistinctへの集計方法の変更" src="https://github.com/user-attachments/assets/f74fcdb8-799e-437e-a116-445a8e234c85" />


5. KPIカードのタイトルを**応募総数**に変更します。

6. 同様に、商品の購入者数に関するKPIカードを作成します。

7. 「値（Value）」エリアに、以下の計算式を入力します。
**CountDistinct([Purchase])**

8. 名前を**購入人数**に変更します。

9. 続いて、３つ目のKPIカードとして、購買転換率を使用します。

10. 再度、「＋」ボタンから新しい**「可視化」要素を追加し、表示形式を「KPI」**に設定します。

「値（Value）」エリアの「Add caluculation」をクリックし、新しい計算式の追加を行います。

<img width="158" height="50" alt="2-5 新しい計算式の追加" src="https://github.com/user-attachments/assets/f169a2c3-fb85-4408-a00e-cebe001a5b71" />

11. 画面上部の関数計算のセルに、以下の計算式を入力します。
**CountDistinct([Purchase ID]/CountDistinct([Customer ID])**

<img width="389" height="28" alt="2-6 購買転換率の計算式" src="https://github.com/user-attachments/assets/07641419-cda4-410c-872a-6e01ffeb56b4" />

12. 要素のタイトルを**購買転換率**に変更します。

13. 計算結果の列名の右側にある、**Format**の書式設定メニューから**Percent**を選択します。

<img width="241" height="707" alt="2-7 書式の変更" src="https://github.com/user-attachments/assets/8444eb3a-2861-4880-bfbd-7ae80d6ff008" />

14.　作成した3つのKPIカードを、ドラッグ＆ドロップで、ダッシュボードの最上部に横一列に配置し、レイアウトの調整をします。

✅ このステップのゴール
2025年上半期の成果を示す、「応募総数」「購入者数」「購買転換率」の3つのKPIカードが、ダッシュボードの最上部に美しく配置された状態になります。

**Step 5：時系列推移グラフの作成**

**目的：**

キャンペーン期間中の**「いつ」「どのくらい」**応募や購買があったのか、その勢いや盛り上がりを折れ線グラフで可視化します。これにより、例えば「3月に応募が集中し、5月に購買のピークが来た」といった、時間軸でのインサイトを発見できます。

**手順：**

1. 新しい可視化要素の追加

* ページに「＋」ボタンから新しい**「可視化（Visualization）」要素を追加し、グラフの種類として「折れ線グラフ（Line Chart）」**を選択します。

<img width="237" height="290" alt="2-8 折れ線グラフの選択" src="https://github.com/user-attachments/assets/4de0c111-288f-4878-b9d3-a424a22b5cf0" />

2. X軸（時間軸）の設定

* 「X軸」エリアに、TBL_ANSWERSテーブルの**Answered At** 列をドラッグ＆ドロップします。
* 表示された日付のピルをクリックし、集計単位を**Week**に切り替えます。これにより、週ごとのトレンドを見ることができます。

<img width="236" height="641" alt="2-9 時系列項目の追加" src="https://github.com/user-attachments/assets/a65d0d7d-e267-48d1-aaef-4172de18978a" />

3. Y軸（2つの指標）の設定

応募者数（1本目の線）

*「Y軸」エリアに、TBL_CUSTOMERSの**Customer Id**をドラッグ＆ドロップし、集計方法を**CountDistinct**（ユニークな数を数える）に設定します。
* 系列の名前を**「応募者数」**に変更します。

購入者数（2本目の線）

* 「Y軸」エリアに、TBL_PURCHASESの**Purchase Id**をドラッグ＆ドロップし、集計方法を**CountDistinct**に設定します。

系列の名前を**購入者数**に変更します。

✅ このステップのゴール
横軸が時間（週単位）、縦軸が人数となった、2025年上半期の応募と購買のトレンドを示す折れ線グラフが完成します。

<img width="610" height="209" alt="2-10 キャンペーン推移完成図" src="https://github.com/user-attachments/assets/368e723a-6261-4b35-b513-34a330421f7f" />

**Step 6：顧客セグメント分析グラフの作成**

**目的：**
キャンペーンに参加した顧客が、どの年代や顧客ランクに多いのか、その構成比を可視化します。これにより、「今回のキャンペーンは、若年層に響いたのか、それとも優良顧客に響いたのか？」といった、ターゲット層へのリーチ状況を明確に把握します。

**手順：**

**1. 新しい可視化要素の追加**

ページに「＋」ボタンから新しい**「可視化（Visualization）」要素を追加し、グラフの種類として「積み上げ棒グラフ（Stacked Bar Chart）」**を選択します。

<img width="163" height="239" alt="2-12 積み上げグラフの色分け" src="https://github.com/user-attachments/assets/a44403f5-f4c5-485c-ad74-2eed07465644" />

**2. X軸（横軸）の設定：年代**

「X軸」エリアに、TBL_CUSTOMERSテーブルの**Age Group**列をドラッグ＆ドロップします。

**3. Y軸（縦軸）の設定：応募者数**

「Y軸」エリアに、TBL_ANSWERSテーブルの**Customer Id**列をドラッグ＆ドロップし、集計方法を**CountDistinct**に設定します。

**4. 積み上げ色の設定：顧客ランク**

グラフ設定の**「色 / 積み上げ（Color / Stack by）」エリアに、TBL_CUSTOMERSテーブルの**Customer Rank**列をドラッグ＆ドロップします。

✅ このステップのゴール
これで、年代ごとの応募者数が棒グラフで表示され、さらにその棒グラフの内訳が顧客ランク（プラチナ、ゴールドなど）によって色分けされた、非常にインサイトに富んだグラフが完成します！

<img width="527" height="317" alt="2-13 積み上げグラフの完成図" src="https://github.com/user-attachments/assets/45a6f347-65c0-4142-bf1f-1d6a64863484" />

**Step 7：応募者プロファイル・エクスプローラーの作成**

**目的：**
見る人が、自らの手で「年代別」「性別」「顧客ランク別」といった、分析の切り口を自由に切り替えられる、インタラクティブな分析ツールを作成します。これにより、会議中に生まれる様々な「なぜ？」に、その場で即座に答えることができます。

**手順：**

1. まず、基本となる棒グラフを作成する
ページに新しい**Visualization**要素を追加し、グラフの種類として**Bar Chart**を選択します。

* X軸: [Age Group]（年代）

* Y軸: CountDistinct([Customer Id])（応募者数）

*これで、「年代別の応募者数」を示す、シンプルな棒グラフが完成します。

2. 続いて、インタラクティブに切り口を切り替えるため、項目の切り替えスイッチを作成します。
<img width="200" height="254" alt="image" src="https://github.com/user-attachments/assets/51a770c3-3767-4ec1-a59e-54c5ca79cfa3" />

* ページに新しい**Controls**要素を追加し、グラフの種類として**Drill Down**を選択します。
* **Value Source**の欄で、先ほど作成したグラフを選択します。
* 次に、**Answer Text**,**Age Group**,**Gender**,**prefecure**,**Campaign Type**を**Drill Categories**に追加します。

<img width="220" height="308" alt="2-18 Drill Down項目" src="https://github.com/user-attachments/assets/99ae7420-ae09-4cb6-8c8d-b42814ebb9e4" />

*ドリルダウン項目のコントロールパネルの項目を切り替えてください。その切り替えと棒グラフの動きが連動している場合は成功です。

<img width="412" height="275" alt="2-19 インタラクティブ棒グラフ完成図" src="https://github.com/user-attachments/assets/6f12fb3b-6c07-4ae2-91a9-de5c459ba010" />

Step 8：【応用編】バブルチャートによる広告チャネル分析
目的： 応募者の「数（量）」と、顧客一人あたりの「価値（質）」という、2つの異なる指標の関係性を、一枚のグラフで直感的に表現します。

1. バブルチャートの「設計図」となる集計表を作成し、ワークブックに、新しい**ピボットテーブル**要素を追加します。

2. 以下の設定を行ってください。

* **行 (Rows): [Answer Text]（Q3の回答 = チャネル名）**

* **値 (Values):**

* **CountDistinct([Customer Id])** → 列名を**応募者数**に変更

* **Avg([Purchase Amount])** → 列名を**平均購入単価**に変更

* **Sum([Purchase Amount])** → 列名を**総売上**に変更

** フィルター機能を使用して、 **Question ID**が**Q3**のデータだけに絞り込みます。

3. 集計表を基に、バブルチャートを作成

* 今作成したピボットテーブルを選択した状態で、画面下部の「＋」ボタンから、グラフの種類として**Scatter**を選択します。

* 左側の設定パネルで、以下の設定を行ってください。

* **X軸: [応募者数]**

* **Y軸: [平均購入単価]**

* **点の色 (Color): [Answer Text]**

* **点の大きさ (Size): [総売上]**

✅ このステップのゴール 横軸が「応募者数」、縦軸が「平均購入単価」、そして円の大きさが「総売上」を示す、\バブルチャートが完成します。
<img width="228" height="269" alt="2-20 バブルチャート完成図" src="https://github.com/user-attachments/assets/977e8ac3-b7b2-4ed8-a3e5-9c8004f7aeef" />

**Step8:AIを活用した定性データの分析**

**目的：**
アンケートの自由回答（Q4）という、自由回答データから、SigmaのAI機能を使って、センチメント分析と特定のフィードバックの自動抽出を行います。

**手順：**

1. AI分析用のテーブル準備

* ページに「＋」ボタンから新しい**「テーブル（Table）」**要素を追加します。

* 作成したテーブル要素のフィルターパネルで、[Question Id]が**「Q4」**（ご意見・ご要望）の行だけに絞り込みます。

* テーブルに、[Customer Rank]と[Answer Text]の列を表示させておきましょう。

2. AIによる「感情分析」

* まず、感情スコアの算出するために、新規作成したテーブルに、新しい計算列を追加します。

**列名: [感情スコア]**

**計算式: CallNumber("SNOWFLAKE.CORTEX.SENTIMENT", [Answer Text])**

※　機能解説: このCallNumber関数は、Snowflake CortexのSENTIMENT機能を直接呼び出し、各コメントの感情を-1（ネガティブ）から1（ポジティブ）の間の**数値（スコア）**として返します。

<img width="331" height="23" alt="2-14 AI関数" src="https://github.com/user-attachments/assets/7d19f6b0-a4ec-4c85-89bc-97b13a77a9ba" />

3. スコアのビジネス上の意味への変換を行うために、もう一つ新しい計算列を追加します。

**列名: [感情]**

**計算式: If([感情スコア] > 0.2, "ポジティブ", [感情スコア] < -0.2, "ネガティブ", "ニュートラル")**

※　機能解説: このIf文は、AIが算出した生のスコアを、「0.2より大きければポジティブ」といった、私たちがビジネス上判断しやすいラベルに変換します。

<img width="441" height="20" alt="2-15 日本語表記ルール付け" src="https://github.com/user-attachments/assets/73fb52f7-1948-417f-9707-b71426c33abb" />

4.AIによる「改善点の抽出」のため、さらに、もう一つ新しい計算列を追加します。ここでは、Snowflake Cortexのより高度なLLM（大規模言語モデル）を直接呼び出すCallText()関数を使います。

**列名: [具体的な改善点]**

**計算式:**

**CallText("SNOWFLAKE.CORTEX.COMPLETE", "llama3-8b", "以下のテキストを読んで、「顧客が指摘している具体的な改善点は何か？」という質問に答えてください。**日本語で**答えてください。もし改善点がなければ「特になし」とだけ答えてください。テキスト： " & [Answer Text])**

※　機能解説: この関数は、Snowflake Cortexが提供するllama3-8bという大規模言語モデルに対し、「コメントを読んで、具体的な改善点だけを日本語で抜き出してください」という、非常に高度な指示を直接送ることができます。

5. 分析結果を可視化し、アクションに繋げる
* 最後に、AIが構造化したデータを、**「全体像を把握するグラフ」と「具体的なアクションリストとしてのテーブル」**という、2つの要素を組み合わせて可視化します。

1. ドーナツグラフで「全体像」を把握する

今作業しているAI分析テーブルを親として、新しい**可視化**要素を追加し、グラフの種類として**Donut Chart**を選択します。

**スライスの色 (Color): [感情]**

**スライスの大きさ (Arc): CountDistinct([Customer Id])**

2. テーブルと「条件付き書式」で、改善案をハイライトする

* ドーナツグラフの隣に、AI分析テーブルそのものを配置します。

* テーブルの**[具体的な改善点]列を選択し、「書式（Format）」タブから「＋ Add new rule」**をクリックします。

* 以下のルールを設定します。

**条件:Text Does not contain '特になし'**

**書式: 背景（Background）を薄い黄色に設定**

* これにより、AIが「改善点あり」と判断した行だけが、自動でハイライトされます。

<img width="163" height="353" alt="2-16 条件付け" src="https://github.com/user-attachments/assets/ac58bf12-52ab-4ebe-b9cf-86fc9b0b06e1" />


✅ このステップのゴール
このステップを完了した時、あなたの手元には、顧客の声の全体像を直感的に示すドーナツグラフとその中から、AIが「改善点あり」と判断した、具体的なコメントだけがハイライトされたテーブル
という、2つが連動した、分析モジュールが完成しています。

<img width="881" height="272" alt="2-21 AIサマリー完成図" src="https://github.com/user-attachments/assets/185ec154-f3f8-4418-bc17-34eaff5ed785" />






# 5.他のアカウントタイプでのユースケース事例

これまでのハンズオンは、主にデータを準備し、ダッシュボードを構築する**Build**ライセンスを持つ、分析担当者の視点で進められてきました。

本章では、この一つのダッシュボードを基点として、「Viewer」、「Act」、「Analyze」の異なるライセンスと役割を持つ人々が、それぞれの立場で、どのようにデータを活用し、ビジネス価値を創造していくのか、その具体的なユースケースを解説します。
---

Viewer（閲覧者）：意思決定を行う「経営層・他部署の部長」
役割：
分析を主な業務としない、ビジネス上の意思決定者や関係者。報告会の結果を迅速に把握し、全社的な視点から、次の大きな方針を決定することが目的。

得られるメリット：
報告を聞きながら、自らの手で、瞬時に「裏付け」と「新たな発見」を得られる。
分析担当者の報告を鵜呑みにするだけでなく、リアルタイムにデータを深掘りすることで、より確信を持って、次の意思決定を下せる。

Sigmaの機能と、会議での具体的なアクション：

あなたが提示したダッシュ-ボードで、「『新商品ローンチ型』施策が好調」であることを確認した経営層が、その場で新たな疑問を口にします。「素晴らしい成果だ。では、その好調な新商品施策は、どの顧客ランクに、どれくらい売れたのか、その構成比を見せてくれ」

経営層のメンバーは、あなたに依頼するのではなく、自らダッシュボード上部の**Ask Sigmaに「新商品ローンチの売上を、顧客ランク別に円グラフで」**と日本語で入力します。

すると、SigmaのAIが瞬時に、その問いに答える円グラフを自動生成し、その成功が主に「プラチナ」「ゴールド」といった優良顧客によるものであることを、経営層自身の目で直接、確認します。

Act（コラボレーション担当者）：議論をアクションに繋げる「キャンペーン運用担当者」
役割：
ビジネスの現場担当者。会議で決定した事項を、次の具体的な「アクション」として、データに直接記録・更新することが主な役割。

得られるメリット：
分析と実行を、シームレスに繋ぐ。
会議で明らかになったインサイトを、その場で即座に、具体的なアクションのステータス更新や、担当者への指示として、データに直接記録できる。

Sigmaの機能と、会議での具体的なアクション：

会議で、「『タイアップ・コラボ型』は、転換率に課題があるため、下半期は戦略を見直す」という方針が決定されました。

Actアカウントを持つ運用担当者は、ダッシュボード上の**Input Table（入力テーブル）を開き、該当する施策のステータスを「実施中」から「要改善計画策定」に、その場で更新**します。

さらに、課題が明確になったグラフ上で、Annotate comments（コメント注釈）機能を使い、「@（ブランドマネージャー名）さん、この層への転換率改善策について、明日までに具体的な計画を提出してください」と、データに直接、指示を書き込みます。

Analyze（深掘り分析を行う関係者）：自らの問いを探求する「ブランドマネージャー」
役割：
ビジネスの現場担当者。公式レポートを基に、自身の担当領域に特化した、より深いアドホック分析を、自らの手で行い、独自のインサイトを発見することが目的。

得られるメリット：
全体の議論を、自分事化し、担当領域における独自の「打ち手」を発見できる。
構築担当者に依存せず、自らのビジネス課題を、自らの手で、データを使って解決できる。

Sigmaの機能と、会議での具体的なアクション：

会議で、「『タイアップ・コラボ型』は、転換率が低い」という報告を聞いた、**「人気アニメ「グルログ」コラボ」**のブランドマネージャーがいました。

彼は、あなたが共有した公式ダッシュボードを**「コピーして（Save As）」**、自分専用の分析環境を瞬時に作成します。

そして、Excelのピボットテーブルと同じ感覚で、[Campaign Name]で自分の担当商品に絞り込み、行にQ2の回答（重視点）、値に購買転換率を設定した、全く新しいクロス集計表を作成。その結果、「私の担当した『グルログ』コラボは、『キャラクター』への興味だけでなく、『味』への興味から購入した層の転換率が、他のコラボ施策より2倍も高い」という、自らの担当領域における、独自の勝ち筋を発見します。


# 6. まとめ

## **6-1 本資料の目的の再確認**
本資料は、Sigmaの基本的な操作スキルを習得し、それを実際の業務課題（キャンペーン分析）にどう応用して価値を生み出すか、具体的なユースケースを通じて体感的に理解していただくことを目的としました。

## **6-2 ダッシュボードで可視化できた内容の要点**

### **シーン①：振り返り会議用ダッシュボードの事前作成**
本ハンズオンで作成したダッシュボードでは、以下の多角的な視点での可視化を実現しました。

* **全体像の把握**: 主要KPIや時系列推移による、キャンペーン成果の俯瞰。
* **顧客セグメント分析**: 参加者のデモグラフィックや顧客ランク別の行動特性の把握。
* **意識と行動の相関分析**: アンケート回答と購買行動を紐づけた、顧客インサイトの深掘り。
* **定性データの活用**: AIを用いた自由回答の分析による、顧客の生の声の定量化。

### **シーン②：振り返り会議内での分析要求**

* **優良セグメントの深掘りによる、貢献顧客層の特定**：施策に好意的な顧客層をさらに顧客ランク別に分解し、キャンペーンが特に「**新規・ライト層**」の獲得に効果的であったことを突き止めました。
* **低迷セグメントの原因特定と、改善指針の導出**：成果の低かった顧客層のアンケート回答を分析し、**訴求メッセージとターゲットニーズの不一致**を発見。具体的なクリエイティブ改善の指針を得ました。
* **流入チャネル別の量と質（顧客単価）の比較による、広告費用の最適化**：応募者数（量）と平均購入単価（質）をチャネル別に比較し、**より収益性の高いチャネルを特定**。広告予算の再配分を検討するための判断材料を得ました。
* **AIを活用した定性データ分析による、潜在リスクの発見**：アンケートの自由回答をAIで分類・分析し、KPIの好調さの裏に隠れた、**特定の優良顧客層が抱えるサービスへの不満（将来の離反リスク）**を特定しました。

## **6-3 Sigmaを用いたことによって得られた業務上のメリット**
Simgaのハンズオンをして、不要工数の削減と分析業務の効率化・民主化という業務上のメリットが生まれました。

キャンペーン情報・アンケート回答・会員属性・購買履歴といった複数のデータソースを素早く統合できる環境が実現できました。これにより、データの結合や正規化・クレンジング等の事前作業に使っていた工数の削減とヒューマンエラーの減少がされました。

設問項目が異なっても、BIツールを改修することなく、分析を実施できることマーケティング担当者自らがターゲットセグメントの抽出や購買特性を迅速に行える状態になりました。分析のリードタイムが劇的に短縮され、担当者が仮説を思いついたその場で検証できるため、施策のPDCAサイクルが高速化しました。また、リアルタイムでのアドホック分析にも対応できることによって、参加者全員が対話しながら即時新しい分析を行うという環境が作られました。

## **6-4 ハンズオン完了によって到達したスキルや操作範囲**
ハンズオン完了によって、参加者のスキルセットは以下のように進化・拡張されました。

* **クラウドデータ基盤の構築スキル**:
    ローカルのExcelファイル操作から、クラウド上の複数のデータソース（DWH、CSV）をGUIで結合し、分析の土台となる信頼性の高いデータモデルを構築するスキルを習得しました。

* **インタラクティブなダッシュボードの設計・構築スキル**:
    ビジネス目的に沿って、主要KPIやグラフを効果的に配置し、関係者との対話の起点となる、操作可能なダッシュボードを設計・構築するスキルを習得しました。

* **対話的なデータ探索・分析スキル**:
    完成したダッシュボードを基に、フィルターやドリルダウン、ピボットテーブルの再構成といった操作をリアルタイムで行い、新たな問い（仮説）をその場で検証・深掘りしていくスキルを習得しました。

本ハンズオンで得られたこれらのスキルと成果は、今回のキャンペーン分析に留まらず、様々な業務へと応用が可能です。次章では、その具体的な活用の方向性について、一例を提示します。

# 7. 展開例


## **7-1 本キャンペーン分析データを用いた展開事例**

### **展開例1：キャンペーン期間中の「予実管理・ROIモニタリング」ダッシュボード**
これは、キャンペーンが終了するのを待つのではなく、期間の途中でも投資対効果をリアルタイムに把握し、軌道修正を行うための、より実践的な管理ダッシュボードです。

| 項目 | 内容 |
| :--- | :--- |
| **目的** | キャンペーン期間中の予算消化ペースと、それによって得られた売上（リターン）をリアルタイムに可視化し、費用対効果（ROI）の健全性を監視する。 |
| **実現できること** | ・**リアルタイムな予実管理**：「本日時点で、予算を何%消化し、売上目標に対して何%達成しているか」を正確に把握できます。<br>・**着地見込みの予測**：現在のペースで進んだ場合の、キャンペーン終了時点での売上とROIの着地見込みをシミュレーション表示します。<br>・**機動的な投資判断**：もしROIが想定より低い場合、キャンペーン期間中であっても、「非効率な広告を停止する」「効果の高いチャネルに追加投資する」といった、機動的な予算の再配分をデータに基づいて判断できます。 |

#### **手軽なWhat if 分析による精度の高い着地見込み予測**
1.  **Inputコントロール（パラメータ）**
    これが「What-if（もし〜だったら）」を実現する、ユーザーが操作する”ツマミ”の役割を果たします。
    * **何ができるか**: 「広告費の追加予算」「目標達成率の変更」といった変数を、スライダーや入力ボックスとしてダッシュボード上に設置できます。
    * **役割**: 分析を見る人が手元で自由に条件を変えて、結果の変化をシミュレーションできるようにします。

---

### **展開例2：日々の健全性を測る「KPI定点観測」ダッシュボード**
これは、キャンペーンの「結果」を振り返るのではなく、日々の「状況」を把握し、問題の兆候をいち早く発見するための運用監視（モニタリング）ダッシュボードです。

| 項目 | 内容 |
| :--- | :--- |
| **目的** | 日次の応募数や転換率といった、キャンペーンの健全性を示す先行指標を定点観測し、異常を早期に検知する。 |
| **実現できること** | ・**日次パフォーマンスの可視化**：「昨日の応募者数は何人だったか」「今日の午前中時点での転換率は何%か」といった、現場が知りたい最新の数値を常に確認できます。<br>・**早期異常検知**：「昨日まで順調だった特定チャネルからの応募が、今日になって急にゼロになった」といった異常を即座に発見し、広告設定のミスやリンク切れといった原因の調査に迅速に着手できます。<br>・**週次比較による傾向把握**：「今週の応募ペースは、先週の同曜日と比較してどうか」をグラフで比較し、キャンペーンの勢いが維持されているか、あるいは失速しているかを客観的に評価できます。 |

#### **リスク管理**
→ **条件付き書式 (Conditional Formatting)による早期検知**
このフェーズの目的は、膨大なデータの中から「いつもと違う」という異常な数値を自動的に浮かび上がらせることです。
* **何ができるか**: 「応募数が前日比で30%以上減少した」「特定チャネルからの応募がゼロになった」といった、あらかじめ設定した危険なルールに合致する数値を自動で赤くハイライトします。これにより、担当者はダッシュボードを見るだけで、どこに問題が発生しているかを瞬時に認識できます。

→ **原因の迅速な追及**
このフェーズでは、ハイライトされた問題点について、「なぜ？」を繰り返して根本原因を特定します。
* **使う機能**: `Pivot集計` ＋ `ドリルダウン (Drill Down)`
* **何ができるか**: `Pivot集計`で「チャ
>
## **7-2 本ユースケースの横展開案**

### **1. 営業部門：データに基づくセールス戦略の立案**

| 項目 | 内容 |
| :--- | :--- |
| **活用方法** | 営業マネージャーが、特定の顧客セグメント（例：特定の業界、ライトユーザー層）の自由回答を横断的に分析する。 |
| **得られるインサイト** | ・このセグメントは、当社の「**サポート体制**」を強みとして認識している。<br>・一方で、「**他社製品との連携機能**」に改善を望む声が多い、といった傾向を把握。 |
| **ビジネス価値** | チーム全体で共有できる、セグメント別の「**攻略法（セールス・プレイブック）**」を作成可能に。強みであるサポート体制をアピールしつつ、改善要望への対処法を準備しておくことで、営業組織全体の提案力を底上げし、商談の成約率向上に繋がります。 |

#### **誰でもデータに基づいた営業戦略を立案**
このフェーズでは、専門的な操作を一切行わず、普段の言葉でAIに質問するだけで、戦略立案に必要なデータやインサイトを引き出します。

* **使う機能**: `Ask Sigma` (自然言語での対話型分析)
* **何ができるか**: 営業マネージャーや担当者が、分析画面のチャット欄に**「製造業の顧客は、うちの製品のどこに不満を持っている？」**のように、知りたいことを日本語で直接入力します。すると、AIがその質問の意図を理解し、該当するアンケートの自由回答や関連データを集計したグラフや表を自動で生成します。さらに**「その中で、価格に関するコメントだけ見せて」「ポジティブな意見はどんなものがある？」**と対話を続けることで、思考を止めずに次々とデータを深掘りできます。このプロセスを通じて、誰もが「製造業の顧客には、価格よりもサポート体制の充実さをアピールする方が響きそうだ」といった、具体的な戦略仮説を発見し、データに基づいた営業活動へと繋げることができます。

---

### **2. 商品企画部門：顧客の声起点の、商品開発・改善**

| 項目 | 内容 |
| :--- | :--- |
| **活用方法** | 商品企画担当者が、特定の商品に関する自由回答を抽出し、AI機能で「要望」「不満点」といったトピックに分類する。 |
| **得られるインサイト** | ・「**モバイルアプリ版が欲しい**」という新機能への要望が、特に若年層から多数寄せられている。<br>・既存製品の「**初期設定プロセスの複雑さ**」に関する不満が多いことを発見。 |
| **ビジネス価値** | 顧客の具体的なニーズという客観的データに基づいて、新機能の開発や既存機能の改善の優先順位を決定できます。これにより、開発リソースを最も効果的な領域に投下し、製品の市場競争力を高めることができます。 |

#### **商品企画：顧客の声起点の、商品開発・改善**
このフェーズでは、AIの力を借りて、大量の顧客の声を**「客観的な開発要件」**へと変換し、データに基づいた製品戦略を立案します。

* **使う機能**: `各種AI関数` (自動カテゴリ分け、改善要望の抽出、感情分析など) ＋ `フィルタ`
* **何ができるか**: 商品企画担当者が、特定商品に関する数千件の自由回答データに対し、AI関数を適用して複数の分析列を一度に作成します。例えば、**[トピック]列**（自動カテゴリ分け）、**[改善提案]列**（改善要望の抽出）、**[感情スコア]列**（感情分析）といった列が自動で生成されます。これにより、これまで担当者が感覚で読んでいた顧客の声が、構造化されたデータに変わります。担当者は、そのデータをフィルタ機能で「若年層」に絞り込み、**[改善提案]列**を見るだけで、「**若年層からはモバイルアプリの要望が特に多い**」といった具体的なインサイトを発見できます。この客観的データに基づき、開発の優先順位を明確に決定し、限られたリソースを最も効果的な新機能開発や機能改善に投下することが可能になります。
